<!DOCTYPE html><html><head><title>专利 CN102970702A - 一种基于Zigbee协议的无线传感器网络结构维护方法及系统 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_4874c258b856314cce6b80d777b4ee7a/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_4874c258b856314cce6b80d777b4ee7a__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种基于Zigbee协议的无线传感器网络结构维护方法及系统"><meta name="DC.contributor" content="陈岚" scheme="inventor"><meta name="DC.contributor" content="龚关飞" scheme="inventor"><meta name="DC.contributor" content="李莹" scheme="inventor"><meta name="DC.contributor" content="俞雪婷" scheme="inventor"><meta name="DC.contributor" content="中国科学院微电子研究所" scheme="assignee"><meta name="DC.date" content="2012-12-3" scheme="dateSubmitted"><meta name="DC.description" content="本发明提供了一种基于Zigbee协议的无线传感器网络结构的维护方法及系统，其中，所述方法包括：网关节点预先建立网络拓扑结构信息表的步骤；所述网关节点检测到网关子节点的变化并生成网关子节点变化信息的步骤；网络中路由节点检测到路由子节点的变化并生成路由子节点变化信息并上报至网关节点的步骤；所述网关节点根据网关子节点和路由子节点的变化信息更新所述网络拓扑结构信息表，以供用户查询的步骤。通过本发明的方法，实现了在网关节点处存储并维护有网络中的所有节点的信息，解决了现有技术中不能在网关节点获知网络中的网络结构信息的问题。"><meta name="DC.date" content="2013-3-13"><meta name="DC.relation" content="CN:101140695:A" scheme="references"><meta name="DC.relation" content="CN:102572156:A" scheme="references"><meta name="DC.relation" content="CN:102622896:A" scheme="references"><meta name="citation_patent_publication_number" content="CN:102970702:A"><meta name="citation_patent_application_number" content="CN:201210510343"><link rel="canonical" href="https://www.google.com/patents/CN102970702A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN102970702A?cl=zh"/><meta name="title" content="专利 CN102970702A - 一种基于Zigbee协议的无线传感器网络结构维护方法及系统"/><meta name="description" content="本发明提供了一种基于Zigbee协议的无线传感器网络结构的维护方法及系统，其中，所述方法包括：网关节点预先建立网络拓扑结构信息表的步骤；所述网关节点检测到网关子节点的变化并生成网关子节点变化信息的步骤；网络中路由节点检测到路由子节点的变化并生成路由子节点变化信息并上报至网关节点的步骤；所述网关节点根据网关子节点和路由子节点的变化信息更新所述网络拓扑结构信息表，以供用户查询的步骤。通过本发明的方法，实现了在网关节点处存储并维护有网络中的所有节点的信息，解决了现有技术中不能在网关节点获知网络中的网络结构信息的问题。"/><meta property="og:title" content="专利 CN102970702A - 一种基于Zigbee协议的无线传感器网络结构维护方法及系统"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?hl=zh-CN&tbm=isch&source=og&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?hl=zh-CN&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?hl=zh-CN&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN102970702A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN102970702A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=pDTXBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN102970702A&amp;usg=AFQjCNET-5eKicgy6ZItu8f0UnOWMnkkrQ" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/78b3df0ff332d585ed55/CN102970702A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/78b3df0ff332d585ed55/CN102970702A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN102970702A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN102970702A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN102970702A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN102970702B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN102970702A?cl=zh" style="display:none"><span itemprop="description">本发明提供了一种基于Zigbee协议的无线传感器网络结构的维护方法及系统，其中，所述方法包括：网关节点预先建立网络拓扑结构信息表的步骤；所述网关节点检测到网关子节点的变化并生成网关子节点变化信息的步骤；网络中...</span><span itemprop="url">https://www.google.com/patents/CN102970702A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN102970702A - 一种基于Zigbee协议的无线传感器网络结构维护方法及系统</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN102970702A - 一种基于Zigbee协议的无线传感器网络结构维护方法及系统" title="专利 CN102970702A - 一种基于Zigbee协议的无线传感器网络结构维护方法及系统"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN102970702 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201210510343</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2013年3月13日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2012年12月3日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2012年12月3日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102970702B?hl=zh-CN&amp;cl=zh">CN102970702B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201210510343.3, </span><span class="patent-bibdata-value">CN 102970702 A, </span><span class="patent-bibdata-value">CN 102970702A, </span><span class="patent-bibdata-value">CN 201210510343, </span><span class="patent-bibdata-value">CN-A-102970702, </span><span class="patent-bibdata-value">CN102970702 A, </span><span class="patent-bibdata-value">CN102970702A, </span><span class="patent-bibdata-value">CN201210510343, </span><span class="patent-bibdata-value">CN201210510343.3</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%99%88%E5%B2%9A%22">陈岚</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%BE%9A%E5%85%B3%E9%A3%9E%22">龚关飞</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%9D%8E%E8%8E%B9%22">李莹</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E4%BF%9E%E9%9B%AA%E5%A9%B7%22">俞雪婷</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E4%B8%AD%E5%9B%BD%E7%A7%91%E5%AD%A6%E9%99%A2%E5%BE%AE%E7%94%B5%E5%AD%90%E7%A0%94%E7%A9%B6%E6%89%80%22">中国科学院微电子研究所</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102970702A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102970702A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102970702A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (3),</span> <span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (1),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (2),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=pDTXBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201210510343&amp;usg=AFQjCNHlRlktOdVswku9YiyKryHhoRBv-Q"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=pDTXBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D102970702A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNF4y81ifnKSzuJUXimFFQ1lsB6Dxw"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT122641261" lang="ZH" load-source="patent-office">一种基于Zigbee协议的无线传感器网络结构维护方法及系统</invention-title>
      </span><br><span class="patent-number">CN 102970702 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA109542492" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明提供了一种基于Zigbee协议的无线传感器网络结构的维护方法及系统，其中，所述方法包括：网关节点预先建立网络拓扑结构信息表的步骤；所述网关节点检测到网关子节点的变化并生成网关子节点变化信息的步骤；网络中路由节点检测到路由子节点的变化并生成路由子节点变化信息并上报至网关节点的步骤；所述网关节点根据网关子节点和路由子节点的变化信息更新所述网络拓扑结构信息表，以供用户查询的步骤。通过本发明的方法，实现了在网关节点处存储并维护有网络中的所有节点的信息，解决了现有技术中不能在网关节点获知网络中的网络结构信息的问题。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(10)</span></span></div><div class="patent-text"><div mxw-id="PCLM52004199" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.	一种基于Zigbee协议的无线传感器网络结构的维护方法，其特征在于，所述方法包括：  网关节点预先建立网络拓扑结构信息表的步骤；  所述网关节点检测到网关子节点的变化，所述网关节点生成网关子节点变化信息的步骤，所述网关子节点包括网络中与网关节点存在父子关系的路由节点和/或终端节点；网络中路由节点检测到路由子节点的变化，所述路由节点生成路由子节点变化信息并上报至所述网关节点的步骤；  所述网关节点根据网络中节点的变化信息更新所述网络拓扑结构信息表，以供用户查询的步骤，所述网络中节点包括所述网关子节点和所述路由子节点；  其中，所述网关节点预先建立网络拓扑结构信息表的步骤包括；  所述网关节点在所述网络中广播节点信息收集命令；  网络中的节点根据收到的所述广播节点信息收集命令返回自身的节点信息至所述网关节点；  所述网关节点将所述网络中的节点返回的所述节点信息进行组合生成网络拓扑结构信息表并存储。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.根据权利要求I所述的方法，其特征在于，  所述网关节点检测到网关子节点的变化，生成网关子节点变化信息，其中，所述网关子节点变化信息包括网关子节点加入信息和网关子节点丢失信息；  和/或；  所述网络中路由节点检测到路由子节点的变化，生成路由子节点变化信息并上报至所述网关节点；其中，所述路由子节点变化信息包括路由子节点加入信息和路由子节点丢失信息；  所述网关节点检测到网关子节点的变化，生成网关子节点加入信息，包括：  当一节点以所述网关节点为父节点加入所述网络时，所述网关节点生成网关子节点加入信息；  所述网关节点检测到网关子节点的变化，生成网关子节点丢失信息，包括：  所述网关节点根据待发送数据的目的节点确定下一跳网关子节点；  所述网关节点将所述待发送数据发送至所述下一跳网关子节点； 所述网关节点根据所述待发送数据的接收状态判断所述下一跳网关子节点是否丢失；  当所述网关子节点丢失时，则所述网关节点生成网关子节点丢失信息；  所述路由节点检测到路由子节点的变化，生成路由子节点加入信息，包括：  当一节点以所述路由节点为父节点加入所述网络时，所述路由节点生成路由子节点加入信息；  所述路由节点上报所述路由子节点加入信息至所述网关节点；  所述路由节点检测到路由子节点的变化，生成路由子节点丢失信息，包括：  所述路由节点根据待发送数据的目的节点确定下一跳节点；  所述路由节点将所述待发送数据发送至所述下一跳节点；  所述路由节点根据所述待发送数据的接收状态确定所述下一跳节点是否丢失；若所述下一跳节点丢失，且所述下一跳节点为所述路由节点的子节点，则在所述路由节点的协议层生成路由子节点丢失信息并上报至所述路由节点的应用层；  当所述路由节点的应用层接收到所述路由子节点丢失信息时，所述路由节点将所述路由子节点丢失信息上报至所述网关节点；  若所述下一跳节点丢失，且所述下一跳节点为路由节点的父节点，则在所述路由节点的协议层生成路由父节点丢失信息并上报至所述路由节点的应用层；  当所述路由节点的应用层接收到所述路由父节点丢失信息时，所述路由节点开启节点加入流程，选择合适的节点为父节点重新加入所述网络。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.根据权利要求I所述的方法，其特征在于，所述网关节点根据网络中节点的变化信息更新所述网络拓扑结构信息表，包括：  当所述节点的变化信息为节点的加入信息时，所述网关节点根据网络拓扑结构信息表的内容判断所述节点是否存在于所述网络中；  若所述节点存在于所述网络中，则所述网关节点更新所述网络拓扑结构信息表中存储的所述节点的相应信息；  若所述节点未存在于所述网络中，则所述网关节点在所述网络拓扑结构信息表中为所述节点分配存储空间，并增加对应的父子信息；  当所述节点的变化信息为节点的丢失信息时，所述网关节点根据网络拓扑结构信息表的内容判断所述节点是否已经存在于所述网络中；  若所述节点存在于所述网络中，则所述网关节点在所述网络拓扑结构信息表中删除所述节点的信息；  若所述节点未存在于所述网络中，则所述网关节点提示出错。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.根据权利要求I所述的方法，其特征在于，所述方法还包括：  所述路由节点根据所述路由子节点的变化信息更新存储于所述路由节点的路由节点拓扑结构信息表，以供用户查询所述路由节点处的拓扑结构信息，具体包括：  当所述路由子节点的变化信息为加入信息时，所述路由节点根据路由节点拓扑结构信息表的内容判断所述路由子节点是否已经存在于所述网络中；  若是，则更新在所述路由节点拓扑结构信息表中所存储的所述路由子节点的信息；若否，则在所述路由节点拓扑结构信息表中为所述路由子节点分配存储空间，并增加对应的父子信息；  当所述路由子节点的变化信息为丢失信息时，所述路由节点根据路由节点拓扑结构信息表的内容判断所述路由子节点是否已经存在于所述网络中；  若是，则所述路由节点在所述路由节点拓扑结构信息表中删除所述路由子节点的信息；  若否，则所述路由节点提示出错。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.根据权利要求I至4任一项所述的方法，其特征在于，所述方法还包括：终端节点根据待发送数据目的节点确定下一跳终端父节点；  所述终端节点发送所述待发送数据至所述下一跳终端父节点；  所述终端节点根据所述待发送数据的接收状态判断所述终端父节点是否丢失；  若所述终端父节点丢失，则生成终端父节点丢失信息；所述终端节点根据所述终端父节点丢失信息开启孤点加入流程，选择所述终端节点的父节点为父节点加入所述网络；  若无法加入，则所述终端节点开启节点加入流程，选择其他合适的节点为父节点加入所述网络。</div>
    </div>
    </div> <div class="claim"> <div num="6" class="claim">
      <div class="claim-text">6.	一种基于Zigbee协议的无线传感器网络结构的维护系统，其特征在于，所述系统包括网关节点、路由节点和终端节点；  所述网关节点包括：  网络拓扑结构信息表建立单元，用于预先建立网络拓扑结构信息表；  网关子节点变化信息生成单元，用于在检测到网关子节点的变化时生成网关子节点变化信息；所述网关子节点包括网络中与网关节点存在父子关系的路由节点和/或终端节占.  网关更新单元，用于根据网络中节点的变化信息更新所述网络拓扑结构信息表，以供用户查询；所述网络中节点包括所述网关子节点和所述路由子节点；  所述路由节点包括：  路由子节点变化信息生成单元，用于在检测到路由子节点的变化时生成路由子节点变化信息并上报至所述网关节点；  路由节点信息返回单元，用于根据接收到的广播节点信息收集命令返回自身的节点信息至所述网关节点；  所述终端节点包括：  终端节点信息返回单元，用于根据接收到的广播节点信息收集命令返回自身的节点信息至所述网关节点；  所述网络拓扑结构信息表建立单元包括：  广播单元，用于在所述网络中广播节点信息收集命令；  网络拓扑结构信息表建立子单元，用于根据路由节点信息返回单元和终端节点信息返回单元返回的节点信息进行组合生成网络拓扑结构信息表并存储。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.根据权利要求6所述的系统，其特征在于，  所述网关子节点变化信息生成单元，包括：网关子节点加入信息生成单元和网关子节点丢失彳目息生成单兀；  和/或；  所述路由子节点变化信息生成单元，包括：路由子节点加入信息生成单元和路由子节点丢失彳目息生成单兀；  所述网关子节点加入信息生成单元，用于在检测到网关子节点的变化时，生成网关子节点加入信息；  所述网关子节点加入信息生成单元，具体用于当一节点以所述网关节点为父节点加入所述网络时，生成网关子节点加入信息；  所述网关子节点丢失信息生成单元，用于在检测到网关子节点的变化，生成网关子节点丢失信息，包括：  第一下一跳节点确定单元，用于根据待发送数据的目的节点确定下一跳网关子节点；  第一数据发送单元，用于将所述待发送数据发送至所述下一跳网关子节点；网关子节点丢失判断单元，用于根据所述待发送数据的接收状态判断所述下一跳网关子节点是否丢失；  网关子节点丢失信息生成子单元，用于当所述网关子节点丢失时，生成网关子节点丢失f目息;  所述路由子节点加入信息生成单元，用于在检测到路由子节点的变化时，生成路由子节点加入信息；  所述路由子节点加入信息生成单元，包括：  路由子节点加入信息生成子单元，用于当一节点以所述路由节点为父节点加入所述网络时，生成路由子节点加入信息；  所述路由子节点丢失信息生成单元，具体用于在检测到路由子节点的变化时，生成路由子节点丢失信息；包括：  第二下一跳节点确定单元，用于根据待发送数据的目的节点确定下一跳节点；  第二数据发送单元，用于将所述待发送数据发送至所述下一跳节点；  路由子节点丢失判断单元，用于根据所述待发送数据的接收状态确定所述路由节点的下一跳节点是否丢失；  协议层上报单元，用于在所述下一跳路由子节点丢失，且所述下一跳路由节点为所述路由节点的子节点时，在所述路由节点的协议层生成路由子节点丢失信息并上报至所述路由节点的应用层；  应用层上报单元，用于在所述路由节点的应用层接收到所述路由子节点丢失信息时，将所述路由子节点丢失信息上报至所述网关节点；  所述协议层上报单元，还用于在所述下一跳节点丢失，且所述下一跳节点为路由节点的父节点时，在所述路由节点的协议层生成路由父节点丢失信息并上报至所述路由节点的应用层；  应用层上报单元，还用于当所述路由节点的应用层接收到所述路由父节点丢失信息时，开启节点加入流程，选择合适的节点为父节点重新加入所述网络。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.根据权利要求6所述的系统，其特征在于，所述网关更新单元包括：  网关加入信息判断单元，用于当所述节点的变化信息为节点的加入信息时，根据网络拓扑结构信息表的内容判断所述节点是否存在于所述网络中；  网关加入信息更新子单元，用于在所述节点存在于所述网络中时，更新所述网络拓扑结构信息表中存储的所述节点的相应信息；  网关分配单元，用于在所述节点未存在于所述网络中时，在所述网络拓扑结构信息表中为所述节点分配存储空间，并增加对应的父子信息；  网关丢失信息判断单元，用于当所述节点的变化信息为节点的丢失信息时，根据网络拓扑结构信息表的内容判断所述节点是否已经存在于所述网络中；  网关丢失信息删除单元，用于在若所述节点存在于所述网络中时，在所述网络拓扑结构信息表中删除所述节点的信息；  网关提示单元，用于在所述节点未存在于所述网络中时，提示出错。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.根据权利要求6所述的系统，其特征在于，所述路由节点还包括：  路由更新单元，用于根据所述路由子节点的变化信息更新存储于所述路由节点的路由节点拓扑结构信息表，以供用户查询所述路由节点处的拓扑结构信息；  所述路由更新单元包括：  路由加入信息判断单元，用于当所述路由子节点的变化信息为加入信息时，根据路由节点拓扑结构信息表的内容判断所述路由子节点是否已经存在于所述网络中；  路由加入信息更新子单元，用于在所述路由子节点已经存在于所述网络中时，更新在所述路由节点拓扑结构信息表中所存储的所述路由子节点的信息；  路由分配单元，用于在所述路由子节点未存在于所述网络中时，在所述路由节点拓扑结构信息表中为所述路由子节点分配存储空间，并增加对应的父子信息；  路由丢失信息判断单元，用于当所述路由子节点的变化信息为丢失信息时，根据路由节点拓扑结构信息表的内容判断所述路由子节点是否已经存在于所述网络中；  路由丢失信息删除单元，用于在所述路由子节点已经存在于所述网络中时，在所述路由节点拓扑结构信息表中删除所述路由子节点的信息；  路由提示单元，用于在所述路由子节点未存在于所述网络中时提示出错。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.根据权利要求6-9任一项所述的系统，其特征在于，所述终端节点还包括：  终端父节点确定单元，用于根据待发送数据目的节点确定下一跳终端父节点；  终端数据发送单元，用于发送所述待发送数据至所述下一跳终端父节点；  终端父节点丢失判断单元，用于根据所述待发送数据的接收状态判断所述终端父节点是否丢失；  终端父节点丢失信息生成单元，用于在所述终端父节点丢失时，生成终端父节点丢失信息；  孤点加入单元，用于根据所述终端父节点丢失信息开启孤点加入流程，选择所述终端节点的父节点为父节点加入所述网络；  节点加入单元，用于在所述父节点无法通过孤点加入流程加入时，开启节点加入流程，选择其他合适的节点为父节点加入所述网络。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES59080420" lang="ZH" load-source="patent-office" class="description">
    <p>&#8212;种基于Zigbee协议的无线传感器网络结构维护方法及系统</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及无线传感器网络领域，尤其涉及一种基于Zigbee协议的无线传感器网络结构维护方法及系统。</p>
    <p>背景技术</p>
    <p>[0002]	Zigbee是一种开放性的低成本、低功耗、低数据速率、低复杂度、双向传输、高可靠性的新型短距离无线通信技术，该技术应用简单，电池寿命长，成本低，可靠性高，具有自组网和自恢复能力。</p>
    <p>[0003]	Zigbee可以在数千个节点之间相互协调实现通信。这些节点只需要很少的能量，以接力的方式通过无线电波将数据从一个节点传到另一个节点，所以它们的通信效率非常高。因此Zigbee在传感器网络、智能家居、工业自动化等领域有着广泛的应用。</p>
    <p>[0004]	为了方便的获知网络的信息，需要对网络的结构进行监控和维护。以基于Zigbee协议的无线传感器网络为例，目前，主要通过在网络的全功能节点处即网关节点和路由节点处维护一张只与全功能节点直接 关联的节点信息的关联表对网络进行管理。当上述关联表中的节点发生变化时，进行更新。但因为只保存直接关联的节点信息，因此，上述方式无法使用户从网关处获知整个网络的主要结构信息。</p>
    <p>发明内容</p>
    <p>[0005]	本发明旨在提供一种基于Zigbee协议的无线传感器网络结构维护方法及系统，以实现在网关节点处对网络中所有节点信息的维护。</p>
    <p>[0006]	基于此，本发明提供了一种基于Zigbee协议的无线传感器网络结构的维护方法，所述方法包括：</p>
    <p>[0007]	网关节点预先建立网络拓扑结构信息表的步骤；</p>
    <p>[0008]	所述网关节点检测到网关子节点的变化，所述网关节点生成网关子节点变化信息的步骤，所述网关子节点包括网络中与网关节点存在父子关系的路由节点和/或终端节占.</p>
    <p>[0009]	网络中路由节点检测到路由子节点的变化，所述路由节点生成路由子节点变化信息并上报至所述网关节点的步骤；</p>
    <p>[0010]	所述网关节点根据网络中节点的变化信息更新所述网络拓扑结构信息表，以供用户查询的步骤，所述网络中节点包括所述网关子节点和所述路由子节点；</p>
    <p>[0011]	其中，所述网关节点预先建立网络拓扑结构信息表的步骤包括；</p>
    <p>[0012]	所述网关节点在所述网络中广播节点信息收集命令；</p>
    <p>[0013]网络中的节点根据收到的所述广播节点信息收集命令返回自身的节点信息至所述网关节点；</p>
    <p>[0014]	所述网关节点将所述网络中的节点返回的所述节点信息进行组合生成网络拓扑结构信息表并存储。</p>
    <p>[0015]	优选的，所述网关节点检测到网关子节点的变化，生成网关子节点变化信息，其中，所述网关子节点变化信息包括网关子节点加入信息和网关子节点丢失信息；</p>
    <p>[0016]	所述网关节点检测到网关子节点的变化，生成网关子节点加入信息，包括：</p>
    <p>[0017]	当一节点以所述网关节点为父节点加入所述网络时，所述网关节点生成网关子节点加入信息；</p>
    <p>[0018]	所述网关节点检测到网关子节点的变化，生成网关 子节点丢失信息，包括：</p>
    <p>[0019]	所述网关节点根据待发送数据的目的节点确定下一跳网关子节点；</p>
    <p>[0020]	所述网关节点将所述待发送数据发送至所述下一跳网关子节点；</p>
    <p>[0021]	所述网关节点根据所述待发送数据的接收状态判断所述下一跳网关子节点是否丢失;</p>
    <p>[0022]	当所述网关子节点丢失时，则所述网关节点生成网关子节点丢失信息。</p>
    <p>[0023]	优选的，所述网关节点根据网络中节点的变化信息更新所述网络拓扑结构信息表，包括：</p>
    <p>[0024]当所述节点的变化信息为节点的加入信息时，所述网关节点根据网络拓扑结构信息表的内容判断所述节点是否存在于所述网络中；</p>
    <p>[0025]	若所述节点存在于所述网络中，则所述网关节点更新所述网络拓扑结构信息表中存储的所述节点的相应信息；</p>
    <p>[0026]	若所述节点未存在于所述网络中，则所述网关节点在所述网络拓扑结构信息表中为所述节点分配存储空间，并增加对应的父子信息；</p>
    <p>[0027]	当所述节点的变化信息为节点的丢失信息时，所述网关节点根据网络拓扑结构信息表的内容判断所述节点是否已经存在于所述网络中；</p>
    <p>[0028]	若所述节点存在于所述网络中，则所述网关节点在所述网络拓扑结构信息表中删除所述节点的信息；</p>
    <p>[0029]	若所述节点未存在于所述网络中，则所述网关节点提示出错。</p>
    <p>[0030]	优选的，所述网络中路由节点检测到路由子节点的变化，生成路由子节点变化信息并上报至所述网关节点；其中，所述路由子节点变化信息包括路由子节点加入信息和路由子节点丢失信息；</p>
    <p>[0031]	所述路由节点检测到路由子节点的变化，生成路由子节点加入信息，包括：</p>
    <p>[0032]	当一节点以所述路由节点为父节点加入所述网络时，所述路由节点生成路由子节点加入信息；</p>
    <p>[0033]	所述路由节点上报所述路由子节点加入信息至所述网关节点；</p>
    <p>[0034]	所述路由节点检测到路由子节点的变化，生成路由子节点丢失信息，包括：</p>
    <p>[0035]	所述路由节点根据待发送数据的目的节点确定下一跳节点；</p>
    <p>[0036]	所述路由节点将所述待发送数据发送至所述下一跳节点；</p>
    <p>[0037]	所述路由节点根据所述待发送数据的接收状态确定所述下一跳节点是否丢失；</p>
    <p>[0038]	若所述下一跳节点丢失，且所述下一跳节点为所述路由节点的子节点，则在所述路由节点的协议层生成路由子节点丢失信息并上报至所述路由节点的应用层；</p>
    <p>[0039]	当所述路由节点的应用层接收到所述路由子节点丢失信息时，所述路由节点将所述路由子节点丢失信息上报至所述网关节点；</p>
    <p>[0040]	若所述下一跳节点丢失，且所述下一跳节点为路由节点的父节点，则在所述路由节点的协议层生成路由父节点丢失信息并上报至所述路由节点的应用层；</p>
    <p>[0041]	当所述路由节点的应用层接收到所述路由父节点丢失信息时，所述路由节点开启节点加入流程，选择合适的节点为父节点重新加入所述网络。</p>
    <p>[0042]	优选的，所述方法还包括： [0043]	所述路由节点根据所述路由子节点的变化信息更新存储于所述路由节点的路由节点拓扑结构信息表，以供用户查询所述路由节点处的拓扑结构信息。</p>
    <p>[0044]	优选的，所述路由节点根据所述路由子节点的变化信息更新存储于所述路由节点的路由节点拓扑结构信息表包括：</p>
    <p>[0045]	当所述路由子节点的变化信息为加入信息时，所述路由节点根据路由节点拓扑结构信息表的内容判断所述路由子节点是否已经存在于所述网络中；</p>
    <p>[0046]	若是，则更新在所述路由节点拓扑结构信息表中所存储的所述路由子节点的信息；</p>
    <p>[0047]	若否，则在所述路由节点拓扑结构信息表中为所述路由子节点分配存储空间，并增加对应的父子信息；</p>
    <p>[0048]	当所述路由子节点的变化信息为丢失信息时，所述路由节点根据路由节点拓扑结构信息表的内容判断所述路由子节点是否已经存在于所述网络中；</p>
    <p>[0049]	若是，则所述路由节点在所述路由节点拓扑结构信息表中删除所述路由子节点的信息；</p>
    <p>[0050]	若否，则所述路由节点提示出错。</p>
    <p>[0051]	优选的，所述方法还包括：</p>
    <p>[0052]	终端节点根据待发送数据目的节点确定下一跳终端父节点；</p>
    <p>[0053]	所述终端节点发送所述待发送数据至所述下一跳终端父节点；</p>
    <p>[0054]	所述终端节点根据所述待发送数据的接收状态判断所述终端父节点是否丢失；</p>
    <p>[0055]	若所述终端父节点丢失，则生成终端父节点丢失信息；</p>
    <p>[0056]	所述终端节点根据所述终端父节点丢失信息开启孤点加入流程，选择所述终端节点的父节点为父节点加入所述网络；</p>
    <p>[0057]	若无法加入，则所述终端节点开启节点加入流程，选择其他合适的节点为父节点加入所述网络。</p>
    <p>[0058]	优选的，所述网络拓扑结构信息表米用分级动态链表形式，在每一级中存储上一级节点对应的子节点信息。</p>
    <p>[0059]	对应上述方法，本发明还提供了一种基于Zigbee协议的无线传感器网络结构的维护系统，所述系统包括网关节点、路由节点和终端节点；</p>
    <p>[0060]	所述网关节点包括：</p>
    <p>[0061]	网络拓扑结构信息表建立单兀，用于预先建立网络拓扑结构信息表；</p>
    <p>[0062]	网关子节点变化信息生成单元，用于在检测到网关子节点的变化时生成网关子节点变化信息；所述网关子节点包括网络中与网关节点存在父子关系的路由节点和/或终端节点；[0063]	网关更新单元，用于根据网络中节点的变信息更新所述网络拓扑结构信息表，以供用户查询；所述网络中节点包括所述网关子节点和所述路由子节点；</p>
    <p>[0064]	所述路由节点包括：</p>
    <p>[0065]	路由子节点变化信息生成单元，用于在检测到路由子节点的变化时生成路由子节点变化信息并上报至所述网关节点；</p>
    <p>[0066]	路由节点信息返回单元，用于根据接收到的广播节点信息收集命令返回自身的节点信息至所述网关节点； </p>
    <p>[0067]	所述终端节点包括：</p>
    <p>[0068]	终端节点信息返回单元，用于根据接收到的广播节点信息收集命令返回自身的节点信息至所述网关节点；</p>
    <p>[0069]	所述网络拓扑结构信息表建立单元包括：</p>
    <p>[0070]	广播单元，用于在所述网络中广播节点信息收集命令；</p>
    <p>[0071]	网络拓扑结构信息表建立子单元，用于根据路由节点信息返回单元和终端节点信息返回单元返回的节点信息进行组合生成网络拓扑结构信息表并存储。</p>
    <p>[0072]	优选的，所述网关子节点变化信息生成单元，包括：网关子节点加入信息生成单元和网关子节点丢失信息生成单元；</p>
    <p>[0073]	所述网关子节点加入信息生成单元，用于在检测到网关子节点的变化时，生成网关子节点加入信息；</p>
    <p>[0074]	所述网关子节点加入信息生成单元，具体用于当一节点以所述网关节点为父节点加入所述网络时，生成网关子节点加入信息；</p>
    <p>[0075]	所述网关子节点丢失信息生成单元，用于在检测到网关子节点的变化，生成网关子节点丢失信息，包括：</p>
    <p>[0076]	第一下一跳节点确定单元，用于根据待发送数据的目的节点确定下一跳网关子节占.</p>
    <p>[0077]	第一数据发送单元，用于将所述待发送数据发送至所述下一跳网关子节点；</p>
    <p>[0078]	网关子节点丢失判断单元，用于根据所述待发送数据的接收状态判断所述下一跳网关子节点是否丢失；</p>
    <p>[0079]	网关子节点丢失信息生成子单元，用于当所述网关子节点丢失时，生成网关子节点丢失信息。</p>
    <p>[0080]	优选的，所述网关更新单元包括：</p>
    <p>[0081]	网关加入信息判断单元，用于当所述节点的变化信息为节点的加入信息时，根据网络拓扑结构信息表的内容判断所述节点是否存在于所述网络中；</p>
    <p>[0082]	网关加入信息更新子单元，用于在所述节点存在于所述网络中时，更新所述网络拓扑结构信息表中存储的所述节点的相应信息；</p>
    <p>[0083]	网关分配单元，用于在所述节点未存在于所述网络中时，在所述网络拓扑结构信息表中为所述节点分配存储空间，并增加对应的父子信息；</p>
    <p>[0084]	网关丢失信息判断单元，用于当所述节点的变化信息为节点的丢失信息时，根据网络拓扑结构信息表的内容判断所述节点是否已经存在于所述网络中；</p>
    <p>[0085]	网关丢失信息删除单元，用于在若所述节点存在于所述网络中时，在所述网络拓扑结构信息表中删除所述节点的信息；</p>
    <p>[0086]	网关提示单元，用于在所述节点未存在于所述网络中时，提示出错。</p>
    <p>[0087]	优选的，所述路由子节点变化信息生成单元包括路由子节点加入信息生成单元和路由子节点丢失信息生成单元；</p>
    <p>[0088]	所述路由子节点加入信息生成单元，用于在检测到路由子节点的变化时，生成路由子节点加入信息；</p>
    <p>[0089]	所述路由子节点加入信息生成单元，包括： </p>
    <p>[0090]	路由子节点加入信息生成子单元，用于当一节点以所述路由节点为父节点加入所述网络时，生成路由子节点加入信息；</p>
    <p>[0091]	所述路由子节点丢失信息生成单元，具体用于在检测到路由子节点的变化时，生成路由子节点丢失信息；包括：</p>
    <p>[0092]	第二下一跳节点确定单元，用于根据待发送数据的目的节点确定下一跳节点；</p>
    <p>[0093]	第二数据发送单元，用于将所述待发送数据发送至所述下一跳节点；</p>
    <p>[0094]	路由子节点丢失判断单元，用于根据所述待发送数据的接收状态确定所述路由节点的下一跳节点是否丢失；</p>
    <p>[0095]	协议层上报单元，用于在所述下一跳路由子节点丢失，且所述下一跳路由节点为所述路由节点的子节点时，在所述路由节点的协议层生成路由子节点丢失信息并上报至所述路由节点的应用层；</p>
    <p>[0096]	应用层上报单元，用于在所述路由节点的应用层接收到所述路由子节点丢失信息时，将所述路由子节点丢失信息上报至所述网关节点；</p>
    <p>[0097]	所述协议层上报单元，还用于在所述下一跳节点丢失，且所述下一跳节点为路由节点的父节点时，在所述路由节点的协议层生成路由父节点丢失信息并上报至所述路由节点的应用层；</p>
    <p>[0098]	应用层上报单元，还用于当所述路由节点的应用层接收到所述路由父节点丢失信息时，开启节点加入流程，选择合适的节点为父节点重新加入所述网络。</p>
    <p>[0099]	优选的,所述路由节点还包括：</p>
    <p>[0100]	路由更新单元，用于根据所述路由子节点的变化信息更新存储于所述路由节点的路由节点拓扑结构信息表，以供用户查询所述路由节点处的拓扑结构信息。</p>
    <p>[0101]	优选的，所述路由更新单元包括：</p>
    <p>[0102]	路由加入信息判断单元，用于当所述路由子节点的变化信息为加入信息时，根据路由节点拓扑结构信息表的内容判断所述路由子节点是否已经存在于所述网络中；</p>
    <p>[0103]	路由加入信息更新子单元，用于在所述路由子节点已经存在于所述网络中时，更新在所述路由节点拓扑结构信息表中所存储的所述路由子节点的信息；</p>
    <p>[0104]	路由分配单元，用于在所述路由子节点未存在于所述网络中时，在所述路由节点拓扑结构信息表中为所述路由子节点分配存储空间，并增加对应的父子信息；</p>
    <p>[0105]	路由丢失信息判断单元，用于当所述路由子节点的变化信息为丢失信息时，根据路由节点拓扑结构信息表的内容判断所述路由子节点是否已经存在于所述网络中；</p>
    <p>[0106]	路由丢失信息删除单元，用于在所述路由子节点已经存在于所述网络中时，在所述路由节点拓扑结构信息表中删除所述路由子节点的信息；[0107]	路由提示单元，用于在所述路由子节点未存在于所述网络中时提示出错。</p>
    <p>[0108]	优选的,所述终端节点还包括：</p>
    <p>[0109]	终端父节点确定单元，用于根据待发送数据目的节点确定下一跳终端父节点；</p>
    <p>[0110]	终端数据发送单元，用于发送所述待发送数据至所述下一跳终端父节点；</p>
    <p>[0111]	终端父节点丢失判断单元，用于根据所述待发送数据的接收状态判断所述终端父节点是否丢失；</p>
    <p>[0112]	终端父节点丢失信息生成单元，用于在所述终端父节点丢失时，生成终端父节点丢失&#943;目息; [0113]	孤点加入单元，用于根据所述终端父节点丢失信息开启孤点加入流程，选择所述终端节点的父节点为父节点加入所述网络；</p>
    <p>[0114]	节点加入单元，用于在所述父节点无法通过孤点加入流程加入时，开启节点加入流程，选择其他合适的节点为父节点加入所述网络。</p>
    <p>[0115]	与现有技术相比，本发明具有如下有益效果：</p>
    <p>[0116]	本发明中网关节点预先建立网络拓扑结构信息表；网关节点检测到网关子节点即网络中与网关节点存在父子关系的路由节点和/或终端节点的变化后生成网关子节点变化信息，网络中路由节点检测到路由子节点的变化后生成路由子节点变化信息并上报至所述网关节点；网关节点根据网络中节点即所述网关子节点和所述路由子节点的变化信息更新网络拓扑结构信息表，供用户查询，通过上述过程使得在网关节点处维护了网络中所有节点的信息，在后续用户查询时可以直接从网关节点处获知所有节点的信息。</p>
    <p>附图说明</p>
    <p>[0117]	为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附图。</p>
    <p>[0118]	图I是本发明网络中各类型节点连接示意图；</p>
    <p>[0119]	图2是本发明方法实施例流程图；</p>
    <p>[0120]	图3是本发明中网关节点生成网关子节点丢失信息流程图；</p>
    <p>[0121]	图4是本发明路由节点生成路由子节点丢失信息流程图；</p>
    <p>[0122]	图5是本发明终端节点生成终端父节点变化信息流程图；</p>
    <p>[0123]	图6是本发明网关节点更新网络拓扑结构信息表流程图；</p>
    <p>[0124]	图7是本发明网络拓扑结构信息表结构图；</p>
    <p>[0125]	图8是本发明网络中各节点信息维护示意图；</p>
    <p>[0126]	图9是本发明系统实施例结构图。</p>
    <p>具体实施方式</p>
    <p>[0127]	下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员所获得的所有其他实施例，都属于本发明保护的范围。</p>
    <p>[0128]	在本发明中，子节点和父节点是依据基于ZigBee协议的网络中的节点通信关系划分的。当网络中的某台设备通过另一台设备加入网络时，这两台设备就构成了父子关系，新接入的设备成为子节点，而另一台设备称为该子节点的父节点。例如，设备A通过设备B加入到该ZigBee网络中，则设备A称为子节点，设备B称为设备A这个子节点的父节点。</p>
    <p>[0129]	在网络中，节点包括网关节点、路由节点和终端节点三种类型。如图I所示，网关节点为al，终端节点为a3，路由节点为a2。其中，路由节点a2和终端节点a3经常会发生掉电、错误、离开或信号变弱等情况，导致不能被检测，我们称之为节点丢失。当有路由节点a2和终端节点a3加入网络时，为节点加入。</p>
    <p>[0130]	节点的丢失和加入都是节点的一种变化，在网络中是经常发生的情况。为保证网络的稳定，用户需要掌握网络的现状以便及时作出调整。</p>
    <p>[0131]	为此，本发明实施例I提供了一种基于Zigbee协议的无线传感器网络结构的维护方法，参见图2，所述方法包括：</p>
    <p>[0132]	S11、网关节点预先建立网络拓扑结构信息表的步骤。</p>
    <p>[0133]	网关节点预先建立网络拓扑结构信息表的方法有多种，本发明实施例2提供了一种具体方式，包括如下步骤：</p>
    <p>[0134]	所述网关节点在所述网络中广播节点信息收集命令。</p>
    <p>[0135]网络中的节点根据收到的所述广播节点信息收集命令返回自身的节点信息至所述网关节点。</p>
    <p>[0136]	所述网关节点将所述网络中的节点返回的所述节点信息进行组合生成网络拓扑结构信息表并存储。 [0137]	需要说明的是，本发明用以在网关节点处查询网络中所有节点的状态，因此本发明中的拓扑结构信息表应当包含建立该信息表时网络中所有节点的信息。</p>
    <p>[0138]	S12、所述网关节点检测到网关子节点的变化，所述网关节点生成网关子节点变化信息的步骤，所述网关子节点包括网络中与网关节点存在父子关系的路由节点和/或终端节点。</p>
    <p>[0139]	S13、网络中路由节点检测到路由子节点的变化，所述路由节点生成路由子节点变化信息并上报至所述网关节点的步骤。</p>
    <p>[0140]	S14、所述网关节点根据网络中节点的变化信息更新所述网络拓扑结构信息表，以供用户查询的步骤，所述网络中节点包括所述网关子节点和所述路由子节点。</p>
    <p>[0141]	为使本发明更加清楚，以下分几部分对上述实施例进行介绍。</p>
    <p>[0142]	首先对网关节点生成网络中网关子节点的变化信息进行介绍。</p>
    <p>[0143]	在本发明中，网关节点生成网关子节点变化信息可以通过多种方法实现。</p>
    <p>[0144]	tWn，可以通过网关节点周期性查询的方式。即网关节点每隔一定的时间向网关子节点发送查询信息，若网关子节点正常回复，则认为该网关子节点正常，否则认为该网关子节点离开网络。但这种方式中网络结构信息的反映实时性与查询周期的长短直接相关，查询周期设置较长，系统网络结构信息的变化反映时间就增长，实时性变差。若查询周期设置较短，就增大了传输的数据量，占用了网络有限的资源。</p>
    <p>[0145]	另一种方式是通过变化节点主动上报的方式对网络进行监控。即当网关子节点发生变化时，主动上报变化信息至网关节点。但这种方式不具备对突发情况(如节点忽然丢失、损坏等）的反映能力。</p>
    <p>[0146]	针对此，本发明实施例3提供了一种优选的方式，能够解决上述两种方式存在的问题。</p>
    <p>[0147]	如前所述，节点的变化包括节点加入和节点丢失两种情况，对应的该优选的方式具体包括网关节点检测网关子节点的变化生成网关子节点加入信息和网关节点检测网关子节点的变化，生成网关子节点丢失信息。</p>
    <p>[0148]	其中，网关节点检测网关子节点的变 化生成网关子节点加入信息包括：</p>
    <p>[0149]	当一节点以网关节点为父节点加入网络时，网关节点生成网关子节点加入信息。</p>
    <p>[0150]	参见图3，网关节点检测网关子节点的变化生成网关子节点丢失信息包括如下步骤：</p>
    <p>[0151]	S21、网关节点根据待发送数据的目的节点确定下一跳网关子节点。</p>
    <p>[0152]	对于网络中的节点来说，其待发送数据可以是本节点自己构造的数据，也可以是接收的其它节点发送来并由本节点转发的数据。对于网关节点来说，不可能接收其它节点发送的数据，因此，此处的待发送数据实际是指网关节点自身构造的数据。</p>
    <p>[0153]	网关节点在网络层获取到该待发送数据的目的节点，进而查询本节点所保存的路由表，确定出下一跳节点。</p>
    <p>[0154]	S22、网关节点将上述待发送数据发送至确定出的下一跳网关子节点。</p>
    <p>[0155]	S23、网关节点根据待发送数据的接收状态判断下一跳网关子节点是否丢失。</p>
    <p>[0156]	S24、当判断出该下一跳网关子节点丢失时，网关节点生成网关子节点丢失信息。</p>
    <p>[0157]	如果确定出的下一跳网关子节点仍处于网络中，即下一跳网关子节点未丢失，则该下一跳网关子节点会接收到该待发送数据。如果该下一跳网关子节点丢失，则网关节点的ZigBee协议栈底层（即应用层以下的协议层）可以获知该下一跳网关子节点并未接收到该待发送数据，同时在该协议栈底层生成指示该下一跳网关子节点丢失的丢失指示消息。本发明中当在协议栈底层生成该丢失指示消息后，会将该丢失指示消息逐层上报，最终由网络层将该丢失指示消息上报给应用层的ZigBee设备对象（ZDO，Zigbee DeviceObiect),以便ZigBee协议栈中应用层的ZigBee设备对象获取到该下一跳网关子节点丢失的信息。</p>
    <p>[0158]	本发明中为了能够让Zigbee协议栈中应用层的应用对象获取到节点丢失，当从ZigBee设备对象中获取到丢失指示消息时，提取出该消息中包含的节点的网络信息，并进一步将该节点的网络信息作为节点丢失信息上报给应用对象，进而使得应用对象可以实时获取到节点丢失信息。</p>
    <p>[0159]	需要说明的是，该丢失指示消息中包含的节点的网络信息可以包括：丢失节点的网络地址，以及丢失节点与本节点的通信关系，如，丢失节点为本节点的子节点或者丢失节点为本节点的父节点。此处的通信关系为网关节点的子节点。其中，丢失指示消息中所包含节点的网络信息被认为是丢失节点的网络信息。</p>
    <p>[0160]	其次，对路由节点检测到路由子节点的变化，生成路由子节点变化信息进行介绍。</p>
    <p>[0161]	同网关节点相同，根据路由子节点的不同变化，路由节点在检测到路由子节点时可能会生成路由子节点加入信息，也有可能生成路由子节点丢失信息。[0162]	其中，当一节点以路由节点为父节点加入网络时，该路由节点生成路由子节点加入信息。之后路由节点会将该信息上报至网关节点，以便网关节点据此更新网络拓扑结构</p>
    <p>信息表。</p>
    <p>[0163]	同网关节点生成网关子节点的丢失信息类似，参见图4，路由节点生成路由子节点的丢失信息包括如下步骤：</p>
    <p>[0164]	S31、路由节点根据待发送数据的目的节点确定下一跳节点。</p>
    <p>[0165]	S32、路由节点将待发送数据发送至所述确定出的下一跳节点。</p>
    <p>[0166]	S33、路由节点根据待发送数据的接收状态确定该下一跳节点是否丢失。 [0167]	S34、若该下一跳节点丢失，且该下一跳节点为路由节点的子节点，则在路由节点的协议层生成路由子节点丢失信息并上报至路由节点的应用层。</p>
    <p>[0168]	S35、当路由节点的应用层接收到路由子节点丢失信息时，路由节点将路由子节点丢失信息上报至网关节点。</p>
    <p>[0169]	S36、若下一跳节点丢失，且下一跳节点为路由节点的父节点，则在路由节点的协议层生成路由父节点丢失信息并上报至路由节点的应用层。</p>
    <p>[0170]	S37、当路由节点的应用层接收到路由父节点丢失信息时，路由节点开启节点加入流程，选择合适的节点为父节点重新加入网络。</p>
    <p>[0171]	在网络中，网关节点只有子节点，其发送的待发送数据也只能是自己构造的。与之不同的是，路由节点既有子节点也有父节点，其发送的待发送数据既可以是自己构造的，也可以是从上一跳节点接收的。根据目的节点的不同，路由节点有可能将数据发送至父节点，也有可能发送至子节点，即路由节点的下一跳节点有可能是路由子节点，也有可能是路由父节点。由于后续的处理方式不同，因此，要对其进行判断。</p>
    <p>[0172]	具体的，如果该路由节点的下一跳节点丢失，则路由节点的ZigBee协议栈底层(即应用层以下的协议层）可以获知该下一跳节点并未接收到该待发送数据，同时在该协议栈底层生成指示该下一跳节点丢失的丢失指示消息。本发明中当在协议栈底层生成该丢失指示消息后，会将该丢失指示消息逐层上报，最终由网络层将该丢失指示消息上报给应用层的ZigBee设备对象（ZDO, Zigbee Device Obiect),以便ZigBee协议栈中应用层的ZigBee设备对象获取到该下一跳节点丢失的信息。</p>
    <p>[0173]	本发明中为了能够让Zigbee协议栈中应用层的应用对象获取到节点丢失信息，当从ZigBee设备对象中获取到丢失指示消息时，提取出该消息中包含的节点的网络信息，并进一步将该节点的网络信息作为节点丢失信息上报给应用对象，进而使得应用对象可以实时获取到节点丢失息。</p>
    <p>[0174]	需要说明的是，该丢失指示消息中包含的节点的网络信息可以包括：丢失节点的网络地址，以及丢失节点与路由节点的通信关系，如，丢失节点为路由节点的子节点或者丢失节点为路由节点的父节点。</p>
    <p>[0175]	当应用对象根据节点丢失信息发现丢失节点为路由子节点时，会将该节点丢失信息上报至网关节点。</p>
    <p>[0176]	当应用对象根据节点丢失信息发现丢失节点为路由节点的父节点时，该应用对象开启节点加入流程，选择合适的节点为父节点重新加入网络。</p>
    <p>[0177]	在本发明中，除网关节点和路由节点检测节点变化生成节点变化信息外，还包括终端节点检测节点变化生成节点变化信息的步骤。</p>
    <p>[0178]	终端节点只有父节点，因此，终端节点根据对节点的检测只会生成终端父节点变化信息。具体过程如图5所示，包括：</p>
    <p>[0179]	S41、终端节点发送待发送数据至下一跳终端父节点。</p>
    <p>[0180]	终端节点的待发送数据是自己构造的。</p>
    <p>[0181]	S42、终端节点根据待发送数据的接收状态判断终端父节点是否丢失。</p>
    <p>[0182]	S43、若终端父节点丢失，则生成终端父节点丢失信息。</p>
    <p>[0183]	同上述方式类似，如果该终端节点的父节点丢失，则终端节点的ZigBee协议栈底层（即应用层以下的协议层）可以获知该终端父节点并未接收到该待发送数据，同时在该协议栈底层生成指示该终端父节点丢失的丢失指示消息。本发明中当在协议栈底层生成该丢失指示消息后，会将该丢失指示消息逐层上报，最终由网络层将该丢失指示消息上报给应用层的ZigBee设备对象（ZDO,Zigbee Device Obiect),以便ZigBee协议栈中应用层的ZigBee设备对象获取到该终端父节点丢失的信息。</p>
    <p>[0184]	当从ZigBee设备对象中获取到丢失指示消息时，提取出该消息中包含的节点的网络信息，并进一步将该节点的网络信息作为节点丢失信息上报给应用对象，进而使得应用对象可以实时获取到节点丢失信息。</p>
    <p>[0185]	需要说明的是，该丢失指示消息中包含的节点的网络信息可以包括：丢失节点的网络地址，以及丢失节点与终端节点的通信关系，此处为终端节点的父节点。</p>
    <p>[0186]	S44、终端节点根据终端父节点丢失信息开启孤点加入流程，选择终端节点的父节点为父节点加入网络。</p>
    <p>[0187]	孤点加入流程即以该丢失的父节点为父节点，将其重新加入网络。</p>
    <p>[0188]	S45、若无法加入，则终端节点开启节点加入流程，选择其他合适的节点为父节点 加入网络。</p>
    <p>[0189]	在原父节点无法加入时，选择其他合适的节点为终端节点的父节点加入网络。</p>
    <p>[0190]	本发明中，待发送数据可以为任意数据，如可以为与协议栈相关的数据，也可以是普通通信数据。</p>
    <p>[0191]	上述过程中涉及发送待发送数据的节点判断下一跳节点是否接收到待发送数据。其具体判断方式有多中，其中一种方式为：判断ZigBee协议栈底层在指定时间内是否接收到该下一跳节点返回的确认接收到待发送数据的消息，如果是，则该下一跳节点处于网络中；如果否，则下一跳节点丢失。也就是说，如果该下一跳节点接收到待发送数据后，会向其上一跳节点回复一个确认消息，以表示自己接收到待发送数据。当发送待发送数据的节点的协议层在指定时间内没有检测或接收到该下一跳节点返回的确认消息，则在协议层中生成指示下一跳节点丢失的丢失指示消息。</p>
    <p>[0192]	需要明确的是，有时候下一跳节点只是暂时的失去联系，而非真正的丢失，尤其是下一跳子节点，可以通过孤立加入申请，很快的加入网络，恢复正常的运行状态。因此，在发现下一跳子节点失去联系时，可定时一段时间，再作判断。比如定时一段时间比如三秒后，下一跳子节点仍旧失去联系，则确定下一跳子节点丢失，生成下一跳子节点丢失信息。</p>
    <p>[0193]	关于上述网关节点、路由节点以及终端节点检测节点的变化生成相关节点丢失信息的具体过程可参见申请号为201110391507.0，发明名称为“基于ZigBee协议获取节点丢失信息的方法和系统”以及申请号为201110391517. O，发明名称为“基于ZigBee协议获取节点丢失信息的方法和系统”的专利申请。此处不再详述。</p>
    <p>[0194]	接下来对网关节点更新网络拓扑结构信息表的过程进行描述。通过上述过程可知，路由节点会将自身生成的路由子节点丢失信息以及路由子节点加入信息上报至网关节点，因此，在网关节点处就汇集了路由子节点的变化信息和网关子节点的变化信息。网关节点根据这些变化信息更新网络拓扑结构信息表。其具体过程参见图6 ：</p>
    <p>[0195]	S51、判断节点的变化信息为节点的加入信息还是节点的丢失信息。若为节点的加入信息，转入步骤S52 ;若为节点的丢失信息， 转入步骤S55。</p>
    <p>[0196]	S52、网关节点根据网络拓扑结构信息表的内容判断节点是否存在于网络中。若存在于所述网络中，转入步骤S53。若没有存在于所述网络中，则转入步骤S54。</p>
    <p>[0197]	S53、网关节点更新网络拓扑结构信息表中存储的该节点的相应信息。</p>
    <p>[0198]	S54、网关节点在所述网络拓扑结构信息表中为该节点分配存储空间，并增加对应的父子信息。</p>
    <p>[0199]	S55、网关节点根据网络拓扑结构信息表的内容判断该节点是否已经存在于所述网络中。若存在于所述网络中，转入步骤S56，若否，转入步骤S57。</p>
    <p>[0200]	S56、网关节点在网络拓扑结构信息表中删除该节点的信息。</p>
    <p>[0201]	S57、网关节点提示出错。</p>
    <p>[0202]	考虑到网关资源有限，为节省存储空间，网络拓扑结构信息表可以选用分级动态链表的形式，具体如图7所示。</p>
    <p>[0203]	本发明优选实施例中，可同时在路由节点处维护路由节点拓扑结构信息表，以供用户查询该路由节点处的拓扑结构信息。具体过程如下：</p>
    <p>[0204]	判断路由子节点的变化信息为节点加入信息还是节点丢失信息。</p>
    <p>[0205]	若为节点加入信息，则路由节点根据路由节点拓扑结构信息表的内容判断该路由子节点是否已经存在于所述网络中。如果存在于所述网络中，则路由节点更新所述路由节点拓扑结构信息表中存储的该路由子节点的信息；如果没有存在于所述网络中，则路由节点在路由节点拓扑结构信息表中为路由子节点分配存储空间，并增加对应的父子信息。</p>
    <p>[0206]	当路由子节点的变化信息为丢失信息时，路由节点根据路由节点拓扑结构信息表的内容判断路由子节点是否已经存在于网络中。</p>
    <p>[0207]	若存在于所述网络中，则路由节点在路由节点拓扑结构信息表中删除该路由子节点的信息；若否，则所述路由节点提示出错。</p>
    <p>[0208]	图8为本发明中网络各节点信息的维护示意图。</p>
    <p>[0209]	其中，终端节点生成其父节点丢失信息，并根据其父节点丢失信息开启孤点加入流程，将父节点重新加入所述网络。其具体加入过程参见之前实施例，此处不再详述。</p>
    <p>[0210]	路由节点生成路由子节点加入信息、路由子节点丢失信息和路由父节点丢失信息。路由节点根据路由父节点丢失信息开启节点加入流程，选择一个合适的节点作为父节点，以此重新加入所述网络；并根据路由子节点加入信息和路由子节点丢失信息更新路由节点网络结构信息表，同时将路由子节点加入信息和路由子节点丢失信息上报至网关节点。</p>
    <p>[0211]	网关节点生成网关子节点加入信息、网关子节点丢失信息，接收路由节点上报的路由子节点加入和路由子节点丢失信息，并据此更新网络拓扑结构信息表。</p>
    <p>[0212]	本发明实施例4提供了一种基于Zigbee协议的无线传感器网络结构的维护系统，参见图9，所述系统包括网关节点1，路由节点2以及终端节点3。其中，网关节点I包括：</p>
    <p>[0213]	网络拓扑结构信息表建立单元11，用于预先建立网络拓扑结构信息表。</p>
    <p>[0214]	网关子节点变化信息生成单元12，用于在检测到网关子节点的变化时生成网关子节点变化信息；所述网关子节点包 括网络中与网关节点存在父子关系的路由节点和/或终端节点。</p>
    <p>[0215]	网关更新单元13，用于根据网络中节点的变信息更新所述网络拓扑结构信息表，以供用户查询；所述网络中节点包括所述网关子节点和所述路由子节点。</p>
    <p>[0216]	路由节点2包括：</p>
    <p>[0217]	路由子节点变化信息生成单元21，用于在检测到路由子节点的变化时生成路由子节点变化信息并上报至所述网关节点。</p>
    <p>[0218]	路由节点信息返回单元22，用于根据接收到的广播节点信息收集命令返回自身的节点信息至所述网关节点。</p>
    <p>[0219]	终端节点3包括：</p>
    <p>[0220]	终端节点信息返回单元31，用于根据接收到的广播节点信息收集命令返回自身的节点信息至所述网关节点。</p>
    <p>[0221]	其中，网络拓扑结构信息表建立单元11包括：</p>
    <p>[0222]	广播单元111，用于在所述网络中广播节点信息收集命令。</p>
    <p>[0223]	网络拓扑结构信息表建立子单元112，用于根据路由节点信息返回单元22和终端节点信息返回单元31返回的节点信息进行组合生成网络拓扑结构信息表并存储。</p>
    <p>[0224]	在网络中节点的变化分节点的加入和节点丢失两种情况。对应的，网关子节点变化信息生成单元，包括：网关子节点加入信息生成单元和网关子节点丢失信息生成单元。路由子节点变化信息生成单元，包括：路由子节点加入信息生成单元和路由子节点丢失信息生成单元。</p>
    <p>[0225]	其中，网关子节点加入信息生成单元，用于在检测到网关子节点的变化时，生成网关子节点加入信息，其具体用于当一节点以网关节点为父节点加入网络时，生成网关子节点加入信息。</p>
    <p>[0226]	网关子节点丢失信息生成单元，用于在检测到网关子节点的变化，生成网关子节点丢失信息，包括：</p>
    <p>[0227]	第一下一跳节点确定单元，用于根据待发送数据的目的节点确定下一跳网关子节点。</p>
    <p>[0228]	第一数据发送单元，用于将所述待发送数据发送至所述下一跳网关子节点。</p>
    <p>[0229]	网关子节点丢失判断单元，用于根据所述待发送数据的接收状态判断所述下一跳网关子节点是否丢失。</p>
    <p>[0230]	网关子节点丢失信息生成子单元，用于当所述网关子节点丢失时，生成网关子节点丢失信息。</p>
    <p>[0231]	所述路由子节点加入信息生成单元，用于在检测到路由子节点的变化时，生成路由子节点加入信息；具体包括：[0232]	路由子节点加入信息生成子单元，用于当一节点以所述路由节点为父节点加入所述网络时，生成路由子节点加入信息；</p>
    <p>[0233]	路由子节点丢失信息生成单元，具体用于在检测到路由子节点的变化时，生成路由子节点丢失信息；包括：</p>
    <p>[0234]	第二下一跳节点确定单元，用于根据待发送数据的目的节点确定下一跳节点；</p>
    <p>[0235]	第二数据发送单元，用于将所述待发送数据发送至所述下一跳节点；</p>
    <p>[0236]	路由子节点丢失判断单元，用于根据所述待发送数据的接收状态确定所述路由节点的下一跳节点是否丢失；</p>
    <p>[0237]	协议层上报单元，用于在所述下一跳路由子节点丢失，且所述下一跳路由节点为 所述路由节点的子节点时，在所述路由节点的协议层生成路由子节点丢失信息并上报至所述路由节点的应用层；</p>
    <p>[0238]	应用层上报单元，用于在所述路由节点的应用层接收到所述路由子节点丢失信息时，将所述路由子节点丢失信息上报至所述网关节点；</p>
    <p>[0239]	协议层上报单元，还用于在所述下一跳节点丢失，且所述下一跳节点为路由节点的父节点时，在所述路由节点的协议层生成路由父节点丢失信息并上报至所述路由节点的应用层；</p>
    <p>[0240]	应用层上报单元，还用于当所述路由节点的应用层接收到所述路由父节点丢失信息时，开启节点加入流程，选择合适的节点为父节点重新加入所述网络。</p>
    <p>[0241]	在本发明中，终端节点也可检测其父节点的变化，生成父节点变化信息。此时，终端节点还包括：</p>
    <p>[0242]	终端父节点确定单元，用于根据待发送数据目的节点确定下一跳终端父节点；</p>
    <p>[0243]	终端数据发送单元，用于发送所述待发送数据至所述下一跳终端父节点；</p>
    <p>[0244]	终端父节点丢失判断单元，用于根据所述待发送数据的接收状态判断所述终端父节点是否丢失；</p>
    <p>[0245]	终端父节点丢失信息生成单元，用于在所述终端父节点丢失时，生成终端父节点丢失f目息;</p>
    <p>[0246]	孤点加入单元，用于根据所述终端父节点丢失信息开启孤点加入流程，选择所述终端节点的父节点为父节点加入所述网络；</p>
    <p>[0247]	节点加入单元，用于在所述父节点无法通过孤点加入流程加入时，开启节点加入流程，选择其他合适的节点为父节点加入所述网络。</p>
    <p>[0248]	通过上述介绍可知，路由子节点丢失信息以及路由子节点加入信息会被上报至网关节点，因此，在网关节点处就汇集了路由子节点的变化信息和网关子节点的变化信息。网关更新单元根据这些变化信息更新网络拓扑结构信息表。网关更新单元具体包括：</p>
    <p>[0249]	网关更新单元包括：</p>
    <p>[0250]	网关加入信息判断单元，用于当所述节点的变化信息为节点的加入信息时，根据网络拓扑结构信息表的内容判断所述节点是否存在于所述网络中；</p>
    <p>[0251]	网关加入信息更新子单元，用于在所述节点存在于所述网络中时，更新所述网络拓扑结构信息表中存储的所述节点的相应信息；</p>
    <p>[0252]	网关分配单元，用于在所述节点未存在于所述网络中时，在所述网络拓扑结构信息表中为所述节点分配存储空间，并增加对应的父子信息；</p>
    <p>[0253]	网关丢失信息判断单元，用于当所述节点的变化信息为节点的丢失信息时，根据网络拓扑结构信息表的内容判断所述节点是否已经存在于所述网络中；</p>
    <p>[0254]	网关丢失信息删除单元，用于在若所述节点存在于所述网络中时，在所述网络拓扑结构信息表中删除所述节点的信息；</p>
    <p>[0255]	网关提示单元，用于在所述节点未存在于所述网络中时，提示出错。</p>
    <p>[0256]	在本发明的优选实施例中，可同时在路由节点处维护路由节点拓扑结构信息表，以供用户查询该路由节点处的拓扑结构信息。此时，路由节点还包括： [0257]	路由更新单元，用于根据所述路由子节点的变化信息更新存储于所述路由节点的路由节点拓扑结构信息表，以供用户查询所述路由节点处的拓扑结构信息；</p>
    <p>[0258]	所述路由更新单元包括：</p>
    <p>[0259]	路由加入信息判断单元，用于当所述路由子节点的变化信息为加入信息时，根据路由节点拓扑结构信息表的内容判断所述路由子节点是否已经存在于所述网络中；</p>
    <p>[0260]	路由加入信息更新子单元，用于在所述路由子节点已经存在于所述网络中时，更新在所述路由节点拓扑结构信息表中所存储的所述路由子节点的信息；</p>
    <p>[0261]	路由分配单元，用于在所述路由子节点未存在于所述网络中时，在所述路由节点拓扑结构信息表中为所述路由子节点分配存储空间，并增加对应的父子信息；</p>
    <p>[0262]	路由丢失信息判断单元，用于当所述路由子节点的变化信息为丢失信息时，根据路由节点拓扑结构信息表的内容判断所述路由子节点是否已经存在于所述网络中；</p>
    <p>[0263]	路由丢失信息删除单元，用于在所述路由子节点已经存在于所述网络中时，在所述路由节点拓扑结构信息表中删除所述路由子节点的信息；</p>
    <p>[0264]	路由提示单元，用于在所述路由子节点未存在于所述网络中时提示出错。</p>
    <p>[0265]	值得注意的是，本发明系统与本发明的方法相对应，因此对系统不再详述，相关部分参见方法实施例即可。</p>
    <p>[0266]	以上对本发明所提供的一种基于Zigbee协议的无线传感器网络结构的维护方法及系统，进行了介绍，本文中应用了具体个例对本发明的原理及实施方式进行了阐述，以上实施例的说明只是用于帮助理解本发明的方法及其核心思想；同时，对于本领域的一般技术人员，依据本发明的思想，在具体实施方式及应用范围上均会有改变之处。综上所述，本说明书内容不应理解为对本发明的限制。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101140695A?cl=zh">CN101140695A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年9月30日</td><td class="patent-data-table-td patent-date-value">2008年3月12日</td><td class="patent-data-table-td ">浙江大学</td><td class="patent-data-table-td ">基于ZigBee无线传感器网络的温室环境监控系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102572156A?cl=zh">CN102572156A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年1月11日</td><td class="patent-data-table-td patent-date-value">2012年7月11日</td><td class="patent-data-table-td ">南京航空航天大学</td><td class="patent-data-table-td ">基于无线传感器网络的儿童警报车载系统及方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102622896A?cl=zh">CN102622896A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年4月5日</td><td class="patent-data-table-td patent-date-value">2012年8月1日</td><td class="patent-data-table-td ">郭海锋</td><td class="patent-data-table-td ">一种基于GPRS/3G与ZigBee网络的车速信息采集系统</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103312547A?cl=zh">CN103312547A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年6月18日</td><td class="patent-data-table-td patent-date-value">2013年9月18日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">通信方法、装置及系统</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=pDTXBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04W0084180000">H04W84/18</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=pDTXBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04W0024040000">H04W24/04</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2013年3月13日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年4月10日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2016年3月2日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Grant of patent or utility model</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/78b3df0ff332d585ed55/CN102970702A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_4874c258b856314cce6b80d777b4ee7a.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8EZigbee%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%97%A0%E7%BA%BF%E4%BC%A0%E6%84%9F.pdf?id=pDTXBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U0zWzvXOI0EQ0ZC8-dEXcj6qnGROQ"},"sample_url":"https://www.google.com/patents/reader?id=pDTXBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>