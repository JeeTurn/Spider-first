<!DOCTYPE html><html><head><title>专利 CN103001734A - 一种基于电平采样的异步串口通信协议自动侦测方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种基于电平采样的异步串口通信协议自动侦测方法"><meta name="DC.contributor" content="陈永冰" scheme="inventor"><meta name="DC.contributor" content="吴泽民" scheme="inventor"><meta name="DC.contributor" content="刘勇" scheme="inventor"><meta name="DC.contributor" content="周岗" scheme="inventor"><meta name="DC.contributor" content="董大琼" scheme="inventor"><meta name="DC.contributor" content="卓延陵" scheme="inventor"><meta name="DC.contributor" content="海军工程大学" scheme="assignee"><meta name="DC.date" content="2012-10-17" scheme="dateSubmitted"><meta name="DC.description" content="本发明属于数字通信技术领域，具体地说是一种基于电平采样的异步串口通信协议的自动侦测方法。本发明首先对异步串口通信的电平信号进行采样，通过异步串口通信波特率与采样信号单个低电平的平均时间长度的关系，侦测异步串口通信波特率。再以波特率已被侦测的电平信号为靶信号，用停止位相关性匹配算法确定靶信号的数据帧比特位数和数据帧位置；再通过对帧内数据和帧间比特距离的分析确定靶信号的数据位比特位数、校验方式和停止位比特位数；最后用基于最小错误率的Bayes决策方法确定靶信号的数据编码方式。本发明可用于各种应用异步串口通信协议进行通信和数据传输设备的通信协议侦测。"><meta name="DC.date" content="2013-3-27"><meta name="DC.relation" content="CN:102306136:A" scheme="references"><meta name="DC.relation" content="CN:1293852:A" scheme="references"><meta name="DC.relation" content="EP:1696576:A1" scheme="references"><meta name="citation_patent_publication_number" content="CN:103001734:A"><meta name="citation_patent_application_number" content="CN:201210394398"><link rel="canonical" href="https://www.google.com/patents/CN103001734A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN103001734A?cl=zh"/><meta name="title" content="专利 CN103001734A - 一种基于电平采样的异步串口通信协议自动侦测方法"/><meta name="description" content="本发明属于数字通信技术领域，具体地说是一种基于电平采样的异步串口通信协议的自动侦测方法。本发明首先对异步串口通信的电平信号进行采样，通过异步串口通信波特率与采样信号单个低电平的平均时间长度的关系，侦测异步串口通信波特率。再以波特率已被侦测的电平信号为靶信号，用停止位相关性匹配算法确定靶信号的数据帧比特位数和数据帧位置；再通过对帧内数据和帧间比特距离的分析确定靶信号的数据位比特位数、校验方式和停止位比特位数；最后用基于最小错误率的Bayes决策方法确定靶信号的数据编码方式。本发明可用于各种应用异步串口通信协议进行通信和数据传输设备的通信协议侦测。"/><meta property="og:title" content="专利 CN103001734A - 一种基于电平采样的异步串口通信协议自动侦测方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN103001734A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN103001734A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=GRnsBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN103001734A&amp;usg=AFQjCNGxALKvy2559I-gnThPXcI9lMT7eg" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/12548f2d17ed712967de/CN103001734A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/12548f2d17ed712967de/CN103001734A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN103001734A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN103001734A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN103001734A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN103001734B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN103001734A?cl=zh" style="display:none"><span itemprop="description">本发明属于数字通信技术领域，具体地说是一种基于电平采样的异步串口通信协议的自动侦测方法。本发明首先对异步串口通信的电平信号进行采样，通过异步串口通信波特率与采样信号单个低电平的平均时间长度的关系，侦测...</span><span itemprop="url">https://www.google.com/patents/CN103001734A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN103001734A - 一种基于电平采样的异步串口通信协议自动侦测方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN103001734A - 一种基于电平采样的异步串口通信协议自动侦测方法" title="专利 CN103001734A - 一种基于电平采样的异步串口通信协议自动侦测方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN103001734 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201210394398</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2013年3月27日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2012年10月17日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2012年10月17日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103001734B?hl=zh-CN&amp;cl=zh">CN103001734B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201210394398.2, </span><span class="patent-bibdata-value">CN 103001734 A, </span><span class="patent-bibdata-value">CN 103001734A, </span><span class="patent-bibdata-value">CN 201210394398, </span><span class="patent-bibdata-value">CN-A-103001734, </span><span class="patent-bibdata-value">CN103001734 A, </span><span class="patent-bibdata-value">CN103001734A, </span><span class="patent-bibdata-value">CN201210394398, </span><span class="patent-bibdata-value">CN201210394398.2</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%99%88%E6%B0%B8%E5%86%B0%22">陈永冰</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%90%B4%E6%B3%BD%E6%B0%91%22">吴泽民</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%88%98%E5%8B%87%22">刘勇</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%91%A8%E5%B2%97%22">周岗</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E8%91%A3%E5%A4%A7%E7%90%BC%22">董大琼</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%8D%93%E5%BB%B6%E9%99%B5%22">卓延陵</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E6%B5%B7%E5%86%9B%E5%B7%A5%E7%A8%8B%E5%A4%A7%E5%AD%A6%22">海军工程大学</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103001734A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103001734A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103001734A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (3),</span> <span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (1),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (1),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=GRnsBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201210394398&amp;usg=AFQjCNHoJ2CRFe2UTSK0stfek7MjqtZQfw"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=GRnsBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D103001734A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNGeDQdYESTCApKVGHExNt3QkUz_MA"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT122901305" lang="ZH" load-source="patent-office">一种基于电平采样的异步串口通信协议自动侦测方法</invention-title>
      </span><br><span class="patent-number">CN 103001734 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA109781443" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明属于数字通信技术领域，具体地说是一种基于电平采样的异步串口通信协议的自动侦测方法。本发明首先对异步串口通信的电平信号进行采样，通过异步串口通信波特率与采样信号单个低电平的平均时间长度的关系，侦测异步串口通信波特率。再以波特率已被侦测的电平信号为靶信号，用停止位相关性匹配算法确定靶信号的数据帧比特位数和数据帧位置；再通过对帧内数据和帧间比特距离的分析确定靶信号的数据位比特位数、校验方式和停止位比特位数；最后用基于最小错误率的Bayes决策方法确定靶信号的数据编码方式。本发明可用于各种应用异步串口通信协议进行通信和数据传输设备的通信协议侦测。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(10)</span></span></div><div class="patent-text"><div mxw-id="PCLM52325654" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.	一种基于电平采样的异步串口通信协议自动侦测方法，其特征在于：包括如下步骤：步骤一、异步串口通信电平信号采样；步骤二、采样数据中单个低电平的平均时间长度计算；步骤三、异步串口通信波特率与单个低电平的平均时间长度的数学关系推导；步骤四、异步串口通信波特率估计取值范围计算；步骤五、结合异步串口通信协议，由异步串口通信波特率估计取值范围确定异步串口 通信波特率；步骤六、基于停止位相关性匹配的异步串口通信协议数据帧比特位数和数据帧位置侦测；步骤七、异步串口通信协议数据校验方式与数据位比特位数侦测；步骤八、基于帧间距离检测的异步串口通信协议停止位比特位数侦测；步骤九、基于最小错误率Bayes决策的异步串口通信协议数据编码方式侦测。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2 如权利要求1所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在 于：所述步骤一异步串口通信的电平信号进行采样的具体方法是：高电平的采样结果为 “1”，低电平的采样结果为“0”，采样频率为需要被侦测的最大波特率的整数倍或异步串口 通信协议所规定的最大波特率的整数倍。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.如权利要求1所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在 于：所述步骤二单个低电平的平均时间长度计算方法是：统计采样数据中低电平的总数和 低电平采样点的总数，用低电平采样点的总数除以采样频率得到低电平的总时间长度，再 用低电平的总时间长度除以低电平的总数得到单个低电平的平均时间长度：<div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AC00021.png"> <img id="icf0001" file="CN103001734AC00021.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AC00021.png" class="patent-full-image" alt="Figure CN103001734AC00021"> </a> </div>式中表示单个低电平的平均时间长度，n表示低电平采样点总数，m表示低电平总 j.数，fs表示采样频率。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.如权利要求1所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在 于：所述步骤三异步串口通信波特率与单个低电平的平均时间长度的数学关系式为：<div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AC00022.png"> <img id="icf0002" file="CN103001734AC00022.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AC00022.png" class="patent-full-image" alt="Figure CN103001734AC00022"> </a> </div>式中表示异步串口通信波特率，&amp;表示采样数据中所含帧数，s表示每帧的采 样误码率。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.如权利要求1所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤四异步串口通信波特率估计取值范围的计算为：利用统计计算得到的采样数据单个低电平的平均时间长度值和数学推导出的异步串口通信波特率与单个低电平的平均时间长度的关系式计算得到异步串口通信波特率的估计取值范围：<div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AC00031.png"> <img id="icf0003" file="CN103001734AC00031.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AC00031.png" class="patent-full-image" alt="Figure CN103001734AC00031"> </a> </div> </div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.如权利要求1所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤五的具体步骤为：根据异步串口通信协议的规定，通信波特率的合法取值集合为{50、100、120、150、300、600、1200、1800、2400、4800、7200、9600、14400、19200、28800、 38400,57600,115200,128000,256000 }，在波特率合法取值集合内，搜索落入波特率的估计取值范围或与波特率的估计取值范围最接近的波特率值即为异步串口通信的波特率。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.如权利要求1所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤六的具体实现方式是：以波特率已被侦测的电平信号为靶信号，虚拟5个匹配模版，所述模版的特征包括如下五方面：特征1:模版波特率等于靶信号的波特率；特征2 :模版的第一位为I比特低电平起始位；特征3 :模版的最后一位为I比特高电平停止位；特征4 ：5个模版起始位和停止位的距离分别是5、6、7、8、9个比特位；特征5 :模版起始位和停止位之间的比特位没有任何电平特征；所述的停止位相关性匹配的匹配步骤是：步骤a:用模板的起始位与靶信号中有可能是一帧起始位的一个低电平进行重合对准，用模版的停止位与模版停止位位置重合的靶信号比特位进行同或运算，记录运算值； 步骤b :寻找模版停止位后第一个低电平进行对准；步骤c :重复步骤a，步骤b，直至遍历靶信号所有电平，算完成一次相关性匹配；步骤d :用相关性函数计算5个模版不同次匹配的相关性，相关性函数定义为：<div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AC00032.png"> <img id="icf0004" file="CN103001734AC00032.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AC00032.png" class="patent-full-image" alt="Figure CN103001734AC00032"> </a> </div>式中为进行匹配的靶信号比特位的电平值，V』=I是模板停止位的电平值，N为 ； ^ &#183;参加匹配的总比特数，Θ表示同或运算符，s为模版帧的比特位数，I为匹配序号；步骤e :以相关性函数值最大的那次匹配的模版比特位数作为帧内比特位数，以相关性函数值最大的那次匹配的每个起始位对准位置作为每个数据帧的起始位置。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.如权利要求1所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤七的具体实现方式是：通过步骤一确定的数据帧的位置和长度，提取每帧内数据，对帧内数据进校4种“特定关系”统计；特定关系1:一帧内高电平的比特数为偶数，偶校验统计量加I ;特定关系2 :&#8212;帧内高电平的比特数为奇数，奇校验统计量加I ;特定关系3 ：一巾贞内最后一比特位为闻电平，闻校验统计量加I ;特定关系4 :一帧内最后一比特位为低电平，低校验统计量加I ;根据统计量与帧总数的比例与“校验统计门限值”进行比较，4种统计量哪一种统计量占数据总帧数的比例超出了“校验统计门限值”，就判定那种统计量对应的校验方式为靶信号数据的校验方式，否则判定靶信号数据无校验；依实验确定“校验统计门限值”设定为 95%,在无校验的情况下，数据位比特位数等于步骤六所确定的数据帧比特位数减2，在有校验的情况下，数据位比特位数等于步骤六所确定的数据帧比特位数减3。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.如权利要求1所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤八的具体实现方式是：在于由步骤六、步骤七确定每帧数据在靶信号中的位置，统计帧与帧之间的比特距离，从不小于总帧数10%数量的帧间比特距离统计量中搜索出最短的比特距离Vmin :(I ) Vaia =0(bit)，则认为停止位比特位数为I比特；(II ) Vmm =0. 5 (bit)，则认为停止位比特位数为1. 5比特；(III) Vmm =1 (bit)，则认为停止位比特位数为2比特；(IV )其他情况，则认为停止位比特位数为I比特。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.如权利要求1所述的所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤九的具体实现方式是：通过步骤六、步骤七所确定的数据帧比特位数和数据校验方式，取出不含校验位的帧内数据，统计取出的帧内数据总量和ASC II编码方式译码值合法的数据量，用基于最小错误率的Bayes决策计算数据编码方式是ASC II码的后验概率，以数据编码方式是ASC II码的后验概率是否大于“语义判定门限值”判断异步串口通信数据的编码方式是ASC II码还是16进制数，依实验确定“语义判定门限值”最好设定为95%，基于最小错误率的Bayes决策计算方法为： <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AC00041.png"> <img id="icf0005" file="CN103001734AC00041.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AC00041.png" class="patent-full-image" alt="Figure CN103001734AC00041"> </a> </div>式中W1表示数据为ASC II码；表示数据为16进制数；q为数据错误率；为一个数据可以被译码为ASC II码的概率；x为事件个数据中，有I?个数据可被译为ASC II 码；P(Xlwi)和I W，）分别为在作！ fD 1^2条件下事件x发生的前验概率，Pi^i I X)为数据编码方式是ASC II码的后验概率。、</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES59392725" lang="ZH" load-source="patent-office" class="description">
    <p>一种基于电平采样的异步串口通信协议自动侦测方法</p>
    <p>技术领域</p>
    <p>[0001]	本发明属于数字通信技术领域，具体地说是一种基于电平采样的异步串口通信协议的自动侦测方法，可用于各种应用异步串口通信协议进行通信和数据传输的设备的通信协议侦测。</p>
    <p>技术背景</p>
    <p>[0002]	异步串口通信协议是一种以数据帧为通信单位传送数据信息的协议，协议规定了数据帧被传送的速度（即波特率)、数据帧内和帧间结构和数据的传送方式，如图1所示。波特率表示通信中单位时间内传送的二进制数据的位数，单位为“位/秒（bps) ”，一位二进制数叫做一比特（bit)，根据异步串口通信协议的规定，通信波特率的合法取值集合为{50、100、120、150、300、600、1200、1800、2400、4800、7200、9600、14400、19200、28800、38400、57600、115200、128000、256000}。异步串口通信协议把需要发送的数据分割成若干个数据帧，数据帧的结构由具体的异步串口通信协议指定。一个数据帧以一个比特低电平开始，作为帧的起始位。起始位后面是数据位，根据异步串口通信协议的规定，数据位比特位数的所有合法的取值是：5比特、6比特、7比特、8比特四者之一。数据位后是校验位，根据异步串口通信协议的规定，如果有校验位，校验位占I比特，所有合法的校验方式是：奇校验（ODD)、偶校验（EVEN)、高校验（MARK)、低校验（SPACE)四者之一；如果没有校验，则不设校验位。校验位后是停止位(如果没有校验位停止位紧接着最后一位数据位)，根据异步串口通信协议的规定，停止位为高电平，其比特位数所有合法的取值是：1比特、1. 5比特、2比特三者之一。停止位是帧内结构的结尾，帧与帧之间可以有任意比特位数(包括0比特)空闲位，空闲位为高电平，空闲位后是下一帧的起始位。根据异步串口通信协议的规定，通信数据的传送方式可以为ASC II码传送或者是16进制数传送。</p>
    <p>[0003]	异步串口通信需在通信前互相约定好通信使用的协议参数，具体的说就是：波特率、数据位比特位数、校验方式、停止位比特位数、数据编码方式。在以某些配备串口的军用进口设备为代表的场合下，常常因为保密等原因无法获得设备的配套说明书，从而不知道设备上使用的异步串口通信协议。中国发明专利《基于单片机输入捕获功能的波特率自适应方法》（申请号：CN201110221090. 3)提出了一种用机器对异步串口通信电平进行采样，通过寻找采样点数量最少的电平计算通信的波特率的方法。但是没有现成的对于波特率、数据位比特位数、校验方式、停止位比特位数、数据编码方式这一整套参数的自动侦测方法。</p>
    <p>[0004]	综上所述，设计一种能够自动完成异步串口通信协议波特率、数据位比特位数、校验方式、停止位比特位数、数据编码方式的侦测算法，不仅有一定的创新价值，也有明显的现实意义。</p>
    <p>[0005]</p>
    <p>发明内容</p>
    <p>[0006]	针对背景技术的不足，本发明提出了一种对信号进行电平采样，通过计算采样信号单个低电平的平均时间长度自动侦测通信波特率的新方法，并在波特率被侦测出来的基础上提出了数据位比特位数、校验方式、停止位比特位数、数据编码方式的自动侦测方法。</p>
    <p>[0007]	本发明的技术方案是：一种基于电平采样的异步串口通信协议自动侦测方法，其特征在于：包括如下步骤：</p>
    <p>  步骤一、异步串口通信电平信号采样；</p>
    <p>  步骤二、采样数据中单个低电平的平均时间长度计算；</p>
    <p>  步骤三、异步串口通信波特率与单个低电平的平均时间长度的数学关系推导；</p>
    <p>  步骤四、异步串口通信波特率估计取值范围计算；   步骤五、结合异步串口通信协议，由异步串口通信波特率估计取值范围确定异步串口通信波特率；</p>
    <p>  步骤六、基于停止位相关性匹配的异步串口通信协议数据帧比特位数和数据帧位置侦</p>
    <p>测；</p>
    <p>  步骤七、异步串口通信协议数据校验方式与数据位比特位数侦测；</p>
    <p>  步骤八、基于帧间距离检测的异步串口通信协议停止位比特位数侦测；</p>
    <p>  步骤九、基于最小错误率Bayes决策的异步串口通信协议数据编码方式侦测。</p>
    <p>[0008]	如上所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤一异步串口通信的电平信号进行采样的具体方法是：高电平的采样结果为“1”，低电平的采样结果为“0”，采样频率为需要被侦测的最大波特率的整数倍或异步串口通信协议所规定的最大波特率的整数倍。其有益效果是：能有效的采样通信数据，例如：需要侦测波特率小于等于38400bps的异步串口信号的波特率，采样频率取38400bps的4倍，为153. 6KHz ;采样频率也可直接取为异步串口通信协议所规定的最大波特率的整数倍，例如：采样频率取256000bps的2倍，为512KHz。</p>
    <p>[0009]	如上所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤二单个低电平的平均时间长度计算方法是：统计采样数据中低电平的总数和低电平采样点的总数，用低电平采样点的总数除以采样频率得到低电平的总时间长度，再用低电平的总时间长度除以低电平的总数得到单个低电平的平均时间长度：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00071.png"> <img id="idf0001" file="CN103001734AD00071.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00071.png" class="patent-full-image" alt="Figure CN103001734AD00071"> </a> </div>
    <p>式中瓦表示单个低电平的平均时间长度，n表示低电平采样点总数，m表示低电平总</p>
    <p>                    L</p>
    <p>数，fs表示采样频率。</p>
    <p>[0010]	如上所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤三异步串口通信波特率与单个低电平的平均时间长度的数学关系式为：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00081.png"> <img id="idf0002" file="CN103001734AD00081.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00081.png" class="patent-full-image" alt="Figure CN103001734AD00081"> </a> </div>
    <p>财&#31308;辟$ □&#35613;言&#36774;寺氧免&#31308;&#38620;&#40629;顿i中贞it s标&#8226;中贞白勺M</p>
    <p>样误码率。其有益效果是：基于采样误差不可避免的实际情况，经过数学分析，推导出在异步串口通信帧结构框架下，单个低电平的平均时间长度与异步串口通信波特率的数学关系。</p>
    <p>[0011]	如上所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤四异步串口通信波特率估计取值范围的计算为：利用统计计算得到的采样数据单个低电平的平均时间长度值和数学推导出的异步串口通信波特率与单个低电平的平均时间长度的关系式计算得到异步串口通信波特率的估计取值范围：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00082.png"> <img id="idf0003" file="CN103001734AD00082.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00082.png" class="patent-full-image" alt="Figure CN103001734AD00082"> </a> </div>
    <p>[0012]	如上所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤五的具体步骤为：根据异步串口通信协议的规定，通信波特率的合法取值集合为{50、100、120、150、300、600、1200、1800、2400、4800、7200、9600、14400、19200、28800、38400、57600、115200、128000、256000 }，在波特率合法取值集合内，搜索落入波特率的估计取值范围或与波特率的估计取值范围最接近的波特率值即为异步串口通信的波特率。</p>
    <p>[0013]	如上所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤六的具体实现方式是：以波特率已被侦测的电平信号为靶信号，虚拟5个匹配模版，所述模版的特征包括如下五方面：</p>
    <p>  特征1:模版波特率等于靶信号的波特率；</p>
    <p>  特征2 :模版的第一位为I比特低电平起始位；</p>
    <p>  特征3 :模版的最后一位为I比特高电平停止位；</p>
    <p>  特征4 ：5个模版起始位和停止位的距离分别是5、6、7、8、9个比特位；</p>
    <p>  特征5 :模版起始位和停止位之间的比特位没有任何电平特征；</p>
    <p>  所述的停止位相关性匹配的匹配步骤是：</p>
    <p>  步骤a:用模板的起始位与靶信号中有可能是一帧起始位的一个低电平进行重合对准，用模版的停止位与模版停止位位置重合的靶信号比特位进行同或运算，记录运算值；步骤b :寻找模版停止位后第一个低电平进行对准；</p>
    <p>  步骤c :重复步骤a，步骤b，直至遍历靶信号所有电平，算完成一次相关性匹配；</p>
    <p>  步骤d :用相关性函数计算5个模版不同次匹配的相关性，相关性函数定义为：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00091.png"> <img id="idf0004" file="CN103001734AD00091.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00091.png" class="patent-full-image" alt="Figure CN103001734AD00091"> </a> </div>
    <p>式中Y为进行匹配的靶信号比特位的电平值，V. 二 I是模板停止位的电平值，N为     i ^ ^</p>
    <p>参加匹配的总比特数，G)表示同或运算符，s为模版帧的比特位数，灸为匹配序号；</p>
    <p>  步骤e :以相关性函数值最大的那次匹配的模版比特位数作为帧内比特位数，以相关性函数值最大的那次匹配的每个起始位对准位置作为每个数据帧的起始位置。</p>
    <p>[0014]	如上所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤七的具体实现方式是：通过步骤一确定的数据帧的位置和长度，提取每帧内数据，对帧内数据进校4种“特定关系”统计； </p>
    <p>  特定关系1:一帧内高电平的比特数为偶数，偶校验统计量加I ;</p>
    <p>  特定关系2 :&#8212;帧内高电平的比特数为奇数，奇校验统计量加I ;</p>
    <p>  特定关系3 ：一巾贞内最后一比特位为闻电平，闻校验统计量加I ;</p>
    <p>  特定关系4 :一帧内最后一比特位为低电平，低校验统计量加I ;</p>
    <p>  根据统计量与帧总数的比例与“校验统计门限值”进行比较，4种统计量哪一种统计量占数据总帧数的比例超出了 “校验统计门限值”，就判定那种统计量对应的校验方式为靶信号数据的校验方式，否则判定靶信号数据无校验，依实验确定“校验统计门限值”最好设定为95%</p>
    <p>  在无校验的情况下，数据位比特位数等于步骤六所确定的数据帧比特位数减2，在有校验的情况下，数据位比特位数等于步骤六所确定的数据帧比特位数减3。</p>
    <p>[0015]	如上所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤八的具体实现方式是：在于由步骤六、步骤七确定每帧数据在靶信号中的位置，统计帧与帧之间的比特距离，从不小于总帧数10%数量的帧间比特距离统计量中搜索出最短的比</p>
    <p>特距离Vmhl ：</p>
    <p>   (I ) Vmia =0(bit)，则认为停止位比特位数为I比特；</p>
    <p>   (II ) Vmm =0. 5 (bit)，则认为停止位比特位数为1. 5比特；</p>
    <p>   (III) Vmm =1 (bit)，则认为停止位比特位数为2比特；</p>
    <p>  (IV )其他情况，则认为停止位比特位数为I比特。</p>
    <p>[0016]	如上所述的基于电平采样的异步串口通信协议自动侦测方法，其特征在于：所述步骤九的具体实现方式是：通过步骤六、步骤七所确定的数据帧比特位数和数据校验方式，取出不含校验位的帧内数据，统计取出的帧内数据总量和ASC II编码方式译码值合法的数据量，用基于最小错误率的Bayes决策计算数据编码方式是ASC II码的后验概率，以数据编码方式是ASC II码的后验概率是否大于“语义判定门限值”判断异步串口通信数据的编码方式是ASC II码还是16进制数，依实验确定“语义判定门限值”最好设定为95%，基于最小错误率的Bayes决策计算方法为：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00101.png"> <img id="idf0005" file="CN103001734AD00101.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00101.png" class="patent-full-image" alt="Figure CN103001734AD00101"> </a> </div>
    <p>式中W1表示数据为ASC Ii码；w:表示数据为16进制数；q为数据错误率；夕为一个数据可以被译码为ASC II码的概率；X为事件：a个数据中，有&amp;个数据可被译为ASC II码；Pix IW1)和Pfx I W、)分别为在W1和W、条件下事件Y发生的前验概率，Pfw1 I X)为数据编码方式是ASC II码的后验概率。</p>
    <p>[0017]	本发明的创新点：本发明提出了从异步串口通信低电平平均时间长度的入手，通过异步串口通信波特率与单个低电平的平均时间长度的数学关系，侦测异步串口通信波特率的新方法；提出了一种用虚拟匹配模版对靶信号进行相关性匹配，确定数据帧比特位数与数据帧位置的新方法；并在此基础上提出了异步串口通信协议数据位比特位数、校验方式、停止位比特位数、数据编码方式的侦测方法。</p>
    <p>附图说明</p>
    <p>[0018]	图1为异步串口通信帧结构示意图；</p>
    <p>  图2为本发明实施的方法流程图；</p>
    <p>  图3为本发明波特率侦测实施的方法流程图；</p>
    <p>  图4为本发明把异步串口通信信号电平数据帧的起始位与停止位和帧间的空闲位从电平里取出的示意图；</p>
    <p>  图5为本发明计算单个低电平的不同比特长度概率的示意图；</p>
    <p>  图6为本发明把取出的异步串口通信帧每一帧的起始位与停止位和帧间的空闲位放回随机数据中的示意图；</p>
    <p>  图7为本发明的虚拟匹配模版示意图；</p>
    <p>  图8为本发明提出的停止位相关性匹配示意图；</p>
    <p>  图9为本发明异步串口通信协议数据校验方式与数据位比特位数侦测流程图；</p>
    <p>  图10为本发明基于帧间距离检测的异步串口通信协议停止位比特位数侦测的流程</p>
    <p>图；</p>
    <p>  图11为本发明基于最小错误率Bayes决策的异步串口通信协议数据编码方式侦测的流程图；</p>
    <p>  图12为本发明的一个实施实例图；具体实施方式：</p>
    <p>  下面结合附图对本发明作进一步说明。</p>
    <p>[0019]	参照图2，它是本发明的实施流程图。首先对信号的波特率进行侦测，在通信波特率已被侦测的基础上，虚拟一系列匹配模版，用这些模版对靶信号的不同匹配点进行停止位相关性匹配，用相关性函数度量每次匹配的相关性，以相关性函数值最大的那次匹配模版比特位数作为帧内比特位数，以相关性函数值最大的那次匹配的每个起始位对准位置作为每个数据帧的起始位置。再根据数据帧的位置和比特位数，提取每帧内数据，进行校验方式的检验。同时提取帧间距离，用最短的帧间距离估计停止位比特位数。最后取出不含校验位的帧内数据，采用基于最小错误率的Bayes决策方法，根据帧内数据用ASC II编码方式译码的后验判定概率判断异步串口通信数据的编码方式是ASC II码还是16进制数。</p>
    <p>[0020]	参照图3，它是本发明波特率侦测实施方法流程图。首先对异步串口通信的电平信号进行采样，高电平的采样结果为“1”，低电平的采样结果为“0”，采样频率可取为需要被侦测的最大波特率的整数倍，例如：需要侦测波特率小于等于38400bps的异步串口信号的波特率，采样频率取38400bps的4倍，为153. 6KHz ;采样频率也可直接取为异步串口通信协议所规定的最大波特率的整数倍，例如：采样频率取256000bps的2倍，为512KHz。然后统计采样数据中低电平的总数和低电平采样点的总数，用低电平采样点的总数除以采样频率得到低电平的总时间长度，再用低电平的总时间长度除以低电平的总数得到单个低电平的平均时间长度。再结合推导出的异步串口通信波特率与单个低电平的平均时间长度的数学关系式计算得到异步串口通信波特率的估计取值范围。最后用计算得到的通信波特率的估计取值范围在异步串口通信协议的规定的通信波特率的合法取值集合内搜索，取落入波特率的估计取值范围或与波特率的估计取值范围最接近的波特率合法值确定为所采样异步串口电平的通信波特率。</p>
    <p>[0021]	参照图4至图6，它们展示了异步串口通信波特率与单个低电平的平均时间长度的数学关系的推导过程。</p>
    <p>[0022]	参照图4，假设把异步串口通信信号电平数据帧每一帧的起始位与停止位和帧间的空闲位都从电平里取出，可认为剩下的数据是通信传输的随机数据。</p>
    <p>[0023]	参照图5，它展示了在无误码条件下，随机数据中单个低电平的平均比特长度的推导思路。因为随机数据每个比特位相互独立，低电平在下一个比特跳变为高电平的概率是</p>
    <p>1/2。单个低电平的比特长度为L比特的概率Pl为：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00111.png"> <img id="idf0006" file="CN103001734AD00111.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00111.png" class="patent-full-image" alt="Figure CN103001734AD00111"> </a> </div>
    <p> 随机数据中单个低电平的平均比特长度Ei为：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00112.png"> <img id="idf0007" file="CN103001734AD00112.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00112.png" class="patent-full-image" alt="Figure CN103001734AD00112"> </a> </div>
    <p>设有一段包含灸个数据帧的电平信号。取出每一帧的起始位与停止位和帧间的空闲</p>
    <p>位后，电平信号中低电平个数为m，故低电平总比特长度估计为2m，在一帧随机数据信号中高低电平的概率相等，故帧内电平总比特长度估计为4m。因为在串口帧格式中一帧的比特</p>
    <p>长度为5、比特，则可推导k与讯的关系为：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00121.png"> <img id="idf0008" file="CN103001734AD00121.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00121.png" class="patent-full-image" alt="Figure CN103001734AD00121"> </a> </div>
    <p>  参照图6，把取出的异步串口通信帧每一帧的起始位与停止位和帧间的空闲位放回随机数据中，放入位置的电平有4种可能，如图6中的：①高电平下降沿，②高电平，③低电平上升沿，④低电平。由于数据是随机的，4种可能等概率。只有放在①处使得整个数据序列的低电平数量不变，放在其余三个位置数据序列的低电平数量增I。而每执行一次放入操作 低电平总比特长度增均I。则放入每一帧的起始位与停止位和帧间的空闲位后，低电平总比</p>
    <p>特长度估计为:2讲+灸，低电平个数估计为:m+3k/4。</p>
    <p>[0024]	再考虑误码，设数据的帧采样误码率为误码以等概率发生在高低电平中，所以误码不影响低电平总比特长度。无论误码发生在高电平使误码处的高电平采样成低电平，还是发生在低电平使误码处的低电平采样成高电平，均导致低电平个数增I。考虑误码后的</p>
    <p>低电平总比特长度估计为：2m+ k ,低电平个数估计为：+	+ 。比特长</p>
    <p>度除以波特率就得到了时间长度，存在误码的采样数据单个低电平时间长度期望是：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00122.png"> <img id="idf0009" file="CN103001734AD00122.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00122.png" class="patent-full-image" alt="Figure CN103001734AD00122"> </a> </div>
    <p>  采样数据单个低电平时间长度可由对采样数据进行统计，通过下式得到：</p>
    <p>                    m</p>
    <p>  式中n表示低电平采样点总数，m表示低电平总数，fs表示采样频率。</p>
    <p>[0025]	由以上三式可推导出异步串口通信波特率的估计取值范围：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00123.png"> <img id="idf0010" file="CN103001734AD00123.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00123.png" class="patent-full-image" alt="Figure CN103001734AD00123"> </a> </div>
    <p>由于误码率S远小于1，计算估计取值范围时可忽略S ,直接写为：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00131.png"> <img id="idf0011" file="CN103001734AD00131.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00131.png" class="patent-full-image" alt="Figure CN103001734AD00131"> </a> </div>
    <p>  上述波特率的估计取值范围的区间比较小，而波特率的合法取值集合为{50、100、120、150、300、600、1200、1800、2400、4800、7200、9600、14400、19200、28800、38400、57600、115200、128000、256000}，合法取值集合中相邻波特率的差异值很大，在异步串口通信协议的规定的通信波特率的合法取值集合内搜索，取落入波特率的估计取值范围或与波特率的估计取值范围最接近的波特率合法值确定为所采样异步串口电平的通信波特率。</p>
    <p>[0026]	参照图7，它是本发明的虚拟匹配模版示意图，共可以虚拟5个模板，这些匹配模版的特征是：</p>
    <p>  ①.模版波特率等于靶信号的波特率；</p>
    <p>  ②.模版的第一位为I比特低电平起始位；</p>
    <p>  ③.模版的最后一位为I比特高电平停止位；</p>
    <p>  ④.5个模版起始位和停止位的距离s分别是5、6、7、8、9个比特位；</p>
    <p>  ⑤.模版起始位和停止位之间的比特位没有任何电平特征；</p>
    <p>  参照图8，它是本发明提出的停止位相关性匹配示意图。停止位相关性匹配的具体实施步骤是：</p>
    <p>  步骤1:选取起始位和停止位间的比特个数s=5的匹配模板，对准靶信号第一个低电平比特。同时记录靶信号中被匹配模板s位比特覆盖的低电平比特的个数m，被覆盖的每个低电平均要在后续步骤中作为初始对准点，进行一次相关性匹配；</p>
    <p>  步骤2 :用模版的停止位与模版停止位位置重合的靶信号比特位进行同或运算，记录运算结果；</p>
    <p>  步骤3:扫描靶信号后续电平至低电平出现，用模版的起始位对准靶信号第一个低电平比特，重复步骤2，直至遍历靶信号所有电平，算完成一次相关性匹配；</p>
    <p>  步骤4 :用相关性函数计算第一次匹配相关性乙；</p>
    <p>  步骤5 :分别以被第一次匹配中匹配模版覆盖的m个低电平比特为初始对准点，重复步</p>
    <p>骤2&#8212;步骤4，得到另外m次匹配的相关性U., U，、......U”r ；</p>
    <p>  步骤6 :若匹配模版的起始位和停止位间的比特个数s〈9，则s增1，重复步骤I一步骤</p>
    <p>5 ；</p>
    <p>  步骤7 :选出所有匹配相关性的最大值L;.,把r值则作为帧内比特位数，把被长度为r的匹配模版第一次匹配所覆盖的第V个低电平作为靶信号的第一帧数据的起始位，把Un.所对应的那次匹配的每个起始位对准位置作为靶信号每个数据帧的起始位位置。</p>
    <p>[0027]	参照图9，它是本发明异步串口通信协议数据校验方式与数据位比特位数侦测流程图。提取每帧内数据，对帧内数据满足的“特定关系”的帧数进行统计，根据统计量与帧总数的比例与设定的“校验统计门限值”进行比较。4种统计量哪一种统计量占数据总帧数的比例超出了 “校验统计门限值”，就判定那种统计量对应的校验方式为靶信号数据的校验方式，否则判定靶信号数据无校验。依实验确定“校验统计门限值”设定为95%，对所述“特定关系”进行的统计包括：</p>
    <p>  (I ) 一帧内高电平的比特数为偶数，偶校验统计量加I ;</p>
    <p>  (II ) 一帧内高电平的比特数为奇数，奇校验统计量加I ;</p>
    <p>  (III) 一帧内最后一比特位为高电平，高校验统计量加I ;</p>
    <p>  (IV ) 一帧内最后一比特位为低电平，低校验统计量加I ;</p>
    <p>  在判定无校验的情况下，数据位比特位数等于步骤六所确定的数据帧比特位数减2，在判定有校验的情况下，数据位比特位数等于步骤六所确定的数据帧比特位数减3。</p>
    <p>[0028]	参照图10，它是本发明基于帧间距离检测的异步串口通信协议停止位比特位数侦测的流程图。首先把每帧之间的比特距离信息提取出来，再从不小于总帧数10%数量的帧</p>
    <p>间比特距离统计量中搜索出最短的比特距离Vmn来判定停止位比特位数：</p>
    <p>   (I ) Vfiin =0 (bit),则认为停止位比特位数为I比特；</p>
    <p>   (II ) Vmtt =0. 5 (bit)，则认为停止位比特位数为1. 5比特；</p>
    <p>   (III)	Vmtl =1 (bit)，则认为停止位比特位数为2比特；</p>
    <p>  如果出现其他情况，说明靶信号大多数数据帧之间总是存在空闲位，此时认为停止位为I比特位。因为在异步串口通信中停止位和空闲位相连接而且二者均为高电平，所以超过I比特位的停止位与空闲位等价，认为停止位为I比特位，并不影响异步串口通信的正常进行。</p>
    <p>[0029]	参照图11，它是本发明基于最小错误率Bayes决策的异步串口通信协议数据编码方式侦测的流程图。异步串口通信帧内数据位比特位数必须大于等于7才能进行ASC II码的传输，而且异步串口通信传输的ASC II码均为可见字符，即ASC II码表中的32号至127号字符。若一个数据值不在[32，127]之间，则该数据不可能被译码为ASC II码。若异步串口通信帧内数据位比特位数是7或者8，则需要进行数据编码方式判定。首先提取出不含校验位的帧内数据，统计数据总数量和能被译码为ASC II码的数据数量。然后用基于最小错误率的Bayes决策方法计算所有数据的编码方式ASC II码的后验概率。这个后验概率大于“语义判定门限值”则判定异步串口通信数据的编码方式是ASC II码，反之判定数据编码方式为16进制数。依实验确定“语义判定门限值”设定为95%，基于最小错误率的Bayes决策计算方法为：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00141.png"> <img id="idf0012" file="CN103001734AD00141.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00141.png" class="patent-full-image" alt="Figure CN103001734AD00141"> </a> </div>
    <p>式中W1表示数据为ASC II码；表示数据为16进制数；q为数据错误率；Jp为一个数据可以被译码为ASC II码的概率；X为事件个数据中，有&amp;个数据可被译为ASC II码；</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00151.png"> <img id="idf0013" file="CN103001734AD00151.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00151.png" class="patent-full-image" alt="Figure CN103001734AD00151"> </a> </div>
    <p>分别为在</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00152.png"> <img id="idf0014" file="CN103001734AD00152.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00152.png" class="patent-full-image" alt="Figure CN103001734AD00152"> </a> </div>
    <p>条件下事件发生的前验概率，</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00153.png"> <img id="idf0015" file="CN103001734AD00153.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103001734A/CN103001734AD00153.png" class="patent-full-image" alt="Figure CN103001734AD00153"> </a> </div>
    <p>为数据编码方式是ASC II码的后验概率。</p>
    <p>[0030]	参照图12，它是本发明的一个实施实例图。把本发明提出的基于电平采样的异步串口通信协议自动侦测方法编制成计算机程序，从计算机额COM接口输入一串异步串口信号，该信号的通信协议为：波特率：9600bps，数据位比特位数：7，校验位：无，停止位比特位数：2，数据编码方式=ASCII码。图8显示了协议侦测结果和部分侦测过程数据。需要说明的是，图中“数据字长”栏中显示了不同帧内比特位数的匹配模版对靶信号进行相关性匹配的最大相关性函数值，其中“7位”和“8位”帧内比特位数的匹配模版的相关性函数的最大值相同，原因是靶信号的停止位比特位数为2，两种匹配模版每个匹配点正好是靶信号停止位的第一比特位和第二比特位，算法基于帧内数据的随机性，判定帧内比特位数为7。</p>
    <p>[0031]	以上结合附图对本发明的具体实施方式作了说明，但这些说明不能被理解为限制了本发明的范围，本发明的保护范围由随附的权利要求书限定，任何在本发明权利要求基础上进行的改动和润色都属于本发明的保护范围。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN1293852A?cl=zh">CN1293852A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">1999年2月9日</td><td class="patent-data-table-td patent-date-value">2001年5月2日</td><td class="patent-data-table-td ">艾利森公司</td><td class="patent-data-table-td ">用于异步串行通信的自动速率检测</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102306136A?cl=zh">CN102306136A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年8月3日</td><td class="patent-data-table-td patent-date-value">2012年1月4日</td><td class="patent-data-table-td ">宁波三星电气股份有限公司</td><td class="patent-data-table-td ">基于单片机输入捕获功能的波特率自适应方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/EP1696576A1?cl=zh">EP1696576A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2006年2月15日</td><td class="patent-data-table-td patent-date-value">2006年8月30日</td><td class="patent-data-table-td ">Casio Hitachi Mobile Communications Co., Ltd.</td><td class="patent-data-table-td ">System and method of network-linked digital terrestrial television broadcasting using bit error rate detection and stopping of transmission.</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103389960A?cl=zh">CN103389960A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年7月26日</td><td class="patent-data-table-td patent-date-value">2013年11月13日</td><td class="patent-data-table-td ">山东康威通信技术股份有限公司</td><td class="patent-data-table-td ">电力监控领域实现波特率自适应的方法及装置</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=GRnsBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0001000000">H04L1/00</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2013年3月27日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年4月24日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2015年5月6日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Grant of patent or utility model</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/12548f2d17ed712967de/CN103001734A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8E%E7%94%B5%E5%B9%B3%E9%87%87%E6%A0%B7%E7%9A%84%E5%BC%82%E6%AD%A5%E4%B8%B2%E5%8F%A3.pdf?id=GRnsBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U0dUhN8ksPWDuOYeI5C_Mi86vpoNg"},"sample_url":"https://www.google.com/patents/reader?id=GRnsBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>