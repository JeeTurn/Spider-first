<!DOCTYPE html><html><head><title>专利 CN101877783A - 网络视频存储器集群化视频监控系统和方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_5115ea495017d9115e613207d3810e5a/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_5115ea495017d9115e613207d3810e5a__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="网络视频存储器集群化视频监控系统和方法"><meta name="DC.contributor" content="严杰" scheme="inventor"><meta name="DC.contributor" content="周娟娟" scheme="inventor"><meta name="DC.contributor" content="周烽" scheme="inventor"><meta name="DC.contributor" content="熊晖" scheme="inventor"><meta name="DC.contributor" content="祝夭龙" scheme="inventor"><meta name="DC.contributor" content="北京邦诺存储科技有限公司" scheme="assignee"><meta name="DC.date" content="2009-11-6" scheme="dateSubmitted"><meta name="DC.description" content="本发明涉及一种网络视频存储器集群化视频监控系统和方法，该系统包括网络编码器、多个网络视频存储器(即NVR)和一个NVR管理器，网络编码器、NVR管理器和各NVR均与IP网络相连，各NVR支持网络编码器直接在其上存取音视频数据的网络存储协议，以将网络编码器编码输出的音视频数据直接保存在NVR上；NVR管理器包括映射模块和监控模块，映射模块存储有网络编码器与各NVR的映射关系，监控模块对各NVR接收的音视频数据的监控管理；各NVR在NVR管理器的控制下通过IP网络接收网络编码器编码后的音视频数据，并进行录像，以及响应客户端或网络编码器的访问请求、查询或回放或存储录像数据。该系统将NVR进行集群化管理，并同时解决了性能瓶颈和存储瓶颈的问题，提高了系统整体性能。"><meta name="DC.date" content="2010-11-3"><meta name="citation_patent_publication_number" content="CN:101877783:A"><meta name="citation_patent_application_number" content="CN:200910237461"><link rel="canonical" href="https://www.google.com/patents/CN101877783A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101877783A?cl=zh"/><meta name="title" content="专利 CN101877783A - 网络视频存储器集群化视频监控系统和方法"/><meta name="description" content="本发明涉及一种网络视频存储器集群化视频监控系统和方法，该系统包括网络编码器、多个网络视频存储器(即NVR)和一个NVR管理器，网络编码器、NVR管理器和各NVR均与IP网络相连，各NVR支持网络编码器直接在其上存取音视频数据的网络存储协议，以将网络编码器编码输出的音视频数据直接保存在NVR上；NVR管理器包括映射模块和监控模块，映射模块存储有网络编码器与各NVR的映射关系，监控模块对各NVR接收的音视频数据的监控管理；各NVR在NVR管理器的控制下通过IP网络接收网络编码器编码后的音视频数据，并进行录像，以及响应客户端或网络编码器的访问请求、查询或回放或存储录像数据。该系统将NVR进行集群化管理，并同时解决了性能瓶颈和存储瓶颈的问题，提高了系统整体性能。"/><meta property="og:title" content="专利 CN101877783A - 网络视频存储器集群化视频监控系统和方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101877783A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101877783A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=UoOABwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101877783A&amp;usg=AFQjCNGO_GzIhdE_T4ZnIibva3BK89tCuQ" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/95e713265febfc622efd/CN101877783A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/95e713265febfc622efd/CN101877783A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101877783A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101877783A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN101877783A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN101877783B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101877783A?cl=zh" style="display:none"><span itemprop="description">本发明涉及一种网络视频存储器集群化视频监控系统和方法，该系统包括网络编码器、多个网络视频存储器(即NVR)和一个NVR管理器，网络编码器、NVR管理器和各NVR均与IP网络相连，各NVR支持网络编码器直接在其上存取音视频数据 ...</span><span itemprop="url">https://www.google.com/patents/CN101877783A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101877783A - 网络视频存储器集群化视频监控系统和方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101877783A - 网络视频存储器集群化视频监控系统和方法" title="专利 CN101877783A - 网络视频存储器集群化视频监控系统和方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101877783 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200910237461</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2010年11月3日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2009年11月6日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2009年11月6日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101877783B?hl=zh-CN&amp;cl=zh">CN101877783B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200910237461.X, </span><span class="patent-bibdata-value">CN 101877783 A, </span><span class="patent-bibdata-value">CN 101877783A, </span><span class="patent-bibdata-value">CN 200910237461, </span><span class="patent-bibdata-value">CN-A-101877783, </span><span class="patent-bibdata-value">CN101877783 A, </span><span class="patent-bibdata-value">CN101877783A, </span><span class="patent-bibdata-value">CN200910237461, </span><span class="patent-bibdata-value">CN200910237461.X</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E4%B8%A5%E6%9D%B0%22">严杰</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%91%A8%E5%A8%9F%E5%A8%9F%22">周娟娟</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%91%A8%E7%83%BD%22">周烽</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%86%8A%E6%99%96%22">熊晖</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%A5%9D%E5%A4%AD%E9%BE%99%22">祝夭龙</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E5%8C%97%E4%BA%AC%E9%82%A6%E8%AF%BA%E5%AD%98%E5%82%A8%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">北京邦诺存储科技有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101877783A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101877783A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101877783A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (14),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (2),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (6)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=UoOABwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200910237461&amp;usg=AFQjCNEmGZrM_tTtji1qx5R4xBCFNTvekw"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=UoOABwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101877783A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNFrZScZdFcx5RvvHJr10gC55urVDg"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT98515878" lang="ZH" load-source="patent-office">网络视频存储器集群化视频监控系统和方法</invention-title>
      </span><br><span class="patent-number">CN 101877783 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA80941178" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明涉及一种网络视频存储器集群化视频监控系统和方法，该系统包括网络编码器、多个网络视频存储器(即NVR)和一个NVR管理器，网络编码器、NVR管理器和各NVR均与IP网络相连，各NVR支持网络编码器直接在其上存取音视频数据的网络存储协议，以将网络编码器编码输出的音视频数据直接保存在NVR上；NVR管理器包括映射模块和监控模块，映射模块存储有网络编码器与各NVR的映射关系，监控模块对各NVR接收的音视频数据的监控管理；各NVR在NVR管理器的控制下通过IP网络接收网络编码器编码后的音视频数据，并进行录像，以及响应客户端或网络编码器的访问请求、查询或回放或存储录像数据。该系统将NVR进行集群化管理，并同时解决了性能瓶颈和存储瓶颈的问题，提高了系统整体性能。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(10)</span></span></div><div class="patent-text"><ol mxw-id="PCLM33554222" lang="ZH" load-source="patent-office" class="claims">
    <li class="claim"> <div num="1" class="claim">
      <div class="claim-text">一种网络视频存储器集群化视频监控系统，包括网络编码器和与其连接的IP网络，其特征在于，还包括多个网络视频存储器(即NVR)和一个NVR管理器，所述NVR管理器和各网络视频存储器均与所述IP网络相连，所述网络视频存储器还与客户端相连或通过所述IP网络与客户端相连，所述各网络视频存储器支持所述网络编码器直接在其上存取音视频数据的网络存储协议，以将网络编码器编码输出的音视频数据直接保存在NVR上；所述NVR管理器为一逻辑管理模块，所述NVR管理器包括映射模块和监控模块，所述映射模块存储管理网络编码器与各网络视频存储器的映射关系，所述监控模块用于对各网络视频存储器接收的网络编码器编码后的音视频数据的监控管理；所述各网络视频存储器在NVR管理器的控制下通过IP网络接收网络编码器编码后的音视频数据，并进行录像，以及响应客户端或网络编码器的访问请求、查询或回放或存储录像数据。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.根据权利要求1所述的网络视频存储器集群化视频监控系统，其特征在于，所述网 络存储协议包括标准存储协议和专用流存储协议。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.根据权利要求1或2所述的网络视频存储器集群化视频监控系统，其特征在于，所述 网络视频存储器从底层向上层依次包括内核层、核心层和接口层，所述内核层包括专用文 件模块和协议存储模块，所述专用文件模块用于实现音视频数据流到磁盘上的最终分布控 制和读写处理，所述专用文件模块具有专用的访问接口，所述协议存储模块用于存储网络 存储协议；所述核心层包括视频流统一接口模块、视频流统一回放模块、录像存储模块、录 像查询模块和设置模块，视频流统一接口模块用于将外部接入的音视频数据转化为统一的 接口标准，视频流统一回放模块用于处理接口层传入的客户端的查询、回放、分发请求，录 像存储模块用于将从视频流统一接口模块获取的音视频数据进行存储，录像查询模块用于 根据设定的条件在录像存储模块中查询录像记录和报警记录，设置模块用于将网络视频存 储器中的各模块进行参数设置、权限设置和报警配置设置；所述接口层用于提供对外接口， 包括编码器接口层和客户端接口层。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.根据权利要求3所述的网络视频存储器集群化视频监控系统，其特征在于，所述NVR 管理器还包括负载均衡模块和自动识别模块，所述负载均衡模块用于为网络编码器动态分 配网络视频存储器，实现网络视频存储器的负载均衡，并由映射模块保存新的映射关系；所 述自动识别模块用于在某一网络视频存储器出现异常时进行自动识别，并替换为另一网络 视频存储器来响应访问请求，并由映射模块保存新的映射关系；所述监控模块为各网络视 频存储器提供对外单一的统一访问接口。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.根据权利要求4所述的网络视频存储器集群化视频监控系统，其特征在于，所述NVR 管理器部署在一个或分别集成在多个网络视频存储器中，或部署在单独的设备上；多个网 络视频存储器均部署有所述NVR管理器时，所述NVR管理器设置有同步机制。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.根据权利要求1或2所述的网络视频存储器集群化视频监控系统，其特征在于，所述 访问请求包括录像回放、录像下载、手动录像、定时录像、自动报警录像、录像查询、录像管 理。</div>
    </div>
    </li> <li class="claim"> <div num="7" class="claim">
      <div class="claim-text">7.	&#8212;种网络视频存储器集群化视频监控方法，其特征在于，将网络编码器和多个网络 视频存储器（NVR)连接到IP网络，并通过连接在所述IP网络上的NVR管理器建立网络编 码器与各网络视频存储器之间的映射关系，来实现网络编码器与各网络视频存储器的映射 和监控管理；所述各网络视频存储器支持所述网络编码器直接在其上存取音视频数据的网络存储协议，以将网络编码器编码输出的音视频数据直接保存在NVR上，再进行录像，以及 响应客户端或网络编码器的访问请求、查询或回放或存储录像数据。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.根据权利要求7所述的网络视频存储器集群化视频监控方法，其特征在于，在网络 视频存储器的底层设置专用的访问接口和进行网络存储协议的存储；在中间层将外部接入 的音视频数据转化为统一的接口标准，并将接入的音视频数据进行录像、响应客户端或网 络编码器的访问请求、查询或回放或存储录像数据；在上层设置编码器接口和客户端接口。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.根据权利要求7或8所述的网络视频存储器集群化视频监控方法，其特征在于，还包 括为网络编码器动态分配网络视频存储器，实现网络视频存储器的负载均衡；在某一网络 视频存储器出现异常时进行自动识别，并替换为另一网络视频存储器来响应访问请求；并 为各网络视频存储器提供对外单一的统一访问接口。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.根据权利要求9所述的网络视频存储器集群化视频监控方法，其特征在于，通过网 络视频存储器客户端实现对网络编码器和网络视频存储器的设置管理，以及录像数据的查 询或浏览或下载或回放。</div>
    </div>
  </li> </ol>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES38817350" lang="ZH" load-source="patent-office" class="description">
    <p>网络视频存储器集群化视频监控系统和方法</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及视频监控技术，特别是涉及一种可以应用在大型的监控平台系统中， 例如在城市安防等系统中应用的网络视频存储器集群化视频监控系统和方法。</p>
    <p>背景技术</p>
    <p>[0002]	传统视频监控领域里，硬盘录像机（Digital Video Recorder，DVR)集成了录像数 字化、控制网络化、存储硬盘化等功能于一体。其中录像数字化指将外接模拟摄像头的模拟 视频信号转换成数字信号，然后经过视频编码模块将这些数字信号转换成按一定格式排列 的数字视频流。再通过网络传输模块将这些数字视频流发往网络用户，同时也可将这些数 字视频流保存在设备的硬盘上以供日后的视频录像信息的查询。但是随着监控平台规模的 扩大和录像存储时间加长的要求，DVR受限于其嵌入式性能和模拟接入方式，在大规模部署 的监控应用中，渐渐的被网络编码器加存储服务器和磁盘阵列的方式或者是网络视频存储 器进行监控的方式取代。</p>
    <p>[0003]	网络编码器指具有音视频编码功能，而且可以利用网络传输数字信号的设备，通 常包括IP摄像头，数字视频服务器（Digital Video Server, DVS)和硬盘录像机（Digital Video Recorder,DVR)等。如图1所示的传统网络视频监控系统的结构示意图，网络编码器 1将音视频流编码后通过IP网络发送给录像服务器2 (或分发服务器），录像服务器再通过 存储协议（例如，iSCSI)将音视频数据存储到磁盘阵列上。录像服务器2还要负责存储于 磁盘阵列上的音视频数据的管理、查询和回放等。在这种网络视频监控系统结构的前提下， 又产生了很多改进技术：如申请号为200610111995. 4、申请人为北京天地互连信息技术有 限公司、名称为基于下一代互联网的远程视频监控系统及其实现方法的发明专利申请，提 供了一种基于互联网，能为公众提供运营级远程视频监控业务，支持运营平台，实现远程视 频监视、存储、告警联动等多功能的远程视频监控系统。又如申请号为200810239114. 6、申 请人为北京中星微电子有限公司、名称为网状结构的无限级联视频监控系统的发明专利申 请，该系统增加了专门用于多平台互联的路由服务器平台，突破了现有视频监控系统的容 量限制。在申请号为200610103523. 4、申请人为杭州华为三康技术有限公司、名称为一种 视频监控数据存储管理方法及系统的发明专利申请中，实现了将视频数据分割成若干数据 块，并将数据块直接发送到存储设备中并存储，该方法能实现大量视频数据的高效存储，提 交视频数据的可靠性。</p>
    <p>[0004]	随着网络编码器应用的推广，特别是IP摄像头的普及，上述系统的监控、存储方 案的规模也越来越大，对系统性能的要求越来越高。而在上述方案中，需要录像以及存储 的音视频流都要通过录像服务器这一设备，才可以最终到达存储录像数据的磁盘阵列，故 录像服务器不但增加了额外的硬件成本，而且成为了整个网络监控系统中的一个性能瓶颈 点，一旦一台录像服务器损坏就会引起录像数据丢失，系统崩溃，进而影响到录像业务。</p>
    <p>[0005]	而对于网络视频存储器进行监控的方式，通常是将单一网络视频存储器连接到IP 网络进行监控以及存储，由于网络视频存储器存储容量的限制，产生了存储瓶颈的问题，这</p>
    <p>4种监控模式很难应用于大型的监控平台系统。 发明内容</p>
    <p>[0006]	本发明针对现有技术中网络视频监控系统存在的缺陷或不足，提供一种网络视频 存储器集群化视频监控系统，将网络视频存储器进行集群化管理，同时解决了性能瓶颈和 存储瓶颈的问题，并提高了系统整体性能，本发明还涉及一种网络视频存储器集群化视频 监控方法。</p>
    <p>[0007]	本发明的技术方案如下： </p>
    <p>[0008]	一种网络视频存储器集群化视频监控系统，包括网络编码器和与其连接的IP网 络，其特征在于，还包括多个网络视频存储器（即NVR)和一个NVR管理器，所述NVR管理器 和各网络视频存储器均与所述IP网络相连，所述网络视频存储器还与客户端相连或通过 所述IP网络与客户端相连，所述各网络视频存储器支持所述网络编码器直接在其上存取 音视频数据的网络存储协议，以将网络编码器编码输出的音视频数据直接保存在NVR上； 所述NVR管理器为一逻辑管理模块，所述NVR管理器包括映射模块和监控模块，所述映射模 块存储管理网络编码器与各网络视频存储器的映射关系，所述监控模块用于对各网络视频 存储器接收的网络编码器编码后的音视频数据的监控管理；所述各网络视频存储器在NVR 管理器的控制下通过IP网络接收网络编码器编码后的音视频数据，并进行录像，以及响应 客户端或网络编码器的访问请求、查询或回放或存储录像数据。</p>
    <p>[0009]	所述网络存储协议包括标准存储协议和专用流存储协议。</p>
    <p>[0010]	所述网络视频存储器从底层向上层依次包括内核层、核心层和接口层，所述内核 层包括专用文件模块和协议存储模块，所述专用文件模块用于实现音视频数据流到磁盘上 的最终分布控制和读写处理，所述专用文件模块具有专用的访问接口，所述协议存储模块 用于存储网络存储协议；所述核心层包括视频流统一接口模块、视频流统一回放模块、录像 存储模块、录像查询模块和设置模块，视频流统一接口模块用于将外部接入的音视频数据 转化为统一的接口标准，视频流统一回放模块用于处理接口层传入的客户端的查询、回放、 分发请求，录像存储模块用于将从视频流统一接口模块获取的音视频数据进行存储，录像 查询模块用于根据设定的条件在录像存储模块中查询录像记录和报警记录，设置模块用于 将网络视频存储器中的各模块进行参数设置、权限设置和报警配置设置；所述接口层用于 提供对外接口，包括编码器接口层和客户端接口层。</p>
    <p>[0011]	所述NVR管理器还包括负载均衡模块和自动识别模块，所述负载均衡模块用于为 网络编码器动态分配网络视频存储器，实现网络视频存储器的负载均衡，并由映射模块保 存新的映射关系；所述自动识别模块用于在某一网络视频存储器出现异常时进行自动识 另IJ，并替换为另一网络视频存储器来响应访问请求，并由映射模块保存新的映射关系；所述 监控模块为各网络视频存储器提供对外单一的统一访问接口。</p>
    <p>[0012]	所述NVR管理器部署在一个或分别集成在多个网络视频存储器中，或部署在单独 的设备上；多个网络视频存储器均部署有所述NVR管理器时，所述NVR管理器设置有同步机 制。</p>
    <p>[0013]	所述访问请求包括录像回放、录像下载、手动录像、定时录像、自动报警录像、录像 查询、录像管理。[0014]	一种网络视频存储器集群化视频监控方法，其特征在于，将网络编码器和多个网络视频存储器（NVR)连接到IP网络，并通过连接在所述IP网络上的NVR管理器建立网络 编码器与各网络视频存储器之间的映射关系，来实现网络编码器与各网络视频存储器的映 射和监控管理；所述各网络视频存储器支持所述网络编码器直接在其上存取音视频数据的 网络存储协议，以将网络编码器编码输出的音视频数据直接保存在NVR上，再进行录像，以 及响应客户端或网络编码器的访问请求、查询或回放或存储录像数据。</p>
    <p>[0015]	在网络视频存储器的底层设置专用的访问接口和进行网络存储协议的存储；在中 间层将外部接入的音视频数据转化为统一的接口标准，并将接入的音视频数据进行录像、 响应客户端或网络编码器的访问请求、查询或回放或存储录像数据；在上层设置编码器接 口和客户端接口。</p>
    <p>[0016]	还包括为网络编码器动态分配网络视频存储器，实现网络视频存储器的负载均 衡；在某一网络视频存储器出现异常时进行自动识别，并替换为另一网络视频存储器来响 应访问请求；并为各网络视频存储器提供对外单一的统一访问接口。</p>
    <p>[0017]	通过网络视频存储器客户端实现对网络编码器和网络视频存储器的设置管理，以 及录像数据的查询或浏览或下载或回放。</p>
    <p>[0018]	本发明的技术效果如下：</p>
    <p>[0019]	本发明提供的网络视频存储器集群化视频监控系统，包括多个网络视频存储器 (NetworkVideo Record, NVR)，通过设置NVR管理器，并在该NVR管理器的映射模块中存 储网络编码器与各网络视频存储器的映射关系，以实现网络编码器与各网络视频存储器的 映射，并通过监控模块来监控管理各网络视频存储器接收的网络编码器编码后的音视频数 据，各NVR在NVR管理器的控制下通过IP网络接收网络编码器编码后的音视频数据，完成 录像、响应客户端或网络编码器的访问请求、查询或回放或存储录像数据，解决了现有技术 中必须使用录像服务器这一设备产生性能瓶颈，一旦录像服务器损坏就会引起录像数据丢 失，系统崩溃的问题，省去了录像服务器这一硬件设备，使得音视频数据管理简化，减少了 故障点，解决了性能瓶颈问题，还降低了硬件成本，通过对NVR进行集群化管理，使得监控 录像应用不会因为NVR集群中的某一设备的损坏而发生中断，提高了系统的安全性及整体 性能，同时解决了现有技术中使用单一网络视频存储器连接到IP网络产生的存储瓶颈问 题，该系统可以应用于大型的监控平台系统中，通过对NVR集群，来获取更好的稳定性、可 扩展性以及可管理性。此外，用户还可以根据自身的实际需要，随时增加网络内的网络编码 器和NVR，而且这个扩展过程完全是在线的，且无需中断当前业务。同时，由于NVR支持标准 的网络存储协议，故NVR还可以部署在传统的使用录像服务器的监控存储方案中作为RAID 磁盘阵列，在传统监控平台系统的扩容和转型过程中，NVR可以同时支持传统的录像服务器 和新的音视频的流式存储方式。</p>
    <p>[0020]	在NVR管理器中设置负载均衡模块和自动识别模块，能够实现多个NVR之间的负 载均衡和故障替换，通过NVR管理器实现对NVR集群的统一管理和调度，完善了本发明的网 络视频存储器集群化视频监控系统的管理功能。</p>
    <p>[0021]	设置各网络视频存储器支持专用流存储协议，能够防止长时间反复写入产生磁盘 碎片和存储性能下降，以及文件系统损坏导致的业务中断、录像数据丢失等问题。</p>
    <p>[0022]	本发明提供的网络视频存储器集群化视频监控方法，通过对NVR集群化管理和调度，解决了现有技术中由于录像服务器的存在造成的存储瓶颈问题，提高了系统的安全性， 并使音视频数据管理简化，同时系统的稳定性、可扩展性等整体性能也得到提高。</p>
    <p>附图说明</p>
    <p>[0023]	图1为传统网络视频监控系统的结构示意图；</p>
    <p>[0024]	图2为本发明优选的网络视频存储器集群化视频监控系统的结构示意图；</p>
    <p>[0025]	图3为优选的网络视频存储器内部结构示意图；</p>
    <p>[0026]	图4为优选的NVR管理器内部结构示意图；</p>
    <p>[0027]	图5为本发明网络视频存储器集群化视频监控系统实施例一的工作流程图；</p>
    <p>[0028]	图6为本发明网络视频存储器集群化视频监控系统实施例二的工作流程图；</p>
    <p>[0029]	图7为本发明网络视频存储器集群化视频监控系统实施例三的工作流程图；</p>
    <p>[0030]	图8为本发明网络视频存储器集群化视频监控系统实施例四的工作流程图；</p>
    <p>[0031]	图9为本发明优选的网络视频存储器集群化视频监控方法流程图。</p>
    <p>[0032]	图中各标号列示如下：</p>
    <p>[0033]	1-网络编码器；2-录像服务器；3-内核层；4-核心层；5-接口层；51-编码器接口 层；52-客户端接口层；6-NVR管理器。</p>
    <p>具体实施方式</p>
    <p>[0034]	下面结合附图对本发明进行说明。</p>
    <p>[0035]	图2为本发明优选的网络视频存储器集群化视频监控系统的结构示意图，包括网 络编码器1、IP网络、多个网络视频存储器（以下简称NVR)和一个NVR管理器，其中，网络 编码器1可以是IP摄像头、DVS和DVR，DVS和DVR的前端均连接有模拟摄像头，可根据需 要将一到多个网络编码器接入IP网络，NVR管理器、多个NVR、NVR客户端、其它客户端和平 台服务器分别接入IP网络。网络编码器1将获取的音视频信息编码后传送到IP网络，NVR 管理器为一逻辑管理模块，能够实现网络编码器与各NVR的映射，以及对各网络视频存储 器接收的网络编码器编码后的音视频数据进行监控管理，各NVR在NVR管理器的控制下通 过IP网络接收网络编码器编码后的音视频数据，并进行录像、响应客户端和网络编码器的 访问请求、查询或回放或存储录像数据，本发明的NVR支持专用流存储协议和多种标准的 网络存储协议，以将网络编码器编码输出的音视频码流直接保存在NVR上，如支持iSCSI、 FC和NAS等标准网络存储协议，支持专用流存储协议能够防止长时间反复写入产生磁盘碎 片和存储性能下降，以及文件系统损坏导致的业务中断、录像数据丢失等问题。此外，NVR的 每个存储单元均可采用64位寻址，满足存储容量扩展的需求。还可以使用通用的以太网部 件如交换机等来连接IP网络以构建更大的监控平台系统，通过使用这种相对便宜的网络 部件，使得成本更加低廉，实施更加简便，且利用以太网良好的路由功能，可以支持大地域 范围的部署，例如整个城市的安防监控集中存储。</p>
    <p>[0036]	具体地，NVR和NVR管理器的内部结构示意图分别如图3和图4所示。</p>
    <p>[0037]	图3为优选的网络视频存储器（以下简称NVR)内部结构示意图，NVR从底层向上 层依次包括内核层3、核心层4和接口层5。内核层3包括存储虚拟化和RAID模块、专用文 件模块和协议存储模块，存储虚拟化和RAID模块处于NVR的内核层3的底层，用于实现针对监控应用的RAID算法来提供高性能和高可靠性，以及实现底层的存储虚拟化来支撑存 储的动态容量扩展；专用文件模块用于实现音视频数据流到磁盘上的最终分布控制和读写 处理，该专用文件模块支持64位的寻址和动态空间扩展，并且该专用文件模块对外采用专 用的访问接口，避免了通用的文件系统在监控应用中的不足，例如掉电数据丢失和碎片问 题，而且在性能方面，该专用文件模块可以将多路并发录像时引入的随机录像请求顺序化， 最大限度的提高了 NVR的性能；协议存储模块用于存储相关的网络存储协议的支撑模块， 例如iSCSI协议和NAS协议的相关模块，以及专用流存储协议的相关模块。核心层4用于实 现NVR的核心业务，包括视频流统一接口模块、视频流统一回放模块、录像存储模块、录像 查询模块和设置模块，其中，视频流统一接口模块负责提供一个标准的NVR内部音视频数 据接入的接口，不论IP网络前端的网络编码器的品牌，在NVR内部最终都是要按照统一的 接口标准接入到这个模块来；视频流统一回放模块用于处理接口层传入的客户端的查询、 回放、分发等请求，例如在分发请求下，视频流统一回放模块可以直接从视频流统一接口模 块获取音视频数据；录像存储模块用于将从视频流统一接口模块获取的音视频数据进行存 储；录像查 询模块用于根据设定的条件在录像存储模块中查询录像记录和报警记录，例如 查询请求下发给录像查询模块，再根据其返回值，通过录像存储模块获得录像数据；设置模 块用于将NVR内部的各模块各种应用相关的管理功能，例如，参数设置、用户权限管理和报 警配置管理等。接口层5用于提供NVR所有的对外接口，主要包括编码器接口层51和客户 端接口层52，其中编码器接口层51主要负责和各种厂家的网络编码器进行接口，主要包括 编码器接口模块、NAS的协议接口模块和iSCSI的协议接口模块，编码器接口模块负责将各 种不同的各个网络编码器厂家的接口进行统一的封装，再接入到NVR核心层4，NAS的协议 接口模块负责支持NAS存储协议，支持NAS协议的网络编码器可以直接使用标准的NAS协 议（例如，NFS)和NVR对接；iSCSI的协议接口模块负责支持iSCSI存储协议，支持iSCSI 协议的网络编码器可以直接使用标准的iSCSI协议和NVR对接；客户端接口层52包括API 服务器模块、Web服务器模块、NVR存储管理模块、各种视频流回放接口模块和视频流实时 浏览接口模块，API服务器模块负责提供服务来支持NVR所有的对外API接口，Web服务器 模块负责提供Web端服务，NVR存储管理模块负责提供NVR存储管理命令的上层接口，各种 视频流回放接口模块负责将来自上层的视频流下载、回放请求进行标准封装，视频流实时 浏览接口模块负责提供视频流实时浏览请求的封装。客户端接口层52的上端连接客户端 模块，客户端模块包括Web管理、客户端程序和客户端API库等，基于该客户端模块，就可以 支持NVR的独立部署，私有Web管理和客户端程序；同时该监控系统和其它第三方的客户端 可以通过客户端API库来和NVR通讯。</p>
    <p>[0038] 由于NVR同时支持多种标准的网络存储协议，故NVR还可以部署在传统的使用 录像服务器的监控存储方案中作为RAID磁盘阵列（Redundant Array of Inexpensive Disks)，即网络编码器编码后的音视频数据送入IP网络，最终通过录像服务器，由标准的 网络存储协议将音视频数据存储到NVR，此时NVR作为普通的RAID磁盘阵列。NVR同时兼 容标准的网络存储协议的另一个优点在于，在传统监控平台的扩容和转型过程中，NVR可以 同时支持传统的录像服务器和新的音视频的流式存储方式。此外，NVR内部还可以支持编 解码模块，这样在小规模部署时，可以支持模拟音视频设备的直接输入，NVR内部进行编码 和录像。在客户需要回放时，直接进行查询，解码输出。此外，该功能在客户原有的监控方案改造和升级过程中，提供了良好的兼容性，保护了客户在模拟视频设备上的前期投入。</p>
    <p>[0039]	图4为优选的NVR管理器内部结构示意图，包括映射模块、监控模块、自动识别模块、负载均衡模块和接入模块。其中，映射模块存储管理网络编码器与各NVR的映射关系， 监控模块用于对各NVR接收的网络编码器编码后的音视频数据的监控管理，NVR管理器通 过映射模块实现网络编码器与各NVR的映射，并通过监控模块进行各NVR内部录像的监控； 负载均衡模块用于为网络编码器动态分配NVR，实现NVR的负载均衡；自动识别模块用于在 某一 NVR出现异常时进行自动识别，并替换为其它NVR来响应访问请求。NVR管理器作为监 控系统中引入的新的逻辑设备，可以将多个NVR集群化，统一管理，并且为各NVR对外提供 单一的NVR的统一访问接口。对其它设备而言，NVR的集群就是一个大的虚拟NVR。通过映 射模块和监控模块使得NVR管理器能够实现对网络编码器到集群中的每一个NVR设备的映 射和管理，但是在NVR能够正常工作的前提下，音视频数据流的存取是不需要通过NVR管理 器的，而是直接访问每个NVR。通过负载均衡模块和自动识别模块使得NVR集群具备了负载 均衡和故障替换等特性，而且这些特性都是对外界透明的，用户能正常访问NVR。监控录像 应用不会因为NVR集群中的单一设备的损坏而发生中断。该NVR管理器可以部署在单独的 设备上，也可以运行在集群中某个或者多个NVR上，当多个NVR均部署有该NVR管理器时， 在NVR管理器中设置有同步机制。</p>
    <p>[0040]	如图2所示，NVR管理器将多个NVR虚拟成一个统一接口的大NVR集群系统，其它 设备所有对NVR集群的配置和管理命令都统一发给NVR管理器处理，而音视频的录像和回 放功能所引入的大量数据流则直接发生在每个NVR、网络编码器1，以及NVR客户端和其它 客户端之间。NVR管理器对网络编码器1和各NVR发出控制信息，这些控制信息包括这两 类设备在和NVR管理器建立连接时所必须的信息，分别对这两类设备的管理与控制、建立 这两类设备直接联动的信息。在对网络编码器1的控制的信息中，包括根据音视频码流大 小为连接的网络编码器1分配合适的NVR，建立网络编码器1与NVR的映射关系；对NVR的 控制的信息中，包括监测NVR的数据访问量，实现负载均衡，NVR失效后，自动识别替换，被 其它NVR接管。设置完成后，网络编码器1会根据启动录像的策略传输音视频码流到NVR， 启动录像的策略包括手动录像、策略录像、报警录像等。其中，策略录像指周期性按时启动 录像，可以包括周期性按时启动录像或者是一次性按时启动录像；报警录像是当网络编码 器产生报警时启动的录像，由于NVR要兼容多种前端编码设备，故报警类型的定义要涵盖 多种不同编码器的报警类型。音视频数据通过IP网络使用专用流存储协议保存在NVR上。 用户可以通过网络上的NVR客户端对网络编码器1和NVR进行设置管理，如录像的查询、浏 览、下载和回放。NVR客户端请求回放时，NVR响应请求，通过图3所示的NVR内部的各种视 频流回放接口模块、视频流统一回放模块和专用文件模块，将存储的音视频数据通过IP网 络传输到NVR客户端。同时该监控系统支持其它客户端的请求，例如，解码到监视器，或者 矩阵输出到电视墙等。如果网络中配置了平台服务器，平台服务器请求回放时，NVR响应请 求，通过与上述相同的过程，将存储的音视频数据通过IP网络传输到平台服务器。</p>
    <p>[0041]	在本发明的网络视频存储器集群化视频监控系统中，网络编码器和/或NVR均具 备主动发起音视频数据传输的能力，网络编码器和NVR直接在没有NVR管理器参与的情况 下也可以直接传输音视频数据。通过用户事先的设定，这两种设备能够在某些事件触发的 情况下通过IP网络向设定的IP地址发送连接请求并监听目标设备的回应信息，当目标设备的回应信息允许连接请求时，与目标设备的连接随即建立。与此相对应，发送设备还具备 要求停止传输的能力。</p>
    <p>[0042]	此外，可以将N个NVR中的N-1个作为可用存储器使用，另外一个作为备用存储， 用户把每个存储都当作一个独立的设备在使用，即NVR管理器为某网络编码器分配这N-1 个NVR中的某一个，系统正常时，音视频数据通过IP网络存储到该NVR中，当用户需要查 询或回放录像时，该NVR响应请求。当某NVR 110发生故障或链接的网络断开时，NVR管理 器将自动切换，将音视频数据记录到备用存储上，当故障排除或网络连通后，备用设备上的 数据会自动写回该NVR设备中，保证发生异常时，音视频数据不会丢失，满足监控系统的需 求。这些操作对用户均是透明的，简化用户使用。</p>
    <p>[0043]	图5为本发明网络视频存储器集群化视频监控系统实施例一的工作流程图。首先 将网络编码器接入IP网络，然后NVR管理器会分配指定的NVR给网络编码器，然后NVR管理 器自动识别NVR有无故障，即判断NVR是否可用，如果可用，NVR开始接收并保存视频数据， 如果发现NVR已经有异常，则另外指定其它可用的NVR，当网络编码器检测到停止传输的条 件满足时，停止发送音视频数据，否则一直接收并记录音视频数据。</p>
    <p>[0044]	图6为本发明网络视频存储器集群化视频监控系统实施例二的工作流程图，该实 施例是在网络编码器接入IP网络后，由NVR管理器查询NVR状态，并调用内部的映射模块 存储的网络编码器和各NVR之间的映射关系，根据该映射关系来分配NVR，从而建立映射关 系索引。</p>
    <p>[0045]	图7为本发明网络视频存储器集群化视频监控系统实施例三的工作流程图，该实 施例是在网络编码器接入IP网络后，NVR管理器分配指定的NVR给网络编码器，然后判断需 要接收的音视频数据的数据流的大小，若相对于该指定的NVR来说该数据流过大，则由NVR 管理器重新指定其它NVR来接收，若该NVR能够接收此数据流，则由该NVR接收并保存此音 视频数据。该实施例体现了本发明监控系统的负载均衡的特性。</p>
    <p>[0046]	图8为本发明网络视频存储器集群化视频监控系统实施例四的工作流程图，该实 施例是在将音视频数据存储到NVR中以后，由NVR管理器周期性判断NVR是否可用，该周期 可以设置为30秒或1分钟或其它时间，若该NVR没有故障，还可以使用，则可以继续存储音 视频数据，否则，若该NVR发生故障不可使用，则由NVR管理器将其替换为其它NVR来接收 并保存音视频数据。该实施例体现了本发明监控系统的故障替换的特性。</p>
    <p>[0047]	本发明还涉及一种网络视频存储器集群化视频监控方法，其优选的方法流程图如 图9所示，首先将网络编码器和多个NVR连接到IP网络，并通过连接在所述IP网络上的NVR 管理器建立网络编码器与各NVR之间的映射关系，来实现网络编码器与各NVR的映射和和 监控管理，再为网络编码器分配指定的NVR，然后自动识别NVR有无故障，即判断NVR是否可 用，如果发现NVR已经有异常，则另外指定其它可用的NVR，如果可用，则判断需要接收的音 视频数据的数据流的大小，若相对于该指定的NVR来说该数据流过大，则重新指定其它NVR 来接收，即回到分配指定的NVR这一步骤，若该NVR能够接收此数据流，则由该NVR接收并 保存此音视频数据，当网络编码器检测到停止传输的条件满足时，停止发送音视频数据，否 则一直接收并记录音视频数据。该实施例所示的监控方法中，各NVR通过IP网络接收网络 编码器编码后的音视频数据，再进行录像、响应客户端或网络编码器的访问请求、查询或回 放或存储录像数据，完成监控的功能。通过对NVR的分配进行映射，并判断数据流的访问量对于指定的NVR是否过大这些步骤，完成为网络编码器动态分配NVR，使得该监控方法具有 负载均衡的功能，以及在某一 NVR出现异常时进行自动识别，并替换为另一 NVR来响应访 问请求，使得该监控方法具有故障替换的功能，NVR管理器为各NVR提供对外单一的统一访 问接口，通过NVR管理器对NVR的统一管理和调度，解决了现有技术中由于录像服务器的存 在造成的存储瓶颈问题，提高了系统的安全性，并使音视频数据管理简化，同时系统的稳定 性、可扩展性等整体性能也得到提高。通过网络视频存储器客户端实现对网络编码器和网 络视频存储器的设置管理，以及录像数据的查询、浏览、下载和回放，用户能够根据实际需 要来组建基于NVR的网络监控平台系统。</p>
    <p>[0048]	各NVR支持专用流存储协议以及支持如iSCSI、FC和NAS等标准的网络存储协议， 以将网络编码器编码输出的视频码流直接保存在NVR上，支持流存储协议能够防止长时间 反复写入产生磁盘碎片和存储性能下降，以及文件系统损坏导致的业务中断、录像数据丢 失等问题。NVR将外部接入的音视频数据转化为统一的接口标准，并设置网络编码器接口 和客户端接口以方便与网络编码器和NVR客户端相连，此外，NVR的每个存储单元均可采用 64位寻址，满足存储容量扩展的需求，该方法通过手动录像或定时录像或报警录像的策略 来启动传输的音视频数据。</p>
    <p>[0049]	应当指出，以上所述具体实施方式可以使本领域的技术人员更全面地理解本发明 创造，但不以任何方式限制本发明创造。因此，尽管本说明书参照附图和实施例对本发明创 造已进行了详细的说明，但是，本领域技术人员应当理解，仍然可以对本发明创造进行修改 或者等同替换，总之，一切不脱离本发明创造的精神和范围的技术方案及其改进，其均应涵 盖在本发明创造专利的保护范围当中。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102348107A?cl=zh">CN102348107A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年10月27日</td><td class="patent-data-table-td patent-date-value">2012年2月8日</td><td class="patent-data-table-td ">北京汉邦高科数字技术股份有限公司</td><td class="patent-data-table-td ">一种实现网络监控视频即插即用的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102413319A?cl=zh">CN102413319A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年12月14日</td><td class="patent-data-table-td patent-date-value">2012年4月11日</td><td class="patent-data-table-td ">杭州华三通信技术有限公司</td><td class="patent-data-table-td ">一种移动侦测实现方法及设备</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102413319B?cl=zh">CN102413319B</a></td><td class="patent-data-table-td patent-date-value">2011年12月14日</td><td class="patent-data-table-td patent-date-value">2014年3月19日</td><td class="patent-data-table-td ">杭州华三通信技术有限公司</td><td class="patent-data-table-td ">一种移动侦测实现方法及设备</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102723094A?cl=zh">CN102723094A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年6月15日</td><td class="patent-data-table-td patent-date-value">2012年10月10日</td><td class="patent-data-table-td ">杭州海康威视数字技术股份有限公司</td><td class="patent-data-table-td ">高可靠易扩展的录像存储、检索方法及其系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102723094B?cl=zh">CN102723094B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年6月15日</td><td class="patent-data-table-td patent-date-value">2015年11月25日</td><td class="patent-data-table-td ">杭州海康威视数字技术股份有限公司</td><td class="patent-data-table-td ">高可靠易扩展的录像存储、检索方法及其系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102811174A?cl=zh">CN102811174A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年7月30日</td><td class="patent-data-table-td patent-date-value">2012年12月5日</td><td class="patent-data-table-td ">浙江宇视科技有限公司</td><td class="patent-data-table-td ">一种监控业务处理方法和nvr</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102811174B?cl=zh">CN102811174B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年7月30日</td><td class="patent-data-table-td patent-date-value">2015年7月15日</td><td class="patent-data-table-td ">浙江宇视科技有限公司</td><td class="patent-data-table-td ">一种监控业务处理方法和nvr</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102882989A?cl=zh">CN102882989A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年9月5日</td><td class="patent-data-table-td patent-date-value">2013年1月16日</td><td class="patent-data-table-td ">浙江宇视科技有限公司</td><td class="patent-data-table-td ">一种多nvr监控网络分配ip地址的方法和装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102904761A?cl=zh">CN102904761A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年10月24日</td><td class="patent-data-table-td patent-date-value">2013年1月30日</td><td class="patent-data-table-td ">浙江宇视科技有限公司</td><td class="patent-data-table-td ">一种nvr堆叠的方法和nvr</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103037193A?cl=zh">CN103037193A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年12月5日</td><td class="patent-data-table-td patent-date-value">2013年4月10日</td><td class="patent-data-table-td ">江苏清投视讯科技有限公司</td><td class="patent-data-table-td ">一种基于arm架构的分布式网络视频处理方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103079087A?cl=zh">CN103079087A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年12月27日</td><td class="patent-data-table-td patent-date-value">2013年5月1日</td><td class="patent-data-table-td ">广东威创视讯科技股份有限公司</td><td class="patent-data-table-td ">视频存储系统及其负载均衡的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103188518A?cl=zh">CN103188518A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年12月29日</td><td class="patent-data-table-td patent-date-value">2013年7月3日</td><td class="patent-data-table-td ">中国航天科工集团第二研究院七�六所</td><td class="patent-data-table-td ">无线网络视频存储系统及其无线网络视频监控方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103533314A?cl=zh">CN103533314A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年11月4日</td><td class="patent-data-table-td patent-date-value">2014年1月22日</td><td class="patent-data-table-td ">富盛科技股份有限公司</td><td class="patent-data-table-td ">一种实现差异化安防设备标准化接口和统一架构接入方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2013185434A1?cl=zh">WO2013185434A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年11月16日</td><td class="patent-data-table-td patent-date-value">2013年12月19日</td><td class="patent-data-table-td ">Hangzhou Hikvision Digital Technology Co,. Ltd.</td><td class="patent-data-table-td ">高可靠易扩展的录像存储、检索方法及其系统</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=UoOABwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0012260000">H04L12/26</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=UoOABwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04N0007180000">H04N7/18</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2010年11月3日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2010年12月15日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年1月25日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Granted</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年9月5日</td><td class="patent-data-table-td ">C41</td><td class="patent-data-table-td ">Transfer of the right of patent application or the patent right</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年9月5日</td><td class="patent-data-table-td ">COR</td><td class="patent-data-table-td ">Bibliographic change or correction in the description</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">CORRECT: ADDRESS; FROM: 100085 HAIDIAN, BEIJING TO: 310051 HANGZHOU, ZHEJIANG PROVINCE</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年9月5日</td><td class="patent-data-table-td ">ASS</td><td class="patent-data-table-td ">Succession or assignment of patent right</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Owner name: </span><span class="nested-value">BANGNUO MEMORY SCIENCE AND TECHNOLOGY CO., LTD., B</span></div><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20120806</span></div><div class="nested-key-value"><span class="nested-key">Owner name: </span><span class="nested-value">HANGZHOU HIKVISION DIGITAL TECHNOLOGY CO., LTD.</span></div><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">FORMER OWNER: BANGNUO MEMORY SCIENCE AND TECHNOLOGY CO., LTD., BEIJING</span></div><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20120806</span></div></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/95e713265febfc622efd/CN101877783A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_5115ea495017d9115e613207d3810e5a.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E7%BD%91%E7%BB%9C%E8%A7%86%E9%A2%91%E5%AD%98%E5%82%A8%E5%99%A8%E9%9B%86%E7%BE%A4%E5%8C%96%E8%A7%86%E9%A2%91%E7%9B%91.pdf?id=UoOABwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U1wGfEOirJFU1NioD3q75TwF1IIFA"},"sample_url":"https://www.google.com/patents/reader?id=UoOABwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>