<!DOCTYPE html><html><head><title>专利 CN103501228A - 一种动态二维码令牌及动态二维码口令认证方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种动态二维码令牌及动态二维码口令认证方法"><meta name="DC.contributor" content="宋博韬" scheme="inventor"><meta name="DC.contributor" content="石秀英" scheme="inventor"><meta name="DC.contributor" content="张贵良" scheme="inventor"><meta name="DC.contributor" content="沈阳华矿新能源装备科技有限公司" scheme="assignee"><meta name="DC.date" content="2013-8-1" scheme="dateSubmitted"><meta name="DC.description" content="一种动态二维码口令认证方法，其中动态二维码令牌，包括采集模块、显示模块、认证模块、口令模块、管理模块、二维码模块、控制模块；所述控制模块、管理模块、认证模块、口令模块和二维码模块集成于同一微处理器中；所述采集模块与所述控制模块和二维码模块相连；所述显示模块与所述控制模块和二维码模块相连。动态二维码口令认证系统，是用于执行动态二维码口令认证、令牌同步以及令牌相关状态的管理及配置功能的服务程序的集合。本发明具有抗暴露、高强度、不可预测、抗重放、抗抵赖、免记忆、精确、高效、物理隔离和双向认证特性的动态二维码口令，显著提高身份认证的安全性。"><meta name="DC.date" content="2014-1-8"><meta name="DC.relation" content="CN:103186745:A" scheme="references"><meta name="DC.relation" content="CN:103218740:A" scheme="references"><meta name="DC.relation" content="US:20120096277:A1" scheme="references"><meta name="citation_reference" content="李涛等: &quot;一种新的基于动态口令的远程双向认证&quot;, 《中文核心期刊（微计算机信息）》, vol. 23, no. 113, 31 December 2007 (2007-12-31), pages 38 - 40"><meta name="citation_patent_publication_number" content="CN:103501228:A"><meta name="citation_patent_application_number" content="CN:201310329735"><link rel="canonical" href="https://www.google.com/patents/CN103501228A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN103501228A?cl=zh"/><meta name="title" content="专利 CN103501228A - 一种动态二维码令牌及动态二维码口令认证方法"/><meta name="description" content="一种动态二维码口令认证方法，其中动态二维码令牌，包括采集模块、显示模块、认证模块、口令模块、管理模块、二维码模块、控制模块；所述控制模块、管理模块、认证模块、口令模块和二维码模块集成于同一微处理器中；所述采集模块与所述控制模块和二维码模块相连；所述显示模块与所述控制模块和二维码模块相连。动态二维码口令认证系统，是用于执行动态二维码口令认证、令牌同步以及令牌相关状态的管理及配置功能的服务程序的集合。本发明具有抗暴露、高强度、不可预测、抗重放、抗抵赖、免记忆、精确、高效、物理隔离和双向认证特性的动态二维码口令，显著提高身份认证的安全性。"/><meta property="og:title" content="专利 CN103501228A - 一种动态二维码令牌及动态二维码口令认证方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN103501228A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN103501228A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=q1brCAABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN103501228A&amp;usg=AFQjCNFGzGVGrPoJ7-JHmQR86_g8eZmUig" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/5af1654b79f61a41c8a8/CN103501228A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/5af1654b79f61a41c8a8/CN103501228A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN103501228A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN103501228A?cl=en&amp;hl=zh-CN"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN103501228A?cl=zh" style="display:none"><span itemprop="description">一种动态二维码口令认证方法，其中动态二维码令牌，包括采集模块、显示模块、认证模块、口令模块、管理模块、二维码模块、控制模块；所述控制模块、管理模块、认证模块、口令模块和二维码模块集成于同一微处理器中；...</span><span itemprop="url">https://www.google.com/patents/CN103501228A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN103501228A - 一种动态二维码令牌及动态二维码口令认证方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN103501228A - 一种动态二维码令牌及动态二维码口令认证方法" title="专利 CN103501228A - 一种动态二维码令牌及动态二维码口令认证方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN103501228 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201310329735</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2014年1月8日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2013年8月1日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2013年8月1日</td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201310329735.4, </span><span class="patent-bibdata-value">CN 103501228 A, </span><span class="patent-bibdata-value">CN 103501228A, </span><span class="patent-bibdata-value">CN 201310329735, </span><span class="patent-bibdata-value">CN-A-103501228, </span><span class="patent-bibdata-value">CN103501228 A, </span><span class="patent-bibdata-value">CN103501228A, </span><span class="patent-bibdata-value">CN201310329735, </span><span class="patent-bibdata-value">CN201310329735.4</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%AE%8B%E5%8D%9A%E9%9F%AC%22">宋博韬</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%9F%B3%E7%A7%80%E8%8B%B1%22">石秀英</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%BC%A0%E8%B4%B5%E8%89%AF%22">张贵良</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E6%B2%88%E9%98%B3%E5%8D%8E%E7%9F%BF%E6%96%B0%E8%83%BD%E6%BA%90%E8%A3%85%E5%A4%87%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">沈阳华矿新能源装备科技有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103501228A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103501228A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103501228A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (3),</span> <span class="patent-bibdata-value"><a href="#npl-citations">非专利引用</a> (1),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (1),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (2)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=q1brCAABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201310329735&amp;usg=AFQjCNHP5lMi2ytfQN_yo73wLzktmHwZ8A"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=q1brCAABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D103501228A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNHINBr9D42v1oqURBpqVogdRjTF1w"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT132452502" lang="ZH" load-source="patent-office">一种动态二维码令牌及动态二维码口令认证方法</invention-title>
      </span><br><span class="patent-number">CN 103501228 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA128784307" lang="ZH" load-source="patent-office">
    <div class="abstract">一种动态二维码口令认证方法，其中动态二维码令牌，包括采集模块、显示模块、认证模块、口令模块、管理模块、二维码模块、控制模块；所述控制模块、管理模块、认证模块、口令模块和二维码模块集成于同一微处理器中；所述采集模块与所述控制模块和二维码模块相连；所述显示模块与所述控制模块和二维码模块相连。动态二维码口令认证系统，是用于执行动态二维码口令认证、令牌同步以及令牌相关状态的管理及配置功能的服务程序的集合。本发明具有抗暴露、高强度、不可预测、抗重放、抗抵赖、免记忆、精确、高效、物理隔离和双向认证特性的动态二维码口令，显著提高身份认证的安全性。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(3)</span></span></div><div class="patent-text"><div mxw-id="PCLM58432700" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.动态二维码令牌，其特征在于:  动态二维码令牌，是产生并显示动态二维码口令的用户终端设备，将预定义的外部程序存入智能设备，包括掌上电脑、智能手机、平板电脑、PDA或其他专用设备的程序存储器中，当控制器收到相应指令后，根据预定义的程序可实现对服务器认证、动态二维码口令产生与显示功能；特别地，上述智能设备必须具备二维码采集功能；  动态二维码令牌由采集模块、显示模块、控制模块、管理模块、二维码模块、认证模块、口令模块组成；  采集模块，获取服务器端显示的二维码，实现设备包括但不限于二维码数据采集器、激光扫描器、摄像头；  显示模块，显示产生的动态二维码口令，实现设备包括IXD、LED显示屏；  控制模块、管理模块、二维码模块、认证模块、口令模块集成于同一微处理器中，具体的:  控制模块，对动态二维码令牌各模块调用，对动态二维码令牌进行运行管理；  管理模块，负责验证动态二维码令牌状态、初始化、参数配置；  二维码模块，实现二维码的编码和解码，二维码信息的加密和解密；  认证模块，根据服务器鉴权信息对服务器进行认证；  口令模块，产生动态二维码口令；  动态二维码口令的产生方法是:  <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103501228A/CN103501228AC00021.png"> <img id="icf0001" file="CN103501228AC00021.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103501228A/CN103501228AC00021.png" class="patent-full-image" alt="Figure CN103501228AC00021"> </a> </div>  T是时间因子T0是UTC (Universal Time Coordinated,协调世界时)时间，Tir是口令变化周期，ID是动态因子，C是事件因子，Q是挑战因子，ID至少包含Τ、C、Q其中的一个参数，并按照T I C I Q的顺序进行数据组装，未包含的参数位置，由下一个参数进行补充，如ID由T、Q组成，则数据组装方式为T I Q，如ID由C、Q组成，则数据组装方式为C | Q，K是运算密钥，只有认证双方持有，FO是算法函数，S是算法函数输出结果，TruncateO是截位函数，OD是输出结果，N是动态口令的位数，不小于6，P是动态口令，M是多因素信息，D是二维码编码因子，D至少包含一个P参数，按照P I M的顺序进行数据组装，如D由P、M组成，则数据组装方式为P I M，如D只包含P参数，则D只对P参数进行数据组装，BO是二维码编码函数，BP是动态二维码口令。</div>
    </div>
    </div> <div class="claim"> <div num="2" class="claim">
      <div class="claim-text">2.动态二维码口令认证方法，其特征在于:  动态二维码令牌，是产生并显示动态二维码口令的客户端设备；  动态二维码口令认证平台包括动态二维码口令认证系统、动态二维码口令管理系统，部署在服务器端，应用系统部署在客户端，通过认证协议与服务器端通讯；  动态二维码口令认证系统，是用于执行动态二维码口令认证、令牌同步，以及令牌相关状态的管理及配置功能的服务程序的集合；  动态二维码口令管理系统，负责动态因子的生成、传输和存储的安全管理；  应用系统是指集成了将动态二维码口令按照认证协议发送至动态二维码口令认证系统进行认证的应用集合，为软件系统、硬件设备或者两者相结合；  认证接口是认证系统提供的用于连接应用系统与认证服务器的接口集合，开发语言包括C/C++、Java、php、ASP、ASP.NET、C# ;应用接口通过调用接口，能完成动态二维码口令认证、同步功能；  认证协议是认证服务通过标准的通讯协议和应用系统进行通讯，完成动态二维码口令的认证、同步功能。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.根据权利要求2所述的动态二维`码口令认证方法，其特征在于:具体的认证过程为:  动态二维码口令认证平台，包括动态二维码口令认证系统、动态二维码口令管理系统，部署在服务器端，应用系统部署在客户端，通过认证协议与服务器端通讯；  动态二维码口令认证系统，是用于执行动态二维码口令认证、令牌同步，以及令牌相关状态的管理及配置功能的服务程序的集合；  动态二维码口令管理系统，负责动态因子的生成、传输和存储的安全管理；  应用系统是指集成了将动态二维码口令按照认证协议发送至动态二维码口令认证系统进行认证的应用集合，为软件系统、硬件设备或者两者相结合；  认证接口是认证系统提供的用于连接应用系统与认证服务器的接口集合，开发语言包括C/C++、Java、php、ASP、ASP.NET、C#,应用接口通过调用接口，完成动态二维码口令认证、同步功能；  认证协议是认证服务通过标准的通讯协议和应用系统进行通讯，完成动态二维码口令的认证、同步功能；  具体的认证过程为:  动态二维码令牌使用前，必须经管理员在服务器端激活并录入相关信息，激活成功后，令牌在用户终端和服务器端状态均为可用状态；  用户启动动态二维码令牌，动态二维码令牌自动验证令牌状态，如果令牌状态为未激活，则提示不可用；  令牌激活成功，用户使用令牌扫描服务器端向应用系统提供的二维码，服务器端提供的二维码信息包括服务器端鉴权信息和产生动态二维码口令的控制信息两部分，令牌二维码模块对服务器端提供的二维码信息解码，根据符合国密标准的安全算法，对解码后提取出信息进行解密，解密后，将服务器端鉴权信息和产生动态二维码口令的控制信息分离，令牌认证模块根据得到的服务器端鉴权信息对服务器进行认证，如果服务器端不能通过认证，则停止整个认证过程；  服务器端认证成功，令牌管理模块初始化令牌；令牌口令模块根据由服务器端提供的二维码中分离出来的产生动态二维码口令的控制信息，确定动态二维码口令的生成方式包括时间模式、事件模式、挑战应答模式、令牌算法及动态因子，产生动态口令；  令牌二维码模块将动态口令与客户端标识信息及其他指定特征值分组封装加密，再生成二维码图像，令牌显示模块将二维码图像显示在智能设备的显示屏上；  至此，动态二维码口令生成完成；  服务器端通过二维码扫描设备捕获令牌生成的动态二维码口令，并解析动态二维码口令，解析过程具体为:服务器端对捕获的二维码图像解码，再根据指定的符合国密标准的安全算法，对解码后提取出的信息进行解密，得到封装的动态口令与客户端标识信息及其他指定特征值，将动态口令与客户端标识信息及其他指定特征值分离，根据认证规则进行口令认证；  如果口令认证失败，拒绝对用户授权，整个认证过程失败；通过口令认证，则对用户授权，用户获得相应权限，认证成功；  动态二维码令牌特性要求；   温度:-10O -500C ；   湿度:30°C ±2°C下，相对湿度为93%±3°C ；  防尘防水满足IP44要求；   振动:10-300HZ，振动幅值≥3.5mm ；  静电放电:外壳端口接触放电±6KV，空气放电±8KV ；  动态二维码口令认证平台:  (1)、动态二维码口令认证平台构成  动态二维码口令认证平台是为应用系统提供动态二维码口令认证及管理的服务系统，由两个部分构成:动态二维码口令认证系统、动态二维码口令管理系统；  动态二维码口令认证系统对应用系统提供认证和管理服务；  动态二维码口令管理系统对认证平台的运行进行管理；  (2)、令牌的系统状态  令牌的系统状态为认证系统内保存的令牌工作状态:  1)未激活，本状态为不可用状态，成功激活后进入就绪状态，激活令牌验证动态二维码口令是否正确，未激活令牌不能提供正常的动态二维码口令认证；  2)就绪，令牌为正常工作状态，此状态下令牌可用于动态二维码口令认证；  3)锁定，令牌因连续错误、重放攻击、人工方式原因被锁定后处于锁定状态，锁定状态的令牌不能提供正常的动态二维码口令认证；  4)挂起，令牌被人为挂起后，处于挂起状态，挂起状态的令牌不能提供正常的动态二维码口令认证；  5)作废，令牌执行作废操作后，进入作废状态，作废的令牌不能提供正常的动态二维码口令认证；  (3)、令牌的系统数据  令牌的系统数据包括:令牌序列号、密钥数据、令牌状态、上次使用时间、连续错误次数、令牌偏移量和其它配置参数，其中密钥数据加密存放，其它系统数据采用校验机制保证不被非法修改；  (4)、令牌的同步  认证系统提供对令牌的内部计数器与系统的令牌计数器之间的同步处理，对于时间型令牌，使用双向时间窗口 ；对于事件型令牌，使用单向事件窗口 ；  (5)、自动锁定和自动解锁  令牌在使用过程中若连续多次验证错误超过最大次数后，将被自动锁定，在超过设定的时间后，自动解除锁定；  自动解除锁定只能解除被自动锁定的令牌；  (6)、认证系统服务  认证系统服务由认证系统提供，分为安全服务和管理服务，安全服务包括动态口令认证、挑战应答认证和挑战码生成，管理服务包括对令牌的生命周期管理；  (7)、安全服务  安全服务用于支持应用系统对用户身份和交易内容进行验证；  (8)、动态口令认证  对提交的动态二维码口令进行认证的服务，认证方式包括:静态口令+动态二维码口令、动态二维码口令；静态口令为与该动态二维码令牌绑定的静态口令；  (9)、挑战应答认证  对提交的挑战应答码进行认证的服务，认证方式包括:外部挑战认证、内部挑战认证、内部+外部挑战认证；  (10)、产生挑战码  为根据应用的挑战码请求产生的挑战码，生成的挑战码格式包括:数字型、字符型、数字+字符型，其中数字为阿拉伯数字0-9，字符为英文字符或符号字符，区分大小写，挑战码的最小长度和最大长度由认证系统进行设置，挑战码以加密封装后的二维码形式出现；   (11)、管理服务  管理服务用于对令牌进行生命周期管理；   (12)、激活  将未激活的令牌设为可用状态，激活时，要求验证令牌的动态二维码口令；  令牌成功激活后，状态设置为就绪；`  激活不成功，记录激活错误次数，但不锁定令牌；  (13)、锁定/解锁  锁定:将就绪状态的令牌设置为锁定状态；  令牌被锁定后，可通过解锁服务回到就绪状态；  令牌被锁定后，可通过废止服务设置为废止状态；  解锁:将锁定状态的令牌解锁，设置为就绪状态；  解锁时，要求当前的动态二维码口令；若设置了静态口令，要求验证静态口令；  若静态口令的验证方式是内部挑战方式，使用内部挑战认证；  若静态口令的验证方式是普通方式，使用静态口令+动态二维码口令认证；  (14)、挂起/解挂  挂起:将动态令牌设置为挂起状态；  只有就绪或锁定状态的令牌可被设置为挂起状态；  令牌被挂起后，可通过废止服务设置为废止状态；  解挂:解除令牌的挂起状态；  解挂成功后令牌的状态设置为就绪状态；  要求验证当前的动态口令；  若设置了静态口令，要求验证静态口令；   若静态口令的验证方式是内部挑战方式，使用内部挑战认证；  若静态口令的验证方式是普通方式，使用静态口令+动态二维码口令认证；  (15)、设置静态口令  设置动态令牌绑定的静态口令；  要求验证原有的静态口令；  若静态口令的验证方式是内部挑战方式，使用内部挑战认证；  若静态口令的验证方式是普通方式，使用静态口令+动态二维码口令认证；   (16)、远程解PIN  认证系统提供远程解PIN的功能，根据应用请求，认证系统生成当前的远程解PIN密码；  解PIN的密码为0-9的数字串，长度最少为6位；  解PIN的操作最大尝试次数不可超过5次，若超过最大尝试次数，应至少等待I小时才可继续尝试；  超过最大尝试次数的情况不可超过5次，否则令牌应永久锁定，不可再使用；   (17)、同步  认证系统提供令牌的同步服务；  验证令牌的连续2个动态二维码口令，若成功，调整令牌的系统偏移量；  令牌的同步服务不改变令牌状态；  (18)、密钥变形  令牌在正常使用前，通过用户与服务商协商，形成特定的密钥变形机制，将原始种子密钥改变为令牌实际使用时的工作种子密钥，该密钥变形机制所需的变形原理或参数，由用户保存服务商不知晓；   (19)、废止  令牌损坏或失效后，可使用认证系统的废止服务将其废止，废止的令牌不可再用于用户的身份认证和交易验证，系统仅保留该令牌的使用历史记录；  (20)、令牌信息查询  认证系统提供令牌的信息查询服务，包括:令牌的当前状态、上次使用时间、当前累计错误次数；信息查询服务不改变令牌状态；  (21)、认证平台管理功能  .1)权限管理  认证系统对访问人员采取权限控制，不同角色的访问人员赋予不同的操作权限；  .2)参数配置  认证系统对认证和管理功能参数进行配置；  .3)日志管理  日志管理包括日志的写入、查询功能，每条日志至少记录事件的日期和时间、事件类型、主体身份、事件的结果、日志级别，以下事件应该记录日志:  动态二维码口令认证，同步的结果；  令牌系统状态的变更；  .4)服务报表  系统提供对令牌和系统不同时间段对应的状态和结果的统计报表；  .5)种子导入  认证系统提供导入种子密钥的功能，并设置令牌的初始状态；  .6)备份恢复  认证系统提供对敏感信息的备份功能；   (22)、安全要求 . 1)接入端控制  认证服务器具有控制应用服务器安全接入的方法和措施；  .2)通讯敏感字段加密  为了防止网络监听的形式对认证数据进行窃听和分析，在认证服务器和应用服务器之间的通讯数据上做加密处理；  .3)信息存储加密  认证系统中的种子密钥是加密存储的，当认证服务器接收到认证请求时，认证服务器会首先读取种子密钥加密密钥密文，调用加密机或加密卡的接口使用主密钥解密种子密钥加密密钥密文，然后读取种子密钥密文，再使用种子密钥加密密钥解密种子密钥，通过种子密钥和时间因子信息生成对应的动态密码，并与接收到的动态二维码口令信息进行比较，从而完成动态二维码口令身份验证；  (23)、令牌安全性控制  .1)锁定及解锁  按照用户要求提供锁定机制，当一个令牌连续尝试认证失败次数累计达到上限，则对令牌进行锁定，同时提供人工解锁和自动解锁机制；  .2)防重复认证  重复认证检测，对于已经通过认证的动态密码，认证服务器将予以作废，只要已经通过认证的动态密码，均不能再次通过认证；  .3)日志安全  日志信息具有校验码，只要用户对日志信息进行修改，就可通过校验码检查出来；  敏感数据具有备份恢复机制；认证系统针对日志访问具备相应的访问控制策略，对日志的操作有对应记录，以保证日志的完整性和安全性；  4)接入端控制  认证服务器具有时间校准的处理方法和措施；  5)认证系统安全  认证系统安全符合目标应用服务或系统的安全需求，具体参照目标应用服务或系统的相应规 范或标准。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES64820329" lang="ZH" load-source="patent-office" class="description">
    <p>&#8212;种动态二维码令牌及动态二维码口令认证方法</p>
    <p>技术领域</p>
    <p>[0001]	本发明属于信息安全领域，涉及二维码技术以及动态令牌技术，具体涉及一种动态二维码令牌及动态二维码口令认证方法。</p>
    <p>背景技术</p>
    <p>[0002]	随着信息时代的到来，人们对信息系统的依赖程度越来越高，信息系统的安全越来越受到人们的重视。</p>
    <p>[0003]	密码在信息系统中的安全要求最高，一旦密码被盗或者遗失，信息系统就可能被非授权访问，导致直接经济损失和间接名誉损失，损失是巨大的，甚至是致命的。</p>
    <p>[0004]	根据美国某安全协会对数千名系统管理员的调查表明，绝大多数信息系统首先被攻击和突破的就是密码。</p>
    <p>[0005]	现有大多数信息系统的密码记忆在人脑、存储在服务器端数据库中，在相对较长的时间内固定不变，每次登录认证时使用相同密码，称为静态密码，也叫静态口令。</p>
    <p>[0006]	在传统的静态口令认证系统中，静态口令的重复使用增加了其丢失、泄露以及被破解的风险，降低了信息系统的安全系数。在网络环境下，黑客、木马和病毒的泛滥让静态口令显得更加脆弱。除此之外，静态口令还存在如下的安全隐患和缺陷:</p>
    <p>  I)用户的密码在录入时可能被偷看或者被图像采集设备记录。</p>
    <p>[0007]	2)用户的密码通常有一定的规律性且长度较短，容易被猜测和监听破解；</p>
    <p>  3)用户的密码在相对较长的时间内固定不变，可能泄漏。</p>
    <p>[0008]	4)用户的密码不包含抗抵赖信息，可能被恶意操作。</p>
    <p>[0009]	5)用户因某种原因，将密码告诉他人，事后忘记修改造成遗失。</p>
    <p>[0010]	6)用户忘记密码。</p>
    <p>[0011]	7)用户的密码手动输入，可能出现录入错误。</p>
    <p>[0012]	8)用户的密码无法被自动识别，录入效率低下。</p>
    <p>[0013]	9)服务器端与客户端信息不对称，容易被钓鱼攻击。</p>
    <p>发明内容</p>
    <p>[0014]	本发明的目的是为了解决现有认证技术存在的缺陷，提供一种动态二维码令牌及动态二维码口令认证方法。</p>
    <p>[0015]	动态二维码口令具有抗暴露、高强度、不可预测、抗重放、抗抵赖、免记忆、精确、高效、物理隔离和双向认证特性，可显著提高身份认证的安全性。</p>
    <p>[0016]	采用的技术方案是:</p>
    <p>  动态二维码令牌，其特征在于:</p>
    <p>  动态二维码令牌，是产生并显示动态二维码口令的用户终端设备。将预定义的外部程序存入智能设备(掌上电脑、智能手机、平板电脑、PDA或其他专用设备)的程序存储器中，当控制器收到相应指令后，根据预定义的程序可实现对服务器认证、动态二维码口令产生与显示功能。特别地，上述智能设备必须具备二维码采集功能。</p>
    <p>[0017]	动态二维码令牌由采集模块、显示模块、控制模块、管理模块、二维码模块、认证模块、口令模块组成，如图3所示，各模块功能如下:</p>
    <p>  采集模块，获取服务器端显示的二维码。实现设备包括但不限于二维码数据采集器、激光扫描器、摄像头。</p>
    <p>[0018]	显示模块，显示产生的动态二维码口令，实现设备包括但不限于IXD、LED显示屏。</p>
    <p>[0019]	采集模块和显示模块中，所涉及的采集设备和显示设备相应的控制电路已经相对成熟，故在此不再阐述。</p>
    <p>[0020]	控制模块、管理模块、二维码模块、认证模块、口令模块集成于同一微处理器中，具体的:</p>
    <p>  控制模块，对动态二维码令牌各模块调用，对动态二维码令牌进行运行管理。</p>
    <p>[0021]	管理模块 ，负责验证动态二维码令牌状态、初始化、参数配置。</p>
    <p>[0022]	二维码模块，实现二维码的编码和解码，二维码信息的加密和解密。</p>
    <p>[0023]	认证模块，根据服务器鉴权信息对服务器进行认证。</p>
    <p>[0024]	口令模块，产生动态二维码口令。</p>
    <p>[0025]	动态二维码口令的产生方法是:</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103501228A/CN103501228AD00101.png"> <img id="idf0001" file="CN103501228AD00101.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103501228A/CN103501228AD00101.png" class="patent-full-image" alt="Figure CN103501228AD00101"> </a> </div>
    <p>  τ是时间因子，Time Coordinated，协调世界时)时间，7；是口令变化周期。ID是动态因子，C是事件因子，Q是挑战因子。ID至少包含T、C、Q其中的一个参数，并按照T I C I Q的顺序进行数据组装。未包含的参数位置，由下一个参数进行补充。如ID由T、Q组成，则数据组装方式为T I Q0如ID由C、Q组成，则数据组装方式为C | Q0K是运算密钥，只有认证双方持有。FO是算法函数。S是算法函数输出结果。TruncateO是截位函数，OD是输出结果。N是动态口令的位数，不小于6。P是动态口令。M是多因素信息。D是二维码编码因子。D至少包含一个P参数，按照P I M的顺序进行数据组装。如D由P、M组成，则数据组装方式为P I M0如D只包含P参数，则D只对P参数进行数据组装。BO是二维码编码函数。BP是动态二维码口令。</p>
    <p>[0026]	动态二维码口令认证平台(包括动态二维码口令认证系统、动态二维码口令管理系统)部署在服务器端。应用系统部署在客户端，通过认证协议与服务器端通讯。</p>
    <p>[0027]	动态二维码口令认证系统，是用于执行动态二维码口令认证、令牌同步，以及令牌相关状态的管理及配置功能的服务程序的集合。</p>
    <p>[0028]	动态二维码口令管理系统，负责动态因子的生成、传输和存储的安全管理。</p>
    <p>[0029]	应用系统是指集成了将动态二维码口令按照认证协议发送至动态二维码口令认证系统进行认证的应用集合，为软件系统、硬件设备或者两者相结合。</p>
    <p>[0030]	认证接口是认证系统提供的用于连接应用系统与认证服务器的接口集合。开发语言不限于c/C++、Java、php、ASP、ASP.NET、C#。应用接口通过调用接口，完成动态二维码口令认证、同步功能。</p>
    <p>[0031]	认证协议是认证服务通过标准的通讯协议和应用系统进行通讯，完成动态二维码口令的认证、同步功能。</p>
    <p>[0032]	动态二维码口令认证流程图如图2所示，结合图2，具体的认证过程为:</p>
    <p>  动态二维码令牌使用前，必须经管理员在服务器端激活并录入相关信息，激活成功后，令牌在用户终端和服务器端状态均为可用状态。</p>
    <p>[0033]	用户启动动态二维码令牌，动态二维码令牌自动验证令牌状态，如果令牌状态为未激活，则提示不可用。</p>
    <p>[0034]	令牌激活成功，用户使用令牌扫描服务器端向应用系统提供的二维码，服务器端提供的二维码信息包括服务器端鉴权信息和产生动态二维码口令的控制信息两部分。令牌二维码模块对服务器端提供的二维码信息解码，根据符合国密标准的安全算法，对解码后提取出信息进行解密。解密后，将服务器端鉴权信息和产生动态二维码口令的控制信息分离。令牌认证模块根据得到的服务器端鉴权信息对服务器进行认证，如果服务器端不能通过认证，则停止整个认证过程。</p>
    <p>[0035]	服务器端认证成功，令牌管理模块初始化令牌。令牌口令模块根据由服务器端提供的二维码中分离出来的产生动态二维码口令的控制信息，确定动态二维码口令的生成方式(如时间模式、事件模式、挑战应答模式)、令牌算法及动态因子，产生动态口令。</p>
    <p>[0036]	令牌二维码模块将动态口令与客户端标识信息及其他指定特征值分组封装加密，再生成二维码图像，令牌显示模块将二维码图像显示在智能设备的显示屏上。</p>
    <p>[0037]	至此，动态二维码口令生成完成。</p>
    <p>[0038]	服务器端通过二维码扫描设备捕获令牌生成的动态二维码口令，并解析动态二维码口令。解析过程具体为:服务器端对捕获的二维码图像解码，再根据指定的符合国密标准的安全算法，对解码后提取出的信息进行解密，得到封装的动态口令与客户端标识信息及其他指定特征值。将动态口令与客户端标识信息及其他指定特征值分离，根据认证规则进行口令认证。</p>
    <p>[0039]	如果口令认证失败，拒绝对用户授权，整个认证过程失败。通过口令认证，则对用户授权，用户获得相应权限，认证成功。</p>
    <p>[0040]	动态二维码令牌特性要求温度:-10°C -50°C ；</p>
    <p>   湿度:30°C ±2°C下，相对湿度为93%±3°C ；</p>
    <p>  防尘防水满足IP44要求。</p>
    <p>[0041]振动:10-300HZ，振动幅值≥	3.5mm ；</p>
    <p>  静电放电:外壳端口接触放电±6KV，空气放电±8KV。</p>
    <p>[0042]	动态二维码口令认证平台:</p>
    <p>  1、动态二维码口令认证平台构成</p>
    <p>  动态二维码口令认证平台是为应用系统提供动态二维码口令认证及管理的服务系统，由两个部分构成:动态二维码口令认证系统、动态二维码口令管理系统。</p>
    <p>[0043]	动态二维码口令认证系统对应用系统提供认证和管理服务。</p>
    <p>[0044]	动态二维码口令管理系统对认证平台的运行进行管理。</p>
    <p>[0045]	2、令牌的系统状  态</p>
    <p>  令牌的系统状态为认证系统内保存的令牌工作状态:</p>
    <p>  I)未激活，本状态 为不可用状态，成功激活后进入就绪状态，激活令牌验证动态二维码口令是否正确，未激活令牌不能提供正常的动态二维码口令认证。</p>
    <p>[0046]	2)就绪，令牌为正常工作状态，此状态下令牌可用于动态二维码口令认证。</p>
    <p>[0047]	3)锁定，令牌因连续错误、重放攻击、人工方式原因被锁定后处于锁定状态，锁定状态的令牌不能提供正常的动态二维码口令认证。</p>
    <p>[0048]	4)挂起，令牌被人为挂起后，处于挂起状态，挂起状态的令牌不能提供正常的动态二维码口令认证。</p>
    <p>[0049]	5)作废，令牌执行作废操作后，进入作废状态，作废的令牌不能提供正常的动态二维码口令认证。</p>
    <p>[0050]	3、令牌的系统数据</p>
    <p>  令牌的系统数据包括:令牌序列号、密钥数据、令牌状态、上次使用时间、连续错误次数、令牌偏移量和其它配置参数，其中密钥数据加密存放，其它系统数据采用校验机制保证不被非法修改。</p>
    <p>[0051]	4、令牌的同步</p>
    <p>  认证系统提供对令牌的内部计数器与系统的令牌计数器之间的同步处理。对于时间型令牌，使用双向时间窗口；对于事件型令牌，使用单向事件窗口。</p>
    <p>[0052]	5、自动锁定和自动解锁</p>
    <p>  令牌在使用过程中若连续多次验证错误超过最大次数后，将被自动锁定。在超过设定的时间后，自动解除锁定。</p>
    <p>[0053]自动解除锁定只能解除被自动锁定的令牌。</p>
    <p>[0054]	6、认证系统服务</p>
    <p>  认证系统服务由认证系统提供，分为安全服务和管理服务。安全服务包括动态口令认证、挑战应答认证和挑战码生成，管理服务包括对令牌的生命周期管理。</p>
    <p>[0055]	7、安全服务</p>
    <p>  安全服务用于支持应用系统对用户身份和交易内容进行验证。</p>
    <p>[0056]	8、动态口令认证  对提交的动态二维码口令进行认证的服务，认证方式包括:静态口令+动态二维码口令、动态二维码口令。静态口令为与该动态二维码令牌绑定的静态口令。</p>
    <p>[0057]	9、挑战应答认证</p>
    <p>  对提交的挑战应答码进行认证的服务，认证方式包括:外部挑战认证、内部挑战认证、内部+外部挑战认证。</p>
    <p>[0058]	10、产生挑战码</p>
    <p>  为根据应用的挑战码请求产生的挑战码，生成的挑战码格式包括:数字型、字符型、数字+字符型。其中数字为阿拉伯数字0-9，字符为英文字符或符号字符，区分大小写。挑战码的最小长度和最大长度由认证系统进行设置。挑战码以加密封装后的二维码形式出现。</p>
    <p>[0059]	11、管理服务</p>
    <p>  管理服务用于对令牌进行生命周期管理。</p>
    <p>[0060]	12、激活</p>
    <p>  将未激活的令牌设为可用状态。激活时，要求验证令牌的动态二维码口令。</p>
    <p>[0061]	令牌成功激活后，状态设置为就绪。</p>
    <p>[0062]	激活不成功，记录激活错误次数，但不锁定令牌。</p>
    <p>[0063]	13、锁定/解锁</p>
    <p>  锁定:将就绪状态的令牌设置为锁定状态。</p>
    <p>[0064]	令牌被锁定后，可通过解锁服务回到就绪状态。</p>
    <p>[0065]	令牌被锁定后，可通过废止服务设置为废止状态。</p>
    <p>[0066]	解锁:将锁定状态的令牌解锁，设置为就绪状态。</p>
    <p>[0067]	解锁时，要求当前的动态二维码口令。</p>
    <p>[0068]	若设置了静态口令，要求验证静态口令。</p>
    <p>[0069]	若静态口令的验证方式是内部挑战方式，使用内部挑战认证。</p>
    <p>[0070]	若静态口令的验证方式是普通方式，使用静态口令+动态二维码口令认证。</p>
    <p>[0071]	14、挂起/解挂</p>
    <p>  挂起:将动态令牌设置为挂起状态。</p>
    <p>[0072]	只有就绪或锁定状态的令牌可被设置为挂起状态。</p>
    <p>[0073]	令牌被挂起后，可通过废止服务设置为废止状态。</p>
    <p>[0074]	解挂:解除令牌的挂起状态。</p>
    <p>[0075]	解挂成功后令牌的状态设置为就绪状态。</p>
    <p>[0076]	要求验证当前的动态口令。</p>
    <p>[0077]	若设置了静态口令，要求验证静态口令。</p>
    <p>[0078]	若静态口令的验证方式是内部挑战方式，使用内部挑战认证。</p>
    <p>[0079]	若静态口令的验证方式是普通方式，使用静态口令+动态二维码口令认证。</p>
    <p>[0080]	15、设置静态口令</p>
    <p>  设置动态令牌绑定的静态口令。</p>
    <p>[0081]	要求验证原有的静态口令。</p>
    <p>[0082]	若静态口令的验证方式是内部挑战方式，使用内部挑战认证。</p>
    <p>[0083]	若静态口令的验证方式是普通方式，使用静态口令+动态二维码口令认证。[0084]	16、远程解 PIN</p>
    <p>  认证系统提供远程解PIN的功能(针对具有PIN保护的令牌)。根据应用请求，认证系统生成当前的远程解PIN密码。</p>
    <p>[0085]	解PIN的密码为0-9的数字串，长度最少为6位。</p>
    <p>[0086]	解PIN的操作最大尝试次数不可超过5次，若超过最大尝试次数，应至少等待I小时才可继续尝试。</p>
    <p>[0087]	超过最大尝试次数的情况不可超过5次，否则令牌应永久锁定，不可再使用。</p>
    <p>[0088]	17、同步</p>
    <p>  认证系统提供令牌的同步服务。</p>
    <p>[0089]	验证令牌的连续2个动态二维码口令，若成功，调整令牌的系统偏移量。</p>
    <p>[0090]	令牌的同步服务不改变令牌状态。</p>
    <p>[0091]	18、密钥变形</p>
    <p>  令牌在正常使用前，通过用户与服务商协商，形成特定的密钥变形机制，将原始种子密钥改变为令牌实际使用时的工作种子密钥。该密钥变形机制所需的变形原理或参数，由用户保存(如银行与使用令牌的储户保存)，服务商不知晓。</p>
    <p>[0092]	19、废止</p>
    <p>  令牌损坏或失效后，可使用认证系统的废止服务将其废止。废止的令牌不可再用于用户的身份认证和交易验证。系统仅保留该令牌的使用历史记录。</p>
    <p>[0093]	20、令牌信息查询</p>
    <p>  认证系统提供令牌的信息查询服务，包括:令牌的当前状态、上次使用时间、当前累计错误次数。</p>
    <p>[0094]	信息查询服务不改变令牌状态。</p>
    <p>[0095]	21、认证平台管理功能</p>
    <p>[0096]	I)权限管理</p>
    <p>[0097]	认证系统对访问人员采取权限控制，不同角色的访问人员赋予不同的操作权限。</p>
    <p>[0098]	2)参数配置</p>
    <p>[0099]	认证系统对认证和管理功能参数进行配置。</p>
    <p>[0100]	3)日志管理</p>
    <p>[0101]	日志管理包括日志的写入、查询功能，每条日志至少记录事件的日期和时间、事件类型、主体身份、事件的结果(成功或失效)、日志级别。以下事件应该记录日志:</p>
    <p>  动态二维码口令认证，同步的结果。</p>
    <p>  令牌系统状态的变更。</p>
    <p>  4)服务报表</p>
    <p>  系统提供对令牌和系统不同时间段对应的状态和结果的统计报表。</p>
    <p>  5)种子导入</p>
    <p>  认证系统提供导入种子密钥的功能，并设置令牌的初始状态。</p>
    <p>  6)备份恢复</p>
    <p>  认证系统提供对敏感信息的备份功能。</p>
    <p>[0102]	22、安全要求  I)接入端控制</p>
    <p>  认证服务器具有控制应用服务器安全接入的方法和措施。</p>
    <p>[0103]	2)通讯敏感字段加密</p>
    <p>  为了防止网络监听的形式对认证数据进行窃听和分析，在认证服务器和应用服务器之间的通讯数据上做加密处理。</p>
    <p>[0104]	3)信息存储加密</p>
    <p>  认证系统中的种子密钥是加密存储的，当认证服务器接收到认证请求时，认证服务器会首先读取种子密钥加密密钥密文，调用加密机或加密卡的接口使用主密钥解密种子密钥加密密钥密文，然后读取种子密钥密文，再使用种子密钥加密密钥解密种子密钥，通过种子密钥和时间因子信息生成对应的动态密码，并与接收到的动态二维码口令信息进行比较，从而完成动态二维码口令身份验证。</p>
    <p>[0105]	23、令牌安全性控制  I)锁定及解锁</p>
    <p>  按照用户要求提供锁定机制，当一个令牌连续尝试认证失败次数累计达到上限，则对令牌进行锁定，同时提供人工解锁和自动解锁机制。</p>
    <p>[0106]	2)防重复认证</p>
    <p>  重复认证检测，对于已经通过认证的动态密码，认证服务器将予以作废，只要已经通过认证的动态密码，均不能再次通过认证。</p>
    <p>[0107]	3)日志安全</p>
    <p>  日志信息具有校验码，只要用户对日志信息进行修改，就可通过校验码检查出来。</p>
    <p>[0108]	敏感数据具有备份恢复机制。</p>
    <p>[0109]	认证系统针对日志访问具备相应的访问控制策略，对日志的操作有对应记录，以保证日志的完整性和安全性。</p>
    <p>[0110]	4)接入端控制</p>
    <p>  认证服务器具有时间校准的处理方法和措施。</p>
    <p>[0111]	5)认证系统安全</p>
    <p>  认证系统安全符合目标应用服务或系统的安全需求，具体参照目标应用服务或系统的相应规范或标准。</p>
    <p>[0112]	本发明的优点:</p>
    <p>  I)抗暴露:使用二维码作为口令载体，排除了肉眼偷窥的可能性。即使动态二维码口令被图像采集设备捕获，也无法在密码生命期内转化为可被认证的动态二维码口令。</p>
    <p>[0113]	2)高强度和不可预测:二维码的高信息容量保证了动态二维码口令的高强度。动态因子存放在服务器端和动态二维码令牌中，不在网络中传输，动态因子的随机性保证了动态二维码口令的不可预测。</p>
    <p>[0114]	3)抗重放:一个动态二维码口令只能使用一次，一旦使用就立即作废。即使不适用，超过密码生命期，将产生新的动态二维码口令，旧的动态二维码口令将失效。</p>
    <p>[0115]	4)抗抵赖:采用多重信息认证方式，只有持有动态二维码令牌的用户能生成包含抗抵赖信息的动态二维码口令，服务方和任何第三方都不能生成该用户的动态二维码口令。[0116]	5)免记忆:动态二维码口令随机生成，每次使用都不同，用户无需记忆，不怕遗失或者遗忘。</p>
    <p>[0117]	6)精确和高效:二维码是信息世界与实体世界的纽带，用户的动态二维码口令可通过二维码扫描设备，精确、高效的被自动识别。在军事、航天、金融领域，可实现M2M无缝自动识别认证。在CPS领域，具有重大的战略意义。</p>
    <p>[0118]	7)物理隔离:动态二维码口令的产生过程完全与网络隔绝，有效杜绝了令牌算法、动态因子被监听和破解，从根本上保障了动态二维码口令的安全。动态二维码令牌通过二维码扫描设备识别，客户端与服务器端设备物理隔离，有效避免了非授权设备接入带来的风险，从根本上保证了信息系统的安全。</p>
    <p>[0119]	8)双向认证:客户端与服务器端双向认证，避免了钓鱼攻击。</p>
    <p>附图说明</p>
    <p>[0120]	图1是动态二维码口令认证平台构架图。</p>
    <p>[0121]	图2是动态二维码口令认证流程图。</p>
    <p>[0122]	图3是动态二维码令牌结构图。</p>
    <p>具体实施方式</p>
    <p>[0123]为了使本专利技术方案和优点更加清楚、明确，下面列举一个实施例，所举实施例仅是本专利的一种应用情景，而不是全部实施例。</p>
    <p>[0124]	本专利提供一种动态二维码令牌及动态二维码口令认证方法，显著提高身份认证的安全性。以下结合实施例对本专利进行详细描述。</p>
    <p>[0125]	参见图1,其示出了动态二维码口令认证平台构架图。</p>
    <p>[0126]	动态二维码令牌，是产生并显示动态二维码口令的用户终端设备。本实施例以智能手机为例，将预定义的动态二维码令牌程序以手机应用的形式部署于智能手机的程序存储器中。</p>
    <p>[0127]	动态二维码口令认证平台(包括动态二维码口令认证系统、动态二维码口令管理系统)部署在服务器端。应用系统部署在客户端，通过认证协议与服务器端通讯。</p>
    <p>[0128]	动态二维码令牌使用前，必须经管理员在服务器端激活并录入相关信息，激活成功后，令牌在用户终端和服务器端状态均为可用状态。</p>
    <p>[0129]	结合图2，动态二维码口令认证流程图，具体的认证过程为:</p>
    <p>  I)用户启动智能手机中动态二维码令牌应用，选择“开始认证”。</p>
    <p>[0130]	2)令牌自动验证令牌状态，如果令牌未激活，则提示“令牌未激活，无法进行认证”。</p>
    <p>[0131]	3)已激活的令牌，则显示“请扫描二维码”。</p>
    <p>[0132]	4)使用智能手机摄像头扫描服务器端向应用系统提供的二维码。</p>
    <p>[0133]	5)令牌二维码模块对服务器端提供的二维码信息解码解密，将服务器端鉴权信息和产生动态二维码口令的控制信息分离。</p>
    <p>[0134]	6)令牌认证模块根据得到的服务器端鉴权信息对服务器进行认证，如果服务器端不能通过认证，则停止整个认证过程并提示“服务器不是可信服务器”。[0135]	7)如果服务器端认证成功，令牌管理模块初始化令牌。</p>
    <p>[0136]	8)令牌口令模块根据由服务器端提供的二维码中分离出来的产生动态二维码口令的控制信息，确定动态二维码口令的生成方式(如时间模式、事件模式、挑战应答模式)、令牌算法及动态因子，产生动态口令。</p>
    <p>[0137]	9)令牌二维码模块将动态口令与客户端标识信息及其他指定特征值分组封装加密，再生成二维码图像。</p>
    <p>[0138]	10)令牌显示模块将二维码图像显示在智能手机的显示屏上并提示“请出示动态二维码口令”。</p>
    <p>[0139]	11)用户向应用系统的二维码扫描设备出示动态二维码口令。服务器端通过应用系统的二维码扫描设备捕获动态二维码口令。[0140]	12)服务器端对捕获的二维码图像解码，再根据指定的符合国密标准的安全算法，对解码后提取出的信息进行解密，得到封装的动态口令与客户端标识信息及其他指定特征值。将动态口令与客户端标识信息及其他指定特征值分离，根据认证规则进行口令认证。如果口令认证失败，拒绝对用户授权，整个认证过程失败，并提示“无法通过认证”</p>
    <p>  13)通过口令认证，则对用户授权，用户获得相应权限，并提示“认证成功”。</p>
    <p>[0141]	动态二维码令牌特性要求</p>
    <p>  作为动态二维码令牌载体的智能设备或专用设备产品特性最低要符合以下严酷条件要求:</p>
    <p>  高温:使用GB/T 2423.2-2008【电工电子产品环境试验第2部分:试验方法试验B:高温】中试验方法Bb，严酷等级选择温度:+50°C，持续时间:2小时。</p>
    <p>[0142]	低温:使用GB/T 2423.1-2008【电工电子产品环境试验第2部分:试验方法试验A:低温】中试验方法Ab，严酷等级选择温度:-10°C，持续时间:2小时。</p>
    <p>[0143]	高低温冲击:使用GB/T 2423.22-2002【电工电子产品环境试验第2部分:试验方法N:温度变化】严酷等级选择高温温度:+50°C，低温温度:_10°C，暴露试验时间:10分钟，转换时间:(2&#8212; 3)分钟，循环数:3个。</p>
    <p>[0144]	湿度:使用GB/T 2423.9-2001【电工电子产品环境试验第2部分:试验方法试验Cb设备用恒定湿热】严酷等级选择温度:30°C ±2°�，相对湿度93%±3%，试验时间:2小时。</p>
    <p>[0145]	工作海拔:使用GB/T 2423.21-1991【电工电子产品基本环境试验规程试验M:低气压试验方法】严酷等级选择气压:55kPa，持续时间:2小时。</p>
    <p>[0146]	跌落:使用GB-T2423.8-1995【电工电子产品环境试验第2部分:试验方法试验Ed:自由跌落】中方法一，严酷等级选择跌落高度:1000mm。</p>
    <p>[0147]	防尘防水:遵守GB4208-2008【外壳防护等级(IP代码)】中IP44的要求。</p>
    <p>[0148]	振动:使用GB/T 2423.10-2008【电工电子产品环境试验第2部分:试验方法试验Fe:振动(正弦)】严酷等级选择频率范围:10Hz到300Hz，振动幅值:3.5mm，持续时间:60分钟。</p>
    <p>[0149]	静电放电:不低于GB/T 17626.2-2006【电磁兼容试验和测量技术静电放电抗扰度试验】中试验等级3的标准，即满足外壳端口接触放电±6kV，空气放电±8kV。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103186745A?cl=zh">CN103186745A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年3月8日</td><td class="patent-data-table-td patent-date-value">2013年7月3日</td><td class="patent-data-table-td ">陈景辉</td><td class="patent-data-table-td ">一种图形动态口令令牌</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103218740A?cl=zh">CN103218740A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年3月13日</td><td class="patent-data-table-td patent-date-value">2013年7月24日</td><td class="patent-data-table-td ">北京宏基恒信科技有限责任公司</td><td class="patent-data-table-td ">使用二维码的交易系统、方法和装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20120096277">US20120096277</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年4月19日</td><td class="patent-data-table-td patent-date-value">2012年4月19日</td><td class="patent-data-table-td ">Alter Core, S.L.</td><td class="patent-data-table-td ">System and method for personal authentication using a mobile device</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="npl-citations"></a><div class="patent-section-header"><span class="patent-section-title">非专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th colspan="3"class="patent-data-table-th">参考文献</th></tr></thead><tr><td class="patent-data-table-td ">1</td><td class="patent-data-table-td "><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td ">李涛等: "<a href='http://scholar.google.com/scholar?q="%E4%B8%80%E7%A7%8D%E6%96%B0%E7%9A%84%E5%9F%BA%E4%BA%8E%E5%8A%A8%E6%80%81%E5%8F%A3%E4%BB%A4%E7%9A%84%E8%BF%9C%E7%A8%8B%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81"'>一种新的基于动态口令的远程双向认证</a>", 《中文核心期刊（微计算机信息）》, vol. 23, no. 113, 31 December 2007 (2007-12-31), pages 38 - 40</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=q1brCAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0009320000">H04L9/32</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2014年1月8日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2014年2月12日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/5af1654b79f61a41c8a8/CN103501228A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E5%8A%A8%E6%80%81%E4%BA%8C%E7%BB%B4%E7%A0%81%E4%BB%A4%E7%89%8C%E5%8F%8A%E5%8A%A8%E6%80%81%E4%BA%8C.pdf?id=q1brCAABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U1jaIA1EbtGEgchx5gF0Yrkj0VR7w"},"sample_url":"https://www.google.com/patents/reader?id=q1brCAABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>