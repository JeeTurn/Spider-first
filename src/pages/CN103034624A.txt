<!DOCTYPE html><html><head><title>专利 CN103034624A - 一种页面对象的精确定位方法和系统 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_50a6672b5f82ffbd39b7a9e87fd4594c/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_50a6672b5f82ffbd39b7a9e87fd4594c__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种页面对象的精确定位方法和系统"><meta name="DC.contributor" content="王学武" scheme="inventor"><meta name="DC.contributor" content="雷少平" scheme="inventor"><meta name="DC.contributor" content="北京大学" scheme="assignee"><meta name="DC.contributor" content="北大方正集团有限公司" scheme="assignee"><meta name="DC.contributor" content="方正国际软件(北京)有限公司" scheme="assignee"><meta name="DC.date" content="2011-9-29" scheme="dateSubmitted"><meta name="DC.description" content="本发明涉及一种页面对象的精确定位方法和系统。现有的公文排版方法无法保证公文格式的规范，排版过程的自动化程度不高，编制公文的效率低。本发明所述的方法充分考虑公文中各要素的格式特点，以页面要素所形成的在页面呈现出来的文字、表格、图形和图像为对象，选取这些对象上的一个点为参考点、用准确的坐标值来确定这些对象在页面中的位置。采用本发明所述的方法和系统，可以实现页面特别是公文页面要素的精确定位，使页面的格式能够满足严格公文格式规范的要求。"><meta name="DC.date" content="2013-4-10"><meta name="DC.relation" content="CN:101443790:A" scheme="references"><meta name="DC.relation" content="CN:101872340:A" scheme="references"><meta name="DC.relation" content="CN:101989256:A" scheme="references"><meta name="DC.relation" content="CN:102147791:A" scheme="references"><meta name="DC.relation" content="CN:1828517:A" scheme="references"><meta name="DC.relation" content="CN:1936882:A" scheme="references"><meta name="DC.relation" content="JP:2000250904" scheme="references"><meta name="citation_patent_publication_number" content="CN:103034624:A"><meta name="citation_patent_application_number" content="CN:201110300551"><link rel="canonical" href="https://www.google.com/patents/CN103034624A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN103034624A?cl=zh"/><meta name="title" content="专利 CN103034624A - 一种页面对象的精确定位方法和系统"/><meta name="description" content="本发明涉及一种页面对象的精确定位方法和系统。现有的公文排版方法无法保证公文格式的规范，排版过程的自动化程度不高，编制公文的效率低。本发明所述的方法充分考虑公文中各要素的格式特点，以页面要素所形成的在页面呈现出来的文字、表格、图形和图像为对象，选取这些对象上的一个点为参考点、用准确的坐标值来确定这些对象在页面中的位置。采用本发明所述的方法和系统，可以实现页面特别是公文页面要素的精确定位，使页面的格式能够满足严格公文格式规范的要求。"/><meta property="og:title" content="专利 CN103034624A - 一种页面对象的精确定位方法和系统"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN103034624A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN103034624A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=pL7vBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN103034624A&amp;usg=AFQjCNF6th1hY-Vgl_lA02ps-ScIkMZYog" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/7e4acd0b2da184f98aec/CN103034624A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/7e4acd0b2da184f98aec/CN103034624A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN103034624A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN103034624A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN103034624A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN103034624B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN103034624A?cl=zh" style="display:none"><span itemprop="description">本发明涉及一种页面对象的精确定位方法和系统。现有的公文排版方法无法保证公文格式的规范，排版过程的自动化程度不高，编制公文的效率低。本发明所述的方法充分考虑公文中各要素的格式特点，以页面要素所形成的在页...</span><span itemprop="url">https://www.google.com/patents/CN103034624A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN103034624A - 一种页面对象的精确定位方法和系统</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN103034624A - 一种页面对象的精确定位方法和系统" title="专利 CN103034624A - 一种页面对象的精确定位方法和系统"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN103034624 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201110300551</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2013年4月10日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2011年9月29日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2011年9月29日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103034624B?hl=zh-CN&amp;cl=zh">CN103034624B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201110300551.6, </span><span class="patent-bibdata-value">CN 103034624 A, </span><span class="patent-bibdata-value">CN 103034624A, </span><span class="patent-bibdata-value">CN 201110300551, </span><span class="patent-bibdata-value">CN-A-103034624, </span><span class="patent-bibdata-value">CN103034624 A, </span><span class="patent-bibdata-value">CN103034624A, </span><span class="patent-bibdata-value">CN201110300551, </span><span class="patent-bibdata-value">CN201110300551.6</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%8E%8B%E5%AD%A6%E6%AD%A6%22">王学武</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%9B%B7%E5%B0%91%E5%B9%B3%22">雷少平</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%22">北京大学</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E5%8C%97%E5%A4%A7%E6%96%B9%E6%AD%A3%E9%9B%86%E5%9B%A2%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">北大方正集团有限公司</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E6%96%B9%E6%AD%A3%E5%9B%BD%E9%99%85%E8%BD%AF%E4%BB%B6(%E5%8C%97%E4%BA%AC)%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">方正国际软件(北京)有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103034624A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103034624A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103034624A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (7),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (1),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=pL7vBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201110300551&amp;usg=AFQjCNGlrEpWtZY98CI7Ygp23FEAEnLOWA"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=pL7vBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D103034624A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNFPRw80gOoH2PtDfl4PSO6z47arMQ"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT123229868" lang="ZH" load-source="patent-office">一种页面对象的精确定位方法和系统</invention-title>
      </span><br><span class="patent-number">CN 103034624 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA110112907" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明涉及一种页面对象的精确定位方法和系统。现有的公文排版方法无法保证公文格式的规范，排版过程的自动化程度不高，编制公文的效率低。本发明所述的方法充分考虑公文中各要素的格式特点，以页面要素所形成的在页面呈现出来的文字、表格、图形和图像为对象，选取这些对象上的一个点为参考点、用准确的坐标值来确定这些对象在页面中的位置。采用本发明所述的方法和系统，可以实现页面特别是公文页面要素的精确定位，使页面的格式能够满足严格公文格式规范的要求。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(10)</span></span></div><div class="patent-text"><div mxw-id="PCLM52524118" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.	一种页面对象的精确定位方法，包括以下步骤：(1)由页面设置信息建立页眉、版心、页脚这三个排版区域的逻辑坐标系；(2)解析包含页面要素显现对象定义的计算机文件，建立版心中的页面要素显现对象队列，如果其中定义了页眉、页脚对象，还分别建立页眉、页脚中的显现对象队列；(3)选取版心显现对象队列为当前排版对象队列，版心坐标系为当前坐标系，版心所占区域为当前排版区域，对象为流动排放方式，进入定位对象队列的子过程，子过程结束后，进入步骤⑷；(4)如果有页眉显现对象队列，选取该队列为当前排版对象队列，在页眉坐标系中，页眉所占区域为当前排版区域，对象为不流动排放方式，进入定位对象队列的子过程，子过程结束后，进入步骤（5);如果没有页眉显现对象队列，直接进入步骤（5)；(5)如果有页脚显现对象队列，选取该队列为当前排版对象队列，在页脚坐标系中，页脚所占区域为当前排版区域，对象为不流动排放方式，进入定位对象队列的子过程，子过程结束后，结束整篇文件的排版；如果没有页脚显现对象队列，直接结束整篇文件的排版。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.如权利要求1所述的一种页面对象的精确定位方法，其特征是：步骤（2)中，所述版心中的显现对象依次在页面中排放，并会自动向后页流动，所述的流动是整个对象的流动，而不是内容数据的流动。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.如权利要求1所述的一种页面对象的精确定位方法，其特征是：步骤（2)中，所述的页眉、页脚中的显现对象不流动，仅在对应的排版区域内排版。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.如权利要求1或2或3所述的一种页面对象的精确定位方法，其特征是：步骤（3)、步骤（4)和步骤（5)中所述的定位对象队列的子过程包括以下步骤：1.初始化当前页面序号为O ;&#971;.从当前排版对象队列中，依次选取一个页面要素显示对象为当前排版对象，选取到一个对象就执行下一步；选取不到，则队列中已没有要排版的对象，结束该子过程；ii1.确定当前排版对象的定位点；iv.确定当前排版对象的可排区域；V.确定当前排版对象的排版区域；v1.当前排版对象在它自己的排版区域内进行排版；vi1.确定当前排版对象的实际大小：水平方向、竖直方向分别处理，数值定义的宽、闻，就是实际的宽、闻；自适应定义的宽、闻，则是对象中的内容所占的宽、闻就是实际的宽、闻;vii1.如果当前对象为未排放状态，则需要进一步判断是否要在当前页上排放它，如果当前页上没有一个已排放的块时，即使当前对象在当前页上不能排放，也只好无条件把它设为可排放状态；&#938;Χ.对可排放状态的当前对象，则要设置它的占位区域；由基点坐标和对象的实际大小就可以算出占位区域；X.对可排放的当前对象进行页面序号的设置，页面序号为当前页面序号；x1.如果当前对象为未排放状态或有后续对象要在下页排版的标记时，当前页面序号加I ;χ&#971;.如果当前对象为未排放状态，回到步骤（iii)，重排当前对象；如果当前对象为可排放状态，回到步骤（ii)，排版下一个对象。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.如权利要求4所述的一种页面对象的精确定位方法，其特征是，步骤（iii)中所述的确定当前排版对象的定位点的方法如下：1)取得当前排版对象的定位类型；2)取得当前排版对象的对齐方式；3)取得当前排版对象的位置坐标；4)由水平方向的定位类型、对齐方式和位置坐标，可确定定位点的X坐标，方法如下：确定水平方向的参考范围：水平方向定位类型为绝对时，取当前排版区域水平方向的范围；为相对时，在当前队列中找到当前对象的前一个对象，队列中的第一个对象不能定义为相对，取前一个对象所占据区域水平方向的范围；水平方向有对齐：先进行对齐，由对齐方式在水平方向的参考范围上找到对齐值，左对齐就选左侧值，中对齐就选中间值，右对齐就选右侧值；如果定义了水平方向的位置坐标，对齐值加上位置坐标的X坐标后为定位点的X坐标；没有定义水平方向的位置坐标，对齐值就为定位点的X坐标；水平方向无对齐时：水平方向定位类型为绝对时，位置坐标的X坐标就为定位点的X坐标；为相对时，位置坐标的X坐标为负时，参考范围左侧值加上位置坐标的X坐标的结果为定位点的X坐标；位置坐标的X坐标为正时,参考范围右侧值加上位置坐标的X坐标的结果为定位点的X坐标；5)确定定位点的Y坐标，和确定X坐标方法几乎相同，不同是把左替换为上，右替换为下，水平替换为竖直，X替换为Y ;定位类型为相对时，增加前一个对象在当前页的前一页的情况，即前一个对象和当前对象不在同一页上，而无法进行竖直方向的对齐和偏移，只好设置定位点的Y坐标为O。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.如权利要求4所述的一种页面对象的精确定位方法，其特征是，步骤（iv)中所述的确定当前排版对象的可排区域的方法如下：a)取得当如排版对象的基点；b)使基点的坐标等于定位点的坐标；c)由当前排版区域、当前排版对象的基点，计算当前排版对象的可排区域，在水平方向、竖直方向分别、独立进行计算；水平方向可排范围，按水平方向基点类型进行分别处理：左：基点的X坐标到当前排版区域的右侧；中：在排版区域水平方向内，以基点X坐标为中点的最大范围；右：当前排版区域的左侧到基点的X坐标；竖直方向可排范围，如果基点Y坐标为O时，直接为当前排版区域的高，大于O时，则按竖直方向基点类型进行分别处理：上：基点的Y坐标到当前排版区域的底边；中：在排版区域竖直方向内，以基点Y坐标为中点的最大范围；下：当前排版区域的上边到基点的Y坐标。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.如权利要求4所述的一种页面对象的精确定位方法，其特征是，步骤（V)中所述的确定当前排版对象的排版区域的方法如下：1)确定水平方向排版范围：取得当前排版对象定义的宽，其定义方式有“数值”和“自适应”二种，具体计算分别如下：数值：取定义宽度和水平方向可排范围值的较小值为水平方向的排版范围；自适应：水平方向可排范围为水平方向排版范围；2)确定竖直方向排版范围：取得当前排版对象定义的高，其定义方式有“数值”和“自适应”二种，具体计算分别如下：数值：取定义宽度和竖直方向可排范围值的较小值为竖直方向的排版范围；自适应：竖直方向可排范围为竖直方向排版范围；3)设置对象的排版状态：对象为流动排放方式、且数值方式定义的高度大于竖直方向可排范围值时，设置对象的排版状态为不可排放状态，其他为可排放状态。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.如权利要求4所述的一种页面对象的精确定位方法，其特征是，步骤（vi)中所述的当前排版对象在它自己的排版区域内进行排版时，按对象类型分别采用以下方法进行处理：对象类型为文字显现对象：采用已经成熟的流式排版技术把文字排放在排版区域内，如果有文字不能排放时，把不能排的文字作为遗留文字；当对象为流动排放方式，且对象的高为自适应时，当有遗留文字，则新生成一个文字显现对象，在当前对象后面加入到当前排版对象队列中；新产生对象的竖直方向属性为：绝对、无对齐、坐标为O、高度为自适应，基点为上；水平方向属性为：相对、左对齐、坐标为O、宽度同当前对象，基点为左；从当前对象中取出遗留文字并放置到新建对象中，并标记后续对象要在下页排版；对象类型为表格显现对象：以表行为单位，依次排版表行中单元格，如果单元格中有文字不能排放，不能排放的文字就作为单元格遗留文字；当对象为流动排放方式，且对象的高为自适应时，如果单元格有遗留文字，就设置对象的排版状态为不可排放状态，表格作整体流动，不做拆分；对象类型为图形显现对象：排放图形中的几何点，当对象为流动排放方式，且对象的高为自适应时，如果有点在竖直方向上超出排版区域，就设置对象的排版状态为不可排放状态，图形作整体流动，不做拆分；对象类型为图像显现对象：排放图像，且对象的高为自适应时，如果图像高度超出排版区域，就设置对象的排版状态为不可排放状态，图像作整体流动，不做拆分。</div>
    </div>
    </div> <div class="claim"> <div num="9" class="claim">
      <div class="claim-text">9.	一种页面对象的精确定位系统，包括以下装置：逻辑坐标系建立装置：用于由页面设置信息建立页眉、版心、页脚这三个排版区域的逻辑坐标系；页面要素显现对象解析装置：用于解析包含页面要素显现对象定义的计算机文件，建立版心中的页面要素显现对象队列及页眉、页脚中的显现对象队列；版心显现对象队列定位装置：用于选取版心显现对象队列为当前排版对象队列，版心坐标系为当前坐标系，版心所占区域为当前排版区域，对象为流动排放方式，对版心显现对象队列进行定位；页眉显现对象队列定位装置：用于选取该队列为当前排版对象队列，在页眉坐标系中，页眉所占区域为当前排版区域，对象为不流动排放方式，对页眉显现对象队列进行定位；页脚显现对象队列定位装置：用于选取该队列为当前排版对象队列，在页脚坐标系中，页脚所占区域为当前排版区域，对象为不流动排放方式，对页脚显现对象队列进行定位。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.如权利要求9所述的一种页面对象的精确定位系统，其特征在于，所述的版心、页眉、页脚显现对象队列定位装置中还包括定位对象队列的模块，该模块用于定位版心、页眉、页脚显现对象队列中的对象，具体方法包括以下步骤：1.初始化当前页面序号为O ;&#971;.从当前排版对象队列中，依次选取一个页面要素显示对象为当前排版对象，选取到一个对象就执行下一步；选取不到，则队列中已没有要排版的对象，结束该子过程；ii1.确定当前排版对象的定位点；iv.确定当前排版对象的可排区域；V.确定当前排版对象的排版区域；v1.当前排版对象在它自己的排版区域内进行排版；vi1.确定当前排版对象的实际大小：水平方向、竖直方向分别处理，数值定义的宽、闻，就是实际的宽、闻；自适应定义的宽、闻，则是对象中的内容所占的宽、闻就是实际的宽、闻;vii1.如果当前对象为未排放状态，则需要进一步判断是否要在当前页上排放它，如果当前页上没有一个已排放的块时，即使当前对象在当前页上不能排放，也只好无条件把它设为可排放状态；&#938;Χ.对可排放状态的当前对象，则要设置它的占位区域；由基点坐标和对象的实际大小就可以算出占位区域；X.对可排放的当前对象进行页面序号的设置，页面序号为当前页面序号；x1.如果当前对象为未排放状态或有后续对象要在下页排版的标记时，当前页面序号加I ;χ&#971;.如果当前对象为未排放状态，回到步骤（iii)，重排当前对象；如果当前对象为可排放状态，回到步骤（ii)，排版下一个对象。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES59584580" lang="ZH" load-source="patent-office" class="description">
    <p>一种页面&#23550;象的精确定位方法和系统</p>
    <p>技术领域</p>
    <p>[0001]	本发明属于印前计算机排版技术领域，具体涉及�种页面对象的精确定位方法和系统。</p>
    <p>背景技术</p>
    <p>[0002]	生成格式规范化的公文是各级机关公文编制的客观要求，也是充分发挥公文作用，维护公文严肃性和权威性的必要条件。随着计算机的普及，各级机关公文的&#32232;制几乎都是用计算机来实现的。公文的&#32232;制一般使用排版软件、办公软件进行印前排版，排版完成后，由排版结果来印制公文。</p>
    <p>[0003]	国标GB/T9704-1999《国家行政机关公文格式》规定了国家行政机关公文通用的纸张要求、印制要求、公文中各要素排列和标识规则；《中国共产党机关公文处理条例》对党的机关公文也有明确规范。党、政的公文都要求具有十分严格的格式规范。</p>
    <p>[0004]目前，公文由公文页面要素组成&#183;，例如：份数序号、秘密等级、保密期限等。公文页面要素的内容在页面中被定位、排放就形成有格式的公文。公文页面要素的内容在页面中显现出来的对象可分为文字、表格、图形和图像等，简称为公文页面要素显现对象，他们所占的区域都为矩形。</p>
    <p>[0005]	公文格式规范对公文页面要素在页面中的位置要求有以下几种：</p>
    <p>[0006]1.显现对象被排放在页面中某个固定位置；</p>
    <p>[0007]	2.显现对象被排放在页面中相对前�个公文要素对象的某个位置；</p>
    <p>[0008]	3.位置要求的方式有以下几种：</p>
    <p>[0009]	I)显现对象和页面之间的对齐。例如：显现对象的右边或下边和页面版心的右边或底边对齐；</p>
    <p>[0010]	2)显现对象之间的对齐。如：公章和成文日期或&#21336;位；</p>
    <p>[0011]	3)页面中的坐标；</p>
    <p>[0012]	4)相对其他显现对象的偏移；</p>
    <p>[0013]	&#8226;在水平和竖直方向上的位置可要求的方式可以不同；例如：水平方向的右边和页面的右边对齐，竖直方向和前�个公文要素相距一行；</p>
    <p>[0014]	&#8226;一个显现对象位置可能会影响其他显现对象位置，例如：多个“签发人”，就会改变“发文字号”的位置；</p>
    <p>[0015]	&#8226;页面上指定位置的显现对象所占的区域也会影响其他显现对象位置，所占的区域也不都是整行闻;</p>
    <p>[0016]	&#8226;某些要素显现对象是否出现，对后面某些显现对象的位置有影响，而对有的又可以没有影响。例如：有“秘密等级和保密期限”&#21515;，“紧急程度”就在页面版心右上角的第ニ行；没有，就在页面版心右上角的第一行；但对其他要素没有影响。</p>
    <p>[0017]	随着计算机普及、文字处理技术的发展，使&#32232;制公文变得更简单，办文人员通过排版软件就可以编制符合规范要求的公文。而排版软件所采用的排版方法就决定了公文格式的质量。目前排版公文的软件主要有方正书版、金山WPS、永中office和微软office等。他们都是面向一些通用文档的排版软件、没有为公文格式特点作特别处理。他们一般都采用“流式排版方法”，其特点就是文档的文字、表格、图形和图像等内容作为一个整体在文档页面中流动，通过行距、字距、对齐和绕排方式来确定字符、图形、图像这些内容在页面中位置。“流式排版方法”在排版公文时，一般通过加减换行符、制表符或空格；调整行距、段距和字距等来调整公文页面要素内容的位置。这些处理只会导致位置信息不精确导，还增加公文排版的工作量。由于在原内容的基础上增加换行符、制表符或空格等空白符，在人工阅读时，几乎没有影响，但对计算机在进行数据处理、再利用时就会有很大的影响。</p>
    <p>[0018]	综上，现有排版软件在排版公文时存在严重缺陷，而增加出现不符合公文格式要求的公文的可能性。另外，公文对格式的规范要求非常严格，各组织、机构一般通过建立严格的制度和规范，确定各环节的权限和责任，来保证公文格式的规范性。在公文格式方面，一般要花费组织、机构大量的人力、物力。具体来说，由于公文排版的现状，公文的排版还存在下列问题：</p>
    <p>[0019]	a)规范的格式难以得到保证；</p>
    <p>[0020]	b)不便于公文内容数据的处理和再利用；</p>
    <p>[0021]	c)排版过程的自动化程度不高；</p>
    <p>[0022]	d)编制公文的效率低。</p>
    <p>发明内容</p>
    <p>[0023]	针对现有技术中存在的缺陷，本发明的目的是提供一种页面对象的精确定位方法和系统。该方法和系统能够充分考虑公文中各页面要素的格式特点，以公文页面要素所形成的在页面呈现出来的文字、表格、图形和图像为对象，选取这些对象上的一个点为参考点、用准确的坐标值来确定这些对象在页面中的位置。</p>
    <p>[0024]	为达到以上目的，本发明采用的技术方案是：一种页面对象的精确定位方法，包括以下步骤：</p>
    <p>[0025]	(I)由页面设置信息建立页眉、版心、页脚这三个排版区域的逻辑坐标系；</p>
    <p>[0026]	(2)解析包含公文要素显现对象定义的计算机文件，建立版心中的页面要素显现对象队列，如果其中定义了页眉、页脚对象，还分别建立页眉、页脚中的显现对象队列；</p>
    <p>[0027]	(3)选取版心显现对象队列为当前排版对象队列，版心坐标系为当前坐标系，版心所占区域为当前排版区域，对象为流动排放方式，进入定位对象队列的子过程，子过程结束后，进入步骤⑷；</p>
    <p>[0028]	(4)如果有页眉显现对象队列，选取该队列为当前排版对象队列，在页眉坐标系中，页眉所占区域为当前排版区域，对象为不流动排放方式，进入定位对象队列的子过程，子过程结束后，进入步骤（5);如果没有页眉显现对象队列，直接进入步骤（5)；</p>
    <p>[0029]	(5)如果有页脚显现对象队列，选取该队列为当前排版对象队列，在页脚坐标系中，页脚所占区域为当前排版区域，对象为不流动排放方式，进入定位对象队列的子过程，子过程结束后，结束整篇文件的排版；如果没有页脚显现对象队列，直接结束整篇文件的排版。</p>
    <p>[0030]	进一步，步骤（2)中，所述版心中的显现对象依次在页面中排放，并会自动向后页流动，所述的流动是整个对象的流动，而不是内容数据的流动。</p>
    <p>[0031]	所述的页眉、页脚中的显现对象不流动，仅在对应的排版区域内排版。</p>
    <p>[0032]	进一步，步骤（3)、步骤（4)和步骤（5)中所述的定位对象队列的子过程包括以下步骤：</p>
    <p>[0033]1.初始化当前页面序号为O ;</p>
    <p>[0034]	i1.从当前排版对象队列中，依次选取一个页面要素显示对象为当前排版对象，选取到一个对象就执行下一步；选取不到，则队列中已没有要排版的对象，结束该子过程；</p>
    <p>[0035]	ii1.确定当前排版对象的定位点；</p>
    <p>[0036]	iv.确定当前排版对象的可排区域；</p>
    <p>[0037]	V.确定当前排版对象的排版区域；</p>
    <p>[0038]	v1.当前排版对象在它自己的排版区域内进行排版；</p>
    <p>[0039]	vi1.确定当前排版对象的实际大小：水平方向、竖直方向分别处理，数值定义的宽、闻，就是实际的宽、闻;自适应定义的宽、闻，则是对象中的内容所占的宽、闻就是实际的宽、高；</p>
    <p>[0040]	vii1.如果当前对象为未排放状态，则需要进一步判断是否要在当前页上排放它，如果当前页上没有一个已排放的块时，即使当前对象在当前页上不能排放，也只好无条件把它设为可排放状态；</p>
    <p>[0041]	ix.对可排放状态的当前对象，则要设置它的占位区域；由基点坐标和对象的实际大小就可以算出占位区域；</p>
    <p>[0042]	X.对可排放的当前对象进行页面序号的设置，页面序号为当前页面序号；</p>
    <p>[0043]	x1.如果当前对象为未排放状态或有后续对象要在下页排版的标记时，当前页面序号加I ;</p>
    <p>[0044]	xi1.如果当前对象为未排放状态，回到步骤（iii)，重排当前对象；如果当前对象为可排放状态，回到步骤（ii)，排版下一个对象。</p>
    <p>[0045]	一种页面对象的精确定位系统，包括以下装置：</p>
    <p>[0046]	逻辑坐标系建立装置：用于由页面设置信息建立页眉、版心、页脚这三个排版区域的逻辑坐标系；</p>
    <p>[0047]	页面要素显现对象解析装置：用于解析包含页面要素显现对象定义的计算机文件，建立版心中的页面要素显现对象队列及页眉、页脚中的显现对象队列；</p>
    <p>[0048]	版心显现对象队列定位装置：用于选取版心显现对象队列为当前排版对象队列，版心坐标系为当前坐标系，版心所占区域为当前排版区域，对象为流动排放方式，对版心显现对象队列进行定位；</p>
    <p>[0049]	页眉显现对象队列定位装置：用于选取该队列为当前排版对象队列，在页眉坐标系中，页眉所占区域为当前排版区域，对象为不流动排放方式，对页眉显现对象队列进行定位；</p>
    <p>[0050]	页脚显现对象队列定位装置：用于选取该队列为当前排版对象队列，在页脚坐标系中，页脚所占区域为当前排版区域，对象为不流动排放方式，对页脚显现对象队列进行定位。</p>
    <p>[0051]	本发明的效果在于：采用本发明所述的方法，可以实现公文要素的精确定位，使公文的格式能够满足严格公文格式规范的要求。由公文页面要素格式的特点，实现了绝对、相对的坐标和对齐；建立定位点、基点；数值型、自适应的长、宽定义，使得公文页面要素排放在页面变得简便、准确，大大提高排版效率，便于公文页面要素内容数据的交&#25563;和利用。因此，与现有的公文排版技术相比，本发明具有以下几个方面的显著优点：</p>
    <p>[0052]	a)公文页面要素在页面中精确定位；</p>
    <p>[0053]	b)定位方式简洁、定位功能强大；</p>
    <p>[0054]	c)方便、高质量地满足公文格式需要；</p>
    <p>[0055]	d)在页面中流动的是公文页面要素对象，而不是公文页面要素里的内容；</p>
    <p>[0056]	e)便于公文页面要素内容数据的输入和获取。</p>
    <p>附图说明</p>
    <p>[0057]	图1是逻辑页面上三个可排版区域及逻辑坐标系的示意图；</p>
    <p>[0058]	图2是矩形的九宫位点示意图；</p>
    <p>[0059]	图3是页面要素显现对象精确定位的方法流程图；</p>
    <p>[0060]	图4是版心显现对象队列的定位流程图；</p>
    <p>[0061]	图5是眉首显现对象队列的定位流程图；</p>
    <p>[0062]	图6是页脚显现对象队列的定位流程图；</p>
    <p>[0063]	图7是定位显示对象队列中对象流程图；</p>
    <p>[0064]	图8是定位一个显示对象的流程图；</p>
    <p>[0065]	图9a、图9b是�个标记了各个页面要素的位置&#21443;数的公文示意图。</p>
    <p>具体实施方式</p>
    <p>[0066]	下面结合附图和具体实施方式对本发明作进�步描述。</p>
    <p>[0067]	本实施例中，以公文为例，本发明所述的方法充分考虑公文中各页面要素的格式特点，以公文页面要素（以下简称公文要素）所形成的在页面呈现出来的文字、表格、图形和图像为对象，选取这些对象上的�个点为&#21443;考点、用准确的坐标值来确定这些对象在页面中的位置。</p>
    <p>[0068]	�种页面对象的精确定位系统，包括以下装置：</p>
    <p>[0069]	逻辑坐标系建立装置：用于由页面设置信息建立页眉、版心、页脚这三个排版区域的逻辑坐标系；</p>
    <p>[0070]	公文要素显现对象解析装置：用于解析包含公文要素显现对象定义的计算机文件，建立版心中的公文要素显现对象队列及页眉、页脚中的显现对象队列；</p>
    <p>[0071]	版心显现对象队列定位装置：用于选取版心显现对象队列为当前排版对象队列，版心坐标系为当前坐标系，版心所占区域为当前排版区域，对象为流动排放方式，对版心显现对象队列进行定位；</p>
    <p>[0072]	页眉显现对象队列定位装置：用于选取该队列为当前排版对象队列，在页眉坐标系中，页眉所占区域为当前排版区域，对象为不流动排放方式，对页眉显现对象队列进行定位；</p>
    <p>[0073]	页脚显现对象队列定位装置：用于选取该队列为当前排版对象队列，在页脚坐标系中，页脚所占区域为当前排版区域，对象为不流动排放方式，对页脚显现对象队列进行定位。</p>
    <p>[0074]	本发明的相关技术术语：</p>
    <p>[0075]	a)逻辑坐标系</p>
    <p>[0076]	以公文用纸的纸幅面定义逻辑页面，逻辑单位为720DPI (每英寸720点)，由版心尺寸划分逻辑页面为三个可排版的区域：页眉、版心、页脚，并对它们分别建立坐标系，这些坐标系的原点、X轴和Y轴的方向如图1所示。各个区域内的公文要素显现对象只在各自区域内排放，用各自的坐标系对他们进行定位操作。</p>
    <p>[0077]	b)公文要素显现对象的队列</p>
    <p>[0078]	公文要素显现对象的种类有：文字、表格、图形和图像四种。表格包含表行和单元格。</p>
    <p>[0079]	一个显现对象可为一个公文要素，也可以由几个公文要素组成；如：表格对象就可以包含多个公文要素。</p>
    <p>[0080]	显现对象和单元格都可以有一个标识符，标识他们所对应的公文要素。通过这些标识符就可以设置显现对象的内容信息、从显现对象中获取指定的公文要素的内容数据，有利于公文数据的处理和利用。</p>
    <p>[0081]	对一类公文，按三个排版区域，定义每个区域所包含的显现对象。对于页眉、页脚中的显现对象可进一步指定它所在的页面是首页、单页、双页或尾页；对版心中的对象，可按公文中包含的公文要素顺序依次定义所需要的公文要素显现对象。一个文种所定义的公文页面要素显现对象及其次序可以被保存在一个计算机文件中。由这个有次序的公文页面要素显现对象的定义形成公文要素显现对象的队列，按排版区域分别处理，最多可有三个队列。</p>
    <p>[0082]	c)要素显现对象的定位点</p>
    <p>[0083]	定位显现对象，主要就是确定显示对象被放置的位置，为了精确定位，本发明只使用一个点来进行定位，这个点简称定位点。</p>
    <p>[0084]	d)要素显现对象的定位类型</p>
    <p>[0085]	描述定位点的方式为定位类型。</p>
    <p>[0086]	定位类型有：绝对、相对二种。</p>
    <p>[0087]	绝对：以对象所在的排版区域为参考。</p>
    <p>[0088]	相对：以被定位对象的前一个对象为参考，进行定位。</p>
    <p>[0089]	e)要素显现对象的对齐方式</p>
    <p>[0090]	对齐就是由参考对象，通过对齐处理，确定定位点坐标的过程。</p>
    <p>[0091]	对齐方式为可选项，可以没有。可以在水平方向或竖直方向上可单独进行对齐，也可以在这两个方向都进行对齐。</p>
    <p>[0092]	在水平方向的对齐方式分为：左对齐、中对齐、右对齐；</p>
    <p>[0093]	在竖直方向的对齐方式分为：上对齐、中对齐、下对齐；</p>
    <p>[0094]	由水平方向、竖直方向上的对齐方式和参考对象所在的区域，分别确定定位点X、Y坐标。例如：左对齐、上对齐，则定位点就是参考对象左上角点。</p>
    <p>[0095]	f)要素显现对象的位置坐标[0096]	通过位置坐标也可以确定定位点的坐标。它也是�个可选项，X、Y坐标同样可以</p>
    <p>单独设置。</p>
    <p>[0097]	由定位类型、对齐方式和位置坐标就能唯一地确定定位点的坐标，其中定位类型是必选项，而对齐方式和位置坐标这两个是可选项，但必须至少定义其中的�个，不能两个都没有定义。定位时、采用水平方向、竖直方向分别独立处理的办法，它们之间没有影响。</p>
    <p>[0098]	位置坐标的含义和定位类型、对齐方式的有无有夫。具体含义如下：</p>
    <p>[0099]	绝对、无对齐时，位置坐标为对应排版区域坐标系的坐标；</p>
    <p>[0100]	相对、无对齐时，位置坐标为&#21443;考对象的相对坐标；X坐标为负，在&#21443;考对象左侧X&#21336;位处，X坐标为正，在&#21443;考对象右侧X单位处；Y坐标为负，在&#21443;考对象上方Y&#21336;位处，Y坐标为正，在&#21443;考对象下方Y单位处；</p>
    <p>[0101]	有对齐，位置坐标仅为偏移坐标，对对齐后的定位点进行偏移操作。</p>
    <p>[0102]	g)要素显现对象的基点</p>
    <p>[0103]	公文要素显现对象一般都占据�块区域，为了准确地定位�个显现对象，采用在对象选取�个点，使这个点和前面确定的定位点重合，这个点称为“基点”。</p>
    <p>[0104]	排放显现对象&#21515;，显现对象没有旋转，也没有放大和&#32302;小，当我们把对象的基点放在定位点处，也就确定了排放显现在页面中的站位，这样也就在页面中排放�个公文要素显现对象。 </p>
    <p>[0105]	要素显现对象占据的区域都为矩形，由矩形的九宫位点来表示基点，可简化基点的设置，并能满足公文格式的需要，同时使得排放公文要素显示对象变得非常方便。九宫位点，其定义为：左上、中上、右上；左中、中中、中右；左下、中下、右下，如图2所示。</p>
    <p>[0106]	h)要素显现对象的大小</p>
    <p>[0107]	通过定义公文要素显现对象的宽和高来规定对象的大小。定义方式有ニ种：数值和自适应。定义宽、高时，可以分别、独立地使用这ニ种方式。</p>
    <p>[0108]	使用“数值”来定义的宽和高时，可选用计量&#21336;位有：字、行、磅、毫米、厘米、英寸</p>
    <p>坐寸o</p>
    <p>[0109]	使用“自适应”来定义的宽和高时，是由计算公文要素的内容所占区域来动态设置显现对象的宽或高。</p>
    <p>[0110]	i)要素显现对象精确定位的过程，如图3所示：</p>
    <p>[0111]	(I)由页面设置信息建立页眉、版心、页脚这三个排版区域的逻辑坐标系，Sll0</p>
    <p>[0112]	(2)解析包含公文要素显现对象定义的计算机文件S121，建立版心中的公文要素显现对象队列，如果其中定义了页眉、页脚对象，还分别建立页眉、页脚中的显现对象队列，S122。版心中的显现对象依次在页面中排放、并会自动向后页流动。流动是整个对象进行流动的方式，而不是内容数据进行流动的方式。页眉、页脚对象不流动，仅在对应的排版区域内排版。</p>
    <p>[0113]	(3)如图4所示，选取版心显现对象队列为当前排版对象队列S21，版心坐标系为当前坐标系S22，版心所占区域为当前排版区域S23，对象为流动排放方式S24。进入定位对象队列的子过程出），定位版心显现对象队列S13，子过程结束后，进入（4)。</p>
    <p>[0114]	(4)如图5所示，如果有页眉显现对象队列，选取该队列为当前排版对象队列，在页眉坐标系中，页眉所占区域为当前排版区域。对象为不流动排放方式。进入定位对象队列的子过程（6)，定位页眉显现对象队列S14，子过程结束后，进入（5);如果没有页眉显现对象队列，直接进入（5)；</p>
    <p>[0115]	(5)如图6所示，如果有页脚显现对象队列，选取该队列为当前排版对象队列，在页脚坐标系中，页脚所占区域为当前排版区域。对象为不流动排放方式。进入定位对象队列的子过程（6)，定位页脚显现对象队列S15，子过程结束后，结束整篇公文的排版；如果没有页脚显现对象队列，直接结束整篇公文的排版。</p>
    <p>[0116]	(6)定位对象队列的子过程，如图7、图8所示：</p>
    <p>[0117]	i)初始化当前页面序号为0 ;</p>
    <p>[0118]	ii)从当前排版对象队列中，依次选取�个公文要素显示对象为当前排版对象。选取到一个对象就执行下一&#27497;；选取不到，则队列中已没有要排版的对象，结束该子过程。</p>
    <p>[0119]	iii)确定当前排版对象的定位点。</p>
    <p>[0120]	I)取得当前排版对象的定位类型；</p>
    <p>[0121]	2)取得当前排版对象的对齐方式；</p>
    <p>[0122]	3)取得当前排版对象的位置坐标；</p>
    <p>[0123]	4)由水平方向的定位类型、对齐方式和位置坐标，可确定定位点的X坐标。方法如下：</p>
    <p>[0124]	确定水平方向的&#21443;考范围：水平方向定位类型为绝对时，取当前排版区域水平方向的范围；为相对时，在当前队列中找到当前对象的前一个对象（队列中的第一个对象不能定义为相对），取前一个对象所占据区域水平方向的范围。</p>
    <p>[0125]	水平方向有对齐：先进行对齐，由对齐方式在水平方向的&#21443;考范围上找到对齐值，左对齐就选左侧值，中对齐就选中间值，右对齐就选右侧值；如果定义了水平方向的位置坐标，对齐值加上位置坐标的X坐标后为定位点的X坐标；没有定义水平方向的位置坐标,对齐值就为定位点的X坐标；</p>
    <p>[0126]	水平方向无对齐时：水平方向定位类型为绝对时，位置坐标的X坐标就为定位点的X坐标；为相对时,位置坐标的X坐标为负时,&#21443;考范围左侧值加上位置坐标的X坐标（包括负号）的结果为定位点的X坐标；位置坐标的X坐标为正时,&#21443;考范围右侧值加上位置坐标的X坐标的结果为定位点的X坐标。</p>
    <p>[0127]	5)确定定位点的Y坐标，和确定X坐标方法几乎相同，不同是把左替换为上，右替换为下，水平替换为竖直，X替换为Y ;定位类型为相对时，&#22679;加前一个对象在当前页的前一页的情况，即前一个对象和当前对象不在同一页上，而无法进行竖直方向的对齐和偏移，只好设置定位点的Y坐标为0 ;</p>
    <p>[0128]	iv)确定当前排版对象的可排区域；</p>
    <p>[0129]	I)取得当前排版对象的基点；</p>
    <p>[0130]	2)使基点的坐标等于定位点的坐标；</p>
    <p>[0131]	3)由当前排版区域、当前排版对象的基点，计算当前排版对象的可排区域。在水平方向、竖直方向分别、独立进行计算。</p>
    <p>[0132]	水平方向可排范围，按水平方向基点类型进行分别处理：</p>
    <p>[0133]	左：基点的X坐标到当前排版区域的右侧；</p>
    <p>[0134]	中：在排版区域水平方向内，以基点X坐标为中点的最大范围；[0135]	右：当前排版区域的左侧到基点的X坐标。</p>
    <p>[0136]	竖直方向可排范围，如果基点Y坐标为O时，直接为当前排版区域的高，大于O时，则按竖直方向基点类型进行分别处理：</p>
    <p>[0137]	上：基点的Y坐标到当前排版区域的底边；</p>
    <p>[0138]	中：在排版区域竖直方向内，以基点Y坐标为中点的最大范围；</p>
    <p>[0139]	下：当前排版区域的上边到基点的Y坐标。</p>
    <p>[0140]	V)确定当前排版对象的排版区域；</p>
    <p>[0141]	I)确定水平方向排版范围：取得当前排版对象定义的宽，其定义方式有“数值”和“自适应”二种；具体计算分别如下：</p>
    <p>[0142]	数值：取定义宽度和水平方向可排范围值的较小值为水平方向的排版范围；</p>
    <p>[0143]自适应：水平方向可排范围为水平方向排版范围。</p>
    <p>[0144]	2)确定竖直方向排版范围：取得当前排版对象定义的高，由高定义方式计算出排版范围，计算方法和水平时相同。</p>
    <p>[0145]	3)设置对象的排版状态：对象为流动排放方式、且数值方式定义的高度大于竖直方向可排范围值时，设置对象的排版状态为不可排放状态，其他为可排放状态。</p>
    <p>[0146]	vi)当前排版对象在它自己的排版区域内进行排版，即排版的内容被约束排版区域内。按对象类型分别进行处理；</p>
    <p>[0147]	I)文字显现对象：采用已经成熟的流式排版技术把文字排放在排版区域内。如果有文字不能排放时，把不能排的文字作为遗留文字。当对象为流动排放方式，且对象的高为自适应时，当有遗留文字，则新生成一个文字显现对象，在当前对象后面加入到当前排版对象队列中。新产生对象的竖直方向属性为：绝对、无对齐、坐标为O、高度为自适应，基点为上；水平方向属性为：相对、左对齐、坐标为O、宽度同当前对象，基点为左；从当前对象中取出遗留文字并放置到新建对象中。并标记后续对象要在下页排版。</p>
    <p>[0148]	2)表格显现对象：以表行为单位，依次排版表行中单元格。如果单元格中有文字不能排放，不能排放的文字就作为单元格遗留文字。当对象为流动排放方式，且对象的高为自适应时，如果单元格有遗留文字，就设置对象的排版状态为不可排放状态。表格作整体流动，不做拆分。</p>
    <p>[0149]	3)图形显现对象：排放图形中的几何点。当对象为流动排放方式，且对象的高为自适应时，如果有点在竖直方向上超出排版区域，就设置对象的排版状态为不可排放状态。图形作整体流动，不做拆分。</p>
    <p>[0150]	4)图像显现对象：排放图像，且对象的高为自适应时，如果图像高度超出排版区域，就设置对象的排版状态为不可排放状态。图像作整体流动，不做拆分。</p>
    <p>[0151]	vii)确定当前排版对象的实际大小。水平方向、竖直方向分别处理，数值定义的宽、闻，就是实际的宽、闻；自适应定义的宽、闻，对象中的内容所占的宽、闻就是实际的宽、闻;</p>
    <p>[0152]	viii)如果当前对象为未排放状态，则需要进一步判断是否要在当前页上排放它。如果当前页上没有一个已排放的块时，即使当前对象在当前页上不能排放，也只好无条件把它设为可排放状态；</p>
    <p>[0153]	ix)对可排放状态的当前对象，则要设置它的占位区域；由基点坐标和对象的实际大小就可以算出占位区域；</p>
    <p>[0154]	x)对可排放的当前对象进行页面序号的设置。页面序号为当前页面序号。</p>
    <p>[0155]	xi)如果当前对象为未排放状态或有后续对象要在下页排版的标记时，当前页面序号加I。</p>
    <p>[0156]	xii)如果当前对象为未排放状态，回到步骤（iii)，重排当前对象；如果当前对象为可排放状态，回到步骤（ii)，排版下一个对象。</p>
    <p>[0157]	j)要素显现对象的屏幕显示和打印</p>
    <p>[0158]	精确定位要素显现对象后，就可以进行显示和打印。</p>
    <p>[0159]	由输出设备（显示器、打印机）建立输出设备、按公文的页面进行显示和打印。输出时，分别输出页眉、版心、页脚中的显示对象，要设置相应的逻辑坐标系和设备坐标系映射关系，由输出页面的序号，确定输出内容，进行输出操作。</p>
    <p>[0160]	如图9a、9b所示，图9a、9b给出一个公文示例，并标记了各个公文要素的位置参数。</p>
    <p>[0161]	通用公文在页眉区域一般没有的显示对象，特殊的可以是单位的logo ;在页脚区域一般有页码、公文条码等显示对象；版心区域为公文页面要素显示对象，如：密级91、标题92、主送机关93等页面要素。</p>
    <p>[0162]	公文页面对象的精确定位主要就是版心区域中显示对象的定位。结合图9就“主送机关”显示对象的定位进行简要描述：</p>
    <p>[0163]	“标题”92显示对象被定位后，就要定位“主送机关”93显示对象。由它的位置属性可确定它的定位点的X坐标为0，Y坐标为标题对象底边下方一行的值I ;可排区域为：x方向0-28字，Y方向y-版心底；排版区域等于可排区域；在排版区域内对主送机关的内容进行排版，得到内容实际所占的矩形区域，确定它的基点坐标，对该矩形区域进行移动，使基点和定位点重合后所得到的矩形区域就是“主送机关”显示对象在页面中占位区域。</p>
    <p>[0164]	由上可看出一个对象的占位区域是由它的位置参数定义所确定的，使用适当的逻辑单位（一般高于输出设备，如：打印机）可以使位置参数具有很高的精确度，使用精准的值描述页面中显示对象，从而在页面中实现精确定位。</p>
    <p>[0165]	本发明所述的方法和系统并不限于具体实施方式中所述的实施例，本领域技术人员根据本发明的技术方案得出其他的实施方式，同样属于本发明的技术创新范围。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN1828517A?cl=zh">CN1828517A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2006年2月28日</td><td class="patent-data-table-td patent-date-value">2006年9月6日</td><td class="patent-data-table-td ">佳能株式会社</td><td class="patent-data-table-td ">文档处理装置和文档处理方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN1936882A?cl=zh">CN1936882A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2006年10月13日</td><td class="patent-data-table-td patent-date-value">2007年3月28日</td><td class="patent-data-table-td ">北京北大方正电子有限公司</td><td class="patent-data-table-td ">一种分页表格的数据处理方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101443790A?cl=zh">CN101443790A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年3月22日</td><td class="patent-data-table-td patent-date-value">2009年5月27日</td><td class="patent-data-table-td ">亚马逊科技公司</td><td class="patent-data-table-td ">数字图像中的非回流内容的有效处理</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101872340A?cl=zh">CN101872340A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2009年4月23日</td><td class="patent-data-table-td patent-date-value">2010年10月27日</td><td class="patent-data-table-td ">北京大学;北大方正集团有限公司;北京方正电子政务信息科技有限公司</td><td class="patent-data-table-td ">一种基于版面格式模板的排版方法及装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101989256A?cl=zh">CN101989256A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2009年7月31日</td><td class="patent-data-table-td patent-date-value">2011年3月23日</td><td class="patent-data-table-td ">北京大学;北大方正集团有限公司;北京方正电子政务信息科技有限公司</td><td class="patent-data-table-td ">一种文书文件的排版方法及装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102147791A?cl=zh">CN102147791A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年4月2日</td><td class="patent-data-table-td patent-date-value">2011年8月10日</td><td class="patent-data-table-td ">数字时代出版设计有限公司</td><td class="patent-data-table-td ">一种图书自动排版方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="https://www.google.com/url?id=pL7vBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DJP%26NR%3D2000250904A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNHNwzxpMpwB73A9z9cdgw_bBdxHnA">JP2000250904A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td "> </td><td class="patent-data-table-td citation-no-title">没有名称</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=pL7vBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=G06F0017250000">G06F17/25</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2013年4月10日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年7月17日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2015年12月16日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Grant of patent or utility model</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/7e4acd0b2da184f98aec/CN103034624A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_50a6672b5f82ffbd39b7a9e87fd4594c.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E9%A1%B5%E9%9D%A2%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%B2%BE%E7%A1%AE%E5%AE%9A%E4%BD%8D%E6%96%B9%E6%B3%95.pdf?id=pL7vBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U0eO9o-8SEH7rHQFrjMe-1zYSlfnA"},"sample_url":"https://www.google.com/patents/reader?id=pL7vBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>