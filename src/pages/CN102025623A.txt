<!DOCTYPE html><html><head><title>专利 CN102025623A - 智能化网络流控方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_50a6672b5f82ffbd39b7a9e87fd4594c/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_50a6672b5f82ffbd39b7a9e87fd4594c__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="智能化网络流控方法"><meta name="DC.contributor" content="王俊华" scheme="inventor"><meta name="DC.contributor" content="胡斌" scheme="inventor"><meta name="DC.contributor" content="苏州迈科网络安全技术股份有限公司" scheme="assignee"><meta name="DC.date" content="2010-12-7" scheme="dateSubmitted"><meta name="DC.description" content="本发明提供了一种智能化网络流控方法，通过AOS设备的DPI深层包检测引擎以及防火墙(Firewall)引擎，对每个进入和流出的数据包进行识别和标识，以确定其所属的内网用户以及应用类型等，这些应用类型可以为P2P、HTTP、迅雷、BT等，然后将这些数据包归类，分别放入不同应用类型下各用户专属的缓存区中暂时缓存，最后按照一定的带宽控制策略将这些数据包逐步发送出去。本发明是一种有别于传统流控方式、全新的、立体的、交叉的流控方法，为客户提供带宽管理、分析和优化的一体化解决方案，能够有效的检测和防止不正常应用对网络带宽资源的非正常消耗，保证关键应用带宽，限制非业务应用带宽，改善和保障了整体网络应用的服务质量。"><meta name="DC.date" content="2011-4-20"><meta name="DC.relation" content="CN:101605067:A" scheme="references"><meta name="DC.relation" content="CN:101645806:A" scheme="references"><meta name="DC.relation" content="CN:101741744:A" scheme="references"><meta name="DC.relation" content="WO:2009089701:A1" scheme="references"><meta name="citation_patent_publication_number" content="CN:102025623:A"><meta name="citation_patent_application_number" content="CN:201010576729"><link rel="canonical" href="https://www.google.com/patents/CN102025623A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN102025623A?cl=zh"/><meta name="title" content="专利 CN102025623A - 智能化网络流控方法"/><meta name="description" content="本发明提供了一种智能化网络流控方法，通过AOS设备的DPI深层包检测引擎以及防火墙(Firewall)引擎，对每个进入和流出的数据包进行识别和标识，以确定其所属的内网用户以及应用类型等，这些应用类型可以为P2P、HTTP、迅雷、BT等，然后将这些数据包归类，分别放入不同应用类型下各用户专属的缓存区中暂时缓存，最后按照一定的带宽控制策略将这些数据包逐步发送出去。本发明是一种有别于传统流控方式、全新的、立体的、交叉的流控方法，为客户提供带宽管理、分析和优化的一体化解决方案，能够有效的检测和防止不正常应用对网络带宽资源的非正常消耗，保证关键应用带宽，限制非业务应用带宽，改善和保障了整体网络应用的服务质量。"/><meta property="og:title" content="专利 CN102025623A - 智能化网络流控方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN102025623A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN102025623A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=dxFyBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN102025623A&amp;usg=AFQjCNEu6_Y86AARlR7MGL8hHHme8-9G_A" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/810d62b013c87c4fa333/CN102025623A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/810d62b013c87c4fa333/CN102025623A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN102025623A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN102025623A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN102025623A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN102025623B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN102025623A?cl=zh" style="display:none"><span itemprop="description">本发明提供了一种智能化网络流控方法，通过AOS设备的DPI深层包检测引擎以及防火墙(Firewall)引擎，对每个进入和流出的数据包进行识别和标识，以确定其所属的内网用户以及应用类型等，这些应用类型可以为P2P、HTTP、迅雷、BT ...</span><span itemprop="url">https://www.google.com/patents/CN102025623A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN102025623A - 智能化网络流控方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN102025623A - 智能化网络流控方法" title="专利 CN102025623A - 智能化网络流控方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN102025623 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201010576729</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2011年4月20日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2010年12月7日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2010年12月7日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102025623B?hl=zh-CN&amp;cl=zh">CN102025623B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201010576729.5, </span><span class="patent-bibdata-value">CN 102025623 A, </span><span class="patent-bibdata-value">CN 102025623A, </span><span class="patent-bibdata-value">CN 201010576729, </span><span class="patent-bibdata-value">CN-A-102025623, </span><span class="patent-bibdata-value">CN102025623 A, </span><span class="patent-bibdata-value">CN102025623A, </span><span class="patent-bibdata-value">CN201010576729, </span><span class="patent-bibdata-value">CN201010576729.5</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%8E%8B%E4%BF%8A%E5%8D%8E%22">王俊华</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E8%83%A1%E6%96%8C%22">胡斌</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E8%8B%8F%E5%B7%9E%E8%BF%88%E7%A7%91%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E6%9C%AF%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">苏州迈科网络安全技术股份有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102025623A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102025623A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102025623A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (4),</span> <span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (7),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (3),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=dxFyBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201010576729&amp;usg=AFQjCNFeymf6_XMlvJgBD8NNofRRS7pm8g"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=dxFyBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D102025623A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNH8lE0PEIi6-SuID4N9SA5jQcRxgw"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT102618088" lang="ZH" load-source="patent-office">智能化网络流控方法</invention-title>
      </span><br><span class="patent-number">CN 102025623 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA84537014" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明提供了一种智能化网络流控方法，通过AOS设备的DPI深层包检测引擎以及防火墙(Firewall)引擎，对每个进入和流出的数据包进行识别和标识，以确定其所属的内网用户以及应用类型等，这些应用类型可以为P2P、HTTP、迅雷、BT等，然后将这些数据包归类，分别放入不同应用类型下各用户专属的缓存区中暂时缓存，最后按照一定的带宽控制策略将这些数据包逐步发送出去。本发明是一种有别于传统流控方式、全新的、立体的、交叉的流控方法，为客户提供带宽管理、分析和优化的一体化解决方案，能够有效的检测和防止不正常应用对网络带宽资源的非正常消耗，保证关键应用带宽，限制非业务应用带宽，改善和保障了整体网络应用的服务质量。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(2)</span></span></div><div class="patent-text"><div mxw-id="PCLM35653594" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.	一种智能化网络流控方法，其特征在于：该方法包括如下步骤，步骤一：由AOS设备的DPI深层包检测引擎以及防火墙（Firewall)弓丨擎，记录每个 数据包所属的链路号以及流动方向；步骤二 ：识别出每个流出数据包来自的内网用户或者内网IP地址，以及每个流出数 据包发往的目的内网用户或者内网IP地址，并为每个连接建立一个连接状态追踪信息， 并根据包的分类有区别的选择丢弃和入队；步骤三：采用DPI深层包检测引擎以及DFI深度流检测技术，标识出每个数据包所 属的应用类型；步骤四：基于以上步骤标识的信息，对每个数据包进行分类，并按照分类将每个数 据包放入各个缓存区中，等待发送；步骤五：由调度器结合控制策略负责将这些缓存的网络数据包，按照用户事先配置 的带宽和优先级控制策略发送出去。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.根据权利要求1所述的智能化网络流控方法，其特征在于：所述步骤五中控制策 略包括CAR令牌算法、RED随机尾部丢弃、DRR亏空轮询、优先级排序策略，所述策 略为能实现4级交叉立体的带宽控制策略。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES41440912" lang="ZH" load-source="patent-office" class="description">
    <p>智能化网络流控方法技术领域[0001]	本发明涉及一种对网络数据流量进行智能化控制的新方法，尤其涉及一种对有 限的带宽资源进行多层次、立体交叉控制和分配的方法。背景技术[0002]	随着互联网的高速发展，IP网络承载的数据流量越来越大，尤其是近年来迅速 崛起的各种P2P的下载软件和在线视频，给网络系统的正常运行带来了一系列的问题， 其中最突出的是由网络流量过大引发的网络拥塞。与此同时，互联网提供的服务日益多 样化和复杂化，对网络流量进行智能化的控制显得日益重要。如果流量超过网络的负载 能力，将会导致网络性能严重下降。网络流量的调度问题，也会直接影响网络性能，网 络局部的突发流量很容易导致网络整体性能的下降，而网络中不同业务流对资源的占用 不同，也会导致少数应用流耗用大部分网络带宽的情况，严重影响网络资源的利用率。 因此，合理的流量控制策略显得尤为重要，我们要解决的问题不仅仅是发生拥塞如何去 及时响应，更重要的是要制定合理的控制策略，避免拥塞的发生，并最大限度的利用资 源。有效的管理和控制特定的业务流将对网络性能提高有着非常直接的意义。根据业务 特性对网络流量的合理调度还能够降低单位带宽的投资成本，同时，对流量的合理控制 也是满足QoS要求的前提。发明内容[0003]	本发明的目的在于解决上述的技术问题，提供一种智能化网络流控方法。[0004]	本发明的目的通过以下技术方案来实现：[0005]	一种智能化网络流控方法，其中该方法包括如下步骤，[0006]	步骤一：由AOS设备的DPI深层包检测引擎以及防火墙（Firewall)弓丨擎，记录每个数据包所属的链路号以及流动方向；[0007]	步骤二 ：识别出每个流出数据包来自的内网用户或者内网IP地址，以及每个流 出数据包发往的目的内网用户或者内网IP地址，并为每个连接建立一个连接状态追踪信 息，并根据包的分类有区别的选择丢弃和入队；[0008]	步骤三：采用DPI深层包检测引擎以及DFI深度流检测技术，标识出每个数据 包所属的应用类型；[0009]	步骤四：基于以上步骤标识的信息，对每个数据包进行分类，并按照分类将每 个数据包放入各个缓存区中，等待发送；[0010]	步骤五：由调度器结合控制策略负责将这些缓存的网络数据包，按照用户事先 配置的带宽和优先级控制策略发送出去。[0011]	进一步地，以上所述的智能化网络流控方法，其中所述步骤五中控制策略包括 CAR令牌算法、RED随机尾部丢弃、DRR亏空轮询、优先级排序策略，所述策略为能实 现4级交叉立体的带宽控制策略。[0012]	本发明提供了一种有别于传统流控方式、全新的、立体的、交叉的流控方法， 可以为网络链路划分多个虚拟带宽通道，能够实现最大带宽限制、保证带宽、带宽租 借、应用优先级、Per-IP带宽控制、Per-Net带宽控制、随机公平队列等一系列带宽管理 功能，为客户提供带宽管理、分析和优化的一体化解决方案，能够有效的检测和防止不 正常应用对网络带宽资源的非正常消耗，保证关键应用带宽，限制非业务应用带宽，改 善和保障了整体网络应用的服务质量。附图说明[0013]	下面结合附图对本发明技术方案作进一步说明：[0014]	图1 ：智能化网络流控系统的应用模型。[0015]	图2 ：本发明的具体实施方式中，对于Per-IP/Per-User模式的流控模型逻辑划 分说明。[0016]	图3:本发明的具体实施方式中，对于Normal模式的流控模型逻辑划分说明。 具体实施方式[0017]	本发明是通过AOS设备的DPI深层包检测引擎以及防火墙（Firewall)引擎，对 每个进入和流出的数据包进行识别和标识，以确定其所属的内网用户以及应用类型等， 这些应用类型可以为P2P、HTTP、迅雷、BT等，然后将这些数据包归类，分别放入不同 应用类型下各用户专属的缓存区中暂时缓存，最后按照一定的带宽控制策略将这些数据 包逐步发送出去。[0018]本发明涉及的关键技术有	DPI、DFK CAR (Committed access rate)、Deficit round robin (DRR)、Random early detection (RED)等流控技术。[0019]	本发明揭示了一种智能化网络流控方法，其具体过程包括：[0020]	首先，本发明需要阐明如下相关概念： [0021 ] Virtual Channel 简称 VC[0022]	一条虚拟链路（确定的Line ID，在非对称流量的情况下，可能多条物理链路是 一条虚拟链路）可以拥有独立的VC配置。VC和网络数据包的应用类型密切相关，一种 或者几种类似的网络应用类型可以划分为一个VC，VC是系统中最底层的节点类型。[0023]	VC拥有的属性包括：VC的类别（NONE/PER-HOST/PER-USER)、保证带 宽、最大带宽、Shared带宽。[0024]	Pipe[0025]	Pipe是定义在VC之上的一个一定数量VC的集合。是为了体现立体的流量控 制而引入的概念，以满足用户希望对某几种业务类型同时加以控制和约束的需求。一个 VC只能属于一个确定的Pipe。[0026]	Pipe 拥有的属性包括：Pipe 的类别（NONE/PER-HOST/PER-USER)、保证带 宽、最大带宽、Shared带宽[0027]	SharedVC[0028]	劝ared VC是定义在Pipe之下、VC之上的一个一定数量VC的集合。是为了体现交叉的流量控制而引入的概念，以满足用户希望某几种业务类型之间进行带宽资源的竞争使用的需求。一个SharedVC也只能属于一个确定的Pipe。[0029]	Shared VC 拥有的属性包括：Shared 的类别（NONE/PER-HOST/PER-USER)、最大带宽[0030]	Shared Pipe[0031]	Shared Pipe是定义在Pipe之上的一定数量的Pipe的集合。是为了体现更高层次的立体、交叉流控特性而引入的概念。Shared Pipe是最顶级的控制节点，可以跨越物理 的链路、网络应用而存在。[0032]	Shared Pipe 拥有的属性包括：Shared 的类别（NONE/PER-HOST/PER-USER)、最大带宽[0033]	Per-Flow Queue-PFQ[0034]	Per-Flow Queue简称PFQ，用户的每条连接Mtate)对应一个独立的PFQ，一个 PFQ 中包含两个 Queue-Inbound PFQ 和 Outbound PFQ。Flow 中的 Inbound 报文，进入 Inbound PFQ 中，Flow 中的 Outbound 报文，进入 Outbound PFQ 中。[0035]	PFQ的队列长度可以定义，每个Virtual Channel(简称VC)可以单独定义这个VC中的PFQ的队列长度，队列长度可以分为Inbound队列长度和Outbound队列长度，可以分别控制。[0036]	当PFQ的队列长度达到一定的限制时，会根据配置情况有选择性的使用Random Early Detection (简称RED)算法来进行随机尾部或者头部丢弃报文。PFQ的RED可以自 定义，每个VC可以定义是否启用VC中的PFQ的RED，RED可以分Inbound和Outbound分别控制。RED算法采用标准RED算法。[0037]	本发明中，在每个链路和每个输入输出方向上，都有单独的配置，用户可以根 据需要，在每个链路和每个输入输出方向上做如上最多4层的交叉带宽控制策略，让用 户对网络的控制更加的精细化。[0038]	首先，对于每个进入系统的网络数据包，依据其来自的物理端口，打上链路ID 号和输入输出方向标签，为网络数据包的分类做好第一步准备。[0039]	基于DPI深层包检测引擎以及DFI深度流检测技术，识别出每个数据包所属的应 用类型（比如P2P、HTTP、迅雷、BT等），然后为每个网络数据包打上VC的ID号。[0040]	根据链路ID号、输入输出方向、VC号，找到该网络数据包所属的虚拟通 道-VC，并根据状态跟踪模块的信息，找到其对应的PFQ队列号，将该网络数据包放入 相应的PFQ队列等待发送。如果VC是Normal属性的，即：不区分各个用户统一控制 总体带宽，则将该报文放入VC下属的PFQ队列中；如果VC是Per-Host或者:Per_User 属性的，即：按照每个用户或者IP地址放入VC下相应的动态通道的PFQ队列中。[0041]	由于任何PFQ队列能够容纳的网络数据包的个数是有限的，因此，当PFQ队列 中网络数据包的个数达到一定的数量阀值时，就需要对新进入的网络数据包进行限制， 丢弃一部分网络数据包。本发明采用了 Randomearlydetection(RED)算法，即：随机尾 部丢弃策略。与传统的尾部丢弃策略相比，RED算法可以有效的避免TCP连接的全局同 步问题，使得网络数据流更加的平滑。[0042]	入包完成之后，接下来由调度器将PFQ中缓存的网络数据包发送出去。[0043]	调度器的主要任务是通过各种控制策略，从缓存区中选取一个最优先发送的网络数据包发送出去，其所涉及的主要技术和控制策略如下所述：[0044]	对于Normal属性的VC节点，所有属于该VC的网络数据包，无论其来源于或者 发往哪个内网用户，都采用统一的带宽控制策略。而对于Per属性的VC节点，是由VC 下属的每个内网用户专属的各动态通道配置的带宽控制策略来进行控制的。VC节点或者 动态通道的带宽采用前述的CAR(发送令牌）的方式来控制，本发明的方法同时支持单速 三色CAR计算方式和双速三色CAR计算方式。[0045]	每个节点或者动态通道，每次发送出一个网络数据包之后，都要通过CAR计算 来确定其颜色：Green(绿色）代表其目前的带宽消耗尚在保证带宽之内；Yellow(黄色） 代表其目前的带宽消耗已经超出了其配置的保证带宽，但尚在其最大带宽之内；Red(红 色）代表其目前的带宽消耗已经超出了其最大带宽的限制。绿色的通道是被安排优先发 送的，而黄色的通道只有在绿色的通道都发送完毕之后，才被允许发送；而红色的通道 是不能够发送数据包的。[0046]	每个通道发送完一个网络数据包之后，除了要计算本身的CAR之外，为了体 现立体交叉的多层次的带宽控制，还需要依次计算其各个父通道的CAR。例如，一个 Normal属性的VC节点发送出一个网络数据包之后，有可能还要依次计算其Normal属性 的Shared VC、Pipe、Shared Pipe各父节点的CAR，以确定其各个父节点的颜色。任何 一个父节点颜色的变迁都将影响到处于最底层的通道的网络数据包的发送。因为调度器 是从最上层的父节点开始寻找最优先发送的通道，如果父节点的颜色级别降低，则调度 器有可能选不中其父节点，进而不会选择到其下属的子通道。[0047]	一个Pipe节点下，会有多个VC通道，很有可能在同一时间，有多个VC通道处于绿色，即这些VC通道的带宽消耗都没有达到其保证带宽，都应该被允许发送数据包。 为了能够选出最应该优先发送的VC，每个VC都配置有优先级参数，优先级最高的VC， 将被优先安排发送。同时，为了保证同优先级之间的VC可以得到公平的发送机会，以 及为了防止高优先级的VC &#8212;直抢占低优先级VC的发送机会，从而导致低优先级的VC 一直得到不到发送机会而处于“饥饿”状态，本发明引入了 Deficitmundr0Wn(DRR)亏 空轮循机制，即：每个VC通道都配置有每次可以连续发送的最大字节数（配额），一旦 达到了其配额，将会切换到下一个VC，并且重新填满该VC的发送配额。[0048]	为了达到带宽控制的目的，该发明每次发送完一个网络数据包，都会对各个通 道进行CAR发送令牌的填充，为了提供系统运行的效率，令牌的填充被限制在一定的时 间间隔内，只有达到了这个时间间隔，才进行令牌的计算和填充，以避免不必要的令牌 填充，消耗系统的CPU资源。因此，本发明引入了 CARRefill链表概念，只有符合条件 的通道才被放入该链表，并且该链表采用FIFO的策略，对链表中的各个通道按照令牌填 充时间进行排序，最需要填充的通道排在链表的最前端。[0049]	如图1示意了该发明在用户现场实际应用时的示意图。整套系统以DPI和DFI 技术为核心，结合带宽自动分配算法、令牌桶算法、随机公平队列等技术，能够全面识 别和控制包括P2P、VoIP、视频/流媒体、HTTP、网络游戏、炒股软件、数据库等在内 的多种应用，提供虚拟带宽通道划分、最大带宽限制、保证带宽、带宽租借、应用优先 级、Per-IP带宽控制、Per-Net带宽控制、随机公平队列等一系列带宽管理功能。[0050]	如图2示意了该发明对于四级Per属性限速控制的内部实现逻辑，体现了立体交叉的流控技术。[0051]	如图3示意了该发明对于四级Normal属性限速控制的内部实现逻辑，体现了立 体交叉的流控技术。[0052]	本发明将在一定网络环境下，为用户提供主动式的、智能化的、可视化的带宽 管理服务，达到可视、可测、可控、可优化的管理目标，为带宽优化与管控、网络规划 提供科学的依据。[0053]	本发明尚有多种具体的实施方式，凡采用等同替换或者等效变换而形成的所有 技术方案，均落在本发明要求保护的范围之内。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101605067A?cl=zh">CN101605067A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2009年4月22日</td><td class="patent-data-table-td patent-date-value">2009年12月16日</td><td class="patent-data-table-td ">网经科技（苏州）有限公司</td><td class="patent-data-table-td ">网络行为主动分析诊断方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101645806A?cl=zh">CN101645806A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2009年9月4日</td><td class="patent-data-table-td patent-date-value">2010年2月10日</td><td class="patent-data-table-td ">东南大学</td><td class="patent-data-table-td ">Dpi和dfi相结合的网络流量分类系统及分类方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101741744A?cl=zh">CN101741744A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2009年12月17日</td><td class="patent-data-table-td patent-date-value">2010年6月16日</td><td class="patent-data-table-td ">东南大学</td><td class="patent-data-table-td ">一种网络流量识别方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2009089701A1?cl=zh">WO2009089701A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2008年9月25日</td><td class="patent-data-table-td patent-date-value">2009年7月23日</td><td class="patent-data-table-td ">Huawei Technologies Co., Ltd.</td><td class="patent-data-table-td ">Procédé et système d&#39;inspection de paquet</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102355422A?cl=zh">CN102355422A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年10月17日</td><td class="patent-data-table-td patent-date-value">2012年2月15日</td><td class="patent-data-table-td ">苏州迈科网络安全技术股份有限公司</td><td class="patent-data-table-td ">多核并行无锁的qos流量控制方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102355422B?cl=zh">CN102355422B</a></td><td class="patent-data-table-td patent-date-value">2011年10月17日</td><td class="patent-data-table-td patent-date-value">2014年7月23日</td><td class="patent-data-table-td ">苏州迈科网络安全技术股份有限公司</td><td class="patent-data-table-td ">多核并行无锁的qos流量控制方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102868638A?cl=zh">CN102868638A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年8月16日</td><td class="patent-data-table-td patent-date-value">2013年1月9日</td><td class="patent-data-table-td ">苏州迈科网络安全技术股份有限公司</td><td class="patent-data-table-td ">动态调整带宽方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102916908A?cl=zh">CN102916908A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年8月2日</td><td class="patent-data-table-td patent-date-value">2013年2月6日</td><td class="patent-data-table-td ">腾讯科技（深圳）有限公司</td><td class="patent-data-table-td ">网络应用中的带宽优化方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103152277A?cl=zh">CN103152277A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年12月7日</td><td class="patent-data-table-td patent-date-value">2013年6月12日</td><td class="patent-data-table-td ">北京网康科技有限公司</td><td class="patent-data-table-td ">一种提高网络流量控制性能的方法及其设备</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103346976A?cl=zh">CN103346976A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年7月10日</td><td class="patent-data-table-td patent-date-value">2013年10月9日</td><td class="patent-data-table-td ">深圳市磊科实业有限公司</td><td class="patent-data-table-td ">一种基于htb的带宽公平控制方法及其实现系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103441947A?cl=zh">CN103441947A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年8月23日</td><td class="patent-data-table-td patent-date-value">2013年12月11日</td><td class="patent-data-table-td ">深信服网络科技（深圳）有限公司</td><td class="patent-data-table-td ">基于桌面虚拟化的流量控制方法及装置</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=dxFyBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0012813000">H04L12/813</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=dxFyBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0012851000">H04L12/851</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=dxFyBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0012823000">H04L12/823</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2011年4月20日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2011年6月8日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年3月20日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Granted</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/810d62b013c87c4fa333/CN102025623A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_50a6672b5f82ffbd39b7a9e87fd4594c.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E6%99%BA%E8%83%BD%E5%8C%96%E7%BD%91%E7%BB%9C%E6%B5%81%E6%8E%A7%E6%96%B9%E6%B3%95.pdf?id=dxFyBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U3uvJWr58qsmtX9XJFNR4tM1f3UoA"},"sample_url":"https://www.google.com/patents/reader?id=dxFyBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>