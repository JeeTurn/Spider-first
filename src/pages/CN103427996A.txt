<!DOCTYPE html><html><head><title>专利 CN103427996A - 一种动态口令牌身份的验证方法及系统 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_50a6672b5f82ffbd39b7a9e87fd4594c/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_50a6672b5f82ffbd39b7a9e87fd4594c__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种动态口令牌身份的验证方法及系统"><meta name="DC.contributor" content="李东声" scheme="inventor"><meta name="DC.contributor" content="天地融科技股份有限公司" scheme="assignee"><meta name="DC.date" content="2013-8-9" scheme="dateSubmitted"><meta name="DC.description" content="本发明公开了一种动态口令牌身份的验证方法及系统，该方法包括：动态口令牌接收身份验证指令，根据第一信息计算第一验证值，并输出第一验证值，其中，第一信息至少包括用于验证动态口令牌身份的第一种子密钥，第一种子密钥是预先设置在动态口令牌中的；动态口令牌对应的验证装置获取第一验证值，对第一验证值进行验证，并在验证完成后，输出验证结果。本发明在动态口令牌中预设用于验证其身份的种子密钥，将至少根据该种子密钥计算的验证值发送到验证装置进行验证，如果该验证值与验证装置中计算的标准验证值一致，则令牌身份合法，否则令牌身份不合法，实现了动态口令牌身份的验证，防止动态口令牌被伪造。"><meta name="DC.date" content="2013-12-4"><meta name="DC.relation" content="CN:101051908:A" scheme="references"><meta name="DC.relation" content="CN:101651675:A" scheme="references"><meta name="citation_patent_publication_number" content="CN:103427996:A"><meta name="citation_patent_application_number" content="CN:201310345514"><link rel="canonical" href="https://www.google.com/patents/CN103427996A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN103427996A?cl=zh"/><meta name="title" content="专利 CN103427996A - 一种动态口令牌身份的验证方法及系统"/><meta name="description" content="本发明公开了一种动态口令牌身份的验证方法及系统，该方法包括：动态口令牌接收身份验证指令，根据第一信息计算第一验证值，并输出第一验证值，其中，第一信息至少包括用于验证动态口令牌身份的第一种子密钥，第一种子密钥是预先设置在动态口令牌中的；动态口令牌对应的验证装置获取第一验证值，对第一验证值进行验证，并在验证完成后，输出验证结果。本发明在动态口令牌中预设用于验证其身份的种子密钥，将至少根据该种子密钥计算的验证值发送到验证装置进行验证，如果该验证值与验证装置中计算的标准验证值一致，则令牌身份合法，否则令牌身份不合法，实现了动态口令牌身份的验证，防止动态口令牌被伪造。"/><meta property="og:title" content="专利 CN103427996A - 一种动态口令牌身份的验证方法及系统"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN103427996A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN103427996A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=5YTlCAABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN103427996A&amp;usg=AFQjCNH0UMP0P52QdDCJpUkTkglllMB0Mg" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/69bc86b085c1e5fae173/CN103427996A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/69bc86b085c1e5fae173/CN103427996A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN103427996A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN103427996A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN103427996A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN103427996B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN103427996A?cl=zh" style="display:none"><span itemprop="description">本发明公开了一种动态口令牌身份的验证方法及系统，该方法包括：动态口令牌接收身份验证指令，根据第一信息计算第一验证值，并输出第一验证值，其中，第一信息至少包括用于验证动态口令牌身份的第一种子密钥，第一种...</span><span itemprop="url">https://www.google.com/patents/CN103427996A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN103427996A - 一种动态口令牌身份的验证方法及系统</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN103427996A - 一种动态口令牌身份的验证方法及系统" title="专利 CN103427996A - 一种动态口令牌身份的验证方法及系统"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN103427996 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201310345514</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2013年12月4日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2013年8月9日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2013年8月9日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103427996B?hl=zh-CN&amp;cl=zh">CN103427996B</a>, </span><span class="patent-bibdata-value"><a href="/patents/WO2015018249A1?hl=zh-CN&amp;cl=zh">WO2015018249A1</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201310345514.6, </span><span class="patent-bibdata-value">CN 103427996 A, </span><span class="patent-bibdata-value">CN 103427996A, </span><span class="patent-bibdata-value">CN 201310345514, </span><span class="patent-bibdata-value">CN-A-103427996, </span><span class="patent-bibdata-value">CN103427996 A, </span><span class="patent-bibdata-value">CN103427996A, </span><span class="patent-bibdata-value">CN201310345514, </span><span class="patent-bibdata-value">CN201310345514.6</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%9D%8E%E4%B8%9C%E5%A3%B0%22">李东声</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E5%A4%A9%E5%9C%B0%E8%9E%8D%E7%A7%91%E6%8A%80%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">天地融科技股份有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103427996A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103427996A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103427996A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (2),</span> <span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (1),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (3),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (4)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=5YTlCAABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201310345514&amp;usg=AFQjCNHjvi1bRS3di7Pu6p2W_2yIuU4SAQ"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=5YTlCAABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D103427996A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNE2Dw4_1VXP0KsthpWqkeu5yu46tw"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT131634905" lang="ZH" load-source="patent-office">一种动态口令牌身份的验证方法及系统</invention-title>
      </span><br><span class="patent-number">CN 103427996 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA126621943" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明公开了一种动态口令牌身份的验证方法及系统，该方法包括：动态口令牌接收身份验证指令，根据第一信息计算第一验证值，并输出第一验证值，其中，第一信息至少包括用于验证动态口令牌身份的第一种子密钥，第一种子密钥是预先设置在动态口令牌中的；动态口令牌对应的验证装置获取第一验证值，对第一验证值进行验证，并在验证完成后，输出验证结果。本发明在动态口令牌中预设用于验证其身份的种子密钥，将至少根据该种子密钥计算的验证值发送到验证装置进行验证，如果该验证值与验证装置中计算的标准验证值一致，则令牌身份合法，否则令牌身份不合法，实现了动态口令牌身份的验证，防止动态口令牌被伪造。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(16)</span></span></div><div class="patent-text"><div mxw-id="PCLM57020719" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.一种动态口令牌身份的验证方法，其特征在于，包括:  动态口令牌接收身份验证指令，根据第一信息计算第一验证值，并输出所述第一验证值，其中，所述第一信息至少包括用于验证动态口令牌身份的第一种子密钥，所述第一种子密钥是预先设置在所述动态口令牌中的；  所述动态口令牌对应的验证装置获取所述第一验证值，对所述第一验证值进行验证，并在验证完成后，输出验证结果。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.根据权利要求1所述的方法，其特征在于，所述动态口令牌接收身份验证指令包括:  所述动态口令牌接收到用户输入的身份验证指令，其中，所述身份验证指令通过以下形式输入:按键或按键组合、声音信号、生物特征信号或光信号；  或者，所述动态口令牌接收到交易信息；  或者，所述动 态口令牌接收到预设周期到达的指令。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.根据权利要求1或2所述的方法，其特征在于，所述验证装置获取所述第一验证值包括:  在联机情况下，后台服务器接收所述第一验证值，并将所述第一验证值发送至所述验证装置。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.根据权利要求1或2所述的方法，其特征在于，所述验证装置获取所述第一验证值包括:  在脱机情况下，终端接收所述第一验证值，并将所述第一验证值发送给所述验证装置。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.根据权利要求1至4中任一项所述的方法，其特征在于，所述验证装置对所述第一验证值进行验证包括:  所述验证装置根据第二信息计算第二验证值，其中，所述第二信息至少包括第二种子密钥，所述第二种子密钥是预先设置的用于验证动态口令牌身份的密钥；  所述验证装置比较所述第一验证值与所述第二验证值；  在所述第一验证值与所述第二验证值相同的情况下，所述验证装置确定所述动态口令牌的身份合法。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.根据权利要求1至5中任一项所述的方法，其特征在于，所述动态口令牌身份的验证是在如下条件下进行的，包括:  所述动态口令牌在生成动态口令前进行动态口令牌身份的验证；  或者，所述动态口令牌在生成动态口令的同时进行动态口令牌身份的验证。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.根据权利要求1至6中任一项所述的方法，其特征在于，所述第一种子密钥与所述动态口令牌中用于生成交易所使用的动态口令的种子密钥不同。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.根据权利要求1至7中任一项所述的方法，其特征在于，所述第一信息还包括以下至少之一:所述动态口令牌的产品序列号、随机数和时间；所述验证装置中用于生成第二验证值的第二信息所包括的内容与所述第一信息包括的内容是对应的。</div>
    </div>
    </div> <div class="claim"> <div num="9" class="claim">
      <div class="claim-text">9.一种动态口令牌身份的验证系统，其特征在于，包括:动态口令牌和验证装置，其中，  所述动态口令牌包括:  接收模块，用于接收身份验证指令；  计算模块，用于根据第一信息计算第一验证值，其中，所述第一信息至少包括用于验证动态口令牌身份的第一种子密钥，所述第一种子密钥是预先设置在所述动态口令牌中的；  第一输出模块，用于输出所述第一验证值；  所述验证装置包括:  获取模块，用于获取所述第一验证值；  验证模块，用于对所述第一验证值进行验证；  第二输出模块，用于在验证完成后，输出验证结果。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.根据权利要求9所述的系统，其特征在于，所述接收模块包括:  第一接收单元，用于接收用户输入的身份验证指令或者接收预设周期到达的指令，其中，所述身份验证指令通过以下形式输入:按键或按键组合、声音信号、生物特征信号或光信号;  第二接收单元，用于接收交易信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="11" class="claim">
      <div class="claim-text">11.根据权利要求9或10所述的系统，其特征在于，所述系统还包括:后台服务器，用于在联机情况下，接收所述第一验证值，并将所述第一验证值发送至所述验证装置。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12.根据权利要求9或10所述的系统，其特征在于，所述系统还包括:终端，用于在脱机情况下，接收所述第一验证值，并将所述第一验证值发送给所述验证装置。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13.根据权利要求9至12中任一项所述的系统，其特征在于，所述验证模块包括:  计算单元，用于根据第二信息计算第二验证值，其中，所述第二信息至少包括第二种子密钥，所述第二种子密钥是 预先设置的用于验证动态口令牌身份的密钥；  比较单元，用于比较所述第一验证值与所述第二验证值；  确定单元，用于在所述第一验证值与所述第二验证值相同的情况下，确定所述动态口令牌的身份合法。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="14" class="claim">
      <div class="claim-text">14.根据权利要求9至13中任一项所述的系统，其特征在于，所述动态口令牌身份的验证是在如下条件下进行的，包括:  所述动态口令牌在生成动态口令前进行动态口令牌身份的验证；  或者，所述动态口令牌在生成动态口令的同时进行动态口令牌身份的验证。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="15" class="claim">
      <div class="claim-text">15.根据权利要求9至14中任一项所述的系统，其特征在于，所述第一种子密钥与所述动态口令牌中用于生成交易所使用的动态口令的种子密钥不同。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="16" class="claim">
      <div class="claim-text">16.根据权利要求9至15中任一项所述的系统，其特征在于，所述第一信息还包括以下至少之一:所述动态口令牌的产品序列号、随机数和时间；所述验证装置中用于生成第二验证值的第二信息所包括的内容与所述第一信息包括的内容是对应的。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES63994524" lang="ZH" load-source="patent-office" class="description">
    <p>一种动态口令牌身份的验证方法及系统</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及一种信息安全领域，尤其涉及一种动态口令牌身份的验证方法及系统。</p>
    <p>背景技术</p>
    <p>[0002]	为了保证信息安全，一般都会在进行操作之前进行身份认证，其目的是赋予合法用户访问的权限以及拒绝非法用户的访问。通过密码正确与否来进行身份认证，是比较常见的方式，密码认证可以分为静态密码认证和动态密码认证。动态密码是一种一次性密码，每个密码只能使用一次。动态密码可以随时间、次数和挑战信息的变化而变化。动态口令牌可以用于产生并显示动态密码(也称为动态口令)，其内置种子密钥，每次计算动态密码时都会引用种子密钥。</p>
    <p>[0003]目前市场上的同步型动态口令牌，每次计算动态密码时，除了引用种子密钥和其他的静态因素外，还需要引用至少一个自动变化的同步因子，如时间、事件计数等。由于同步因子是动态变化的，因此每次得到的动态密码都不相同。挑战应答型动态口令牌，在计算动态密码时，除了引用挑战信息，还引用了时间或事件计数等同步因子。</p>
    <p>[0004]	从上述的基本工作原理可以看出，种子密钥和同步因子是计算动态密码的基本要素。但是，同步因子都是可以预知的，特别是时间同步型令牌，令牌的时间是标准时间，对于事件同步型令牌，其事件计数也是有一个规定的起始值。由于同步因子的可预知性，种子密钥成为了利用动态密码保证安全的根本，如果种子密钥外泄，将极大地影响动态密码的安全性。</p>
    <p>[0005]	在实际的动态令牌应用中，一般是由令牌的制造商(即厂商)生产种子密钥，并注入到令牌中，同时，制造商需要将种子文件提供给客户(例如，银行等)，用于导入动态密码认证系统，以便可以完成动态密码认证。或者，种子密钥也可以由客户产生，提供给令牌厂商用于生产。即令牌的种子密钥必然会被令牌厂商和银行掌握，提高了种子密钥泄露的可能性，并且，一旦种子密钥被泄露，不法分子可以根据泄露的种子密钥伪造令牌，从而造成用户的经济损失。</p>
    <p>[0006]目前，对于如何验证动态口令牌身份是否合法以及在出现了伪造令牌的情况下，如何避免用户经济损失的问题，尚未提出有效的解决方案。</p>
    <p>发明内容</p>
    <p>[0007]	本发明提供了一种动态口令牌身份的验证方法及系统，以至少解决如何验证动态口令牌身份是否合法以及在出现了伪造令牌的情况下，如何避免用户经济损失的问题。</p>
    <p>[0008]	根据本发明的一个方面，提供了一种动态口令牌身份的验证方法，包括:动态口令牌接收身份验证指令，根据第一信息计算第一验证值，并输出所述第一验证值，其中，所述第一信息至少包括用于验证动态口令牌身份的第一种子密钥，所述第一种子密钥是预先设置在所述动态口令牌中的；所述动态口令牌对应的验证装置获取所述第一验证值，对所述第一验证值进行验证，并在验证完成后，输出验证结果。</p>
    <p>[0009]	此外，所述动态口令牌接收身份验证指令包括:所述动态口令牌接收到用户输入的身份验证指令，其中，所述身份验证指令通过以下形式输入:按键或按键组合、声音信号、生物特征信号或光信号；或者，所述动态口令牌接收到交易信息；或者，所述动态口令牌接收到预设周期到达的指令。</p>
    <p>[0010]	此外，所述验证装置获取所述第一验证值包括:在联机情况下，后台服务器接收所述第一验证值，并将所述第一验证值发送至所述验证装置。</p>
    <p>[0011]	此外，所述验证装置获取所述第一验证值包括:在脱机情况下，终端接收所述第一验证值，并将所述第一验证值发送给所述验证装置。</p>
    <p>[0012]	此外，所述验证装置对所述第一验证值进行验证包括:所述验证装置根据第二信息计算第二验证值，其中，所述第二信息至少包括第二种子密钥，所述第二种子密钥是预先设置的用于验证动态口令牌身份的密钥；所述验证装置比较所述第一验证值与所述第二验证值；在所述第一验证值与所述第二验证值相同的情况下，所述验证装置确定所述动态口令牌的身份合法。</p>
    <p>[0013]	此外，所述动态口令牌身份的验证是在如下条件下进行的，包括:所述动态口令牌在生成动态口令前进行动态口令牌身份的验证；或者，所述动态口令牌在生成动态口令的同时进行动态口令牌身份的验证。</p>
    <p>[0014]	此外，所述第一种子密钥与所述动态口令牌中用于生成交易所使用的动态口令的种子密钥不同。</p>
    <p>[0015]	此外，所述第一信息还包括以下至少之一:所述动态口令牌的产品序列号、随机数和时间；所述验证装置中用于生成第二验证值的第二信息所包括的内容与所述第一信息包括的内容是对应的。</p>
    <p>[0016]	根据本发明的另一个方面，提供了一种动态口令牌身份的验证系统，包括:动态口令牌和验证装置，其中，所述动态口令牌包括:接收模块，用于接收身份验证指令；计算模块，用于根据第一信息计算第一验证值，其中，所述第一信息至少包括用于验证动态口令牌身份的第一种子密钥，所述第一种子密钥是预先设置在所述动态口令牌中的；第一输出模块，用于输出所述第一验证值；所述验证装置包括:获取模块，用于获取所述第一验证值；验证模块，用于对所述第一验证值进行验证；第二输出模块，用于在验证完成后，输出验证结果。</p>
    <p>[0017]	此外，所述接收模块包括:第一接收单元，用于接收用户输入的身份验证指令或者接收预设周期到达的指令，其中，所述身份验证指令通过以下形式输入:按键或按键组合、声音信号、生物特征信号或光信号；第二接收单元，用于接收交易信息。</p>
    <p>[0018]	此外，所述系统还包括:后台服务器，用于在联机情况下，接收所述第一验证值，并将所述第一验证值发送至所述验证装置。</p>
    <p>[0019]	此外，所述系统还包括:终端，用于在脱机情况下，接收所述第一验证值，并将所述第一验证值发送给所述验证装置。</p>
    <p>[0020]	此外，所述验证模块包括:计算单元，用于根据第二信息计算第二验证值，其中，所述第二信息至少包括第二种子密钥，所述第二种子密钥是预先设置的用于验证动态口令牌身份的密钥；比较单元，用于比较所述第一验证值与所述第二验证值；确定单元，用于在所述第一验证值与所述第二验证值相同的情况下，确定所述动态口令牌的身份合法。</p>
    <p>[0021]	此外,所述动态口令牌身份的验证是在如下条件下进行的,包括:所述动态口令牌在生成动态口令前进行动态口令牌身份的验证；或者，所述动态口令牌在生成动态口令的同时进行动态口令牌身份的验证。</p>
    <p>[0022]	此外，所述第一种子密钥与所述动态口令牌中用于生成交易所使用的动态口令的种子密钥不同。</p>
    <p>[0023]	此外，所述第一信息还包括以下至少之一:所述动态口令牌的产品序列号、随机数和时间；所述验证装置中用于生成第二验证值的第二信息所包括的内容与所述第一信息包括的内容是对应的。</p>
    <p>[0024]	由上述本发明提供的技术方案可以看出，本发明提供了一种动态口令牌身份的验证方法及系统，在动态口令牌中预先设置用于验证动态口令牌身份的种子密钥，至少根据该种子密钥采用预先设置的算法计算出验证值，将该验证值发送到验证装置进行验证，如果该验证值与验证装置中计算的标准验证值一致，则令牌身份合法，即令牌由可靠的厂商生产，否则令牌身份不合法，是伪造的；实现了动态口令牌身份的验证，防止动态口令牌被伪造。进而，若验证出动态口令牌身份不合法，可以不允许进行后续的交易等操作，从而避免给用户造成经济损失；</p>
    <p>[0025]	另外，提供联机验证和脱机验证两种模式，对于既需要验证动态口令牌身份，又需要进行交易的情况，由于银行服务器本来就需要接收动态口令，采用联机验证模式，由银行服务器转发验证值，得到验证通过信息后，即可进行交易，使得验证以及交易过程比较简单、方便；对于只是验证动态口令牌身份，而不需要进行交易的情况，可以采用脱机验证模式，避免造成银行服务器的负担；</p>
    <p>[0026]另外，第一信息还可以包括其他可以增加计算出的验证值的随机性，使得黑客难以破解，更加安全；</p>
    <p>[0027]	另外，动态口令牌身份的验证可以在生成动态口令前进行，即根据验证结果决定是否生成动态口令，以执行交易，这样，可以避免不必要的操作；或者，在生成动态口令的同时进行动态口令牌身份的验证，在动态口令和身份均验证通过的情况下，执行交易，可以节省整个交易流程耗费的时间。</p>
    <p>附图说明</p>
    <p>[0028]	为了更清楚地说明本发明实施例的技术方案，下面将对实施例描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域的普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他附图。</p>
    <p>[0029]	图1是本发明实施例1提供的动态口令牌身份的验证方法的流程图；</p>
    <p>[0030]图2是本发明实施例2提供的动态口令牌身份的验证系统的结构框图一；</p>
    <p>[0031]图3是本发明实施例2提供的动态口令牌身份的验证系统的结构框图二	；</p>
    <p>[0032]图4是本发明实施例3提供的动态口令牌身份的验证系统的结构框图；</p>
    <p>[0033]	图5是本发明实施例4提供的交易方法的流程图；</p>
    <p>[0034]	图6是本发明实施例5提供的交易方法的流程图；以及[0035]	图7是本发明实施例6提供的交易方法的流程图。</p>
    <p>具体实施方式</p>
    <p>[0036]	下面结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于本发明的实施例，本领域普通技术人员在没有做出创造性劳动前提下所获得的所有其他实施例，都属于本发明的保护范围。</p>
    <p>[0037]	在本发明的描述中，需要理解的是，术语“中心”、“纵向”、“横向”、“上”、“下”、“前”、“后”、“左”、“右”、“竖直”、“水平”、“顶”、“底”、“内”、“外”等指示的方位或位置关系为基于</p>
    <p>附图所示的方位或位置关系，仅是为了便于描述本发明和简化描述，而不是指示或暗示所指的装置或元件必须具有特定的方位、以特定的方位构造和操作，因此不能理解为对本发明的限制。此外，术语“第一”、“第二”仅用于描述目的，而不能理解为指示或暗示相对重要性或数量或位置。</p>
    <p>[0038]	在本发明的描述中，需要说明的是，除非另有明确的规定和限定，术语“安装”、“相连”、“连接”应做广义理解，例如，可以是固定连接，也可以是可拆卸连接，或一体地连接；可以是机械连接，也可以是电连接；可以是直接相连，也可以通过中间媒介间接相连，可以是两个元件内部的连通。对于本领域的普通技术人员而言，可以具体情况理解上述术语在本发明中的具体含义。</p>
    <p>[0039]	下面将结合附图对本发明实施例作进一步地详细描述。</p>
    <p>[0040]	实施例1</p>
    <p>[0041]	本实施例提供了一种动态口令牌身份的验证方法，可以验证动态口令牌身份是否合法，即确定动态口令牌是不是伪造的。图1是本发明实施例1提供的动态口令牌身份的验证方法的流程图，如图1所示，该方法包括以下步骤:</p>
    <p>[0042]	步骤S101，动态口令牌接收身份验证指令，根据第一信息计算第一验证值，并输出第一验证值，其中，第一信息至少包括用于验证动态口令牌身份的第一种子密钥，第一种子密钥是预先设置在动态口令牌中的。输出第一验证值可以是将第一验证值显示在动态口令牌的显示屏上，也可以将第一验证值发送给其他设备，或者两种方式的结合。</p>
    <p>[0043]	优选地，上述第一种子密钥与动态口令牌中用于生成交易所使用的动态口令的种子密钥不同，如果二者相同，在用于生成动态口令的种子密钥泄漏后，不法分子将该种子密钥作为验证动态口令牌身份的密钥，伪造出动态口令牌，可能无法验证出令牌的真伪，例如，伪造的令牌中计算验证值使用的密钥算法恰巧与动态口令牌出厂时设置的算法相同，就无法验证出其真伪。因此，为了避免上述情况的发生，最好采用不同的种子密钥分别用于生成动态口令和验证令牌身份。</p>
    <p>[0044]	步骤S102，动态口令牌对应的验证装置获取第一验证值，对第一验证值进行验证，并在验证完成后，输出验证结果。</p>
    <p>[0045]	需要说明的是，验证装置可以是软件实现的系统，也可以是硬件设备，该硬件设备内可以存储厂商生产的所有的动态口令牌的产品序列号及其对应的用于验证身份的种子密钥等信息。</p>
    <p>[0046]身份验证指令用于触发动态口令牌的身份验证，步骤SlOl中动态口令牌接收身份验证指令包括:动态口令牌接收到用户输入的身份验证指令，其中，身份验证指令通过以下形式输入:按键或按键组合、声音信号、生物特征信号或光信号；或者，动态口令牌接收到交易信息；或者，动态口令牌接收到预设周期到达的指令。</p>
    <p>[0047]	具体地，动态口令牌可以接收以按键或按键组合形式输入的身份验证指令，按键或按键组合可以是动态口令牌的厂商预先设置的，也可以由用户自定义。对于厂商设置按键或按键组合的情况，可以是无法更改的，也可以是用户需要较高权限才可以修改的。按键或按键组合可以是:长按动态口令牌的某个按键、动态口令牌上的任意按键组合(例如按键4和8)。声音信号可以是一段固定的音乐，生物特征信号可以是特定的指纹、虹膜等。利用接收到交易信息来触发身份验证，一般是在验证之后需要进行交易的情况。</p>
    <p>[0048]	步骤S102中验证装置获取第一验证值包括以下两种情况:</p>
    <p>[0049]	(I)在联机情况下，后台服务器接收第一验证值，并将第一验证值发送至验证装置。对应的，验证结果返回给后台服务器。</p>
    <p>[0050]	后台服务器可以是银行的用于交易的服务器。对于既需要验证动态口令牌身份，又需要进行交易的情况，由于银行服务器本来就需要接收动态口令，采用联机验证模式，由银行服务器转发验证值，得到验证通过的信息后，即可进行交易，使得验证以及交易过程比较简单、方便。同时，在验证通过的情况下进行交易，可以保证交易以及用户资金的安全。</p>
    <p>[0051]	(2)在脱机情况下，终端接收第一验证值，并将第一验证值发送给验证装置。对应的，验证结果是返回给终端。此处，脱机指的是不通过银行服务器进行验证，对于只是验证动态口令牌身份，而不需要进行交易的情况，可以采用脱机验证模式，避免造成后台服务器的负担。</p>
    <p>[0052]	动态口令牌输出第一验证值可以是通过显示屏进行显示，用户获知该验证值之后，利用终端(例如，手机、平板电脑、PC机等)采用短信或邮件等形式将该验证值发给厂商的固定联系人或者直接发送至验证装置；也可以在厂商的网站的验证界面输入该验证值，由验证装置后台验证后，将验证结果显示给用户。</p>
    <p>[0053]	步骤S102中验证装置对第一验证值进行验证，可以通过以下步骤实现:验证装置根据第二信息计算第二验证值，其中，第二信息至少包括第二种子密钥，第二种子密钥是预先设置的用于验证动态口令牌身份的密钥；验证装置比较第一验证值与第二验证值；在第一验证值与第二验证值相同的情况下，验证装置确定动态口令牌的身份合法。</p>
    <p>[0054]	实际上，在动态口令牌中预先设置的用于验证动态口令牌身份的第一种子密钥可能是伪造的，至少根据第一种子密钥采用预先设置的算法计算出第一验证值，将该第一验证值发送到验证装置；验证装置使用的第二种子密钥，是厂商针对该动态口令牌预先设置的，只有厂商自己知道，用于唯一标识该动态口令牌，至少根据第二种子密钥采用预先设置的算法计算得到的第二验证值，可以理解为标准验证值，只要第一验证值与标准验证值不一致，令牌身份就不合法，如果一致，则令牌身份合法。</p>
    <p>[0055]	优选地，上述第一信息还包括以下至少之一:动态口令牌的产品序列号、随机数和时间；验证装置中用于生成第二验证值的第二信息所包括的内容与第一信息包括的内容是对应的。采用随机数或时间可以增加计算出的验证值的随机性，使得黑客难以破解，更加安全。正常情况下，第一信息包括第一种子密钥、产品序列号和时间，则第二信息也包括第一种子密钥、产品序列号和时间，且计算第一验证值和计算第二验证值所使用的算法相同，从而可以保证在第一种子密钥不是伪造的情况下，第一验证值与第二验证值是相同的。而对于伪造的令牌，第一信息包括的内容与第二信息包括的内容不一定相同，计算第一验证值和计算第二验证值所使用的算法也不一定相同。</p>
    <p>[0056]	具体地，计算验证值的算法可以是:SM3、HMAC-256、HMAC-512和MD5等算法，第一信息包括的内容以及第二信息包括的内容可以根据算法的不同有所区别。</p>
    <p>[0057]	此外，动态口令牌身份的验证是在如下条件下进行的，包括:动态口令牌在生成动态口令前进行动态口令牌身份的验证；或者，动态口令牌在生成动态口令的同时进行动态口令牌身份的验证。也就是说，可以先验证动态口令牌的身份是否合法，在身份合法的情况下，生成动态口令，以执行交易，这样，可以避免不必要的操作；也可以生成动态口令的同时验证动态口令牌的身份是否合法，在动态口令和身份均验证通过的情况下，执行交易，可以节省整个交易流程耗费的时间。</p>
    <p>[0058]	本实施例提供的技术方案在动态口令牌中预先设置用于验证动态口令牌身份的种子密钥，至少根据该种子密钥采用预先设置的算法计算出验证值，将该验证值发送到验证装置进行验证，如果该验证值与验证装置中计算的标准验证值一致，则令牌身份合法，即令牌由可靠的厂商生产；如果该验证值与验证装置中计算的标准验证值不一致，则该令牌身份不合法，是伪造的；实现了动态口令牌身份的验证，防止动态口令牌被伪造。进而，若验证出动态口令牌身份不合法，可以不允许进行后续的交易等操作，从而避免给用户造成经济损失。另一方面，若能够验证出是伪造的令牌，则表明用于生成动态口令的种子密钥被泄露，而用于身份验证的种子密钥没有泄露，可以排除种子密钥是厂商泄露的可能。</p>
    <p>[0059]	实施例2</p>
    <p>[0060]	本实施例提供了一种动态口令牌身份的验证系统，该系统可以用来实现实施例1中的验证方法。图2是本发明实施例2提供的动态口令牌身份的验证系统的结构框图一，如图2所示，该系统包括:动态口令牌20和验证装置30，其中:</p>
    <p>[0061]	动态口令牌20包括:接收模块201，用于接收身份验证指令；计算模块202，连接至接收模块201，用于根据第一信息计算第一验证值，其中，第一信息至少包括用于验证动态口令牌身份的第一种子密钥，第一种子密钥是预先设置在动态口令牌中的；第一输出模块203，连接至计算模块202，用于输出第一验证值。第一输出模块203可以是动态口令牌20的显示屏。优选地，上述第一种子密钥与动态口令牌中用于生成交易所使用的动态口令的种子密钥不同。</p>
    <p>[0062]	验证装置30包括:获取模块301，用于获取第一验证值；验证模块302，连接至获取模块301，用于对第一验证值进行验证；第二输出模块303，连接至验证模块302，用于在验证完成后，输出验证结果。需要说明的是，验证装置30可以是软件实现的系统，也可以是硬件设备，该硬件设备内可以存储厂商生产的所有的动态口令牌的产品序列号及其对应的用于验证身份的种子密钥等信息。</p>
    <p>[0063]	如图3所示，接收模块201包括:第一接收单元2011，用于接收用户输入的身份验证指令或者接收预设周期到达的指令，其中，身份验证指令通过以下形式输入:按键或按键组合、声音信号、生物特征信号或光信号；第二接收单元2012，用于接收交易信息。在实施例I中已经详细描述，此处不再赘述。</p>
    <p>[0064]	上述系统还包括:后台服务器40，用于在联机情况下，接收第一验证值，并将第一验证值发送至验证装置30。对应的，验证结果返回给后台服务器40。后台服务器40可以是银行的用于交易的服务器。对于既需要验证动态口令牌身份，又需要进行交易的情况，银行服务器得到验证通过的信息后，即可进行交易，使得验证以及交易过程比较简单、方便。同时，在验证通过的情况下进行交易，可以保证交易以及用户资金的安全。</p>
    <p>[0065]	此外，验证模块302包括:计算单元3021，用于根据第二信息计算第二验证值，其中，第二信息至少包括第二种子密钥，第二种子密钥是预先设置的用于验证动态口令牌身份的密钥；比较单元3022，连接至计算单元3021，用于比较第一验证值与第二验证值；确定单元3023，连接至比较单元3022，用于在第一验证值与第二验证值相同的情况下，确定动态口令牌的身份合法。</p>
    <p>[0066]	第一信息还包括以下至少之一:动态口令牌的产品序列号、随机数和时间；验证装置中用于生成第二验证值的第二信息所包括的内容与第一信息包括的内容是对应的。采用随机数或时间可以增加计算出的验证值的随机性，更加安全。正常情况下，第一信息包括第一种子密钥、产品序列号和时间，则第二信息也包括第一种子密钥、产品序列号和时间，且计算第一验证值和计算第二验证值所使用的算法相同，从而可以保证在第一种子密钥不是伪造的情况下，第一验证值与第二验证值是相同的。而对于伪造的令牌，第一信息包括的内容与第二信息包括的内容不一定相同，计算第一验证值和计算第二验证值所使用的算法也不一定相同。具体地，计算验证值的算法可以是:SM3、HMAC-256、HMAC-512和MD5等算法，第一信息包括的内容以及第二信息包括的内容可以根据算法的不同有所区别。</p>
    <p>[0067]	另外，动态口令牌身份的验证是在如下条件下进行的，包括:动态口令牌在生成动态口令前进行动态口令牌身份的验证；或者，动态口令牌在生成动态口令的同时进行动态口令牌身份的验证。也就是说，可以先验证动态口令牌的身份是否合法，在身份合法的情况下，生成动态口令，以执行交易，这样，可以避免不必要的操作；也可以生成动态口令的同时验证动态口令牌的身份是否合法，在动态口令和身份均验证通过的情况下，执行交易，可以节省整个交易流程耗费的时间。</p>
    <p>[0068]	本实施例提供的技术方案在动态口令牌中预先设置用于验证动态口令牌身份的种子密钥，计算模块202至少根据该种子密钥采用预先设置的算法计算出验证值，第一输出模块203将该验证值发送到验证装置30进行验证，如果该验证值与验证装置30中计算的标准验证值一致，则令牌身份合法，即令牌由可靠的厂商生产；如果该验证值与验证装置30中计算的标准验证值不一致，则该令牌身份不合法，是伪造的；实现了动态口令牌身份的验证，防止动态口令牌被伪造。进而，若验证出动态口令牌身份不合法，可以不允许进行后续的交易等操作，从而避免给用户造成经济损失。另一方面，若能够验证出是伪造的令牌，则表明用于生成动态口令的种子密钥被泄露，而用于身份验证的种子密钥没有泄露，可以排除种子密钥是厂商泄露的可能。</p>
    <p>[0069]	实施例3</p>
    <p>[0070]	本实施例的系统与实施例2中图3所不系统的区别在于将后台服务器40替换为终端50，实现脱机验证，且对应于该替换，第一验证值的传输方式有所改变。如图4所示，该系统还包括:终端50，用于在脱机情况下，接收第一验证值，并将第一验证值发送给验证装置30。对应的，验证结果是返回给终端50。此处，脱机指的是不通过银行服务器进行验证，如果只是验证动态口令牌的身份，而不需要进行交易，可以采用脱机验证的模式，避免造成后台服务器的负担。</p>
    <p>[0071]	动态口令牌输出第一验证值可以是通过显示屏进行显示，用户获知该验证值之后，利用终端(例如，手机、ipad、PC机等)采用短信或邮件等形式将该验证值发给厂商的固定联系人或者直接发送至验证装置；也可以在厂商的网站的验证界面输入该验证值，由验证装置后台验证后，将验证结果显示给用户。</p>
    <p>[0072]	实施例4</p>
    <p>[0073]	本实施例提供了一种交易方法，该交易方法可以基于实施例1中描述的动态口令牌身份的验证方法及实施例2中描述动态口令牌身份的验证系统实现，如图5所示，该交易方法包括以下步骤:</p>
    <p>[0074]	步骤S501，动态口令牌生成动态口令；</p>
    <p>[0075]	步骤S502，动态口令牌根据第一信息计算第一验证值，其中，第一信息至少包括用于验证动态口令牌身份的第一种子密钥，第一种子密钥是是预先设置在动态口令牌中的；</p>
    <p>[0076]	需要说明的是，步骤S501和步骤S502的顺序可以交换，即先执行步骤S502计算第一验证值，再执行步骤S501生成动态口令，计算第一验证值的触发条件可以是接收到交易信息；或者接收到交易信息后，同时执行步骤S501和步骤S502。</p>
    <p>[0077]	步骤S503，动态口令牌将动态口令和第一验证值一起发送至后台服务器；</p>
    <p>[0078]	步骤S504，后台服务器接收到动态口令和第一验证值后，验证动态口令，并将第一验证值发送至动态口令牌对应的验证装置进行验证；验证装置验证完成后，输出验证结果;</p>
    <p>[0079]	步骤S505，后台服务器接收验证结果，在动态口令和第一验证值均验证通过的情况下，执行交易。</p>
    <p>[0080]	验证装置验证第一验证值的步骤在实施例1至3中已经详细描述过，此处不再赘述。</p>
    <p>[0081 ] 本实施例中，在动态口令和第一验证值均通过的情况下，才可以执行交易，利用双重保障增加了交易的安全性，保证用户资金安全。即使动态口令牌被伪造，由于其计算出的第一验证值不能验证通过，就无法完成交易，避免用户的经济损失。</p>
    <p>[0082]	实施例5</p>
    <p>[0083]	本实施例提供了一种交易方法，该交易方法可以基于实施例1中描述的动态口令牌身份的验证方法及实施例2中描述的动态口令牌身份的验证系统实现，本实施例的交易方法与实施例4中交易方法的区别在于，本实施例中是先进行令牌的身份验证，再根据验证结果决定是否生成动态口令，以执行交易。如图6所示，该交易方法包括以下步骤:</p>
    <p>[0084]	步骤S601，动态口令牌接收到交易信息，根据第一信息计算第一验证值，并输出第一验证值，其中，第一信息至少包括用于验证动态口令牌身份的第一种子密钥，第一种子密钥是是预先设置在动态口令牌中的；</p>
    <p>[0085]	步骤S602，后台服务器接收第一验证值，并将第一验证值转发给验证装置；</p>
    <p>[0086]	步骤S603，验证装置对第一验证值进行验证，并在验证完成后，输出验证结果；</p>
    <p>[0087]	步骤S604，后台服务器接收验证结果，如果验证结果为身份合法，执行步骤S605 ；如果验证结果为身份不合法，执行步骤S606 ；</p>
    <p>[0088]	步骤S605，后台服务器发送信息(例如，验证通过信息)到动态口令牌，触发动态口令牌生成动态口令，进行后续的交易流程；</p>
    <p>[0089]	步骤S606，后台服务器发送信息(例如，验证失败信息)到动态口令牌，停止交易。</p>
    <p>[0090]	在上述步骤S601中，触发身份验证的条件也可以是预定的验证周期到达或者用户输入身份验证指令，对应的，步骤S605中生成动态口令的触发条件可以是在验证通过后的一定时间内(例如3分钟、10分钟等)接收到交易信息，以保证安全性。</p>
    <p>[0091]	验证装置验证第一验证值的步骤在实施例1至3中已经详细描述过，此处不再赘述。</p>
    <p>[0092]	本实施例中，先进行令牌的身份验证，再根据验证结果决定是否生成动态口令，以执行交易，从而可以避免不必要的操作。</p>
    <p>[0093]	实施例6</p>
    <p>[0094]	本实施例提供了一种交易方法，该交易方法可以基于实施例1中描述的动态口令牌身份的验证方法及实施例3中描述的动态口令牌身份的验证系统实现，本实施例的交易方法与实施例5中交易方法的区别在于，实施例5中采用联机验证模式进行令牌的身份验证，本实施例中采用脱机验证模式对令牌进行身份验证，如图7所示，该交易方法包括以下步骤:</p>
    <p>[0095]	步骤S701，动态口令牌接收到交易信息，根据第一信息计算第一验证值，并输出第一验证值(这里可以是将该第一验证值显示在动态口令牌的显示屏上)，其中，第一信息至少包括用于验证动态口令牌身份的第一种子密钥，第一种子密钥是是预先设置在动态口令牌中的；</p>
    <p>[0096]	步骤S702，用户获知该第一验证值，并通过电子邮件、短信等方式将第一验证值转发给验证装置，或者在验证界面输入第一验证值，使得验证装置获得该第一验证值；</p>
    <p>[0097]	步骤S703，验证装置对第一验证值进行验证，并在验证完成后，输出验证结果；</p>
    <p>[0098]	步骤S704，终纟而接收验证结果，如果验证结果为身份合法，执彳了步骤S705 ;如果验证结果为身份不合法，执行步骤S706 ；</p>
    <p>[0099]	步骤S705，用户操作动态口令牌触发动态口令牌生成动态口令，进行后续的交易流程；</p>
    <p>[0100]	步骤S706，不进行交易。</p>
    <p>[0101]	在上述步骤S701中，触发身份验证的条件也可以是预定的验证周期到达或者用户输入身份验证指令，对应的，步骤S705中生成动态口令的触发条件可以是在验证通过后的一定时间内(例如3分钟、10分钟等)接收到交易信息，以保证安全性。</p>
    <p>[0102]	验证装置验证第一验证值的步骤在实施例1至3中已经详细描述过，此处不再赘述。</p>
    <p>[0103]	利用脱机验证模式验证动态口令牌的身份，如果验证通过，再生成动态口令，与后台服务器完成交易，否则不进行交易，保证用户资金安全；并且，脱机验证可以减轻服务器的负担。</p>
    <p>[0104]	流程图中或在此以其他方式描述的任何过程或方法描述可以被理解为，表示包括一个或更多个用于实现特定逻辑功能或过程的步骤的可执行指令的代码的模块、片段或部分，并且本发明的优选实施方式的范围包括另外的实现，其中可以不按所示出或讨论的顺序，包括根据所涉及的功能按基本同时的方式或按相反的顺序，来执行功能，这应被本发明的实施例所属技术领域的技术人员所理解。</p>
    <p>[0105]	应当理解，本发明的各部分可以用硬件、软件、固件或它们的组合来实现。在上述实施方式中，多个步骤或方法可以用存储在存储器中且由合适的指令执行系统执行的软件或固件来实现。例如，如果用硬件来实现，和在另一实施方式中一样，可用本领域公知的下列技术中的任一项或他们的组合来实现:具有用于对数据信号实现逻辑功能的逻辑门电路的离散逻辑电路，具有合适的组合逻辑门电路的专用集成电路，可编程门阵列(PGA)，现场可编程门阵列(FPGA)等。</p>
    <p>[0106]	本技术领域的普通技术人员可以理解实现上述实施例方法携带的全部或部分步骤是可以通过程序来指令相关的硬件完成，所述的程序可以存储于一种计算机可读存储介质中，该程序在执行时，包括方法实施例的步骤之一或其组合。</p>
    <p>[0107]	此外，在本发明各个实施例中的各功能单元可以集成在一个处理模块中，也可以是各个单元单独物理存在，也可以两个或两个以上单元集成在一个模块中。上述集成的模块既可以采用硬件的形式实现，也可以采用软件功能模块的形式实现。所述集成的模块如果以软件功能模块的形式实现并作为独立的产品销售或使用时，也可以存储在一个计算机可读取存储介质中。</p>
    <p>[0108]	上述提到的存储介质可以是只读存储器，磁盘或光盘等。</p>
    <p>[0109]	在本说明书的描述中，参考术语“一个实施例”、“一些实施例”、“示例”、“具体示例”、或“一些示例”等的描述意指结合该实施例或示例描述的具体特征、结构、材料或者特点包含于本发明的至少一个实施例或示例中。在本说明书中，对上述术语的示意性表述不一定指的是相同的实施例或示例。而且，描述的具体特征、结构、材料或者特点可以在任何的一个或多个实施例或示例中以合适的方式结合。</p>
    <p>[0110]	尽管上面已经示出和描述了本发明的实施例，可以理解的是，上述实施例是示例性的，不能理解为对本发明的限制，本领域的普通技术人员在不脱离本发明的原理和宗旨的情况下在本发明的范围内可以对上述实施例进行变化、修改、替换和变型。本发明的范围由所附权利要求及其等同限定。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101051908A?cl=zh">CN101051908A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年5月21日</td><td class="patent-data-table-td patent-date-value">2007年10月10日</td><td class="patent-data-table-td ">北京飞天诚信科技有限公司</td><td class="patent-data-table-td ">动态密码认证系统及方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101651675A?cl=zh">CN101651675A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2009年8月27日</td><td class="patent-data-table-td patent-date-value">2010年2月17日</td><td class="patent-data-table-td ">北京飞天诚信科技有限公司</td><td class="patent-data-table-td ">提高网络交易安全性的方法和系统</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2015018249A1?cl=zh">WO2015018249A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2014年7月4日</td><td class="patent-data-table-td patent-date-value">2015年2月12日</td><td class="patent-data-table-td ">Tendyron Corporation</td><td class="patent-data-table-td ">一种动态口令牌身份的验证方法及系统</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=5YTlCAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0009320000">H04L9/32</a></span></td></tr><tr><td class="patent-data-table-td "> 合作分类</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=5YTlCAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L9/0869">H04L9/0869</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=5YTlCAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L9/3228">H04L9/3228</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2013年12月4日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年12月25日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2014年7月4日</td><td class="patent-data-table-td ">REG</td><td class="patent-data-table-td ">Reference to a national code</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Ref country code: </span><span class="nested-value">HK</span></div><div class="nested-key-value"><span class="nested-key">Ref legal event code: </span><span class="nested-value">DE</span></div><div class="nested-key-value"><span class="nested-key">Ref document number: </span><span class="nested-value">1190522</span></div><div class="nested-key-value"><span class="nested-key">Country of ref document: </span><span class="nested-value">HK</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">2016年4月6日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Grant of patent or utility model</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/69bc86b085c1e5fae173/CN103427996A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_50a6672b5f82ffbd39b7a9e87fd4594c.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E5%8A%A8%E6%80%81%E5%8F%A3%E4%BB%A4%E7%89%8C%E8%BA%AB%E4%BB%BD%E7%9A%84%E9%AA%8C%E8%AF%81%E6%96%B9.pdf?id=5YTlCAABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U3L3xNcxGge5udEKXBzX_aXIq2plw"},"sample_url":"https://www.google.com/patents/reader?id=5YTlCAABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>