<!DOCTYPE html><html><head><title>专利 CN102064858A - 用于在近程通信中形成安全信道的方法和设备 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="用于在近程通信中形成安全信道的方法和设备"><meta name="DC.contributor" content="印贞植" scheme="inventor"><meta name="DC.contributor" content="孙泰植" scheme="inventor"><meta name="DC.contributor" content="朴容&#22893;" scheme="inventor"><meta name="DC.contributor" content="三星电子株式会社" scheme="assignee"><meta name="DC.date" content="2010-11-18" scheme="dateSubmitted"><meta name="DC.description" content="本发明提供了执行近程无线通信的装置的信道连接。如果接收到由指定装置广播的公共密钥，那么该装置使用公共密钥加密其自己的UID(唯一标识符)以向该指定装置发送加密的UID，向该指定装置发送配对请求，并且使用包含在配对装置中的安全地址和UID从该指定装置安全地接收密钥种子以形成与该指定装置的安全信道。"><meta name="DC.date" content="2011-5-18"><meta name="DC.relation" content="CN:1659821:A" scheme="references"><meta name="citation_reference" content="MOAZZAM KHAN等: &quot;The Cost of Security: Performance of ZigBee Key Exchange Mechanism in an 802.15.4 Beacon Enabled Cluster&quot;, 《IEEE》, 31 October 2006 (2006-10-31), pages 876 - 879, XP031003944"><meta name="citation_patent_publication_number" content="CN:102064858:A"><meta name="citation_patent_application_number" content="CN:201010556112"><link rel="canonical" href="https://www.google.com/patents/CN102064858A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN102064858A?cl=zh"/><meta name="title" content="专利 CN102064858A - 用于在近程通信中形成安全信道的方法和设备"/><meta name="description" content="本发明提供了执行近程无线通信的装置的信道连接。如果接收到由指定装置广播的公共密钥，那么该装置使用公共密钥加密其自己的UID(唯一标识符)以向该指定装置发送加密的UID，向该指定装置发送配对请求，并且使用包含在配对装置中的安全地址和UID从该指定装置安全地接收密钥种子以形成与该指定装置的安全信道。"/><meta property="og:title" content="专利 CN102064858A - 用于在近程通信中形成安全信道的方法和设备"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN102064858A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN102064858A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=7kaUBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN102064858A&amp;usg=AFQjCNF3-h3kNf_blwrSsBtHZ_45bBZnbw" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/12d0472b922ce425cef3/CN102064858A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/12d0472b922ce425cef3/CN102064858A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN102064858A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN102064858A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN102064858A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN102064858B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN102064858A?cl=zh" style="display:none"><span itemprop="description">本发明提供了执行近程无线通信的装置的信道连接。如果接收到由指定装置广播的公共密钥，那么该装置使用公共密钥加密其自己的UID(唯一标识符)以向该指定装置发送加密的UID，向该指定装置发送配对请求，并且使用包含在配 ...</span><span itemprop="url">https://www.google.com/patents/CN102064858A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN102064858A - 用于在近程通信中形成安全信道的方法和设备</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN102064858A - 用于在近程通信中形成安全信道的方法和设备" title="专利 CN102064858A - 用于在近程通信中形成安全信道的方法和设备"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN102064858 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201010556112</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2011年5月18日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2010年11月18日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2009年11月18日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102064858B?hl=zh-CN&amp;cl=zh">CN102064858B</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP2326114A2?hl=zh-CN&amp;cl=zh">EP2326114A2</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP2326114A3?hl=zh-CN&amp;cl=zh">EP2326114A3</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP2326114B1?hl=zh-CN&amp;cl=zh">EP2326114B1</a>, </span><span class="patent-bibdata-value"><a href="/patents/US8477948?hl=zh-CN&amp;cl=zh">US8477948</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20110116631?hl=zh-CN&amp;cl=zh">US20110116631</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201010556112.7, </span><span class="patent-bibdata-value">CN 102064858 A, </span><span class="patent-bibdata-value">CN 102064858A, </span><span class="patent-bibdata-value">CN 201010556112, </span><span class="patent-bibdata-value">CN-A-102064858, </span><span class="patent-bibdata-value">CN102064858 A, </span><span class="patent-bibdata-value">CN102064858A, </span><span class="patent-bibdata-value">CN201010556112, </span><span class="patent-bibdata-value">CN201010556112.7</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%8D%B0%E8%B4%9E%E6%A4%8D%22">印贞植</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%AD%99%E6%B3%B0%E6%A4%8D%22">孙泰植</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%9C%B4%E5%AE%B9%E5%A5%AD%22">朴容&#22893;</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E4%B8%89%E6%98%9F%E7%94%B5%E5%AD%90%E6%A0%AA%E5%BC%8F%E4%BC%9A%E7%A4%BE%22">三星电子株式会社</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102064858A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102064858A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102064858A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (1),</span> <span class="patent-bibdata-value"><a href="#npl-citations">非专利引用</a> (1),</span> <span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (2),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (7),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=7kaUBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201010556112&amp;usg=AFQjCNGb2wWl6jVdCpznrtf5lCHsCVqemA"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=7kaUBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D102064858A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNFr2KJaQ68vsqil2eL1AbOX5eO7_g"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT103150805" lang="ZH" load-source="patent-office">用于在近程通信中形成安全信道的方法和设备</invention-title>
      </span><br><span class="patent-number">CN 102064858 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA85068696" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明提供了执行近程无线通信的装置的信道连接。如果接收到由指定装置广播的公共密钥，那么该装置使用公共密钥加密其自己的UID(唯一标识符)以向该指定装置发送加密的UID，向该指定装置发送配对请求，并且使用包含在配对装置中的安全地址和UID从该指定装置安全地接收密钥种子以形成与该指定装置的安全信道。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(20)</span></span></div><div class="patent-text"><div mxw-id="PCLM36105404" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.	一种在近程无线通信中形成信道的方法，包括下列步骤： 由控制装置接收由目标装置广播的公共密钥；由所述控制装置使用所述公共密钥加密其自己的唯一标识符UID并且向所述目标装 置发送加密的UID;由所述控制装置向所述目标装置发送配对请求； 由所述控制装置接收与所述配对请求对应的配对响应；使用包括在所述配对响应中的安全地址和该UID从所述目标装置安全地接收密钥种 子；以及由所述控制装置使用所接收的密钥种子生成链路密钥并且形成与所述目标装置的安全信道。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.根据权利要求1所述的方法，其中接收所述密钥种子包括： 使用所述安全地址和所述UID生成选择掩码；从所述目标装置顺序地接收多个密钥种子；以及使用所述选择掩码从所述多个密钥种子中选择有效密钥种子；其中形成安全信道包括：使用所述有效密钥种子生成所述链路密钥；以及使用所述链路密钥形成所述安全信道。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.根据权利要求2所述的方法，其中所述选择掩码是由比特组成的二进制数，所述比 特的数量与全部密钥种子的数量相同，并且当所述选择掩码的数字串被与以接收顺序排列 的所述多个密钥种子比较时，所述有效密钥种子是以对应于所述选择掩码的数字串中的 “1”的顺序接收的密钥种子。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.根据权利要求1所述的方法，其中接收所述密钥种子包括： 接收η个编号的加密的密钥种子；使用所述UID和所述安全地址解密第一密钥种子；以及通过使用所述UID、所述安全地址和第η-1个密钥种子分别解密第二到第η个密钥种子 来获取全部η个编号的密钥种子；其中使用获取的密钥种子形成所述安全信道。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.根据权利要求1所述的方法，其中所述公共密钥是公共证书，并且如果从所述目标 装置接收到认证机构发布的符号以及所述公共证书，那么所述的方法还包括验证该符号。</div>
    </div>
    </div> <div class="claim"> <div num="6" class="claim">
      <div class="claim-text">6.	一种在近程无线通信中形成信道的方法，包括下列步骤： 由目标装置广播公共密钥；由所述目标装置从控制装置接收使用所述公共密钥加密的唯一标识符UID ； 由所述目标装置从控制装置接收配对请求；由所述目标装置将对应于所述控制装置的安全地址包括在配对响应中并且向所述控 制装置发送所述配对响应；由所述目标装置生成密钥种子并且使用所述安全地址和所述UID向所述控制装置安 全地发送所述密钥种子；以及由所述目标装置使用所述密钥种子生成链路密钥并且形成与所述控制装置的安全信道。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.根据权利要求6所述的方法，其中发送所述密钥种子包括： 使用所述安全地址和所述UID生成选择掩码；顺序地生成和发送多个密钥种子；以及使用所述选择掩码从所述多个密钥种子中选择有效密钥种子；其中形成所述安全信道包括：使用所述有效密钥种子生成所述链路密钥；以及使用所述链路密钥形成所述安全信道。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.根据权利要求7所述的方法，其中所述选择掩码是由比特组成的二进制数，所述比 特的数量与全部密钥种子的数量相同，并且当所述选择掩码的数字串被与以生成顺序排列 的所述多个密钥种子比较时，所述有效密钥种子是以对应于所述选择掩码的数字串中的 “1”的顺序生成的密钥种子。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.根据权利要求6所述的方法，其中发送所述密钥种子包括： 生成η个编号的密钥种子；使用所述UID和所述安全地址加密第一密钥种子并且发送加密的密钥种子；以及 使用所述UID、所述安全地址和第η-1个密钥种子分别加密第二到第η个密钥种子并且 发送全部所述η个编号的密钥种子；其中使用所述η个编号的密钥种子形成所述安全信道，其中η是自然数。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.根据权利要求6所述的方法，其中所述公共密钥是公共证书，并且如果所述目标装 置存储由认证机构发布的符号，那么所述目标装置广播所述符号以及所述公共证书。</div>
    </div>
    </div> <div class="claim"> <div num="11" class="claim">
      <div class="claim-text">11.	一种用于形成执行近程无线通信的控制装置的信道的设备，包括： 近程发送/接收单元，其执行所述近程无线通信；以及处理器，其控制所述近程发送/接收单元接收由目标装置广播的公共密钥，使用所述 公共密钥加密其自己的唯一标识符UID，并且向所述目标装置发送加密的UID，向所述目标 装置发送配对请求，由所述控制装置接收对应于所述配对请求的配对响应，使用包括在所 述配对响应中的安全地址和所述UID从所述目标装置安全地接收密钥种子，以及使用所接 收的密钥种子生成链路密钥以形成与所述目标装置的安全信道。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12.根据权利要求11所述的设备，其中所述处理器使用所述安全地址和所述UID生成 选择掩码，从所述目标装置顺序地接收多个密钥种子，使用所述选择掩码从所述多个密钥 种子中选择有效密钥种子，使用所述有效密钥种子生成链路密钥，以及使用所述链路密钥 形成所述安全信道。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13.根据权利要求12所述的设备，其中，所述选择掩码是由比特组成的二进制数，所述 比特的数量与全部密钥种子的数量相同，并且当所述选择掩码的数字串被与以接收顺序排 列的所述多个密钥种子比较时，所述有效密钥种子是以对应于所述选择掩码的数字串中的 “1”的顺序接收的密钥种子。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="14" class="claim">
      <div class="claim-text">14.根据权利要求11所述的设备，其中所述处理器接收η个编号的加密的密钥种子，使 用所述UID和所述安全地址解密第一密钥种子，通过使用所述UID、所述安全地址和第η-1 个密钥种子分别解密第二到第η个密钥种子来获取全部η个编号的密钥种子，并且使用所 获取的密钥种子形成所述安全信道。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="15" class="claim">
      <div class="claim-text">15.根据权利要求11所述的设备，其中所述公共密钥是公共证书，并且如果从所述目标装置接收到认证机构发布的符号以及所述公共证书，那么所述处理器验证所述符号。</div>
    </div>
    </div> <div class="claim"> <div num="16" class="claim">
      <div class="claim-text">16.	一种用于形成执行近程无线通信的目标装置的信道的设备，包括：近程发送/接收单元，其执行所述近程无线通信；以及处理器，其控制所述近程发送/接收单元广播公共密钥，从控制装置接收使用所述公 共密钥加密的唯一标识符UID，如果从所述控制装置接收到配对请求，那么使对应于所述控 制装置的安全地址包括在配对响应中并且向所述控制装置发送所述配对响应，生成密钥种 子，使用所述安全地址和所述UID向所述控制装置安全地发送所述密钥种子，以及使用所 述密钥种子生成链路密钥以形成与所述控制装置的安全信道。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="17" class="claim">
      <div class="claim-text">17.根据权利要求16所述的设备，其中所述处理器使用所述安全地址和所述UID生成 选择掩码，顺序地生成并且发送多个密钥种子，使用所述选择掩码从所述多个密钥种子中 选择有效密钥种子，使用所述有效密钥种子生成所述链路密钥，以及使用所述链路密钥形 成所述安全信道。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="18" class="claim">
      <div class="claim-text">18.根据权利要求17所述的设备，其中，所述选择掩码是由比特组成的二进制数，所述 比特的数量与全部密钥种子的数量相同，并且当所述选择掩码的数字串被与以生成顺序排 列的所述多个密钥种子比较时，所述有效密钥种子是以对应于所述选择掩码的数字串中的 “1”的顺序生成的密钥种子。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="19" class="claim">
      <div class="claim-text">19.根据权利要求16所述的设备，其中所述处理器生成η个编号的密钥种子，使用所 述UID和所述安全地址加密第一密钥种子以发送加密的密钥种子，使用所述UID、所述安全 地址和第η-1个密钥种子分别加密第二到第η个密钥种子以发送全部所述η个编号的密钥 种子，并且使用所述η个编号的密钥种子形成所述安全信道，其中η是自然数。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="20" class="claim">
      <div class="claim-text">20.根据权利要求16所述的设备，其中所述公共密钥是公共证书，并且如果认证机构 发布的符号被存储在存储器中，那么所述处理器广播所述符号以及所述公共证书。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES41878116" lang="ZH" load-source="patent-office" class="description">
    <p>用于在近程通信中形成安全信道的方法和设备</p>
    <p>技术领域</p>
    <p>[0001]	本发明通常涉及近程通信，并且更具体地，涉及用于在近程通信中形成安全信道 的方法和设备。</p>
    <p>背景技术</p>
    <p>[0002]	通常，近程通信已经在诸如移动通信终端、笔记本电脑、PDA(个人数字助理)、便 携式DMB (数字多媒体广播）终端、MP3 (MPEG层3)播放器、PMP (便携式多媒体广播）以及 PSP(便携式游戏机）的多种终端中实现。</p>
    <p>[0003]	此外，近程通信模块被安装在包括电视接收器、DVD (数字视频盘）播放器、CD (致 密盘）播放器、空调等的家用电器中，并且装置之间的无线连接通常方便且简单地执行。因 此，通过使用无线连接的家庭网络的配置提供各种复杂服务的尝试和用户的需求已经增 加，并且已经开发出各种近程通信系统。</p>
    <p>[0004]	作为这样的近程无线通信系统的一种，基于使用2. 4GHz频率的IEEE(电气和电 子工程师协会）802. 15. 4PHY/MAC(物理/媒体访问控制)无线技术，已经设计了 ZigBee RF4CE (用于消费电子的远程控制标准），其不仅应用于诸如HD (高清晰度）电视接收器、家 庭影院设备、置顶盒以及其他音频设备的家庭娱乐电器，而且应用于诸如照明控制、安全监 控以及无钥匙进入系统的各种产品。</p>
    <p>[0005]	具体来说，已经开发了根据ZigBee RF4CE标准实现的RF(射频）遥控器以代替现 有的顶（红外线）遥控器。与顶遥控器相比，不管存在/不存在障碍物，RF遥控器都可以 在远距离自由地操作设备，并且提供长的电池寿命。此外，RF遥控器允许双向通信，因此预 期RF遥控器适合于数据广播服务。</p>
    <p>[0006]	图1中例示了通过ZigBee近程通信连接两个装置即装置A和装置B之间的信道 的过程，其例示了通常的信道连接过程。装置A 10是请求信道连接的装置并且包括应用层 11和网络层12。装置B 20是对该信道连接作出响应的装置，并且包括应用层22和网络层 21。</p>
    <p>[0007]	根据用户的请求或者如果需要，应用层11在步骤101向网络层12传递 (transfer)配对请求（a pair request)。配对请求是装置A请求与装置B配对的请求。根 据用户的输入或者当执行ZigBee近程通信的装置存在时，生成配对请求。在步骤103，网络 层21设置响应等待时间，并且向装置B 20发送配对请求。</p>
    <p>[0008]	装置B 20的网络层21在步骤105向应用层22传递接收到的配对请求，并且应用 层22在步骤107向网络层21传递配对响应。</p>
    <p>[0009]	装置B 20的网络层21在步骤109向装置A 10传递该配对响应。当接收到配对 响应，装置A 10的网络层12设定网络密钥种子的接收等待时间。网络密钥种子用于装置 10和20生成链路密钥(link key)，即，相同的秘密密钥。</p>
    <p>[0010]	另一方面，装置B 20的网络层21在步骤111生成（n+1)个编号的网络密钥种子， 并且向装置A &#8212;个接一个地发送这些网络密钥种子。[0011]	如果接收到全部的网络密钥种子，装置A 10生成链路密钥，并且在步骤113向装 置B 20发送关于连接信道的ping请求。装置B 20在步骤115向装置A 10发送ping响 应，并且在步骤117通过发送通信状态（C0MM-STATUS)指示符向应用层22传递当前状态。 如果接收到ping响应，装置A 10的网络层12在步骤119向应用层11传递配对确认。</p>
    <p>[0012]	然而，在上述信道连接过程中，用于在两个装置之间生成相同秘密密钥的网络密 钥种子以明文的形式发送。因此，网络密钥种子易受到中间人（Man-in-the-Middle)的攻 击。也就是说，存在这样的可能性，即，不是装置10或20的第三方获取了密钥种子并且生 成秘密密钥。此外，为了生成秘密密钥，要求最大限度地连续组合255个密钥种子，因此第 三方可以通过伪造密钥种子帧的顺序或种子值本身来阻碍秘密密钥的生成。</p>
    <p>[0013]	解决此问题的方法可以是通过使用主密钥进行加密来保护密钥种子的方法。然 而，不容易安全地分发主密钥，并且此方法易受到节点捕获的攻击。此外，由于加密操作而 导致可能存在延迟，并且功耗增加。而且，此方法具有依然易受到伪造密钥种子帧的序列或 种子值本身的攻击的缺点。</p>
    <p>发明内容</p>
    <p>[0014]	因此，已经做出本发明用以解决现有技术中出现的上述问题，并且本发明提供了 能够提供密钥种子值的秘密性、完整性和有效性的方法和设备，该密钥种子值被交换以在 配对过程之后在两个装置之间生成秘密密钥。</p>
    <p>[0015]	而且，本发明提供了能够在两个装置之间安全地设置安全信道的方法和设备。</p>
    <p>[0016]	根据本发明的一个方面，提供了连接执行近程无线通信的装置的信道的方法，其 包括控制装置接收由目标装置广播的公共密钥；该控制装置使用公共密钥加密其自己的 UID(唯一标识符）并且向目标装置发送加密的UID ；控制装置向目标装置发送配对请求； 如果控制装置接收配对响应，那么使用包括在配对响应中的安全地址和UID从目标装置安 全地接收密钥种子；以及该控制装置使用发送的密钥种子生成链路密钥并且形成与目标装 置的安全信道。</p>
    <p>[0017]	在根据本发明的实施例的连接装置的信道的方法中，接收密钥种子包括使用安全 地址和UID生成选择掩码；从目标装置顺序地接收多个密钥种子；以及使用选择掩码从多 个密钥种子中选择有效密钥种子；其中形成安全信道的步骤包括：使用有效密钥种子生成 链路密钥；以及使用链路密钥形成安全信道。</p>
    <p>[0018]	在根据本发明的实施例的连接装置的信道的方法中，接收密钥种子还包括：接收 η个编号的加密的密钥种子；使用UID和安全地址解密第一密钥种子；以及通过使用UID、 安全地址和第η-1个密钥种子解密第η个密钥种子来获取全部η个编号的密钥种子；其中 使用所获取的密钥种子形成安全信道。</p>
    <p>附图说明</p>
    <p>[0019]	本发明的上述或其他方面、特征和优点通过下面结合附图的详细说明将变得更加 明显，其中：</p>
    <p>[0020]	图1是说明相关领域中信道连接过程的流程图；</p>
    <p>[0021]	图2是说明根据本发明的实施例的装置的配置的流程图；[0022]	图3是说明根据本发明的实施例的信道连接过程的流程图；</p>
    <p>[0023]	图4至图7是根据本发明的实施例详细说明图3的各过程的流程图；</p>
    <p>[0024]	图8和图9是说明根据本发明的实施例的装置的操作过程的流程图。</p>
    <p>具体实施方式</p>
    <p>[0025]	下文中，将参考附图说明本发明的实施例。在下述说明中，相同的元件将以相同的 参考标号表示，虽然它们在不同的附图中示出。此外，在本发明的下述说明中，当对本发明 书中结合的公知功能和配置的具体描述可能使得本发明的主题变得相当不清楚时，该具体 描述将被省略。</p>
    <p>[0026]	本发明提供了一种能够安全交换密钥种子的方法，该密钥种子用于在执行近程通 信的两个装置之间形成安全信道，以便得以设置更稳定的安全信道。具体地，本发明能够更 有效地应用于ZigBee近程无线通信。</p>
    <p>[0027]	根据本发明，在初始配对过程前，增加了能够在两个装置之间执行相互认证的过 程，并且分配了用于配对过程中的安全密钥种子交换的初始矢量。此外，通过使用在认证过 程中使用的识别信息和该初始矢量，产生用于从多个密钥种子中选择将要用来生成链路密 钥的密钥种子的掩码。该密钥种子还可以被加密和发送用以提高该密钥种子的安全性。</p>
    <p>[0028]	采用本发明的装置的配置如图2所示。参考图2，装置200包括处理器210、近程 发射/接收单元220和存储器单元230。</p>
    <p>[0029]	在处理器210的控制下，近程无线发射/接收单元220执行近程无线通信，并且根 据近程无线通信发射/接收各种数据。根据本发明的实施例，近程发射/接收单元220能 够执行ZigBee近程通信。</p>
    <p>[0030]	处理器210控制装置200的全部操作，并且控制近程发射/接收单元220使得可 以进行近程无线通信，具体地，处理器210根据用于近程无线通信的信道设置过程来控制 所有的操作。</p>
    <p>[0031]	存储器单元230在其内存储用于控制单元210的数据处理和控制的程序、参考数 据、各种用于存储的可更新的数据等，并且这样的程序和数据被提供给控制单元210的工 作存储器。存储器单元230还可以存储分配给装置200的公共证书和装置200的UID (唯 一标识符）。同样地，存储器单元230可以存储符号（sign)。该符号一般被发布给通过指 定的认证机构被允许近程无线通信的装置，并且在装置的认证过程中使用。该符号可以在 装置生产过程中被包括或者可以通过在认证阶段中执行注册程序的过程来获取。在认证处 理中可以使用或可以不使用该符号。</p>
    <p>[0032]	此外，存储器单元230可以存储配对表。配对表是其中分配给当前配对的相对 (opposite)装置和用于密钥种子安全发送的对应装置的安全地址相匹配的表。安全地址可 以由处理器210生成，针对每个安全地址可以设定有效期。</p>
    <p>[0033]	此外，存储器单元230根据密钥种子分发模式（distribution mode)存储安全算 法。密钥种子分发模式被分成快速模式和普通模式。在快速模式中，产生随机选择掩码 (mask)并且在全部密钥种子中选中用于生成链路密钥的密钥种子。在普通模式中，加密并 且发送密钥种子本身。因此，存储器单元230能够存储随机选择掩码算法和密钥种子加密算法。[0034]	在信道连接期间，可以作为缺省值或根据用户的选择设定安全信道的形成。在用 户确定是否设定安全信道的情况中，处理器210提供用户能够通过其输入关于是否设定安 全信道的命令的用户接口。例如，可以显示安全信道设置菜单。因此，用户能够选择是否 形成安全信道并且还能够选择密钥种子分发模式。优选地，密钥种子分发模式由请求信道 连接的装置侧来指定，用户设定的值在信道连接过程中被发送给对信道连接作出响应的装 置。</p>
    <p>[0035]	根据情况，如上配置的装置200可以请求信道连接或者可以被请求执行信道连 接。因此，在本发明的下列说明中，基于如下假设来说明信道连接过程，请求信道连接的装 置称为控制装置310，并且作为信道连接请求的对象的装置称为目标装置320。控制装置 310和目标装置320具有类似图2的装置200的配置。虽然，本发明可以应用到所有近程无 线通信方案，但是在本说明书中出于容易理解的目的，描述了 ZigBee近程无线通信。</p>
    <p>[0036]	参考图3，在步骤Si，控制装置310和目标装置320使用证书、符号和UID来执行 相互的装置认证。如果成功执行认证，在步骤S2，将由目标装置320生成的安全地址和该安 全地址的有效期被传递给控制装置310用以分配初始矢量。在步骤S3，使用该UID和该安 全地址通过安全算法来执行密钥种子分发。在本发明中，密钥种子分发可以被划分成快速 模式和普通模式。如果完成密钥种子分发，在步骤S4生成使用密钥种子的链路密钥，并且 形成使用链路密钥的安全信道。</p>
    <p>[0037]	下文中，参考图4至图7，将具体说明步骤Sl至S4。图4A和图4B说明了对应步 骤Sl的步骤。图4A示出仅使用公共证书的认证过程，图4B示出使用公共证书和符号的认 证过程。</p>
    <p>[0038]	参考图4A，在步骤401，目标装置320广播该公共证书。因此，控制装置310能够 接收该公共证书，并且使用公共证书认证目标装置。响应于用户的请求或者如果确定需要 与用于执行指定功能的目标装置310的信道连接，控制装置310在步骤S403使用目标装置 的公共证书加密其自己的UID。控制装置310进行到步骤405，向目标装置320发送加密的 UID0如果收到加密的UID，目标装置320在步骤407使用其自己的公共证书解密并且确认 该 UID。</p>
    <p>[0039]	在本发明的另一个实施例中，在使用符号的情况中，如图4B所示，目标装置320在 步骤411广播公共证书和符号两者。因此，控制装置310在步骤413接收该公共证书和符 号，并且确认该符号。在步骤415，控制装置310使用目标装置320的公共证书加密其自己 的UID。然后，控制装置310进行到步骤417，并且向目标装置320发送加密的UID。已经 接收到该加密的UID的目标装置320在步骤419使用其自己的公共证书来解密并且确认该 UID。</p>
    <p>[0040]	在上述认证过程中使用的消息可以使用例如ZigBee RF4CE的网络命令格式。该 网络命令格式在以下的表1中示出。</p>
    <p>[0041]	表 1</p>
    <p>[0042]</p>
    <p>帧控制	帧计数器	命令标识符	命令有效载荷	FCS</p>
    <p>[0043] 在使用该网络命令格式的消息的情况中，当证书被广播时，指示该消息是请求UID的消息的标识符被包括在该消息的命令标识符字段，并且证书被包括在命令有效载荷中。 此外，当发送UID时，指示该消息是对UID请求的响应消息的标识符被包括在该消息的命令 标识符字段，并且UID被包括在命令有效载荷中。</p>
    <p>[0044]	相应地，包括在命令标识符中的命令的种类在下面的表2中示出。在本发明的实 施例中，使用命令帧标识符的OxOA和OxOB。</p>
    <p>[0045]表	2</p>
    <p>[0046]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102064858A/CN102064858AD00091.png"> <img id="idf0001" file="CN102064858AD00091.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102064858A/CN102064858AD00091.png" class="patent-full-image" alt="Figure CN102064858AD00091"> </a> </div>
    <p>[0047]</p>
    <p>[0048]	在如图4A或4B所示的过程已经完成对目标装置320的认证的控制装置310根据 图5所示的过程执行初始矢量分配过程。</p>
    <p>[0049]	参考图5，控制装置310在步骤501发送配对请求。在该情况下，配对请求包括用 于请求安全信道的形成的安全参数。安全参数例如可以以如下状态被发送，在该状态中安 全参数被包括在网络节点能力常数的允许安全（security capable)字段中。包括关于密 钥种子分发模式的信息的安全设置信息也能够被包括在配对请求中。因此，安全设置信息 可以以如下状态被发送，在该状态中安全设置信息被包括在网络节点能力常数的预留字段 中。网络节点能力常数的格式如下表3所示。</p>
    <p>[0050]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102064858A/CN102064858AD00101.png"> <img id="idf0002" file="CN102064858AD00101.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102064858A/CN102064858AD00101.png" class="patent-full-image" alt="Figure CN102064858AD00101"> </a> </div>
    <p>[0052]	因此，如果收到配对请求，目标装置320在步骤503通过确认安全参数来确认安全 信道形成请求是否被包括在配对请求中。如果安全信道形成请求被包括在配对请求中，那 么目标装置320生成对应于控制装置310的安全地址，并且设置所生成的安全地址的有效 期。然后，在步骤505，目标装置320做出包括该安全地址和该有效期的配对响应并且向控 制装置310发送该配对响应。</p>
    <p>[0053]	如果通过上述过程发送了该安全地址和该有效期并且完成了矢量分配，那么目标 装置320和控制装置310确认当前设置的密钥种子分发模式。控制装置310能够通过其自 己的内部设置信息确认密钥种子分发模式，并且目标装置320能够通过包括在配对请求中 的安全设置信息来确认密钥种子分发模式。</p>
    <p>[0054]	如果密钥种子分发模式是快速模式，那么密钥种子分发将以图6所示的过程执 行，然而，如果密钥种子分发模式是普通模式，那么密钥种子分发将以图7所示的过程执 行。</p>
    <p>[0055]	图6示出安全被设置为快速模式并且密钥能力（key capability)被设置为随机 选择的情况下的密钥种子分发过程。参考图6，已经从目标装置320接收到包括安全地址和 有效期的配对响应的控制装置310在步骤601使用安全地址和其自己的UID生成随机选择 掩码。</p>
    <p>[0056]	另一方面，在发送包括安全地址和有效期的配对响应之后，目标装置320在步骤 603使用所发送的安全地址和如在图4A或4B中所示的过程中从控制装置310接收的UID 也生成随机选择掩码。在步骤601和步骤603生成的随机选择掩码相同，并且被在从由目 标装置320生成的密钥种子中选择有效密钥种子的过程中使用。</p>
    <p>[0057]	如果完成随机选择掩码的生成，那么目标装置320在步骤605生成n个编号 (n-numbered)的密钥种子并且顺序地向控制装置310发送所生成的密钥种子。如果完成了 该η个编号的密钥种子的发送，控制装置310和目标装置320分别在步骤607和步骤609 使用随机选择掩码从该η个编号的密钥种子中选择有效密钥种子。</p>
    <p>[0058]	随机选择掩码是随机二进制数，其由与全部密钥种子的数目相同的数目的比特 (即，η个比特）构成。例如，在生成并发送了 255个密钥种子的情况中，随机选择掩码变成 255个比特的随机二进制数。</p>
    <p>[0059]	当按密钥种子的生成顺序排列的密钥种子被与随机选择掩码的数字串比较时，对 应于随机选择掩码的数字串中的“1”的密钥种子被确定为有效密钥种子。也就是说，以对 应于随机选择掩码的数字串中的“1”的顺序生成的密钥种子被确定为有效密钥种子。例 如，如果密钥种子的总数是3并且随机选择掩码是“101”，那么第一个生成的密钥种子和第 三个生成的密钥种子被确定为有效密钥种子。</p>
    <p>[0060]	由于按密钥种子的生成顺序发送密钥种子，所以目标装置320通过比较接收顺序的密钥种子和随机选择掩码来选择有效密钥种子。</p>
    <p>[0061]	如果完成了有效密钥种子的选择，在步骤611和步骤613，控制装置310和目标装 置320分别使用该有效密钥种子来生成链路密钥并且使用该链路密钥在它们之间形成安</p>
    <p>全信道。</p>
    <p>[0062]	另一方面，如果密钥种子以普通模式分发，如图7所示，那么目标装置320在发送 包括安全地址和有效期的配对响应后，在步骤701生成η个编号的密钥种子。在这种情况 下，η是自然数。然后，在步骤703，目标装置使用安全地址和控制装置310的UID加密第一 个生成的密钥种子，即，密钥种子1，并且进行到步骤705以向控制装置310发送加密的密钥 种子1。已经接收到加密的密钥种子1的控制装置310在步骤707使用安全地址和该UID 解密密钥种子1并且存储解密的密钥种子1。</p>
    <p>[0063]	目标装置320在步骤709使用安全地址、控制装置310的UID和密钥种子1加密 密钥种子2，并且在步骤711向控制装置310传递加密的密钥种子2。相应地，控制装置310 在步骤713使用安全地址、该UID和密钥种子1来解密该加密的密钥种子2，并且存储密钥 种子2。</p>
    <p>[0064]	重复执行这些过程直到密钥种子达到密钥种子η。也就是说，目标装置在步骤715 使用安全地址、该UID和种子η-1来加密种子η，并且在步骤717向控制装置310传递加密 的种子η。相应地，控制装置310在步骤719使用安全地址、该UID和密钥种子η_1来解密 该加密的密钥种子n，并且存储密钥种子η。</p>
    <p>[0065]	如果如上面那样直到密钥种子η的所有密钥种子的发送都已经完成，那么控制装 置310和目标装置320分别在步骤723和步骤721使用全部η个编号的密钥种子来生成链 路密钥并且使用该链路密钥在它们之间形成安全信道。</p>
    <p>[0066]	图8和图9是说明根据本发明的实施例的装置200的操作过程的视图。图8是图 示装置200从另一个装置接收信道连接请求的情况下的操作过程的流程图，图9是图示装 置200从另一个装置请求信道连接的情况下的操作过程的流程图。</p>
    <p>[0067]	参考图8，装置200的处理器210在步骤801初始化该连接，并且在步骤803确认 存储器单元230中是否存在符号。如果存在符号，那么处理器210在步骤805广播公共证 书，然而，如果不存在符号，那么处理器在步骤807广播公共证书和符号两者。</p>
    <p>[0068]	此后，如果从指定装置接收到UID，那么处理器在步骤809使用其自己的公共证书 解密并且确认UID。然后，如果处理器210在步骤811确认从指定装置接收到配对请求，那 么处理器210在步骤813通过确认包括在配对请求中的安全参数来确认请求了安全信道的 形成。然后，处理器210在步骤815生成对应于该指定装置的安全地址，设置有效期，使得 安全地址和有效期被包括在配对响应中，并且向该指定装置发送该配对响应。</p>
    <p>[0069]	然后，处理器210在步骤817通过确定包括在配对请求中的安全设置信息来确认 密钥种子分发模式是快速模式还是普通模式。如果密钥种子分发模式是快速模式，那么处 理器210进行到步骤819以生成随机选择掩码和η个编号的密钥种子，在步骤821向该指 定装置顺序地发送该η个编号的密钥种子。此外，处理器210在步骤823使用该随机掩码 来选择有效密钥种子，进行到步骤829以生成链路密钥，并且形成安全信道。</p>
    <p>[0070]	如果作为步骤817确定的结果，密钥种子分发模式是普通模式，那么处理器210进 行到步骤825以生成η个编号的密钥种子，并且使用安全地址、指定装置的UID和种子η_1加密各个密钥种子。然而，处理器210使用安全地址和指定装置的UID来加密作为第一个 密钥种子的密钥种子1。然后，处理器210在步骤827向该指定装置发送加密的密钥种子， 并且进行到步骤829以生成链路密钥，并且形成安全信道。</p>
    <p>[0071]	参考图9，如果装置200请求信道连接，那么处理器210在步骤901初始化该连接， 进行到步骤903以确认是否接收到公共证书和指定装置的符号。如果接收到公共证书和符 号两者，那么处理器210进行到步骤905以确认接收的符号是否有效，如果符号有效，其进 行到步骤909。在仅接收到公共证书的情况下，处理器210通过在步骤907的确认，进行到 步骤909。</p>
    <p>[0072]	处理器210在步骤909通过接收到的公共证书加密其自己的UID，在步骤911向该 指定装置发送加密的UID。然后，处理器210在步骤913向该指定装置发送包括安全信道 形成请求的配对请求。此后，如果处理器210在步骤915接收配对响应，那么其进行到步骤 917以从该配对响应中确认安全地址和该安全地址的有效期。</p>
    <p>[0073]	然后，处理器210在步骤919确认当前安全设置，如果当前模式是快速模式，那么 其进行到步骤921以生成随机选择掩码。处理器210在步骤923从指定装置顺序地接收密 钥种子，如果密钥种子的接收完成，那么处理器在步骤925使用该随机掩码来选择有效密 钥种子，并且进行到步骤932以生成链路密钥，并且形成安全信道。如果在步骤919当前模 式不是快速模式，那么处理器在步骤927接收加密的密钥种子，然后在步骤9&#190;使用安全地 址、该指定装置的UID、种子n-1来解密该加密的种子η。然而，处理器210使用安全地址和 该指定装置的UID来解密作为第一密钥种子的密钥种子1。如果如上获取了所有的密钥种 子，那么处理器210进行到步骤932以使用获取的密钥种子来生成链路密钥，并且形成安全 信道。</p>
    <p>[0074]	根据本发明，能够保证用于在执行近程通信的两个装置之间设置安全信道的密钥 种子值的保密性、完整性和有效性。因此，能够在这两个装置之间安全地设置准确的安全信 道。</p>
    <p>[0075]	虽然已经参考其实施例示出和说明了本发明，但是在不背离本发明的范围的情况 下，可以做出各种修改。例如，虽然在上述实施例中以公共密钥是公共证书为例，但是也可 以使用其他种类的公共密钥。此外，在ZigBee近程通信中，控制装置可以是用于远程控制 目标装置的远程控制器，例如移动通信终端，并且目标装置可以是被该控制装置远程控制 的装置，例如电视接收机、家庭影院、计算机等。因此，本发明的范围不是由上述实施例限定 的，而应该由所附权利要求及其等同物来限定。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN1659821A?cl=zh">CN1659821A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2003年6月10日</td><td class="patent-data-table-td patent-date-value">2005年8月24日</td><td class="patent-data-table-td ">纳格拉卡德股份有限公司</td><td class="patent-data-table-td ">在两个装置之间交换安全数据的方法</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="npl-citations"></a><div class="patent-section-header"><span class="patent-section-title">非专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th colspan="3"class="patent-data-table-th">参考文献</th></tr></thead><tr><td class="patent-data-table-td ">1</td><td class="patent-data-table-td "><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td ">MOAZZAM KHAN等: "<a href='http://scholar.google.com/scholar?q="The+Cost+of+Security%3A+Performance+of+ZigBee+Key+Exchange+Mechanism+in+an+802.15.4+Beacon+Enabled+Cluster"'>The Cost of Security: Performance of ZigBee Key Exchange Mechanism in an 802.15.4 Beacon Enabled Cluster</a>", 《IEEE》, 31 October 2006 (2006-10-31), pages 876 - 879, XP031003944</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102420642A?cl=zh">CN102420642A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年12月15日</td><td class="patent-data-table-td patent-date-value">2012年4月18日</td><td class="patent-data-table-td ">北京握奇数据系统有限公司</td><td class="patent-data-table-td ">蓝牙设备及其通信方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102420642B?cl=zh">CN102420642B</a></td><td class="patent-data-table-td patent-date-value">2011年12月15日</td><td class="patent-data-table-td patent-date-value">2014年4月23日</td><td class="patent-data-table-td ">北京握奇数据系统有限公司</td><td class="patent-data-table-td ">蓝牙设备及其通信方法</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=7kaUBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0009320000">H04L9/32</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=7kaUBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029060000">H04L29/06</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=7kaUBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04B0005000000">H04B5/00</a></span></td></tr><tr><td class="patent-data-table-td "> 合作分类</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=7kaUBwABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04W12/06">H04W12/06</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=7kaUBwABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04W12/04">H04W12/04</a></span></td></tr><tr><td class="patent-data-table-td "> 欧洲专利分类号</td><td class="patent-data-table-td "><span class="nested-value">H04W12/02</span>, <span class="nested-value">H04W12/04</span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2011年5月18日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年12月19日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2015年3月11日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Grant of patent or utility model</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/12d0472b922ce425cef3/CN102064858A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E7%94%A8%E4%BA%8E%E5%9C%A8%E8%BF%91%E7%A8%8B%E9%80%9A%E4%BF%A1%E4%B8%AD%E5%BD%A2%E6%88%90%E5%AE%89%E5%85%A8%E4%BF%A1.pdf?id=7kaUBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U01cnIlRQbD96wYFOC2V2wIUl6u_Q"},"sample_url":"https://www.google.com/patents/reader?id=7kaUBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>