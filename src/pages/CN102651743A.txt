<!DOCTYPE html><html><head><title>专利 CN102651743A - 一种令牌种子的生成方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种令牌种子的生成方法"><meta name="DC.contributor" content="于华章" scheme="inventor"><meta name="DC.contributor" content="陆舟" scheme="inventor"><meta name="DC.contributor" content="飞天诚信科技股份有限公司" scheme="assignee"><meta name="DC.date" content="2012-5-2" scheme="dateSubmitted"><meta name="DC.description" content="本发明公开一种令牌种子的生成方法，包括：终端获取动态令牌模块中的第一计算结果并将其发送给服务器；服务器根据第一计算结果、生成的第二随机数、服务器证书信息生成第三拼接值，将第三拼接值发送给终端；终端接收第三拼接值，并将其下发给所述动态令牌模块进行验证，验证通过则从动态令牌模块中获取第三拼接结果，并将其发送给服务器；服务器接收所述第三拼接结果并进行解析和验证，解析成功并验证通过时根据令牌种子生成第五拼接值，并将其发送给终端；终端接收第五拼接值，并将其下发给动态令牌模块进行验证，如验证通过则动态令牌模块从第五拼接值中获取令牌种子并存储。本发明的方法具有方便安全的特点。"><meta name="DC.date" content="2012-8-29"><meta name="DC.relation" content="CN:101719826:A" scheme="references"><meta name="DC.relation" content="CN:101741852:A" scheme="references"><meta name="DC.relation" content="CN:101777158:A" scheme="references"><meta name="DC.relation" content="CN:102025716:A" scheme="references"><meta name="DC.relation" content="US:20090006858:A1" scheme="references"><meta name="citation_reference" content="张秋余,等: &quot;一种新的基于PKI的动态身份认证系统的设计&quot;, 《计算机应用研究》, vol. 23, no. 10, 7 November 2006 (2006-11-07), pages 116 - 118"><meta name="citation_patent_publication_number" content="CN:102651743:A"><meta name="citation_patent_application_number" content="CN:201210134173"><link rel="canonical" href="https://www.google.com/patents/CN102651743A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN102651743A?cl=zh"/><meta name="title" content="专利 CN102651743A - 一种令牌种子的生成方法"/><meta name="description" content="本发明公开一种令牌种子的生成方法，包括：终端获取动态令牌模块中的第一计算结果并将其发送给服务器；服务器根据第一计算结果、生成的第二随机数、服务器证书信息生成第三拼接值，将第三拼接值发送给终端；终端接收第三拼接值，并将其下发给所述动态令牌模块进行验证，验证通过则从动态令牌模块中获取第三拼接结果，并将其发送给服务器；服务器接收所述第三拼接结果并进行解析和验证，解析成功并验证通过时根据令牌种子生成第五拼接值，并将其发送给终端；终端接收第五拼接值，并将其下发给动态令牌模块进行验证，如验证通过则动态令牌模块从第五拼接值中获取令牌种子并存储。本发明的方法具有方便安全的特点。"/><meta property="og:title" content="专利 CN102651743A - 一种令牌种子的生成方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN102651743A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN102651743A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=sF-dBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN102651743A&amp;usg=AFQjCNGJofd7f78Onf269mJgOeaPvgUJhA" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/32dc741c3cafef77a820/CN102651743A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/32dc741c3cafef77a820/CN102651743A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN102651743A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN102651743A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN102651743A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN102651743B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN102651743A?cl=zh" style="display:none"><span itemprop="description">本发明公开一种令牌种子的生成方法，包括：终端获取动态令牌模块中的第一计算结果并将其发送给服务器；服务器根据第一计算结果、生成的第二随机数、服务器证书信息生成第三拼接值，将第三拼接值发送给终端；终端接收...</span><span itemprop="url">https://www.google.com/patents/CN102651743A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN102651743A - 一种令牌种子的生成方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN102651743A - 一种令牌种子的生成方法" title="专利 CN102651743A - 一种令牌种子的生成方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN102651743 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201210134173</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2012年8月29日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2012年5月2日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2012年5月2日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102651743B?hl=zh-CN&amp;cl=zh">CN102651743B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201210134173.3, </span><span class="patent-bibdata-value">CN 102651743 A, </span><span class="patent-bibdata-value">CN 102651743A, </span><span class="patent-bibdata-value">CN 201210134173, </span><span class="patent-bibdata-value">CN-A-102651743, </span><span class="patent-bibdata-value">CN102651743 A, </span><span class="patent-bibdata-value">CN102651743A, </span><span class="patent-bibdata-value">CN201210134173, </span><span class="patent-bibdata-value">CN201210134173.3</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E4%BA%8E%E5%8D%8E%E7%AB%A0%22">于华章</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%99%86%E8%88%9F%22">陆舟</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E9%A3%9E%E5%A4%A9%E8%AF%9A%E4%BF%A1%E7%A7%91%E6%8A%80%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">飞天诚信科技股份有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102651743A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102651743A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102651743A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (5),</span> <span class="patent-bibdata-value"><a href="#npl-citations">非专利引用</a> (1),</span> <span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (3),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (2),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=sF-dBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201210134173&amp;usg=AFQjCNGhv7mr32Im-U05n3wyw4T0L_vETA"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=sF-dBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D102651743A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNGLqE165Sc7meNV_8TGMxKktwpHow"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT114931002" lang="ZH" load-source="patent-office">一种令牌种子的生成方法</invention-title>
      </span><br><span class="patent-number">CN 102651743 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA99762749" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明公开一种令牌种子的生成方法，包括：终端获取动态令牌模块中的第一计算结果并将其发送给服务器；服务器根据第一计算结果、生成的第二随机数、服务器证书信息生成第三拼接值，将第三拼接值发送给终端；终端接收第三拼接值，并将其下发给所述动态令牌模块进行验证，验证通过则从动态令牌模块中获取第三拼接结果，并将其发送给服务器；服务器接收所述第三拼接结果并进行解析和验证，解析成功并验证通过时根据令牌种子生成第五拼接值，并将其发送给终端；终端接收第五拼接值，并将其下发给动态令牌模块进行验证，如验证通过则动态令牌模块从第五拼接值中获取令牌种子并存储。本发明的方法具有方便安全的特点。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(15)</span></span></div><div class="patent-text"><div mxw-id="PCLM44938609" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.一种令牌种子的生成方法，其特征在于，包括：  步骤A :终端获取动态令牌模块中的第一计算结果，判断是否与服务器连接，是则执行步骤B，否则输出错误提示信息，结束；  步骤B :所述终端将所述第一计算结果发送给所述服务器；  步骤C :所述服务器接收所述第一计算&#32080;果，生成第二随机数，根据所述第一计算结果和所述第二随机数生成第一会话密钥和第一认证码密钥，根据所述第二随机数生成第一计算值；  步骤D :所述服务器使用所述第一认证码密钥对服务器证书信息进行计算生成服务器证书信息计算值；使用证书私钥对所述第一计算结果和第二随机数进行签名生成第一签名值；  步骤E :所述服务器判断是否存储有第一待加密数据和/或第一待签名数据，如存储有第一待加密数据和第一待签名数据则执行步骤F1，如只存储有第一待加密数据则执行步骤F2，如只存储有第一待签名数据则执行步骤F3，如两者都未存储则执行步骤F4 ；  步骤Fl :所述服务器获取第一待加密数据和第一待签名数据，使用所述第一会话密钥对所述第一待加密数据进行加密生成第一加密值，根据所述第一计算值、服务器证书信息、服务器证书信息计算值、第一待签名数据、第一加密值、第一签名值生成第二拼接值，顺序执行步骤G ；  步骤F2 :所述服务器获取第一待加密数据，使用所述第一会话密钥对所述第一待加密数据进行加密生成第一加密值，根据所述第一计算值、服务器证书信息、服务器证书信息计算值、第一加密值、第一签名值生成第二拼接值，顺序执行步骤G ；  步骤F3 :所述服务器获取第一待签名数据，根据所述第一计算值、服务器证书信息、月艮务器证书信息计算值、第一待签名数据、第一签名值生成第二拼接值，顺序执行步骤G ;  步骤F4 :所述服务器根据所述第一计算值、服务器证书信息、服务器证书信息计算值和第一签名值生成第二拼接值，顺序执行步骤G，  步骤G :使用所述第一认证码密钥对所述第二拼接值进行计算生成第三计算值，根据所述第二拼接值和第三计算值生成第三拼接值，并将所述第三拼接值发送给所述终端；步骤H :所述终端接收所述第三拼接值，并将所述第三拼接值下发给所述动态令牌模块进行验证，如验证通过，则执行步骤I，如验证未通过则结束；  步骤I :所述终端从所述动态令牌模块中获取第三拼接结果，并将其发送给所述服务器；  步骤J :所述服务器接收所述第三拼接结果并进行解析，判断解析是否成功，是则执行步骤K，否则给所述终端发送错误提示信息，结束；  步骤K :所述服务器对解析结果进行验证，如验证通过，则执行步骤L，如验证未通过则给终端返回错误提示信息，结束；  步骤L :所述服务器根据令牌种子生成第三待加密数据，使用所述第一会话密钥对第三待加密数据进行加密生成第二加密值；  步骤M :所述服务器判断是否存储有第三待签名数据，是则执行步骤N，否则执行步骤O ；  步骤N :所述服务器获取第三待签名数据，根据所述第三待签名数据、第二加密值和解析结果中的临时随机数生成第四拼接值，使用所述第一认证码密钥对所述第四拼接值进行计算生成第四计算值；根据所述第四拼接值和所述第四计算值生成第五拼接值，将所述第五拼接值发送给所述终端，顺序执行步骤P;  步骤O :所述服务器根据所述第二加密值和解析结果中的临时随机数生成第四拼接值，使用所述第一认证码密钥对所述第四拼接值进行计算生成第四计算值；根据所述第四拼接值和第四计算值生成第五拼接值，将所述第五拼接值发送给所述终端，顺序执行步骤P;  步骤P:所述终端接收所述第五拼接值，并将所述第五拼接值下发给所述动态令牌模块进行验证，如验证通过，则所述动态令牌模块从所述第五拼接值中获取所述令牌种子并存储，如验证未通过，则结束。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.如权利要求I所述的方法，其特征在于，所述步骤A中终端获取动态令牌模块中的第�计算&#32080;果，具体包括：所述终端通过给所述动态令牌模块下发第一指令，获取所述动态令牌模块生成的第一计算&#32080;果。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.如权利要求2所述的方法，其特征在干，在所述终端下发第一指令和获取第一计算结果之间还包括：  所述动态令牌模块在接收到所述第一指令时，按照第一预设算法对生成的第一随机数进行计算生成所述第一计算&#32080;果。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.如权利要求3所述的方法，其特征在于，所述第一随机数是动态令牌模块接收到第一指令时生成的或之前生成。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.如权利要求3所述的方法，其特征在于，所述步骤C中生成第一会话密钥和第一认证码密钥，具体包括：  根据所述第一计算结果和所述第二随机数生成第二计算值；  对所述第二计算值进行掩膜运算得到第三计算值，将所述第三计算值的前半部分数据作为所述第一会话密钥，将所述第三计算值的后半部分数据作为所述第一认证码密钥。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.如权利要求5所述的方法，其特征在于，所述步骤C中根据所述第二随机数生成第一计算值，具体包括：  按照所述第一预设算法对所述第二随机数进行计算生成所述第一计算值。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.如权利要求6所述的方法，其特征在于，所述步骤D中生成第一签名值，具体包括：  对所述第一计算结果和第一计算值拼接生成第一拼接值；  使用所述证书私钥对所述第一拼接值进行签名生成第一签名值。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.如权利要求7所述的方法，其特征在于，所述步骤F1、步骤F2、步骤F3和步骤F4中生成第二拼接值的方式具体为：顺序拼接。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.如权利要求8所述的方法，其特征在于，所述步骤H和步骤I之间包括：所述动态令牌模块接收所述第三拼接值并对其进行验证，验证过程具体包括：  步骤Hl :所述动态令牌模块接收所述第三拼接值并对其进行解析，判断解析是否成功，是则执行步骤H2，否则给终端返回错误提示信息，结束；  步骤H2 :所述动态令牌模块根据解析得到的第一计算值和所述第一随机数生成第二计算&#32080;果，对所述第二计算结果进行掩膜运算得到第三计算&#32080;果，将所述第三计算结果的前半部分数据作为所述第二会话密钥，将所述第三计算结果的后半部分数据作为所述第二认证码密钥；  步骤H3 :所述动态令牌模块使用所述第二认证码密钥对解析得到的第二拼接值进行计算，生成第一验证结果，判断所述第一验证结果与解析得到的第三计算值是否相同，是则执行步骤H4，否则结束；  步骤H4 :所述动态令牌模块使用所述第二认证码密钥对解析得到的服务器证书信息进行计算，生成服务器证书信息计算&#32080;果，判断所述服务器证书信息计算结果与解析得到的服务器证书信息计算值是否相同，是则执行步骤H5，否则结束；  步骤H5 :所述动态令牌模块判断解析结果中是否有第一加密值，是则执行步骤H6，否则验证通过；  步骤H6 :所述动态令牌模块使用所述第二会话密钥对解析得到的第一加密值进行解密，如解密成功则验证通过，否则验证未通过。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.如权利要求9所述的方法，其特征在于，所述验证通过后、步骤I之前包括：  步骤H-I :所述动态令牌模块使用所述第二认证码密钥对令牌证书信息进行计算，生成令牌证书信息计算&#32080;果，对所述第一计算结果和解析得到的第一计算值拼接生成第一拼接&#32080;果，使用证书私钥对所述第一拼接结果进行加密生成第一加密结果；  步骤H-2 :所述动态令牌模块生成临时随机数并获取动态令牌序列号；  步骤H-3 :所述动态令牌模块对所述令牌证书信息、令牌证书信息计算结果、第一加密结果、动态令牌序列号、临时随机数顺序拼接生成第二拼接&#32080;果；  步骤H-4 :所述动态令牌模块使用所述第二认证码密钥对所述第二拼接结果进行计算生成第三计算&#32080;果，对所述第二拼接结果和所述第三计算结果拼接生成第三拼接&#32080;果。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="11" class="claim">
      <div class="claim-text">11.如权利要求10所述的方法，其特征在于，在步骤H-2和步骤H-3之间包括：  所述动态令牌模块判断是否存储第二待加密数据和/或第二待签名数据，如存储有第二待加密数据和第二待签名数据则执行步骤H-3-1，如只存储有第二待加密数据则执行步骤H-3-2，如只存储有第二待签名数据则执行步骤H-3-3 ;如两者都未存储则执行步骤H-3 ；  步骤H-3-1 :所述动态令牌模块获取所述第二待加密数据和第二待签名数据，使用所述第二会话密钥对所述第二待加密数据进行加密生成第二加密数据，对所述令牌证书信息、令牌证书信息计算结果、第一加密结果、第二待签名数据、第二加密数据、动态令牌序列号、临时随机数顺序拼接生成第二拼接&#32080;果，顺序执行步骤H-4 ；  步骤H-3-2 :所述动态令牌模块获取所述第二待加密数据，使用所述第二会话密钥对所述第二待加密数据进行加密生成第二加密数据，对所述令牌证书信息、令牌证书信息计算结果、第一加密结果、第二加密数据、动态令牌序列号、临时随机数顺序拼接生成第二拼接&#32080;果，顺序执行步骤H-4;  步骤H-3-3 :所述动态令模块获取所述第二待签名数据，对所述令牌证书信息、令牌证书信息计算结果、第一加密结果、第二待签名数据、动态令牌序列号、临时随机数顺序拼接生成第二拼接&#32080;果，顺序执行步骤H-4。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12.如权利要求10所述的方法，其特征在于，所述步骤K包括：  步骤Kl :所述服务器根据解析得到的动态令牌序列号，查找对应的令牌证书信息，如找到，则执行步骤K2，否则给终端返回错误信息，结束；步骤K2 :所述服务器使用所述第一认证码密钥对所述令牌证书信息进行计算，生成令牌证书信息计算值，并判断所述令牌证书信息计算值与解析得到的令牌证书信息计算结果是否相同，是则执行步骤K3，否则给终端返回错误信息，结束；  步骤K3 :所述服务器从所述令牌证书信息中获取证书公钥，使用所述证书公钥对解析得到的第一加密结果进行解密，判断解密结果与所述第一拼接值是否相同，是则执行步骤K4，否则给终端返回错误信息，结束；  步骤K4 :所述服务器使用所述第一认证码密钥对解析得到的第二拼接结果进行计算得到第一验证值，判断所述第一验证值与解析得到的第三计算结果是否相同，是则验证通过，否则验证未通过。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13.如权利要求11或12所述的方法，其特征在于，所述步骤L中生成第三待加密数据具体包括：  所述服务器对软件版本号、动态ロ令算法标识、动态ロ令长度、哈希算法标识、时间步长、起始时间、服务器时间、固定字节、所述令牌种子、认证数据顺序拼接生成第三待加密数据。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="14" class="claim">
      <div class="claim-text">14.如权利要求13所述的方法，其特征在于，所述生成所述第四拼接值和所述第五拼接值的方式均为顺序拼接。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="15" class="claim">
      <div class="claim-text">15.如权利要求14所述的方法，其特征在于，所述步骤P包括：所述终端接收所述第五拼接值，并将所述第五拼接值下发给所述动态令牌模块；  所述动态令牌接收所述第五拼接值并对其进行验证，如验证通过，则所述动态令牌模块从所述第五拼接值中获取所述令牌种子并存储，如验证未通过，则结束；  其中，所述动态令牌模块对所述第五拼接值进行验证，具体包括：  步骤Pl :所述动态令牌模块对所述第五拼接值进行解析，判断解析是否成功，是则执行步骤P2，否则结束；  步骤P2 :使用所述第二认证码密钥对解析得到的第四拼接值进行计算，生成第二验证结果，并判断所述第二验证结果与解析得到的第四计算值是否相同，是则执行步骤P3，否则结束；  步骤P3 :判断解析得到的临时随机数和所述临时随机数是否相同，是则执行步骤P4，否则结束；  步骤P4:使用所述第二会话密钥对解析得到的第二加密值进行解密，如解密成功则得到动态令牌种子，进行存储，如解密失败则结束。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES51319429" lang="ZH" load-source="patent-office" class="description">
    <p>一种令牌种子的生成方法</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及信息安全技术领域，尤其涉及一种令牌种子的生成方法。</p>
    <p>背景技术</p>
    <p>[0002]	随着电子政务、电子商务等应用系统的飞速发展，动态密码技术作为替换静态密码的有效方式，由于其使用简便、安全性好，使得动态密码系统也得到了广泛应用。</p>
    <p>[0003]	动态密码是一次性密码，每个密码只能使用一次，它随着时间或使用次数的变化而不断变化。动态令牌是�种密码设备，用于产生动态密码。动态密码的产生依赖于种子密钥，每个令牌都内置�个不同的种子密钥。这个种子密钥结合时间、使用次数值和/或挑战信息，用于产生动态密码。种子密钥是动态密码的安全基础。如果种子密钥外泄，将极大的影响动态密码的安全性。</p>
    <p>[0004]	在实际的动态令牌应用中，一般是由令牌的制造商产生种子密钥，并注入到令牌中。同时，需要令牌制造商提供种子文件给客户，并将其导入动态密码认证系统，以便完成动态密码的认证。有些情况下，种子密钥也由客户产生，然后提供给令牌制造商用于生产动态密码。不管在哪种情况下，令牌的种子密钥必须由令牌制造商掌握。</p>
    <p>[0005]	对于上述情况，种子密钥的保密成为�个关键问题。尤其是令牌用量特大的金融、电子商务类客户，对种子的安全非常敏感，非常担心由于种子密钥外泄所带来的巨大损失。因此，如何安全地生成种子、防止种子外泄是本领域亟待解决的问题。</p>
    <p>发明内容</p>
    <p>[0006]	本发明的目的是为了克服现有技术的不足，提供一种令牌种子的生成方法，其具有方便安全的特点。</p>
    <p>[0007]	本发明提供一种令牌种子的生成方法，包括：</p>
    <p>[0008]	步骤A :终端获取动态令牌模块中的第一计算&#32080;果，判断是否与服务器连接，是则执行步骤B，否则输出错误提示信息，结束；</p>
    <p>[0009]	步骤B :所述终端将所述第一计算结果发送给所述服务器；</p>
    <p>[0010]	步骤C :所述服务器接收所述第一计算&#32080;果，生成第二随机数，根据所述第一计算结果和所述第二随机数生成第一会话密钥和第一认证码密钥，根据所述第二随机数生成第一计算值；</p>
    <p>[0011]	步骤D :所述服务器使用所述第一认证码密钥对服务器证书信息进行计算生成服务器证书信息计算值；使用证书私钥对所述第一计算结果和第二随机数进行签名生成第一签名值； [0012]	步骤E :所述服务器判断是否存储有第一待加密数据和/或第一待签名数据，如存储有第一待加密数据和第一待签名数据则执行步骤F1，如只存储有第一待加密数据则执行步骤F2，如只存储有第一待签名数据则执行步骤F3，如两者都未存储则执行步骤F4 ；</p>
    <p>[0013]	步骤Fl :所述服务器获取第一待加密数据和第一待签名数据，使用所述第一会话密钥对所述第一待加密数据进行加密生成第一加密值，根据所述第一计算值、服务器证书信息、服务器证书信息计算值、第一待签名数据、第一加密值、第一签名值生成第二拼接值，顺序执行步骤G ;[0014]	步骤F2 :所述服务器获取第一待加密数据，使用所述第一会话密钥对所述第一待加密数据进行加密生成第一加密值，根据所述第一计算值、服务器证书信息、服务器证书信息计算值、第一加密值、第一签名值生成第二拼接值，顺序执行步骤G ；</p>
    <p>[0015]	步骤F3 :所述服务器获取第一待签名数据，根据所述第一计算值、服务器证书信息、服务器证书信息计算值、第一待签名数据、第一签名值生成第二拼接值，顺序执行步骤G ；</p>
    <p>[0016]	步骤F4 :所述服务器根据所述第一计算值、服务器证书信息、服务器证书信息计算值和第一签名值生成第二拼接值，顺序执行步骤G，</p>
    <p>[0017]	步骤G :使用所述第一认证码密钥对所述第二拼接值进行计算生成第三计算值，根据所述第二拼接值和第三计算值生成第三拼接值，并将所述第三拼接值发送给所述终端;</p>
    <p>[0018]步骤H	:所述终端接收所述第三拼接值，并将所述第三拼接值下发给所述动态令牌模块进行验证，如验证通过，则执行步骤I，如验证未通过则结束；</p>
    <p>[0019]	步骤I :所述终端从所述动态令牌模块中获取第三拼接&#32080;果，并将其发送给所述服务器；</p>
    <p>[0020]	步骤J :所述服务器接收所述第三拼接结果并进行解析，判断解析是否成功，是则执行步骤K，否则给所述终端发送错误提示信息，结束；</p>
    <p>[0021]	步骤K :所述服务器对解析结果进行验证，如验证通过，则执行步骤L，如验证未通过则给&#32066;端返回错误提示信息，结束；</p>
    <p>[0022]	步骤L :所述服务器根据令牌种子生成第三待加密数据，使用所述第一会话密钥对第三待加密数据进行加密生成第二加密值；</p>
    <p>[0023]	步骤M :所述服务器判断是否存储有第三待签名数据，是则执行步骤N，否则执行步骤0 ;</p>
    <p>[0024]	步骤N :所述服务器获取第三待签名数据，根据所述第三待签名数据、第二加密值和解析结果中的临时随机数生成第四拼接值，使用所述第一认证码密钥对所述第四拼接值进行计算生成第四计算值；根据所述第四拼接值和所述第四计算值生成第五拼接值，将所述第五拼接值发送给所述终端，顺序执行步骤P ;</p>
    <p>[0025]	步骤0 :所述服务器根据所述第二加密值和解析结果中的临时随机数生成第四拼接值，使用所述第一认证码密钥对所述第四拼接值进行计算生成第四计算值；根据所述第四拼接值和第四计算值生成第五拼接值，将所述第五拼接值发送给所述终端，顺序执行步骤P;</p>
    <p>[0026]	步骤P :所述终端接收所述第五拼接值，并将所述第五拼接值下发给所述动态令牌模块进行验证，如验证通过，则所述动态令牌模块从所述第五拼接值中获取所述令牌种子并存储，如验证未通过，则结束。</p>
    <p>[0027]	其中，所述步骤A中终端获取动态令牌模块中的第一计算结果，具体包括：所述终端通过给所述动态令牌模块下发第一指令，获取所述动态令牌模块生成的第一计算&#32080;果。[0028]	其中，在所述终端下发第一指令和获取第一计算结果之间还包括：</p>
    <p>[0029]	所述动态令牌模块在接收到所述第一指令时，按照第一预设算法对生成的第一随机数进行计算生成所述第一计算&#32080;果。</p>
    <p>[0030]	其中，所述第一随机数是动态令牌模块接收到第一指令时生成的或之前生成。</p>
    <p>[0031]	其中，所述步骤C中生成第一会话密钥和第一认证码密钥，具体包括：</p>
    <p>[0032]	根据所述第一计算结果和所述第二随机数生成第二计算值；</p>
    <p>[0033]	对所述第二计算值进行掩膜运算得到第三计算值，将所述第三计算值的前半部分 数据作为所述第一会话密钥，将所述第三计算值的后半部分数据作为所述第一认证码密钥。</p>
    <p>[0034]	其中，所述步骤C中根据所述第二随机数生成第一计算值，具体包括：</p>
    <p>[0035]	按照所述第一预设算法对所述第二随机数进行计算生成所述第一计算值。</p>
    <p>[0036]	其中，所述步骤D中生成第一签名值，具体包括：</p>
    <p>[0037]对所述第一计算结果和第一计算值拼接生成第一拼接值；</p>
    <p>[0038]	使用所述证书私钥对所述第一拼接值进行签名生成第一签名值。</p>
    <p>[0039]	其中，所述步骤F1、步骤F2、步骤F3和步骤F4中生成第二拼接值的方式具体为：顺序拼接。</p>
    <p>[0040]	其中，所述步骤H和步骤I之间包括：所述动态令牌模块接收所述第三拼接值并对其进行验证，验证过程具体包括：</p>
    <p>[0041]	步骤Hl :所述动态令牌模块接收所述第三拼接值并对其进行解析，判断解析是否成功，是则执行步骤H2，否则给终端返回错误提示信息，结束；</p>
    <p>[0042]	步骤H2 :所述动态令牌模块根据解析得到的第一计算值和所述第一随机数生成第二计算&#32080;果，对所述第二计算结果进行掩膜运算得到第三计算&#32080;果，将所述第三计算结果的前半部分数据作为所述第二会话密钥，将所述第三计算结果的后半部分数据作为所述第二认证码密钥；</p>
    <p>[0043]	步骤H3 :所述动态令牌模块使用所述第二认证码密钥对解析得到的第二拼接值进行计算，生成第一验证结果，判断所述第一验证结果与解析得到的第三计算值是否相同，是则执行步骤H4，否则结束；</p>
    <p>[0044]	步骤H4 :所述动态令牌模块使用所述第二认证码密钥对解析得到的服务器证书信息进行计算，生成服务器证书信息计算结果，判断所述服务器证书信息计算结果与解析得到的服务器证书信息计算值是否相同，是则执行步骤H5，否则结束；</p>
    <p>[0045]	步骤H5 :所述动态令牌模块判断解析结果中是否有第一加密值，是则执行步骤H6，否则验证通过；</p>
    <p>[0046]	步骤H6 :所述动态令牌模块使用所述第二会话密钥对解析得到的第一加密值进行解密，如解密成功则验证通过，否则验证未通过。</p>
    <p>[0047]	其中，所述验证通过后、步骤I之前包括：</p>
    <p>[0048]	步骤H-I :所述动态令牌模块使用所述第二认证码密钥对令牌证书信息进行计算，生成令牌证书信息计算&#32080;果，对所述第一计算结果和解析得到的第一计算值拼接生成第一拼接&#32080;果，使用证书私钥对所述第一拼接结果进行加密生成第一加密结果；</p>
    <p>[0049]	步骤H-2 :所述动态令牌模块生成临时随机数并获取动态令牌序列号；[0050]	步骤H-3 :所述动态令牌模块对所述令牌证书信息、令牌证书信息计算结果、第一加密结果、动态令牌序列号、临时随机数顺序拼接生成第二拼接&#32080;果；</p>
    <p>[0051]	步骤H-4 :所述动态令牌模块使用所述第二认证码密钥对所述第二拼接结果进行计算生成第三计算&#32080;果，对所述第二拼接结果和所述第三计算结果拼接生成第三拼接结果。</p>
    <p>[0052]	其中，在步骤H-2和步骤H-3之间包括：</p>
    <p>[0053]	所述动态令牌模块判断是否存储第二待加密数据和/或第二待签名数据，如存储有第二待加密数据和第二待签名数据则执行步骤H-3-1，如只存储有第二待加密数据则执行步骤H-3-2，如只存储有第二待签名数据则执行步骤H-3-3 ;如两者都未存储则执行步骤H-3 ；</p>
    <p>[0054]	步骤H-3-1 :所述动态令牌模块获取所述第二待加密数据和第二待签名数据，使用所述第二会话密钥对所述第二待加密数据进行加密生成第二加密数据，对所述令牌证书信息、令牌证书信息计算结果、第一加密结果、第二待签名数据、第二加密数据、动态令牌序列号、临时随机数顺序拼接生成第二拼接&#32080;果，顺序执行步骤H-4 ；</p>
    <p>[0055]	步骤H-3-2 :所述动态令牌模块获取所述第二待加密数据，使用所述第二会话密钥对所述第二待加密数据进行加密生成第二加密数据，对所述令牌证书信息、令牌证书信息计算结果、第一加密结果、第二加密数据、动态令牌序列号、临时随机数顺序拼接生成第ニ拼接&#32080;果，顺序执行步骤H-4 ；</p>
    <p>[0056]	步骤H-3-3 :所述动态令模块获取所述第二待签名数据，对所述令牌证书信息、令牌证书信息计算结果、第一加密结果、第二待签名数据、动态令牌序列号、临时随机数顺序拼接生成第二拼接&#32080;果，顺序执行步骤H-4。</p>
    <p>[0057]	其中，所述步骤K包括：</p>
    <p>[0058]	步骤Kl :所述服务器根据解析得到的动态令牌序列号，查找对应的令牌证书信息，如找到，则执行步骤K2，否则给终端返回错误信息，结束；</p>
    <p>[0059]	步骤K2 :所述服务器使用所述第一认证码密钥对所述令牌证书信息进行计算，生成令牌证书信息计算值，并判断所述令牌证书信息计算值与解析得到的令牌证书信息计算结果是否相同，是则执行步骤K3，否则给终端返回错误信息，结束；</p>
    <p>[0060]	步骤K3 :所述服务器从所述令牌证书信息中获取证书公钥，使用所述证书公钥对解析得到的第一加密结果进行解密，判断解密结果与所述第一拼接值是否相同，是则执行步骤K4，否则给终端返回错误信息，结束；</p>
    <p>[0061]	步骤K4 :所述服务器使用所述第一认证码密钥对解析得到的第二拼接结果进行计算得到第一验证值，判断所述第一验证值与解析得到的第三计算结果是否相同，是则验证通过，否则验证未通过。</p>
    <p>[0062]	其中，所述步骤L中生成第三待加密数据具体包括：</p>
    <p>[0063]	所述服务器对软件版本号、动态ロ令算法标识、动态ロ令长度、哈希算法标识、时间步长、起始时间、服务器时间、固定字节、所述令牌种子、认证数据顺序拼接生成第三待加密数据。 [0064]	其中，所述生成所述第四拼接值和所述第五拼接值的方式均为顺序拼接。</p>
    <p>[0065]	其中，所述步骤P包括：所述终端接收所述第五拼接值，并将所述第五拼接值下发给所述动态令牌模块；</p>
    <p>[0066]	所述动态令牌接收所述第五拼接值并对其进行验证，如验证通过，则所述动态令牌模块从所述第五拼接值中获取所述令牌种子并存储，如验证未通过，则结束；</p>
    <p>[0067]	其中，所述动态令牌模块对所述第五拼接值进行验证，具体包括：</p>
    <p>[0068]	步骤Pl :所述动态令牌模块对所述第五拼接值进行解析，判断解析是否成功，是则执行步骤P2，否则结束；</p>
    <p>[0069]	步骤P2 :使用所述第二认证码密钥对解析得到的第四拼接值进行计算，生成第二验证结果，并判断所述第二验证结果与解析得到的第四计算值是否相同，是则执行步骤P3，否则结束；</p>
    <p>[0070]	步骤P3 :判断解析得到的临时随机数和所述临时随机数是否相同，是则执行步骤 P4，否则结束；</p>
    <p>[0071]	步骤P4:使用所述第二会话密钥对解析得到的第二加密值进行解密，如解密成功则得到动态令牌种子，进行存储，如解密失败则结束。</p>
    <p>[0072]	本发明与现有技术相比，具有以下优点：</p>
    <p>[0073]	本发明中的&#32066;端中设置动态令牌模块，对于联机终端而言，通过终端与服务器进行交互的过程中生成并同步更新种子密钥，不需要提前生成令牌种子，有利于生产流程的简化；且动态令牌模块中存储的令牌种子不出&#32066;端，进�步的提高了令牌种子的安全性，还可以完成生产和检测的连续进行；令牌动态模块中的种子和服务器中的种子可以采用不同的数据形式保存，即无法通过服务器中的种子推导出令牌中的令牌种子，且动态令牌模块设置在&#32066;端中，与&#32066;端合为一体，保证了动态令牌模块中保存的令牌种子的安全性。</p>
    <p>附图说明</p>
    <p>[0074]	图I为本发明实施例一提供的一种令牌种子到的生成方法流程图；</p>
    <p>[0075]	图2和图3为本发明实施例ニ提供的另�种令牌种子的生成方法流程图。</p>
    <p>具体实施方式</p>
    <p>[0076]	为更近�步阐述本发明为达成预订目的所采取的技术手段及功效，以下结合附图及较佳实施例，对依据发明提出的�种令牌种子生成方法，其具体实施方式、结构、特征及其功效，说明如后。</p>
    <p>[0077]	实施例一</p>
    <p>[0078]	本发明实施例一提供一种令牌种子的生成方法，适用于时间型或事件型的动态ロ令，&#32066;端内设置有动态令牌模块，&#32066;端和认证服务器相互连接进行通信，如图I所示，包括：</p>
    <p>[0079]	步骤A :终端获取动态令牌模块中的第一计算&#32080;果，判断是否与服务器连接，是则执行步骤B，否则输出错误提示信息，结束；</p>
    <p>[0080]	步骤B :终端将第一计算结果发送给服务器；</p>
    <p>[0081]	步骤C :服务器接收第一计算结果，生成第二随机数，根据第一计算结果和所述第ニ随机数生成第一会话密钥和第一认证码密钥，根据第二随机数生成第一计算值；</p>
    <p>[0082]	步骤D :服务器使用第一认证码密钥对服务器证书信息进行计算生成服务器证书信息计算值；使用证书私钥对第一计算结果和第二随机数进行签名生成第一签名值；[0083]	步骤E :服务器判断是否存储有第一待加密数据和/或第一待签名数据，如存储有第一待加密数据和第一待签名数据则执行步骤F1，如只存储有第一待加密数据则执行步骤F2，如只存储有第一待签名数据则执行步骤F3，如两者都未存储则执行步骤F4 ；</p>
    <p>[0084]	步骤Fl :服务器获取第一待加密数据和第一待签名数据，使用第一会话密钥对第一待加密数据进行加密生成第一加密值，根据第一计算值、服务器证书信息、服务器证书信息计算值、第一待签名数据、第一加密值、第一签名值生成第二拼接值，顺序执行步骤G ;</p>
    <p>[0085]	步骤F2 :服务器获取第一待加密数据，使用第一会话密钥对第一待加密数据进行加密生成第一加密值，根据第一计算值、服务器证书信息、服务器证书信息计算值、第一加密值、第一签名值生成第二拼接值，顺序执行步骤G ；</p>
    <p>[0086]	步骤F3 :服务器获取第一待签名数据，服务器根据第一计算值、服务器证书信息、服务器证书信息计算值、第一待签名数据、第一签名值生成第二拼接值，顺序执行步骤G ； [0087]	步骤F4 :服务器根据第一计算值、服务器证书信息、服务器证书信息计算值和第一签名值生成第二拼接值，顺序执行步骤G，</p>
    <p>[0088]	步骤G :服务器使用第一认证码密钥对第二拼接值进行计算生成第三计算值，根据第二拼接值和第三计算值生成第三拼接值，并将第三拼接值发送给&#32066;端；</p>
    <p>[0089]	步骤H :&#32066;端接收第三拼接值，并将第三拼接值下发给动态令牌模块进行验证，如验证通过，则执行步骤I，如验证未通过则结束；</p>
    <p>[0090]	本实施例中，动态令牌模块接收到第三拼接值先对其解析，解析成功得到第二拼接值和第三计算值，在对第二拼接值解析得到第一计算值、服务器证书信息、服务器证书信息计算值、第一签名值，对第二拼接值解析还可以得到第一待签名数据和/或第一加密值，然后对第三计算值和服务器证书信息计算值进行验证，当解析结果中还包括第一加密值时还对第一加密值进行解密操作；</p>
    <p>[0091]	步骤I :&#32066;端从动态令牌模块中获取第三拼接&#32080;果，并将其发送给服务器；</p>
    <p>[0092]	本实施例中动态令牌模块对第三拼接值验证通过时，动态令牌模块根据令牌证书信息、证书私钥、生成的临时随机数、获取的动态令牌序列号生成第三拼接&#32080;果；</p>
    <p>[0093]	步骤J :服务器接收第三拼接结果并进行解析，判断解析是否成功，是则执行步骤K，否则给终端发送错误提示信息，结束；</p>
    <p>[0094]	本实施中解析成功时的解析结果包括：第二拼接结果、第三计算结果、令牌证书信息、令牌证书信息计算结果、第一加密结果、动态令牌序列号和临时随机数；其中令牌证书信息、令牌证书信息计算结果、第一加密结果、动态令牌序列号和临时随机数有第二拼接结果解析得到；</p>
    <p>[0095]	步骤K :服务器对解析结果进行验证，如验证通过，则执行步骤L，如验证未通过则给终端返回错误提示信息，结束；</p>
    <p>[0096]	本实施例中步骤K包括：服务器对令牌证书信息计算结果和第三计算结果进行验证，对第一加密结果进行解密；</p>
    <p>[0097]	步骤L :服务器根据令牌种子生成第三待加密数据，使用所述第一会话密钥对第三待加密数据进行加密生成第二加密值；</p>
    <p>[0098]	本实施例中的第三待签名数据还可包括：软件版本号、动态ロ令算法标识、动态ロ令长度、哈希算法标识、时间步长、起始时间、服务器时间、固定字节、认证数据；其中令牌种子设置在固定字节和认证数据之间；</p>
    <p>[0099]	步骤M :服务器判断是否存储有第三待签名数据，是则执行步骤N，否则执行步骤0 ;[0100]	步骤N :服务器获取第三待签名数据，根据第三待签名数据、第二加密值和解析结果中的临时随机数生成第四拼接值，使用第一认证码密钥对第四拼接值进行计算生成第四计算值；根据第四拼接值和第四计算值生成第五拼接值，顺序执行步骤P’ ;</p>
    <p>[0101]	步骤0:服务器根据第二加密值和解析结果中的临时随机数生成第四拼接值，使用第一认证码密钥对第四拼接值进行计算生成第四计算值；根据第四拼接值和第四计算值生成第五拼接值，顺序执行步骤P’;</p>
    <p>[0102]	步骤P’ ：服务器将第五拼接值发送给&#32066;端；</p>
    <p>[0103]	步骤P :&#32066;端接收第五拼接值，并将第五拼接值下发给所述动态令牌模块进行验证，如验证通过，则动态令牌模块从第五拼接值中获取令牌种子并存储，如验证未通过，则结束；</p>
    <p>[0104]	本实施例中动态令牌接收到第五拼接值先对其进行解析，解析成功得到四拼接值、第四计算值，在从第四拼接值中解析得到第二加密值和和临时随机数或第三待签名数据、第二加密值和和临时随机数，然后对第四拼接值和临时随机数进行验证，验证成功对第ニ加密值进行解密，解密成功得到令牌种子。</p>
    <p>[0105]	本发明实施例一提供的方法中，动态令牌模块设置在&#32066;端里面，通过终端与服务器进行交互，在对终端和服务器的身份认证安全后，服务器同步生成种子通过终端发送给动态令牌模块，不需要提前生成令牌种子，有利于生产流程的简化；动态令牌模块对接收到的数据进行解析和解密最后获得令牌种子进行保存，进�步的提高了令牌种子的安全性。</p>
    <p>[0106]	实施例ニ</p>
    <p>[0107]	本发明实施例ニ提供一种令牌种子的生成方法，适用于时间型或事件型的动态ロ令，&#32066;端内设置有动态令牌模块，&#32066;端和认证服务器相互连接进行通信，如图2和图3所示，具体步骤如下：</p>
    <p>[0108]	步骤101 :终端获取动态令牌模块生成的第一计算&#32080;果，并将第一计算结果发送给与之连接的服务器；</p>
    <p>[0109]	本实施例中，终端通过给动态令牌模块下发第一指令，获取动态令牌模块生成的第一计算结果；动态令牌模块在接收到终端下发的第一指令&#21515;，按照第一预设算法对生成的第一随机数进行计算生成第一计算&#32080;果；动态令牌模块生成第一随机数可以在接收到第一指令时生成，或在接收到第一指令之前生成；具体的，第一预设算法为加密算法；</p>
    <p>[0110]	优选的，本实施例中第一计算结果为：93 ce eb 21 4b c0 2c cc da f3 ed 5226d7 46 eO b2 dO 14 84 b3 76 f8 al f4 98 ad 11 fa 85 el ab 65 64 79 5a 5a 7a 6b6c 8af3 c8 80 47 2f f9 07 c4 bO e3 a3 37 c8 9e 31 d4 b9 d7 89 7b 85 28 a5 ；</p>
    <p>[0111]	步骤102 :服务器接收第一计算结果，并生成第二随机数；</p>
    <p>[0112]	步骤103 :服务器对第二随机数进行计算生成第一计算值，根据第二随机数和第�计算结果生成第二计算值；</p>
    <p>[0113]	本实施例中生成第一计算结果和第一计算值的方法相同，第二计算值具体为：将第一计算结果作为底数，第二随机数作为幂数进行计算得到的&#32080;果；[0114]	优选的，本实施例中的第一计算值为：9a 16 6b e7 a5 5b 53 3b 69 b9 f5 7c4cl6 b5 89 a9 9d 8c b6 9b al b6 52 d4 84 6b dO 80 03 23 52 2a c8 b5 61 fd 19 745b 07b2 39 16 48 6d c2 5d 25 f6 84 la 9b a6 Oa 44 If fO 70 37 fl 48 bd la ；</p>
    <p>[0115]	步骤104 :服务器根据第二计算值生成第三计算值，将第三计算值的前半部分作为第一会话密钥，将第三计算值的后半部分作为第一认证码密钥；</p>
    <p>[0116]	本实施例中，对第二计算值进行掩膜运算（KDF(SHA 256)算法）得到第三计算值；其中，第三计算值为256bit,其中前128bit为第一会话密钥，后128bit为第一认证码密钥；</p>
    <p>[0117]	步骤105 :服务器获取服务器证书信息，并使用第一认证码密钥对服务器数字证书信息进行计算生成服务器证书信息计算值；</p>
    <p>[0118]	本实施例中服务器证书信息中包含证书私钥；优选的，本实施例中的服务器证书信息为：00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0000 Oc</p>
    <p>00	00 00 Oc 15 dc db fa 9a bd df 5c 79 7c 29 dO 78 d5 5b 50 6c 69 Od cb 5e 9117ff 2c 7e Oa e4 6e 45 e6 75 fb 52 b3 be 5d bO 94 cb f5 la 63 dl e8 29 26 40 347a93 41 39 dO 6f 4c c5 5d 3e dd Of ea 57 45 Ib 09 fe 10 22 e6 85 ae 3f 74 df e824 fl92 el c2 f9 5c 53 2b 25 97 98 36 45 26 04 80 38 69 9f el 5c ee ac dc e4 4ad3 7c 4f63 35 42 78 10 66 24 c4 2a aO d8 eO ff 13 95 12 96 e4 87 d6 73 67 00</p>
    <p>01	00 00 00 0000 00 00 00 00 00 00 00 00 00 00 00 00 02 15 dc db fa 9a bd df5c 79 7c 29 dO 78 d55b 50 6c 69 Od cb 5e 91 17 ff 2c 7e 0a e4 6e 45 e6 75 fb52 b3 be 5d bO 94 cb f5 la63 dl e8 29 26 40 34 7a 93 41 39 dO 6f 4c c5 5d 3edd Of ea 57 45 00 00 00 00 00 0000 00 00 00 00 00 00 00 00 00 00 00 00 00 0000 00 00 00 00 00 00 00 00 00 00 0000 00 00 00 00 00 00 00 00 00 00 00 00 0000 00 00 00 00 00 00 00 00 00 00 00 0000 00 00 00 ;相应的，服务器证书信息计算值为:2a 99 42 a3 2a f2 12 87 43 c7 afe6 6c 22 84 51 82 f6 0b 64 fc 8d 9d 7e 256b 34 2c f8 c4 0b 31 ；</p>
    <p>[0119]	步骤106 :服务器将第一计算结果和第一计算值进行拼接生成第一拼接值，使用证书私钥对第一拼接值进行签名操作，生成第一签名值；</p>
    <p>[0120]	本实施例中的签名算法为具体为ECDSA，还可有为其他算法，在此不做限定；</p>
    <p>[0121]	优选的，本实施例中的第一签名值为：fl 4a 19 42 41 20 02 38 7c 06 6a a28580 c5 34 43 76 db 32 bO e3 c7 76 54 ed 2a 6f 5d 89 b9 de 5f a9 a2 51 67 60 df03 aaf7 08 90 b2 4f 6c 08 a3 40 11 a6 8d 44 9f 02 aO b3 cl fe ac 70 79 eb ；</p>
    <p>[0122]	步骤107 :服务器将第一计算值、服务器证书信息、服务器证书信息计算值、第一签名值进行拼接，生成第二拼接值；</p>
    <p>[0123]	优选的，本实施例中第三计算值为：5b 3e fd 73 24 3d 3d 8b 7e ae cd el 4b9d98 7b eb 49 ca 29 de 38 9e cc fa 59 2b 7f f7 41 90 ee ； </p>
    <p>[0124]	本实施例中，在步骤106和步骤107之间还包括：</p>
    <p>[0125]	步骤106’ ：服务器判断是否存储有第一待加密数据和/或第一待签名数据，如存储有第一待加密数据和第一待签名数据则执行步骤107’，如只存储有第一待加密数据则执行步骤107”，如只存储有第一待签名数据则执行步骤107”’，如两者都未存储则执行步骤107	；</p>
    <p>[0126]	步骤107’ ：服务器获取第一待加密数据和第一待签名数据，使用第一会话密钥对第一待加密数据进行加密生成第一加密值，根据第一计算值、服务器证书信息、服务器证书信息计算值、第一待签名数据、第一加密值、第一签名值生成第二拼接值，顺序执行步骤</p>
    <p>108	；</p>
    <p>[0127]	步骤107” :服务器获取第一待加密数据，使用第一会话密钥对第一待加密数据进行加密生成第一加密值，根据第一计算值、服务器证书信息、服务器证书信息计算值、第一加密值、第一签名值生成第二拼接值，顺序执行步骤108 ；</p>
    <p>[0128]	步骤107”’ ：服务器获取第一待签名数据，根据所述第一计算值、服务器证书信息、服务器证书信息计算值、第一待签名数据、第一签名值生成第二拼接值，顺序执行步骤 108 ；</p>
    <p>[0129]	步骤108 :服务器使用第一认证码密钥对第二拼接值进行计算生成第三计算值，将第二拼接值与第三计算值进行拼接生成第三拼接值，并将第三拼接值发送给&#32066;端；</p>
    <p>[0130]	步骤109 :&#32066;端接收第三拼接值并将其下发给动态令牌模块；</p>
    <p>[0131]	步骤110 :动态令牌模块接收第三拼接值并对其进行解析，判断解析是否成功，是则执行步骤111，否则结束；</p>
    <p>[0132]	本实施例中，具体的，动态令牌模块对第三拼接值进行拆分，拆分成功得到第二拼接值、第三计算值，再对第二拼接值拆分得到第一计算值、服务器证书信息、服务器证书信息计算值、第一签名值；对第二拼接值拆分还可以得到第一待签名数据和第一加密值；</p>
    <p>[0133]	步骤111 :动态令牌模块对解析得到的第一计算值和生成的第一随机数进行计算，生成第二计算&#32080;果；</p>
    <p>[0134]	本实施例中，第二计算结果和第二计算值的生成方法相同，在此不再赘述；</p>
    <p>[0135]	步骤112 :动态令牌模块对第二计算结果进行计算生成第三计算结果，将第三计算值的前半部分作为第二会话密钥，将第三计算值的后半部分作为第二认证码密钥；</p>
    <p>[0136]	本实施例中，对第二计算结果进行掩膜运算得到第三计算结果；其中，第三计算结果为256bit,其中前128bit为第二会话密钥,后128bit为第二认证码密钥；</p>
    <p>[0137]	步骤113 :动态令牌模块使用第二认证码密钥对解析得到的第二拼接值进行计算，生成第一验证结果，判断第一验证结果与解析得到的第三计算值是否相同，是则执行步骤114，否则结束；</p>
    <p>[0138]	步骤114 :动态令牌模块使用第二认证码密钥对解析得到的服务器证书信息进行计算，生成服务器证书信息计算结果，判断服务器证书信息计算结果与解析得到的服务器证书信息计算值是否相同，是则执行步骤115，否则结束；</p>
    <p>[0139]	步骤115 :动态令牌模块判断解析结果中是否有第一加密值，是则执行步骤116，否则执行步骤117 ；</p>
    <p>[0140]	步骤116 :动态令牌模块使用第二会话密钥对第一加密值进行解密，如解密成功则执行步骤117，否则结束；</p>
    <p>[0141]	步骤117 :获取令牌证书信息，使用认证码密钥对令牌证书信息进行计算，生成令牌证书信息计算结果；</p>
    <p>[0142]	优选的，本实施例中的令牌证书信息为：00 01 00 Oc 00 00 00 00 07 cd ae09bb 3d a5 be 06 09 7a be 35 Oa dc 29 27 b9 35 59 fa b3 ff ff fe 7c bb d3 b6 85d7 6a 080d a2 Oa 8d 67 8a 83 54 74 c9 ac 4b 33 d4 8f ee aa 05 Ic a9 7c 54 f6 8518 a3 ed 5736 7d 6c 01 18 cd 9c a7 ab d9 81 93 8f 46 d3 5e 53 a9 8e e8 39 2b bO42 a6 82 eb 3c7e 3a 2b 45 42 5b Of 08 56 de 2e 9f ea 9c 5d cc f6 68 3d ea d3 4ebl 18 d7 63 66 7fcc 75 cO f5 71 ca 59 3e 95 72 86 05 ac eO 26 92 87 ba 47 095e 81 b9 18 Oa fa Od 4409 47 97 d6 19 36 00 fc eO Ob ac c5 If dc a3 00 14 2b 566a 4e a6 e8 dl 5c Oc 15 eb08 65 Ie 19 c4 ac 91 de db ff 86 dl bO be 86 8d 74 3997 05 dd 24 d4 15 fO 22 2d c7a2 9b 00 el 8c ee c2 35 19 89 cf c9 d4 b8 28 Oc f906 9d 59 73 2d c8 00 9d 40 57 a65e 55 a2 89 42 bf e4 c7 a2 19 4e 9d d5 d8 19 904f 06 03 9e a7 bd 48 82 c2 06 fl 044c 4e 4c 4f 8e fO 20 da ff e4 45 77 be 84 Oc2d 12 05 92 7c fd ed 16 76 Of f2 f4 12 f072 a5 07 76 Oa cf 5f cf ae 78 46 01 e2be 82 eb 5d ab fO de bl 75 54 f2 aO 18 b8 c9 f8e3 dl 20 al 82 a9 91 53 83 16 Ifa5 be ca c5 4e ba e9 58 b9 45 6d f2 50 d8 2d c3 766c Ie Oa 28 6b b5 dd df 3c 9025 12 09 5d 97 9f 5b 53 77 30 8f 6f 6a 30 3f eb 78 c963 8d fd 5c c3 4b 94 40fO 2a 35 55 bf ;相应的，令牌证书信息计算结果为：94 3834 ec 97 30 8b 34 33 22 8155 Oc c3 d8 47 9c b2 b4 ab 12 96 al d4 47 69 dd 09 c9 4a50 7d ；</p>
    <p>[0143]	步骤118 :动态令牌模块将第一计算结果和第一计算值进行拼接生成第一拼接结果，使用令牌私钥对第一拼接结果进行加密，生成第一加密结果；</p>
    <p>[0144]	优选的，本实施例中的第一加密结果为：92 Dl 69 Fl 94 99 OB CD D5 45 6393DO 4D 3E BD Dl 01 75 F6 28 A2 7E 11 7A 57 61 BE EB D7 14 89 ；</p>
    <p>[0145]	步骤119 :动态令牌模块获取动态令牌序列号，并生成临时随机数；</p>
    <p>[0146]	优选的，本实施例中的动态令牌序列号为：00 00 00 00 ;生成的临时随机数为：ac 39 b5 4b 9f 07 82 10 e4 47 ；</p>
    <p>[0147]	步骤120 :动态令牌模块将令牌证书信息、令牌证书信息计算结果、第一加密结果、动态令牌序列号、临时随机数进行拼接，生成第二拼接&#32080;果；</p>
    <p>[0148]	本实施例中，在步骤119和步骤120之间还可以包括：</p>
    <p>[0149]	119’:动态令牌模块判断是否存储有第二待加密数据和/或第二待签名数据，如存储有第二待加密数据和第二待签名数据则执行步骤120-1，如只存储有第二待加密数据则执行步骤120-2，如只存储有第二待签名数据则执行步骤120-3 ;如两者都未存储则执行步骤 120 ；</p>
    <p>[0150]	步骤120-1 :动态令牌模块获取第二待加密数据和第二待签名数据，使用第二会话密钥对第二待加密数据进行加密生成第二加密数据，对令牌证书信息、令牌证书信息计算结果、第一加密结果、第二待签名数据、第二加密数据、动态令牌序列号、临时随机数顺序拼接生成第二拼接&#32080;果，顺序执行步骤121 ；</p>
    <p>[0151]	步骤120-2 :动态令牌模块获取所述第二待加密数据，使用所述第二会话密钥对所述第二待加密数据进行加密生成第二加密数据，对所述令牌证书信息、令牌证书信息计算结果、第一加密结果、第二加密数据、动态令牌序列号、临时随机数顺序拼接生成第二拼接&#32080;果，顺序执行步骤121; [0152]	步骤120-3 :动态令牌模块获取第二待签名数据，对令牌证书信息、令牌证书信息计算结果、第一加密结果、第二待签名数据、动态令牌序列号、临时随机数顺序拼接生成第二拼接结果，顺序执行步骤121 ；</p>
    <p>[0153]	步骤121 :动态令牌模块使用第二认证码密钥对第二拼接结果进行计算生成第三计算结果，将第二拼接结果和第三计算结果进行拼接生成第三拼接结果；</p>
    <p>[0154]	优选的，本实施例中的第三计算结果为：66 b0 31 46 13 ba d6 92 bf 5d 4c4439 bf 29 09 f3 ae 70 3e b5 c5 73 7e eO d7 53 38 db 39 09 8f</p>
    <p>[0155]	本实施例中，当动态令牌模块接收到终端下发的第二指令时，将第三拼接结果发送给终端；</p>
    <p>[0156]	步骤122 :终端将通过第二指令从动态令牌模块中获取的第三拼接结果发送给服务器；</p>
    <p>[0157]	步骤123 :服务器接收第三拼接结果并对其进行解析，并判断解析是否成功，是则 执行步骤124，否则给终端返回错误提示信息，结束；</p>
    <p>[0158]	具体的，本实施例中服务器对第三拼接结果进行拆分，拆分成功得到第二拼接结果和第三计算结果，再对第二拼接结果拆分得到令牌证书信息、令牌证书信息计算结果、第一加密结果、动态令牌序列号、临时随机数；</p>
    <p>[0159]	步骤124 :服务器根据解析得到的动态令牌序列号，查找对应的令牌证书信息，如找到，则执行步骤125，如未找到则给终端返回错误信息，结束；</p>
    <p>[0160]	步骤125 :服务器使用第一认证码密钥对令牌证书信息进行计算，生成令牌证书信息计算值，并判断令牌证书信息计算值与解析得到的令牌证书信息计算结果是否相同，是则执行步骤126，否则给终端返回错误信息，结束；</p>
    <p>[0161]	步骤126 :服务器从令牌证书信息中获取证书公钥，使用证书公钥对解析得到的第一加密结果进行解密，判断解密结果与第一拼接值是否相同，是则执行步骤127，否则给终端返回错误信息，结束；</p>
    <p>[0162]	步骤127 :服务器使用第一认证码密钥对解析得到的第二拼接结果进行计算得到第一验证值，判断所述第一验证值与解析得到的第三拼接结果是否相同，是则执行步骤128，否则给终端返回错误信息，结束；</p>
    <p>[0163]	步骤128 :服务器根据软件版本号、动态口令算法标识、动态口令长度、哈希算法标识、时间步长、起始时间、服务器时间、固定字节、令牌种子、认证数据生成第三待加密数据，使用第一会话密钥对第三待加密数据进行加密生成第二加密值；</p>
    <p>[0164]	本实施例中，起始时间和服务器时间为4bit，固定字节为19bit，种子为20Bit，认证数据为4bit，本实施例中的固定字节和认证数据均为O ;</p>
    <p>[0165]	优选的，本实施例中的第三待加密数据为：00 38 01 02 06 02 3c 00 00 00004f 6a a2 bl 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ee 34cc 75 1984 bO 95 94 cO 35 9a 14 d8 60 ff 72 56 62 cl 00 00 00 00 ;对应的，第二加密值为：aa a7 33 fO 47 c8 7a 5e 18 8d 65 bl 4e 42 46 f8 22 cf 40 cb 05 91 eO 657f 5c 67 5a0e ad 78 8d 5b 6d 31 9c 5e 56 d2 ef a9 14 50 84 df eb 80 3e 46 f307 25 58 5e 04 58b7 65 c9 36 35 bO 61 27 ；</p>
    <p>[0166]	步骤129 :服务器将第二加密值和解析得到的临时随机数进行拼接生成第四拼接值，使用第一认证码密钥对第四拼接值进行计算，生成第四计算值，顺序执行步骤130 ；[0167]	优选的，本实施例中的第四计算值为：45 8b ef Ic a5 94 8e 8f 37 61 65 eed8a0 la df 84 c2 88 95 9d 4b fa Od ed 31 51 06 27 04 9b ae ；</p>
    <p>[0168]	本实施例中，在步骤129之前还包括：判断是否存在第三待签名数据，是则执行步骤129’，否则执行步骤129;</p>
    <p>[0169]	步骤129’ ：服务器获取第三待签名数据，将第三待签名数据、第二加密值和解析得到的临时随机数进行拼接生成第四拼接值，使用第一认证码密钥对第四拼接值进行计算，生成第四计算值，顺序执行步骤130 ；</p>
    <p>[0170]	步骤130 :服务器将第四拼接值和第四加密值进行拼接生成第五拼接值，并将第 五拼接值发送给终端；</p>
    <p>[0171]	步骤131 :终端接收服务器发送的第五拼接值，并将其下发给动态令牌模块；</p>
    <p>[0172]	步骤132 :动态令牌模块接收第五拼接值，并对其进行解析，判断解析是否成功，是则执行步骤133，否则结束；</p>
    <p>[0173]	具体的，在本实施例中动态令牌对第五拼接值进行拆分，拆分成功得到第四拼接值和第四计算值；对第四拼接值拆分得到第二加密值和解析得到的临时随机数，对第四拼接值拆分还可以得到第三待签名数据；</p>
    <p>[0174]	步骤133 :动态令牌模块使用生成的第二认证码密钥对解析得到的第四拼接值进行计算，生成第二验证结果，并判断第二验证结果与解析得到的第四计算值是否相同，是则执行步骤134，否则结束；</p>
    <p>[0175]	步骤134 :动态令牌模块判断解析得到的临时随机数和生成的临时随机数是否相同，是则执行步骤135，否则结束；</p>
    <p>[0176]	步骤135 :动态令牌模块使用第二会话密钥对解析得到的第二加密值进行解密，如解密成功则执行步骤136，如解密失败则结束；</p>
    <p>[0177]	步骤136 :动态令牌存储解密成功得到令牌种子并存储。</p>
    <p>[0178]	对于联机动态口令产品而言，通过联机与服务器进行交互的过程中生成并同步更新种子密钥，不需要提前生成令牌种子，有利于生产流程的简化；且令牌内存储的种子不出令牌，能进一步的提高了令牌种子的安全性，还可以完成生产和检测的连续进行；令牌中的种子和服务器中的种子可以采用不同的数据形式保存，即无法通过服务器中的种子推导出令牌中的种子，从而保证了令牌中保存的种子和服务器中的种子的安全性。</p>
    <p>[0179]	以上所述，仅为本发明较佳的具体实施方式，但本发明的保护范围并不局限于此，任何熟悉本技术领域的技术人员在本发明公开的技术范围内，可轻易想到的变化或替换，都应涵盖在本发明的保护范围之内。因此，本发明的保护范围应该以权利要求的保护范围为准。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101719826A?cl=zh">CN101719826A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2009年5月13日</td><td class="patent-data-table-td patent-date-value">2010年6月2日</td><td class="patent-data-table-td ">北京宏基恒信科技有限责任公司</td><td class="patent-data-table-td ">具有种子密钥更新功能的动态令牌及其种子密钥的更新方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101741852A?cl=zh">CN101741852A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2009年12月31日</td><td class="patent-data-table-td patent-date-value">2010年6月16日</td><td class="patent-data-table-td ">北京飞天诚信科技有限公司</td><td class="patent-data-table-td ">认证方法、系统和认证装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101777158A?cl=zh">CN101777158A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年1月13日</td><td class="patent-data-table-td patent-date-value">2010年7月14日</td><td class="patent-data-table-td ">北京飞天诚信科技有限公司</td><td class="patent-data-table-td ">一种安全交易的方法和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102025716A?cl=zh">CN102025716A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年6月29日</td><td class="patent-data-table-td patent-date-value">2011年4月20日</td><td class="patent-data-table-td ">北京飞天诚信科技有限公司</td><td class="patent-data-table-td ">一种对动态口令令牌的种子进行更新的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20090006858">US20090006858</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年6月29日</td><td class="patent-data-table-td patent-date-value">2009年1月1日</td><td class="patent-data-table-td ">Duane William M</td><td class="patent-data-table-td ">Secure seed provisioning</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="npl-citations"></a><div class="patent-section-header"><span class="patent-section-title">非专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th colspan="3"class="patent-data-table-th">参考文献</th></tr></thead><tr><td class="patent-data-table-td ">1</td><td class="patent-data-table-td "><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td ">张秋余,等: "<a href='http://scholar.google.com/scholar?q="%E4%B8%80%E7%A7%8D%E6%96%B0%E7%9A%84%E5%9F%BA%E4%BA%8EPKI%E7%9A%84%E5%8A%A8%E6%80%81%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%AE%BE%E8%AE%A1"'>一种新的基于PKI的动态身份认证系统的设计</a>", 《计算机应用研究》, vol. 23, no. 10, 7 November 2006 (2006-11-07), pages 116 - 118</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102891753A?cl=zh">CN102891753A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年9月25日</td><td class="patent-data-table-td patent-date-value">2013年1月23日</td><td class="patent-data-table-td ">深圳市文鼎创数据科技有限公司</td><td class="patent-data-table-td ">动态令牌初始化的方法及装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103312515A?cl=zh">CN103312515A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年6月21日</td><td class="patent-data-table-td patent-date-value">2013年9月18日</td><td class="patent-data-table-td ">百度在线网络技术（北京）有限公司</td><td class="patent-data-table-td ">授权令牌的生成方法、生成装置、认证方法和认证系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103312515B?cl=zh">CN103312515B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年6月21日</td><td class="patent-data-table-td patent-date-value">2016年4月20日</td><td class="patent-data-table-td ">百度在线网络技术（北京）有限公司</td><td class="patent-data-table-td ">授权令牌的生成方法、生成装置、认证方法和认证系统</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=sF-dBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029060000">H04L29/06</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=sF-dBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0009160000">H04L9/16</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2012年8月29日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年10月17日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2014年7月30日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Grant of patent or utility model</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/32dc741c3cafef77a820/CN102651743A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E4%BB%A4%E7%89%8C%E7%A7%8D%E5%AD%90%E7%9A%84%E7%94%9F%E6%88%90%E6%96%B9%E6%B3%95.pdf?id=sF-dBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U2gZ80kv6likVg1bAtTcwlMRXY0AQ"},"sample_url":"https://www.google.com/patents/reader?id=sF-dBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>