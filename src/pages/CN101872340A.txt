<!DOCTYPE html><html><head><title>专利 CN101872340A - 一种基于版面格式模板的排版方法及装置 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_50a6672b5f82ffbd39b7a9e87fd4594c/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_50a6672b5f82ffbd39b7a9e87fd4594c__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种基于版面格式模板的排版方法及装置"><meta name="DC.contributor" content="吴於茜" scheme="inventor"><meta name="DC.contributor" content="王学武" scheme="inventor"><meta name="DC.contributor" content="肖建国" scheme="inventor"><meta name="DC.contributor" content="谢云开" scheme="inventor"><meta name="DC.contributor" content="北京大学;北大方正集团有限公司;北京方正电子政务信息科技有限公司" scheme="assignee"><meta name="DC.date" content="2009-4-23" scheme="dateSubmitted"><meta name="DC.description" content="本发明公开了一种基于版面格式模板的排版方法及装置，用以解决现有技术中排版过程效率低的问题。该方法通过在解析公文样式模板文件，获取公文样式模板文件中对应的每个描述信息解析待排版的文档获取元数据信息，在匹配成功时，根据公文样式模板文件中的公文元素式样子文件中的每个描述信息中引用的公文样式模板文件中式样子文件中预先设置的式样将对应的元数据灌入，生成排版后的文档，在本发明实施例中，由于预先设置了多个模板，保证了每个模板设置的统一性，并且模板中每个描述信息引用预先设定的样式，从而可以有效的提高排版的效率，同时在进行排版时，数据与样式分别进行处理避免了相互之间的影响和制约，提高了排版的准确性。"><meta name="DC.date" content="2010-10-27"><meta name="citation_patent_publication_number" content="CN:101872340:A"><meta name="citation_patent_application_number" content="CN:200910082645"><link rel="canonical" href="https://www.google.com/patents/CN101872340A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101872340A?cl=zh"/><meta name="title" content="专利 CN101872340A - 一种基于版面格式模板的排版方法及装置"/><meta name="description" content="本发明公开了一种基于版面格式模板的排版方法及装置，用以解决现有技术中排版过程效率低的问题。该方法通过在解析公文样式模板文件，获取公文样式模板文件中对应的每个描述信息解析待排版的文档获取元数据信息，在匹配成功时，根据公文样式模板文件中的公文元素式样子文件中的每个描述信息中引用的公文样式模板文件中式样子文件中预先设置的式样将对应的元数据灌入，生成排版后的文档，在本发明实施例中，由于预先设置了多个模板，保证了每个模板设置的统一性，并且模板中每个描述信息引用预先设定的样式，从而可以有效的提高排版的效率，同时在进行排版时，数据与样式分别进行处理避免了相互之间的影响和制约，提高了排版的准确性。"/><meta property="og:title" content="专利 CN101872340A - 一种基于版面格式模板的排版方法及装置"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101872340A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101872340A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=HPN7BwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101872340A&amp;usg=AFQjCNFkpP-3XXFpp6Q5L8NXF7Wqx5Zl8Q" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/dc9d6b84e75068ee34cc/CN101872340A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/dc9d6b84e75068ee34cc/CN101872340A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101872340A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101872340A?cl=en&amp;hl=zh-CN"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101872340A?cl=zh" style="display:none"><span itemprop="description">本发明公开了一种基于版面格式模板的排版方法及装置，用以解决现有技术中排版过程效率低的问题。该方法通过在解析公文样式模板文件，获取公文样式模板文件中对应的每个描述信息解析待排版的文档获取元数据信息，在匹...</span><span itemprop="url">https://www.google.com/patents/CN101872340A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101872340A - 一种基于版面格式模板的排版方法及装置</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101872340A - 一种基于版面格式模板的排版方法及装置" title="专利 CN101872340A - 一种基于版面格式模板的排版方法及装置"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101872340 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200910082645</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2010年10月27日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2009年4月23日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2009年4月23日</td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200910082645.3, </span><span class="patent-bibdata-value">CN 101872340 A, </span><span class="patent-bibdata-value">CN 101872340A, </span><span class="patent-bibdata-value">CN 200910082645, </span><span class="patent-bibdata-value">CN-A-101872340, </span><span class="patent-bibdata-value">CN101872340 A, </span><span class="patent-bibdata-value">CN101872340A, </span><span class="patent-bibdata-value">CN200910082645, </span><span class="patent-bibdata-value">CN200910082645.3</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%90%B4%E6%96%BC%E8%8C%9C%22">吴於茜</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%8E%8B%E5%AD%A6%E6%AD%A6%22">王学武</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E8%82%96%E5%BB%BA%E5%9B%BD%22">肖建国</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E8%B0%A2%E4%BA%91%E5%BC%80%22">谢云开</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E5%8C%97%E4%BA%AC%E5%A4%A7%E5%AD%A6%3B%E5%8C%97%E5%A4%A7%E6%96%B9%E6%AD%A3%E9%9B%86%E5%9B%A2%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%3B%E5%8C%97%E4%BA%AC%E6%96%B9%E6%AD%A3%E7%94%B5%E5%AD%90%E6%94%BF%E5%8A%A1%E4%BF%A1%E6%81%AF%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">北京大学;北大方正集团有限公司;北京方正电子政务信息科技有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101872340A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101872340A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101872340A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (9),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (1),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=HPN7BwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200910082645&amp;usg=AFQjCNFTONClK_7aIoBAwt5L7Klo62AiKg"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=HPN7BwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101872340A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNGelK4FD6oKHySrk_AMxwY1qIK8qA"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT98501915" lang="ZH" load-source="patent-office">一种基于版面格式模板的排版方法及装置</invention-title>
      </span><br><span class="patent-number">CN 101872340 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA80927215" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明公开了一种基于版面格式模板的排版方法及装置，用以解决现有技术中排版过程效率低的问题。该方法通过在解析公文样式模板文件，获取公文样式模板文件中对应的每个描述信息解析待排版的文档获取元数据信息，在匹配成功时，根据公文样式模板文件中的公文元素式样子文件中的每个描述信息中引用的公文样式模板文件中式样子文件中预先设置的式样将对应的元数据灌入，生成排版后的文档，在本发明实施例中，由于预先设置了多个模板，保证了每个模板设置的统一性，并且模板中每个描述信息引用预先设定的样式，从而可以有效的提高排版的效率，同时在进行排版时，数据与样式分别进行处理避免了相互之间的影响和制约，提高了排版的准确性。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(13)</span></span></div><div class="patent-text"><ol mxw-id="PCLM33543229" lang="ZH" load-source="patent-office" class="claims">
    <li class="claim"> <div num="1" class="claim">
      <div class="claim-text">一种基于版面格式模板的排版方法，其特征在于，包括：获取待排版的文档，解析所述文档中的每个元数据信息，并解析选择的公文样式模板文件，获取所述公文样式模板文件对应的每个描述信息，其中所述公文样式模板文件包括：式样子文件以及公文元素式样子文件；将所述每个元数据信息与所述公文元素式样子文件中对应的每个描述信息进行匹配；当匹配不成功时，提示用户选择的模板错误；否则，根据所述每个描述信息中引用的所述式样子文件中预先设置的式样，将对应的所述元数据信息灌入，生成排版后的文档。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.如权利要求1所述的方法，其特征在于，所述将对应的所述元数据信息灌入，生成排 版后的文档包括：将所述公文样式模板文件中的描述信息，及文档中的对应元数据信息，进行逻辑排版， 生成数据文件；将所述数据文件进行物理排版，生成排版后的文档。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.如权利要求2所述的方法，其特征在于，所述进行逻辑排版包括：将所述公文样式模板文件中的每个描述信息的名称，与解析得到的文档中的对应的元 数据信息进行匹配；在公文元素式样子文件中确定匹配成功的描述信息，根据该描述信息的标识在式样子 文件中查找该描述信息对应的式样信息，将该匹配成功的元数据按照所述式样信息组合到 公文元素式样子文件的该匹配成功的描述信息对应的式样中。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.如权利要求2所述的方法，其特征在于，所述进行物理排版包括：根据公文元素式样子文件中引用的式样子文件中的页面式样信息建立页，将排版的元 数据信息在所述页中定位；当在一页中排不下时，建立第二页，将所述第二页中将排版的元数据信息在所述第二 页中定位；依次将每个元数据信息在每页中进行定位。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.如权利要求1所述的方法，其特征在于，所述式样子文件包括：页面式样信息、字体声明信息、句式样信息、段落式样信息、文字表式样信息、单元格式 样信息、图像对象式样信息和图形对象式样信息中的一种或几种。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.如权利要求1所述的方法，其特征在于，所述公文样式模板文件还包括：规则排版子 文件。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.如权利要求6所述的方法，其特征在于，将所述元数据信息灌入后所述方法进一步 包括：读取所述规则排版子文件中的规则，进行自动排版，判断自动排版后的文档是否满足 所述规则的要求，当不满足时重新进行对应元数据信息的灌入，当满足时，进行后续步骤。</div>
    </div>
    </li> <li class="claim"> <div num="8" class="claim">
      <div class="claim-text">8.	一种基于版面格式模板的排版装置，其特征在于，该装置包括：获取解析模块，用于获取待排版的文档，解析所述文档中的每个元数据信息，并根据选 择的公文样式模板文件，解析所述公文样式模板文件，获取所述公文样式模板文件对应的 每个描述信息，其中所述公文样式模板文件包括：排版规则子文件，式样子文件以及公文元素式样子文件；匹配模块，用于将所述每个元数据信息与所述公文元素式样子文件中的每个描述信息 进行匹配；排版提示模块，用于在确定匹配不成功时，提示用户选择的模板错误，在确定匹配成功 时，根据所述每个描述信息中引用的所述式样子文件中预先设置的式样将所述元数据信息 灌入，生成排版后的文档。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.如权利要求8所述的装置，其特征在于，所述排版提示模块包括：逻辑排版单元，用于将所述公文样式模板文件中的描述信息，及文档中的对应元数据 信息，进行逻辑排版，生成数据文件；物理排版单元，用于将所述数据文件进行物理排版，生成排版后的文档。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.如权利要求9所述的装置，其特征在于，所述逻辑排版单元包括：匹配子单元，用于将所述公文样式模板文件中的每个描述信息的名称，与解析得到的 文档中的对应的元数据信息进行匹配；查找组合子单元，用于在公文元素式样子文件中确定匹配成功的描述信息，根据该描 述信息的标识在式样子文件中查找该描述信息对应的式样信息，将该匹配成功的元数据按 照所述式样信息组合到公文元素式样子文件的该匹配成功的描述信息对应的式样中。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="11" class="claim">
      <div class="claim-text">11.如权利要求9所述的装置，其特征在于，所述物理排版单元包括：页建立子单元，用于根据公文元素式样子文件中引用的式样子文件中的页面式样信息 建立页；判断子单元，用于判断建立的页内是否能够排下排版的元数据信息；定位子单元，用于将在该页内排版的元数据信息在所述页中定位。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12.如权利要求8所述的装置，其特征在于，所述装置还包括：存储模块，用于保存页面式样信息、字体声明信息、句式样信息、段落式样信息、文字表 式样信息、单元格式样信息、图像对象式样信息和图形对象式样信息中的一种或几种。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13.如权利要求8所述的装置，其特征在于，所述排版提示模块还用于，根据读取的规则排版子文件中的规则，将所述元数据信息灌入后的文档进行自动排 版，判断自动排版后的文档是否满足所述规则的要求，当确定不满足时重新进行对应元数 据信息的灌入，当确定满足时，生成排版后的文档。</div>
    </div>
  </li> </ol>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES38806357" lang="ZH" load-source="patent-office" class="description">
    <p>一种基于版面格式模板的排版方法及装置</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及数字处理技术领域，尤其涉及一种基于版面格式模板的排版方法及装置。</p>
    <p>背景技术</p>
    <p>[0002]	版面格式是指一类文体其版面所具有的固定格式，对于不同种类的文体其具有不 同的版面格式，例如对于公文类文体其上行文是一种版面格式，对于保险公司的保单类文 体其是另一种版面格式。</p>
    <p>[0003]	目前，基于不同的版面格式会采用不同的模板，例如对于公文类的文体会采用一 种上行文模板，对于保险公司的保单会采用一种保单模板，即都是基于不同的版面格式生 成不同的模板，基本上没有对各个版面格式中的基本要素进行抽取，也没有根据抽取的基 本要素建立对应的模型。</p>
    <p>[0004]	并且，在现有技术中，当需要针对一种版面格式进行排版时，只能根据该版面格式 进行具体的设置生成对应的模板后再进行排版，当针对另一版面格式进行排版时，需要再 针对该版面格式设置对应的模板再进行排版，因此在模板创建上需要浪费很大的精力，并 且创建的模板没有统一性。并且在同一版面格式中可能有多个不同部分的内容有相同的格 式要求，当在具体进行模板的设置时，需要针对该多个不同的部分分别设置对应的格式，需 要付出很多重复性的劳动，从而影响了排版的效率。</p>
    <p>发明内容</p>
    <p>[0005]	有鉴于此，本发明实施例提供一种基于版面格式模板的排版方法及装置，用以解 决现有技术中排版过程效率低的问题。</p>
    <p>[0006]	本发明实施例提供的一种基于版面格式模板的排版方法，包括：</p>
    <p>[0007]	获取待排版的文档，解析所述文档中的每个元数据信息，并根据选择的公文样式 模板文件，解析所述公文样式模板文件，获取所述公文样式模板文件对应的每个描述信息， 其中所述公文样式模板文件包括：式样子文件以及公文元素式样子文件；</p>
    <p>[0008]	将所述每个元数据信息与所述公文元素式样子文件中的每个描述信息进行匹 配；</p>
    <p>[0009]	当匹配不成功时，提示用户选择的模板错误；</p>
    <p>[0010]	否则，根据所述每个描述信息中引用的所述式样子文件中预先设置的式样将所述 元数据信息灌入，生成排版后的文档。</p>
    <p>[0011]	本发明实施例提供的一种基于版面格式模板的排版装置，包括：</p>
    <p>[0012]	获取解析模块，用于获取待排版的文档，解析所述文档中的每个元数据信息，并根 据选择的公文样式模板文件，解析所述公文样式模板文件，获取所述公文样式模板文件对 应的每个描述信息，其中所述公文样式模板文件包括：式样子文件以及公文元素式样子文 件；[0013]	匹配模块，用于将所述每个元数据信息与所述公文元素式样子文件中的每个描述 信息进行匹配；</p>
    <p>[0014]	排版提示模块，用于在确定匹配不成功时，提示用户选择的模板错误，在确定匹配 成功时，根据所述每个描述信息中引用的所述式样子文件中预先设置的式样将所述元数据 信息灌入，生成排版后的文档。</p>
    <p>[0015]	本发明实施例提供了 一种基于版面格式模板的排版方法及装置，该方法通过在解 析公文样式模板文件，获取公文样式模板文件中对应的每个描述信息解析待排版的文档获 取元数据信息，在匹配成功时，根据公文样式模板文件中的公文元素式样子文件中的每个 描述信息中引用的公文样式模板文件中式样子文件中预先设置的式样将对应的元数据灌 入，生成排版后的文档，在本发明实施例中，由于预先设置了多个模板，保证了每个模板设 置的统一性，并且模板中每个描述信息引用预先设定的样式，从而可以有效的提高排版的 效率，同时在进行排版时，数据与样式分别进行处理避免了相互之间的影响和制约，提高了 排版的准确性。</p>
    <p>附图说明 </p>
    <p>[0016]	图1为本发明实施例提供的排版系统的结构示意图；</p>
    <p>[0017]	图2为本发明实施例提供的根据该图1提供的排版系统结构图进行的具体排版操 作；</p>
    <p>[0018]	图3为本发明实施例提供的页面式样示意图；</p>
    <p>[0019]	图4为本发明实施例提供的字体声明示意图；</p>
    <p>[0020]	图5为本发明实施例提供的句式样示意图；</p>
    <p>[0021]	图6为本发明实施例提供的段落式样描述示意图；</p>
    <p>[0022]	图7为本发明实施例提供的文字表式样示意图；</p>
    <p>[0023]	图8为本发明实施例提供的单元格式样示意图；</p>
    <p>[0024]	图9为本发明实施例提供的图像对象式样示意图；</p>
    <p>[0025]	图10为本发明实施例提供的图形对象式样示意图；</p>
    <p>[0026]	图11为本发明实施例提供的图形对象中自然段描述信息示意图；</p>
    <p>[0027]	图12为本发明实施例提供的公文元素式样描述信息示意图；</p>
    <p>[0028]	图13为本发明实施例提供的公文元素式样中页面描述信息示意图；</p>
    <p>[0029]	图14为本发明实施例提供的公文元素式样中页描述信息示意图；</p>
    <p>[0030]	图15为本发明实施例提供的页描述信息中眉首的描述信息示意图；</p>
    <p>[0031]	图16为本发明实施例提供的对文档进行排版的过程；</p>
    <p>[0032]	图17为本发明实施例提供的公文元素式样中文档的眉首、主体和版记中的每项 描述信息的示意图；</p>
    <p>[0033]	图18为本发明实施例提供的基于版面格式模板的排版装置结构示意图。 具体实施方式</p>
    <p>[0034]	本发明实施例为了有效地提高排版的效率，提供了一种基于版面格式模板的排版 方法，该方法包括：获取待排版的文档数据，解析所述文档数据中的每个元数据信息，并解析选择的公文样式模板文件，获取所述公文样式模板文件对应的每个描述信息，其中所述公文样式模板文件包括：式样子文件以及公文元素式样子文件；将所述每个元数据信息与 所述公文元素式样子文件中对应的每个描述信息进行匹配；当匹配不成功时，提示用户选 择的模板错误；否则，根据所述每个描述信息中引用的所述式样子文件中预先设置的式样 将对应的所述元数据信息灌入，生成排版后的文档。在本发明实施例中，由于预先设置了多 个模板，保证了每个模板设置的统一性，并且模板中每个样式信息引用预先设定的样式，从 而可以有效的提高排版的效率，同时在进行排版时，数据与样式分别进行处理避免了相互 之间的影响和制约，提高了排版的准确性。</p>
    <p>[0035]	下面结合说明书附图，对本发明实施例进行详细描述。</p>
    <p>[0036]	图1为本发明实施例提供的排版系统的结构示意图，其中，排版引擎可以实现对 文档的排版，样式模块管理单元用于根据各种样式格式定义，及保存的各种样式设计工具 生成各种样式模板文件。在该样式模板文件中包括：式样集子文件以及公文元素式样子文 件等，生成的样式模板文件可以是可扩展标记语言（Extensible Markup Language,XML)格 式的文件。数据模板管理单元用于根据公文元数据定义，及保存的数据设计工具解析待排 版的数据文件生成数据模板文件，该生成的数据模板文件可以是XML格式的文件。规则模 板管理单元用于根据公文规则定义生成规则模板文件，该生成的规则模板文件可以是XML 格式的文件。</p>
    <p>[0037]	在本发明实施例中样式模板、数据模板和规则模板分别进行管理，从而相互之间 相对独立，而生成的排版后的文件，可以看作是三类模板的有机结合，即对三类模板的分别 编辑和重用的结果。</p>
    <p>[0038]	图2为根据该图1提供的排版系统结构图进行的具体排版操作，该排版的过程具 体包括：</p>
    <p>[0039]	S201 ：样式模板管理单元中读取用户选择的公文样式模板文件，该公文样式模板 文件为XML格式的文件，解析该公文样式模板文件提取该公文样式模板文件中的每个描述 信息，生成样式树，其中该样式树以XML格式显现，并将该XML格式的样式树发送到排版装 置例如排版引擎。</p>
    <p>[0040]	即该公文样式模板文件与该样式树相对应，该样式树中包括：式样集子树、公文元 素式样子树等。并且，在本发明实施例中样式树中还可以包括排版规则子树。</p>
    <p>[0041]	S202:数据模板管理单元读取用户输入的数据文件，解析该数据文件获取数据文 件中的每个元数据信息，生成元数据树，其中该元数据树以XML格式显现，并将该XML格式 的元数据树发送到排版引擎。</p>
    <p>[0042]	S203:排版引擎根据接收的元数据树和样式树，进行相应信息的匹配。</p>
    <p>[0043]	S204:当匹配成功时，排版引擎根据获得的元数据树以及样式树，进行逻辑排版生 成混合树。</p>
    <p>[0044]	S205 ：对排版引擎生成的混合树进行物理排版，进而生成结果树。</p>
    <p>[0045]	S206:规则模板管理单元读取规则模板文件，排版引擎基于该读取的规则模板文 件进行自动排版，当基于该读取的规则模板文件进行的排版满足要求时，则生成排版后的 文件，否则重新进行S204，即进行混合树的生成。</p>
    <p>[0046]	由于不同种类的文件的版面格式中各个元素都具有不同的式样，例如，表格对应表格式样，文字段对应段落式样，图形对应图形式样，图像对应图像式样等等。因此在本 发明实施例中，可以在样式模板管理单元中保存式样集，式样集中又可以包括多种式样，其 中，该多种式样可以是根据各种文档的排版要求进行设置的，并且可以赋予每种式样一个 唯一的标识，并且每种式样中的每个描述单元及描述子单元也都有唯一的一个标识。例如 在本发明实施中样式模板管理单元中包括式样集，该式样集中包括页面式样、字体声明、句 式样、段落式样、文字表式样、单元格式样、图像对象式样和图形对象式样等，每种式样都有 唯一的一个标识，每种式样中每个描述单元及描述子单元也都有唯一的一个标识。</p>
    <p>[0047]	下面详细介绍每种式样包括的每个描述单元及描述子单元。 </p>
    <p>[0048]	对于本发明实施例中的页面式样，其可以描述模板中每一页的页面设置的式样， 在该页面式样中描述了页面的边空信息、纸张信息和页码的设置信息等。如图3所示，页 面式样中可以包括：边空描述单元，纸张描述单元，纸张方向描述单元和页码设置描述单元 等。在边空描述单元中又可以包括对页面的四个方向的边空描述子单元，对于纸张描述单 元其可以包括纸张的纸型、纸张的宽度以及高度等描述子单元，在页码设置描述单元中包 括：页码的属性描述子单元以及其引用的段落式样信息子单元等，其中页码的属性描述子 单元包括：页码是否在首页显示描述子单元、起始编号子单元、数字格式描述子单元、距版 心描述子单元、位置描述子单元、对齐描述子单元、前缀描述子单元和后缀描述子单元等。</p>
    <p>[0049]	在本发明实施例的字体声明中可以描述所属的字体簇，如图4所示，其中该字体 声明包括中文字的字体声明、西文字的字体声明，其中每种字体声明对应不同的编码，例如 中文字体，宋体四号字体对应一个编码，西文罗马10号字体对应一个编码等。</p>
    <p>[0050]	句式样可以描述文档句子中的字体信息、字形信息以及字符间的间距信息等。图 5为本发明实施例提供的句式样示意图，在该句式样中可以包括字体描述单元、字形描述单 元和字符间距描述单元，对于字体描述单元其可以对每个文字的字体，字号以及颜色进行 设置，当选择不同的字体时可以应用上述字体声明中的具体设置形式，例如该字体单元包 括：西文字体引用子单元，其引用西文字体的字体声明，中文字体引用子单元，其引用中文 字体的字体声明，特殊字体引用子单元，其引用特殊字体的字体声明。例如在一个句子中既 包括中文字体又包括西文字体，在对该句子的字体进行描述时，可以应用字体声明中对应 的字体设置。并且该字体描述单元还包括：X字号描述子单元、Y字号描述子单元以及字体 的颜色描述子单元。对于字形描述子单元其包括的描述子单元包括：斜体、加粗、下划线等。 在模板的具体设置时，可以根据句式样的各个描述单元和子单元进行句子式样的设置。</p>
    <p>[0051]	多个句子可以构成段落，在本发明实施例中也需要对段落的式样就行描述。图6 为本发明实施例的段落式样描述示意图，其描述信息可以包括：段落的对齐方式信息、行距 和段间距信息等。例如段落式样中可以包括：对齐描述单元、缩进描述单元、行距描述单元 以及段间距描述单元等。对于对齐描述单元其又可以包括：水平对齐描述子单元和纵向对 齐描述子单元，段间距描述单元又可以包括：段前距描述子单元和段后距描述子单元。在模 板的具体设置时，可以根据该段落式样中的各个描述单元和描述子单元，从而实现对排版 过程中段落的格式进行具体的设置。</p>
    <p>[0052]	为了便于各种文类中存在的文字表的格式设置，在本发明实施例中还提供了一种 文字表式样如图7所示，在该文字表式样中的描述信息可以包括：文字表的属性信息、调整 信息以及文字表的输出属性信息等。例如该文字表式样中的描述信息可以包括：文字表的位置信息、列宽集信息、对齐方式信息、边框信息、自动调整大小信息、自动调整字体信息以 及输出属性信息等。对于列宽集信息其可以对列宽的大小进行选择设置，供设置选择的列 宽的范围可以设置为1到无穷大。在对齐信息中可以包括：横向对齐信息和纵向对其信息 等。边框信息可以包括上下左右四个方向的边线的信息，对于每一个边线信息是对边线的 属性的描述，例如边线的类型、边线的线宽、边线的单元、颜色等。对于位置信息其具体可以 描述文字表的位置属性，例如其可以包括：文字表的基点位置信息、文字表的横轴X轴、纵 轴Y轴的坐标信息、文字表的宽度信息、高度信息、以及文字表的X轴、Y轴坐标类型信息等 中的一个或几个。 </p>
    <p>[0053]	对于各种文类中还可能包括单元格，在本发明实施例中也可以在模板中设置单元 格的样式，具体可以通过单元格式样来进行设置。其中，在本发明实施例中单元格式样中可 以包括单元格的属性信息，如图8所示。该单元格的属性信息包括：单元格的边框信息、行 高信息、列宽信息、边空信息、对齐方式信息以及输出的属性信息等，其中，每一个属性信息 都可以作为单元格式样中的一个描述单元存在。当包括边空信息时，将该边空信息作为单 元格式样中的一个描述单元时，该边空描述单元可以包括：上、下、左、右四个方向的边空描 述子单元。</p>
    <p>[0054]	在排版过程中还需要对图像对象和/或图形对象进行排版。在图像对象的式样中 可以根据各种描述信息进行选择设置。图像对象的式样包括：图像的位置信息、对齐方式信 息以及图像的属性信息等。如图9所示，例如在图像对象式样中可以包括：图像对象的位置 信息、对齐信息、图信息以及输出属性信息等，并且每种信息对应成为一个描述单元，每个 描述单元还可以由几个描述子单元组成。例如在图信息描述单元中还可以包括图信息引用 的文件属性描述子单元，以及图信息的编码方式描述子单元，该引用的文件属性包括文件 的文件名、文件类型等。在该图像对象式样中可以任意选择一种或几种描述单元对应的描 述信息，从而构成图像对象的模板。</p>
    <p>[0055]	从图形对象式样中选择一种或几种描述信息，可以形成图形对象的模板，其中图 形对象式样中可以包括图形的位置信息、对齐方式信息以及图形的属性信息等。如图10所 示，例如在图形对象式样描述信息中包括：图形对象的位置信息、对齐信息、图形信息以及 输出属性信息等。而图形信息对图形对象的基本属性进行了描述，其中在该图形信息中可 以包括：图形的线条信息、关键点的坐标信息、边框信息、自然段信息、图形的自动调整大小 信息以及图形的自动调整字体信息中的一种或几种，关键点坐标信息主要描述了关键点构 成的路径，从而构成整个图形，如图11所示，自然段描述信息中包括文字项的字体声明，以 及文字式样项引用的式样样式，该引用的式样的样式包括句式样，段式样，以及文字的字体 声明等。由于图形对象可以是包括一般的图形，以及文本框，不同的图形对象可以选择不同 的描述单元和描述子单元进行描述。</p>
    <p>[0056]	上述内容是构成本发明实施例的模板的基本式样，每种式样在本发明实施中都可 以具有唯一的编码，并且其对应的每个描述单元、描述子单元也都具有唯一的编码，当选择 不同的式样中的对应的描述单元、子单元构成模板时，只需保存该式样、单元、子单元的编 码信息即可。</p>
    <p>[0057]	由于排版文件需要在每个页面中进行显示，并且不同的页面中可能需要显示的内 容及显示的格式都不同，因此为了适应不同页面排版格式的要求，在本发明实施例中，可以进行页面架构的设置，并且在每页中可能包括一种或几种元素，也可以对每种元素进行</p>
    <p>一一的设置。</p>
    <p>[0058]	在本发明实施例中采用公文元素式样库对页面和页的设置进行描述，如图12所示，在页面描述单元可以设置每个页面描述的内容，及每种描述的式样，如图13所示，例如 可以设置每个单页、双页以及所有页中其对应的描述单元，及每种描述单元其引用的式样， 例如在单页中可以设置文字框、表格、图形、图像等元素，并且每元素可以引用相应的式样。</p>
    <p>[0059]	如图14所示，由于文档中的页一般包括页眉、页脚、眉首、主体以及版记等信息， 而在每页中可以包括页眉、页脚等一系列的元素或者元素集合。例如，在每页中可以对页 眉、页脚的位置及其他属性进行描述，并且可以对显示在每页中的眉首、主体、版记的属性 进行描述。其中，眉首的属性包括：在眉首部分包括的信息，如图15所示，例如该眉首部分 包括的信息包括：眉首的份数序号、文档的秘密等级与保密期限、文档的紧急程度、文字框、 表格、发文机关标识、发文字号与签发人、红色反线和图形等等信息。</p>
    <p>[0060]	对于元素的表示方法包括：用元素标签表示的方法，在属性中标明该元素的类型， 以及用元素类型表示的方法，在属性中标明该元素的标签。对于元素的集合可以用集合名 称来表示，在模板中用集合名称的嵌套，和/或对标签元素的包含体现模板描述的文档的 结构。以眉首的描述信息为例，例如眉首的描述信息为多个带标签的元素的集合和多个带 类型的元素的集合，例如“份数序号”用带标签的元素表示，在属性中该元素的类型为“文本 框”，或者也可以用“文本框”，在属性中表明该元素的标签为“份数序号”。该两种方法可以 交互使用，从而使模板的描述更加完备和可扩充。</p>
    <p>[0061]	在本发明实施例中，可以根据从上述式样集提供的各种式样，排版规则以及公文 元素的式样进行选择，由于每个式样及式样描述单元、描述子单元都有不同的编码，因为该 选择的内容可以构成模板，并且该模板可以用文档架构树的嵌套形式描述。</p>
    <p>[0062]	当对模板中的式样信息、规则信息进行描述，并赋予每种描述信息一个编码后，在 具体排版时，对待排版的文档进行解析，获取公文元素式样中待排版文档的各个描述信息， 将获取的公文元素式样中待排版文档的各个描述信息按照模板中引用的规则以及每种式 样，将该各个描述信息进行灌入，按照该规则和对应的每种式样对该待排版文档进行排版， 从而生成排版后的文档。</p>
    <p>[0063]	如图16所示为在本发明实施例中对文档进行排版的过程，该过程具体包括：</p>
    <p>[0064]	S1601 ：对一篇文档进行排版时，需要读取选择的公文样式模板文件，解析该公文 样式模板文件，其中该公文样式模板文件中包括排版规则子文件、式样子文件以及公文元 素式样子文件，获取该公文样式模板文件中每个子文件对应的描述信息。</p>
    <p>[0065]	在本发明实施例中排版规则、式样集和公文元素式样都可以采用XML结构描述， 因此该公文样式模板文件也可以采用XML结构描述，因此根据解析的得该公文样式模板可 以建立公文显现树，该公文呈现树包括：排版规则子树、式样集子树公文元素式样子树。</p>
    <p>[0066]	S1602:在对一篇文档进行排版时，还需要对该篇文档进行解析，根据该文档的结 构特征，解析得到该文档的元数据信息。</p>
    <p>[0067]	由于一般的文档包括页眉、页脚、眉首、主体和版记信息中的至少一项描述信息， 因此，在解析文档获取文档的数据信息时，可以从上述几项描述信息中获取，如图17所示， 为获取该公文元素式样中文档的眉首、主体和版记中的每项描述信息的示意图。解析该文档得到元数据树。</p>
    <p>[0068]	S1603:根据解析获得的公文样式模板文件中的描述信息、及文档中的元数据信 息，进行排版生成排版后的文档。</p>
    <p>[0069]	将显现树与数据树进行混合，生成结果树，从而完成对该文档的排版。</p>
    <p>[0070]	在本发明实施例中进行排版生成排版后的文档时，该方法包括：</p>
    <p>[0071]	根据解析获得的公文样式模板文件中的描述信息，及文档中的对应的元数据信 息，进行逻辑排版，生成数据文件。</p>
    <p>[0072]	将该数据文件进行物理排版，生成排版后的文档。 [0073]	在进行逻辑排版的过程中，由于该排版规则、式样集及公文元素式样都可以采用 XML的形式标识，因此该过程主要包括：</p>
    <p>[0074]	将公文元素式样子文件中的每个描述信息的名称与解析得到的文档中的对应元 数据信息进行匹配；</p>
    <p>[0075]	在公文元素式样子文件中确定匹配成功的描述信息，根据该描述信息的标识在式 样子文件中查找该描述信息对应的式样信息，将该匹配成功的元数据按照该式样信息组合 到公文元素式样子文件的该匹配成功的描述信息对应的式样中。</p>
    <p>[0076]	其中，包括根据公文元素式样子树的结构特征生成混合树。</p>
    <p>[0077]	例如，公文元素式样子文件中的描述单元为“秘密等级与保密期限”，与解析得到 的数据文件中的描述信息进行匹配，例如匹配成功的描述信息为“绝密”，则在该描述单元 “秘密等级与保密期限”的节点下生成内容节点，并且该内容节点的值为“绝密”。从而实现 了将匹配成功的描述信息组合到公文元素式样子文件的每个描述单元中。</p>
    <p>[0078]	根据该公文元素式样子文件中的描述单元“秘密等级与保密期限”，其对应的式样 为“秘密等级与保密期限对象类型=‘文字框’式样引用=‘ID040961’”，根据该式样引用 标识符“ ID040961”，查找该设置的式样集中，该标识符对应的式样信息，例如查找到的式样 信息为“图形对象式样名称=‘秘密等级与保密期限’标识符=‘ID040961’”，将该标识符 对应的式样信息，在该描述单元“秘密等级与保密期限”的节点下生成式样节点，且该式样 节点对应的值为“图形对象式样”。从而实现将给描述信息对应的式样信息组合到公文元素 式样子文件的每个描述单元中。</p>
    <p>[0079]	在本发明实施例中，将该数据文件进行物理排版，生成排版后的文档的过程包 括：</p>
    <p>[0080]	根据公文元素式样子文件中引用的式样子文件中的页面式样信息建立页，将建立 的页作为排版生成的结构树中第一层子节点；</p>
    <p>[0081]	按照深度优先的策略遍历混合树，按照流式排版方法将待排版的数据信息在页面 中进行定位，当在一页中排不下时，则建立新页，将建立的新页作为第二层子节点，然后在 该页中进行排版，依次将待排版的数据信息在每页中进行定位，从而确定每个待排版的数 据信息所在的页，即进行物理呈现时的页；</p>
    <p>[0082]	按照排版规则依次进行实现，生成排版后的文档。</p>
    <p>[0083]	如图18所示，本发明实施例提供了一种排版装置，该装置包括：</p>
    <p>[0084]	获取解析模块1801，用于获取待排版的文档，解析所述文档中的每个元数据信息， 并根据选择的公文样式模板文件，解析所述公文样式模板文件，获取所述公文样式模板文件对应的每个描述信息，其中所述公文样式模板文件包括：排版规则子文件，式样子文件以及公文元素式样子文件；</p>
    <p>[0085]	匹配模块1802，用于将所述每个元数据信息与所述公文元素式样子文件中的每个 描述信息进行匹配；</p>
    <p>[0086]	排版提示模块1803，用于在确定匹配不成功时，提示用户选择的模板错误，在确定 匹配成功时，根据所述每个描述信息中引用的所述式样子文件中预先设置的式样将所述元 数据信息灌入，生成排版后的文档。</p>
    <p>[0087]	所述排版提示模块1803包括：</p>
    <p>[0088]	逻辑排版单元18030，用于将所述公文样式模板文件中的描述信息，及文档中的对 应元数据信息，进行逻辑排版，生成数据文件；</p>
    <p>[0089]	物理排版单元18033，用于将所述数据文件进行物理排版，生成排版后的文档。</p>
    <p>[0090]	所述逻辑排版单元18030包括：</p>
    <p>[0091]	匹配子单元18031，用于将所述公文样式模板文件中的每个描述信息的名称，与解 析得到的文档中的对应的元数据信息进行匹配；</p>
    <p>[0092]	查找组合子单元18032，用于在公文元素式样子文件中确定匹配成功的描述信息， 根据该描述信息的标识在式样子文件中查找该描述信息对应的式样信息，将该匹配成功的 元数据按照所述式样信息组合到公文元素式样子文件的该匹配成功的描述信息对应的式 样中。</p>
    <p>[0093]	所述物理排版单元18033包括：</p>
    <p>[0094]	页建立子单元18034，用于根据公文元素式样子文件中弓丨用的式样子文件中的页 面式样信息建立页；</p>
    <p>[0095]	判断子单元18035，用于判断建立的页内是否能够排下排版的元数据信息；</p>
    <p>[0096]	定位子单元18036，用于将在该页内排版的元数据信息在所述页中定位。</p>
    <p>[0097]	所述装置还包括：</p>
    <p>[0098]	存储模块1800，用于保存页面式样信息、字体声明信息、句式样信息、段落式样信 息、文字表式样信息、单元格式样信息、图像对象式样信息和图形对象式样信息中的一种或 几种。</p>
    <p>[0099]	所述排版提示模块1803还用于，</p>
    <p>[0100]	根据读取的规则排版子文件中的规则，将所述元数据信息灌入后的文档进行自动 排版，判断自动排版后的文档是否满足所述规则的要求，当确定不满足时重新进行对应元 数据信息的灌入，当确定满足时，生成排版后的文档。</p>
    <p>[0101]	本发明实施例提供了 一种基于版面格式模板的排版方法及装置，该方法通过在解 析公文样式模板文件，获取公文样式模板文件中对应的每个描述信息解析待排版的文档获 取元数据信息，在匹配成功时，根据公文样式模板文件中的公文元素式样子文件中的每个 描述信息中引用的公文样式模板文件中式样子文件中预先设置的式样将对应的元数据灌 入，生成排版后的文档，在本发明实施例中，由于预先设置了多个模板，保证了每个模板设 置的统一性，并且模板中每个描述信息引用预先设定的样式，从而可以有效的提高排版的 效率，同时在进行排版时，数据与样式分别进行处理避免了相互之间的影响和制约，提高了 排版的准确性。[0102] 显然，本领域的技术人员可以对本发明进行各种改动和变型而不脱离本发明的精 神和范围。这样，倘若本发明的这些修改和变型属于本发明权利要求及其等同技术的范围 之内，则 本发明也意图包含这些改动和变型在内。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102663125A?cl=zh">CN102663125A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年4月20日</td><td class="patent-data-table-td patent-date-value">2012年9月12日</td><td class="patent-data-table-td ">李朋涛</td><td class="patent-data-table-td ">一种收集微博内容制作电子文档的方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102663125B?cl=zh">CN102663125B</a></td><td class="patent-data-table-td patent-date-value">2012年4月20日</td><td class="patent-data-table-td patent-date-value">2014年9月17日</td><td class="patent-data-table-td ">李朋涛</td><td class="patent-data-table-td ">一种收集微博内容制作电子文档的方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102841887A?cl=zh">CN102841887A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年6月21日</td><td class="patent-data-table-td patent-date-value">2012年12月26日</td><td class="patent-data-table-td ">北大方正集团有限公司</td><td class="patent-data-table-td ">可变数据排版的方法和装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102841888A?cl=zh">CN102841888A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年9月14日</td><td class="patent-data-table-td patent-date-value">2012年12月26日</td><td class="patent-data-table-td ">《中国学术期刊(光盘版)》电子杂志社</td><td class="patent-data-table-td ">一种快速排版系统及方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102841888B?cl=zh">CN102841888B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年9月14日</td><td class="patent-data-table-td patent-date-value">2015年10月14日</td><td class="patent-data-table-td ">《中国学术期刊（光盘版）》电子杂志社有限公司</td><td class="patent-data-table-td ">一种快速排版系统及方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103034624A?cl=zh">CN103034624A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年9月29日</td><td class="patent-data-table-td patent-date-value">2013年4月10日</td><td class="patent-data-table-td ">北京大学</td><td class="patent-data-table-td ">一种页面对象的精确定位方法和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103034624B?cl=zh">CN103034624B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年9月29日</td><td class="patent-data-table-td patent-date-value">2015年12月16日</td><td class="patent-data-table-td ">北京大学</td><td class="patent-data-table-td ">一种页面对象的精确定位方法和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103440231A?cl=zh">CN103440231A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年9月2日</td><td class="patent-data-table-td patent-date-value">2013年12月11日</td><td class="patent-data-table-td ">北京网秦天下科技有限公司</td><td class="patent-data-table-td ">用于比较文本的设备和方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103678268A?cl=zh">CN103678268A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年9月19日</td><td class="patent-data-table-td patent-date-value">2014年3月26日</td><td class="patent-data-table-td ">北京大学</td><td class="patent-data-table-td ">公文自动排版方法和装置</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=HPN7BwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=G06F0017250000">G06F17/25</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2010年10月27日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2010年12月8日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年4月3日</td><td class="patent-data-table-td ">C12</td><td class="patent-data-table-td ">Rejection of an application for a patent</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/dc9d6b84e75068ee34cc/CN101872340A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_50a6672b5f82ffbd39b7a9e87fd4594c.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8E%E7%89%88%E9%9D%A2%E6%A0%BC%E5%BC%8F%E6%A8%A1%E6%9D%BF%E7%9A%84%E6%8E%92%E7%89%88.pdf?id=HPN7BwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U3nDWD9XCIKLCK020ZNrNMNUhgZTA"},"sample_url":"https://www.google.com/patents/reader?id=HPN7BwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>