<!DOCTYPE html><html><head><title>专利 CN103119889A - 使用硬件超级密钥验证和保护正版软件安装 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="使用硬件超级密钥验证和保护正版软件安装"><meta name="DC.contributor" content="P&#183;吴" scheme="inventor"><meta name="DC.contributor" content="英特尔公司" scheme="assignee"><meta name="DC.date" content="2011-9-26" scheme="dateSubmitted"><meta name="DC.description" content="公开了一种设备、系统和方法。在一个实施方式中，该设备从用户应用接收用户密钥。该设备通过将管理引擎密钥创建算法应用于用户密钥来创建管理引擎密钥。然后该设备将管理引擎密钥发送到远程服务器。稍后，该设备从远程服务器获取服务器密钥。该设备接着执行对用户密钥、管理引擎密钥和服务器密钥的散列组合以创建超级密钥。一旦超级密钥已经被创建，该设备就认证超级密钥，并且如果超级密钥是有效的，则该设备接着将管理引擎证书发送到用户应用。"><meta name="DC.date" content="2013-5-22"><meta name="DC.relation" content="CN:101206704:A" scheme="references"><meta name="DC.relation" content="CN:101266638:A" scheme="references"><meta name="DC.relation" content="CN:101604362:A" scheme="references"><meta name="DC.relation" content="CN:1407446:A" scheme="references"><meta name="DC.relation" content="CN:1514375:A" scheme="references"><meta name="DC.relation" content="CN:1561026:A" scheme="references"><meta name="DC.relation" content="US:20080159540:A1" scheme="references"><meta name="DC.relation" content="US:20090106751:A1" scheme="references"><meta name="citation_patent_publication_number" content="CN:103119889:A"><meta name="citation_patent_application_number" content="CN:201180045632"><link rel="canonical" href="https://www.google.com/patents/CN103119889A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN103119889A?cl=zh"/><meta name="title" content="专利 CN103119889A - 使用硬件超级密钥验证和保护正版软件安装"/><meta name="description" content="公开了一种设备、系统和方法。在一个实施方式中，该设备从用户应用接收用户密钥。该设备通过将管理引擎密钥创建算法应用于用户密钥来创建管理引擎密钥。然后该设备将管理引擎密钥发送到远程服务器。稍后，该设备从远程服务器获取服务器密钥。该设备接着执行对用户密钥、管理引擎密钥和服务器密钥的散列组合以创建超级密钥。一旦超级密钥已经被创建，该设备就认证超级密钥，并且如果超级密钥是有效的，则该设备接着将管理引擎证书发送到用户应用。"/><meta property="og:title" content="专利 CN103119889A - 使用硬件超级密钥验证和保护正版软件安装"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN103119889A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN103119889A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=z4klCAABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN103119889A&amp;usg=AFQjCNF572ZwdQZplZVOlYSg6mesNBX0hg" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/1e1aa825adb9a24c2955/CN103119889A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/1e1aa825adb9a24c2955/CN103119889A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN103119889A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN103119889A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN103119889A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN103119889B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN103119889A?cl=zh" style="display:none"><span itemprop="description">公开了一种设备、系统和方法。在一个实施方式中，该设备从用户应用接收用户密钥。该设备通过将管理引擎密钥创建算法应用于用户密钥来创建管理引擎密钥。然后该设备将管理引擎密钥发送到远程服务器。稍后，该设备从远...</span><span itemprop="url">https://www.google.com/patents/CN103119889A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN103119889A - 使用硬件超级密钥验证和保护正版软件安装</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN103119889A - 使用硬件超级密钥验证和保护正版软件安装" title="专利 CN103119889A - 使用硬件超级密钥验证和保护正版软件安装"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN103119889 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201180045632</td></tr><tr><td class="patent-bibdata-heading"> 专利合作条约 (PCT) 编号</td><td class="single-patent-bibdata">PCT/US2011/053311</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2013年5月22日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2011年9月26日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2010年9月24日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103119889B?hl=zh-CN&amp;cl=zh">CN103119889B</a>, </span><span class="patent-bibdata-value"><a href="/patents/EP2619707A1?hl=zh-CN&amp;cl=zh">EP2619707A1</a>, </span><span class="patent-bibdata-value"><a href="/patents/US8522030?hl=zh-CN&amp;cl=zh">US8522030</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20120079277?hl=zh-CN&amp;cl=zh">US20120079277</a>, </span><span class="patent-bibdata-value"><a href="/patents/WO2012040728A1?hl=zh-CN&amp;cl=zh">WO2012040728A1</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201180045632.4, </span><span class="patent-bibdata-value">CN 103119889 A, </span><span class="patent-bibdata-value">CN 103119889A, </span><span class="patent-bibdata-value">CN 201180045632, </span><span class="patent-bibdata-value">CN-A-103119889, </span><span class="patent-bibdata-value">CN103119889 A, </span><span class="patent-bibdata-value">CN103119889A, </span><span class="patent-bibdata-value">CN201180045632, </span><span class="patent-bibdata-value">CN201180045632.4, </span><span class="patent-bibdata-value">PCT/2011/53311, </span><span class="patent-bibdata-value">PCT/US/11/053311, </span><span class="patent-bibdata-value">PCT/US/11/53311, </span><span class="patent-bibdata-value">PCT/US/2011/053311, </span><span class="patent-bibdata-value">PCT/US/2011/53311, </span><span class="patent-bibdata-value">PCT/US11/053311, </span><span class="patent-bibdata-value">PCT/US11/53311, </span><span class="patent-bibdata-value">PCT/US11053311, </span><span class="patent-bibdata-value">PCT/US1153311, </span><span class="patent-bibdata-value">PCT/US2011/053311, </span><span class="patent-bibdata-value">PCT/US2011/53311, </span><span class="patent-bibdata-value">PCT/US2011053311, </span><span class="patent-bibdata-value">PCT/US201153311</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22P%C2%B7%E5%90%B4%22">P&#183;吴</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E8%8B%B1%E7%89%B9%E5%B0%94%E5%85%AC%E5%8F%B8%22">英特尔公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103119889A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103119889A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103119889A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (8),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (3),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=z4klCAABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201180045632&amp;usg=AFQjCNHT_jsv7hT3fi55fKU99SoDInkxTw"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=z4klCAABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D103119889A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNF-9QygpACi8RDs4TrRdDCRp2aUBw"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT124838167" lang="ZH" load-source="patent-office">使用硬件超级密钥验证和保护正版软件安装</invention-title>
      </span><br><span class="patent-number">CN 103119889 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA114656472" lang="ZH" load-source="patent-office">
    <div class="abstract">公开了一种设备、系统和方法。在一个实施方式中，该设备从用户应用接收用户密钥。该设备通过将管理引擎密钥创建算法应用于用户密钥来创建管理引擎密钥。然后该设备将管理引擎密钥发送到远程服务器。稍后，该设备从远程服务器获取服务器密钥。该设备接着执行对用户密钥、管理引擎密钥和服务器密钥的散列组合以创建超级密钥。一旦超级密钥已经被创建，该设备就认证超级密钥，并且如果超级密钥是有效的，则该设备接着将管理引擎证书发送到用户应用。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(24)</span></span></div><div class="patent-text"><div mxw-id="PCLM53057259" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.一种管理引擎设备，包括用于以下的逻辑:  通过将用户密钥解密算法应用于从用户应用接收的已加密的用户密钥来获取用户密钥；  通过将管理引擎密钥创建算法应用于所述用户密钥来创建管理引擎密钥；  通过将管理引擎密钥加密算法应用于所述管理引擎密钥来对所述管理引擎密钥进行加密；  将已加密的管理引擎密钥发送到远程服务器；  通过将服务器密钥解密算法应用于从所述远程服务器接收的已加密的服务器密钥来获取服务器密钥，所述管理引擎设备响应于将所述管理引擎密钥发送到所述远程服务器而从所述远程服务器接收所述已加密的服务器密钥；  执行对所述用户密钥、所述管理引擎密钥和所述服务器密钥的散列组合以创建超级密钥；  执行对所述超级密钥的认证；以及  响应于所述超级密钥被成功地认证而将管理引擎证书发送到所述用户应用。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.如权利要求1所述的管理引擎，还包括:  至少存储超级密钥主值的存储器存储单元，其中当散列组合值等于所述超级密钥主值时，所述超级密钥被成功地认证。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.如权利要求1所述的管理引擎，其中所述已加密的用户密钥和所述证书是经由带外信道在所述用户应用与所述管理引擎之间进行发送的。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.如权利要求1所述的管理引擎，其中所述管理引擎密钥和所述已加密的服务器密钥是经由带外信道在所述管理引擎与所述远程服务器之间进行发送的。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.如权利要求1所述的管理引擎，其中所述管理引擎密钥创建算法包括管理引擎密码散列函数，其中所述用户密钥被输入到所述散列函数中，并且所述管理引擎密钥是所述散列函数的产生的输出。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.如权利要求1所述的管理引擎，还包括:  至少存储所述用户密钥、所述管理引擎密钥和所述服务器密钥的存储器存储单元。</div>
    </div>
    </div> <div class="claim"> <div num="7" class="claim">
      <div class="claim-text">7.一种系统,包括:  管理引擎，用于:  通过将用户密钥解密算法应用于从用户应用接收的已加密的用户密钥来获取用户密钥；  通过将管理引擎密钥创建算法应用于所述用户密钥来创建管理引擎密钥；  通过将管理引擎密钥加密算法应用于所述管理引擎密钥来对所述管理引擎密钥进行加密；  将已加密的管理引擎密钥发送到远程服务器；  通过将服务器密钥解密算法应用于从所述远程服务器接收的已加密的服务器密钥来获取服务器密钥，所述管理引擎响应于将所述管理引擎密钥发送到所述远程服务器而从所述远程服务器接收所述已加密的服务器密钥；  执行对所述用户密钥、所述管理引擎密钥和所述服务器密钥的散列组合以创建超级密钥；以及执行对所述超级密钥的认证；以及  响应于所述超级密钥被成功地认证而将管理引擎证书发送到所述用户应用；以及  所述远程服务器，用于:  从安全引擎接收所述已加密的管理引擎密钥；  通过将管理引擎密钥解密算法应用于所述已加密的管理引擎密钥来获取所述管理引擎密钥； 通过将反转的管理引擎密钥创建算法应用于所述管理引擎密钥来获取所述用户密钥；  通过将服务器密钥创建算法应用于所述用户密钥来创建服务器密钥；  通过将服务器密钥加密算法应用于所述服务器密钥来对所述服务器密钥进行加密；以及  将所述已加密的服务器密钥发送到所述管理弓I擎。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.如权利要求7所述的系统，其中所述管理引擎还包括:  至少存储超级密钥主值的存储器存储单元，其中当散列组合值等于所述超级密钥主值时，所述超级密钥被成功地认证。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.如权利要求7所述的系统，还包括:  带外信道，用于将所述管理引擎与所述用户应用通信地耦合，其中所述已加密的用户密钥和所述证书是经由所述带外信道在所述用户应用与所述管理引擎之间进行发送的。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.如权利要求7所述的系统，还包括:  带外信道，用于将所述管理引擎与所述远程服务器通信地耦合，其中所述管理引擎密钥和所述已加密的服务器密钥是经由带外信道在所述管理引擎与所述远程服务器之间进行发送的。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="11" class="claim">
      <div class="claim-text">11.如权利要求7所述的系统，其中所述管理引擎密钥创建算法包括管理引擎密码散列函数，其中所述用户密钥被输入到所述散列函数中，并且所述管理引擎密钥是所述散列函数的产生的输出。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12.如权利要求7所述的系统，其中所述服务器密钥创建算法包括服务器密码散列函数，其中所述用户密钥被输入到所述散列函数中，并且所述服务器密钥是所述散列函数的产生的输出</div>
    </div>
    </div> <div class="claim"> <div num="13" class="claim">
      <div class="claim-text">13.&#8212;种方法,包括:  通过将用户密钥解密算法应用于从用户应用接收的已加密的用户密钥来获取用户密钥；  通过将管理引擎密钥创建算法应用于所述用户密钥来创建管理引擎密钥；  通过将管理引擎密钥加密算法应用于所述管理引擎密钥来对所述管理引擎密钥进行加密；  将已加密的管理引擎密钥发送到远程服务器；  通过将服务器密钥解密算法应用于从所述远程服务器接收的已加密的服务器密钥来获取服务器密钥，管理引擎响应于将所述管理引擎密钥发送到所述远程服务器而从所述远程服务器接收所述已加密的服务器密钥；  执行对所述用户密钥、所述管理引擎密钥和所述服务器密钥的散列组合以创建超级密钥；  执行对所述超级密钥的认证；以及  响应于所述超级密钥被成功地认证而将管理引擎证书发送到所述用户应用。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="14" class="claim">
      <div class="claim-text">14.如权利要求13所述的方法，还包括:  将超级密钥主值至少存储在管理引擎中，其中当散列组合值等于所述超级密钥主值时，所述超级密钥被成功地认证。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="15" class="claim">
      <div class="claim-text">15.如权利要求13所述的方法，还包括:  经由带外信道在所述用户应用与所述管理引擎之间发送所述已加密的用户密钥和所述证书。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="16" class="claim">
      <div class="claim-text">16.如权利要求13所述的方法，还包括:  经由带外信道在所述管理引擎与所述远程服务器之间发送所述管理引擎密钥和所述已加密的服务器密钥。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="17" class="claim">
      <div class="claim-text">17.如权利要求13所述的方法，其中所述管理引擎密钥创建算法包括管理引擎密码散列函数，其中所述用户密钥被输入到所述散列函数中，并且所述管理引擎密钥是所述散列函数的产生的输出。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="18" class="claim">
      <div class="claim-text">18.如权利要求14所述的方法，还包括:  将所述用户密钥、所述管理引擎密钥和所述服务器密钥存储在所述管理引擎中的单独存储单元中。</div>
    </div>
    </div> <div class="claim"> <div num="19" class="claim">
      <div class="claim-text">19.一种管理引擎设备，包括用于以下的逻辑:  从用户应用接收用户密钥；  通过将管理引擎密钥创建算法应用于所述用户密钥来创建管理引擎密钥；  将所述管理引擎密钥发送到远程服务器；  从所述远程服务器获取服务器密钥，所述管理引擎设备响应于将所述管理引擎密钥发送到所述远程服务器而从所述远程服务器接收已加密的服务器密钥；  执行对所述用户密钥、所述管理引擎密钥和所述服务器密钥的散列组合以创建超级密钥；  执行对所述超级密钥的认证；以及  响应于所述超级密钥被成功地认证而将管理引擎证书发送到所述用户应用。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="20" class="claim">
      <div class="claim-text">20.如权利要求19所述的管理引擎，还包括:  至少存储超级密钥主值的存储器存储单元，其中当散列组合值等于所述超级密钥主值时，所述超级密钥被成功地认证。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="21" class="claim">
      <div class="claim-text">21.如权利要求19所述的管理引擎，其中所述用户密钥和所述证书是经由带外信道在所述用户应用与所述管理引擎之间进行发送的。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="22" class="claim">
      <div class="claim-text">22.如权利要求19所述的管理引擎，其中所述管理引擎密钥和所述服务器密钥是经由带外信道在所述管理引擎与所述远程服务器之间进行发送的。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="23" class="claim">
      <div class="claim-text">23.如权利要求19所述的管理引擎，其中所述管理引擎密钥创建算法包括管理引擎密码散列函数，其中所述用户密钥被输入到所述散列函数中，并且所述管理引擎密钥是所述散列函数的产生的输出。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="24" class="claim">
      <div class="claim-text">24.如权利要求19所述的管理引擎，还包括:至少存储 所述用户密钥、所述管理引擎密钥和所述服务器密钥的存储器存储单元。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES60105054" lang="ZH" load-source="patent-office" class="description">
    <p>使用硬件超级密钥验证和保护正版软件安装</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及验证和保护软件安装过程。</p>
    <p>背景技术</p>
    <p>[0002]	每年有数百万美元的收入损失掉，这是因为软件在全世界被非法地拷贝和安装在个人计算机上。软件许可密钥试图抑制这种盗版行为，但它们容易受到能够定期地对软件安全特征进行解锁的恶意用户(例如，黑客)的攻击。此外，独立的软件卖主没有验证安装在最终用户计算机系统上的软件是否是正版的而不是被非法侵入的能力。在线执行的软件升级是易受攻击的，并可导致在软件安装时附带发生的恶意软件安装的非计划中的结果。</p>
    <p>附图说明</p>
    <p>[0003]	通过例子的方式示出了本发明，并且本发明不受附图的限制，在附图中，相似的参考符号表示相似的元件，并且其中:</p>
    <p>[0004]	图1示出了能够使用地址交换动态地更换存储段的计算机系统的实施方式；</p>
    <p>[0005]	图2是在实现了加密的情况下利用硬件超级密钥来验证和保护正版软件安装的过程的实施方式的流程图；</p>
    <p>[0006]	图3是在没有实现加密的情况下利用硬件超级密钥来验证和保护正版软件安装的过程的实施方式的流程图。</p>
    <p>具体实施方式</p>
    <p>[0007]	公开了使用硬件超级密钥来验证并保护正版软件安装的装置、系统、方法和机器可读介质的元素。</p>
    <p>[0008]	图1示出了能够使用地址交换动态地更换存储段的计算机系统的实施方式。</p>
    <p>[0009]	示出了计算机系统100。计算机系统可以是台式机、服务器、工作站、膝上型计算机、手持设备、电视机顶盒、媒体中心、游戏控制台、集成系统(例如位于汽车中)或其它类型的计算机系统。在几个实施方式中，计算机系统100包括也被称为“处理器”的一个或多个中央处理单元(CPU)。虽然在很多实施方式中可能有很多CPU，但是在图1所示的实施方式中，为了清楚起见，只示出了 CPU102。CPU102可以是Inter&#174;公司的CPU或另一品牌的CPU。在不同的实施方式中，CPU102包括一个或多个核心。CPU102被示为包括四个核心(核心104,106,108 和 110)。</p>
    <p>[0010]	在很多实施方式中，每个核心包括内部功能块，例如一个或多个执行单元、引退单元、一组通用和专用寄存器等。在单线程核心中，每个核心可被称为硬件线程。当核心是多线程的或超线程的时，则在每个核心中操作的每个线程也可被称为硬件线程。因此，在计算机系统100中运行的执行的任何单线程可被称为硬件线程。例如，在图1中，如果每个核心是单线程的，则在于系统中存在四个硬件线程(四个核心)。另一方面，如果每个核心是多线程的并具有同时维持两个线程的状态的能力，则在于系统中存在八个硬件线程(四个核心，每核心有两个线程)。</p>
    <p>[0011]	CPU102还可包括一个或多个高速缓冲存储器，例如高速缓冲存储器112。在未示出的很多实施方式中，除了高速缓冲存储器112以外，还实现另外的高速缓冲存储器，使得在存储器与每个核心的执行单元之间存在多级高速缓冲存储器。在不同的实施方式中，可以用不同的方式分配高速缓冲存储器112。此外，在不同的实施方式中，高速缓冲存储器112可以具有很多不同大小中的一个大小。例如，高速缓冲存储器112可以是8兆字节(MB)高速缓冲存储器、16MB高速缓冲存储器等。此外，在不同的实施方式中，高速缓冲存储器可以是直接映射高速缓冲存储器、全关联高速缓冲存储器、多路组关联高速缓冲存储器或具有另一类型的映射的高速缓冲存储器。在很多实施方式中，高速缓冲存储器112可包括在所有核心当中共享的一个大部分，或可被划分成几个单独的功能分片(例如，每个核心有一个分片)。高速缓冲存储器112还可包括一个在所有核心当中共享的部分和几个其它部分，所述其它部分针对每个核心而言是单独的功能分片。</p>
    <p>[0012]	在很多实施方式中，CPU102包括集成的系统存储器控制器114，用于提供与系统存储器16通信的接口。在未示出的其它实施方式中，存储器控制器114可位于与CPU102分离的分立部件(计算机系统100的其它地方)中。</p>
    <p>[0013]	系统存储器116可包括几个动态随机存取存储器(DRAM)设备，例如一种双数据速率(DDR) DRAM。系统存储器可通过焊接或其它连接直接耦合到主板，或者它可通过一个或多个双列直插式存储器模块(DIMM)或其它类似的存储器模块耦合到主板。</p>
    <p>[0014]	系统存储器116可以是存储将由CPU102操作的数据和指令的通用存储器。此外，在计算机系统100内可以存在具有对系统存储器进行读和写的能力的其它可能的设备，例如能够进行直接存储器存取(DMA)的I/O (输入/输出)设备。</p>
    <p>[0015]	将CPU102与系统存储器116耦合起来的链路118 (即，总线、互连等)可包括能够传输数据、地址、控制和时钟信息的一个或多个光学、金属或其它线(即，线路)。</p>
    <p>[0016]	平台控制器中心(PCH) 120 (例如，I/O控制器和其它电路的集合体)包括实现CPU102与外部I/O设备之间的通信的I/O接口。该中心可包括一个或多个I/O适配器，例如I/O适配器122。I/O适配器将在CPU102内使用的主机通信协议转换成与特定的I/O设备(例如I/O设备124)兼容的协议。给定I/O适配器可转换的一些协议包括外围部件互连(PCI)-快速协议、通用串行总线(USB)、串行高级技术附件(SATA)接口、以太网和1394 “火线”等等。此外，可以存在一个或多个无线协议I/O适配器。无线协议的例子是蓝牙、基于IEEE802.11的无线协议和蜂窝协议等等。</p>
    <p>[0017]	除了 I/O设备以外，PCH120还可耦合到系统中的一个或多个嵌入式控制器(EC)，例如EC126。EC126可合并很多功能。例如，RAID存储控制器设备可存在于计算机系统100内。RAID控制器可管理硬盘驱动器或固态磁盘(SSD)的阵列。控制器设备的其它例子可以是分立的带外管理引擎、键盘控制器或另一类型的控制器。</p>
    <p>[0018]	在其它实施方式中，PCH120是位于CPU102外部的分立设备。在这些实施方式中，诸如直接存储器接口(DMI)之类的接口或另一类似的接口将CPU耦合到PCH的CPU。虽然没有示出这些实施方式。</p>
    <p>[0019]	CPU之间的接口 128可向耦合到一个或多个额外的CPU的链路提供接口，并允许CPU之间的通信发生。例如，CPU之间的高速接口可以是快速路径互连(QPI)或其它类似的接口。虽然图1中未示出额外的CPU，但在很多实施方式中，CPU102是存在于计算机系统100内的多个CPU之一。在很多实施方式中，CPU之间的接口 128提供CPU102与存在于系统中的其它CPU中的每个CPU之间的点到点高速通信接口。</p>
    <p>[0020]	图形接口 130可向耦合到分立图形控制器(分立图形控制器未示出)的链路提供接口。该接口可以是高速平台部件互连(PCI)-快速接口或另一高速接口。在其它实施方式中，CPU102包括集成的图形控制器，并且图形接口 144可耦合到显示设备，例如监视器。在很多实施方式中，该接口是高速的，以允许在链路上传输相当多的图形数据业务(例如，3D图形、视频等)。</p>
    <p>[0021]	计算机系统100还包括系统管理固件132，用于提供初始化计算机系统和部件的引导指令。在不同的实施方式中，系统管理固件可以是基本输入/输出系统(BIOS)、可扩展固件或在平台的引导期间计算机系统可使用的另一形式的固件指令。</p>
    <p>[0022]	此外，计算机系统100包括网络接口 134。网络接口 134可包括网络接口控制器，以便于在CPU102与计算机系统100外部的一个或多个实体之间的通信。例如，网络接口134可耦合到网络136，并且网络136可直接或间接地耦合到一个或多个服务器(例如服务器138)或其它类型的计算机。网络136可以是企业内联网内的局部服务器、或者可能是位于互联网上的某个位置处的不相关的远程服务器、或者是很多其它服务器实施方式中的任意一个。</p>
    <p>[0023]	在很多实施方式中，计算机系统100运行操作系统(OS)以管理当前的硬件和软件应用。例如，0S140可在计算机系统100的引导过程期间被加载到系统存储器116中，并在计算机系统100运转时运行。在不同的实施方式中，0S140可以是基于Microsoft&#174;Windows(g)的OS、基于Linux的OS或任何其它类型的OS。</p>
    <p>[0024]	此外，在很多实施方式中，PCH120可包括管理引擎(ME) 142，其为关键计算机系统功能(例如系统管理固件132的更新、认证在系统内运行或与系统通信的软件和/或硬件部件的安全测量和验证过程、以及与功率管理相关的功能等等)提供带外(OOB)管理。当计算机系统100被充分供电时以及当计算机系统100处于几种低功率状态时，ME148可以是可操作的。ME148的这种多功率状态通信能力使信息技术(IT)管理员或其它类似的管理人员能够在计算机系统100否则将无法通信时与该系统进行通信。在未示出的其它实施方式中，ME142位于PCH120外部。在未示出的这些实施方式的一些中，ME142是耦合到计算机系统100的主板的分立芯片。在其它实施方式中，ME142集成在PCH120中，但PCH120位于CPU102 外部。</p>
    <p>[0025]	在很多实施方式中，可以使用安装程序将软件应用安装在计算机系统100中。软件应用可能需要来自ME148的硬件密钥证书以允许完全的安装。硬件密钥证书具有执行密钥是有效的而不是被恶意实体假冒或以另外方式规避的更严格的安全检查的能力。接下来的是对由0S140内的软件、ME148内的硬件以及远程服务器138内的硬件执行的过程进行解释，以创建“超级密钥”，“超级密钥”在被创建时向ME148授予发送真实的软件证书的权利，所述真实的软件证书向软件通知在软件应用的安装期间输入的用户密钥是有效的，这将允许完成软件应用安装。</p>
    <p>[0026]	软件应用150可作为程序在0S140层处(例如，以与0S140中的一般应用环级别相同的信任级别)运行。在安装期间的某个点处，软件应用请求安装密钥。被称为用户密钥的密钥可以是可使用脚本或其它这样的软件机制自动地输入的或通过用户键入密钥而手动地输入的任何形式的字母数字密钥。一旦已经输入了用户密钥，0S140就将其存储在临时或永久的用户密钥存储单元152中。</p>
    <p>[0027]	在一些实施方式中，用户密钥加密算法154将用户密钥加密成已加密的用户密钥。该加密可以是掩饰用户密钥152的标识的任何可行的加密方案。例如，在一些实施方式中，使用RSA加密来将用户密钥加密成已加密的用户密钥。在很多实施方式中，使用加密算法中的第一加密密钥来对用户密钥进行加密。为了对用户密钥进行解密，必须知道第一加密密钥和加密算法。</p>
    <p>[0028]	一旦用户密钥已经通过用户密钥加密算法154被加密，0S140 (例如，或在0S140上运行的安装程序)就将已加密的用户密钥发送到ME148。已加密的用户密钥在进入点156处进入ME148，并由ME148内的用户密钥解密算法158接收。用户密钥解密算法158有权访问用户密钥加密算法154用于对用户密钥进行加密的第一加密密钥和算法。</p>
    <p>[0029]	当使用用户密钥解密算法158连同第一加密密钥在ME148内对已加密的用户密钥进行了解密时，得到原始用户密钥。该用户密钥接着存储在用户密钥存储单元160中。用户密钥存储单元160向ME密钥创建算法162提供用户密钥。在很多实施方式中，ME密钥创建算法使用额外的ME散列键使用户密钥散列化，以创建散列化的用户密钥的唯一校验和值，其被称为“ME密钥”。新创建的ME密钥首先存储在ME密钥存储单元164中，并且使用ME密钥加密算法166来加密ME密钥的副本。ME密钥加密算法166利用第二加密密钥来对新创建的ME密钥进行加密。这个已加密的ME密钥接着由ME148通过退出点168、通过网络接口 134以及在网络136上向外发送到服务器138。</p>
    <p>[0030]	服务器138知道第二加密密钥和ME密钥加密算法，这允许服务器138通过使用第二加密密钥反转加密算法来将已加密的ME密钥解密成原始ME密钥。因此，ME密钥解密算法170对从计算机系统100接收的已加密的ME密钥进行解密并得到原始ME密钥。</p>
    <p>[0031]	在很多实施方式中，服务器接着利用所得到的ME密钥来在数据库中运行查找算法。在数据库中示出一组有效的ME密钥。如果其他人已经使用同一用户密钥认证了程序的另一安装，则ME密钥将就这点告知服务器138，并且服务器可接着决定停止进一步的密钥验证，这是因为该密钥是已知的用过的密钥。虽然服务器138不完全拥有用户密钥，但从对用户密钥进行散列化而创建的ME密钥可用作有效密钥表中的索引查找。</p>
    <p>[0032]	例如，假设ME密钥是有效的，而不是无效的ME密钥。如果是有效的，则服务器138通过以下方式使用服务器密钥创建算法172来创建服务器密钥:用额外的服务器散列键来对ME密钥进行散列化，以创建散列化的ME密钥的唯一校验和值，其被称为“服务器密钥”。随后服务器密钥加密算法174使用第三加密密钥对新创建的服务器密钥进行加密。接着在网络136上将已加密的服务器密钥发送回计算机系统100。在ME148内，已加密的服务器密钥在进入点176处由已加密的服务器密钥解密算法178接收。服务器密钥解密算法178有权访问服务器138上的服务器密钥加密算法174用于加密服务器密钥的第三加密密钥和算法。</p>
    <p>[0033]	当使用服务器密钥解密算法178连同第三加密密钥在ME148内对已加密的服务器密钥进行了解密时，得到原始服务器密钥。该服务器密钥接着存储在服务器密钥存储单元180 中。[0034]	此时，ME148分别在用户密钥存储单元160、ME密钥存储单元164和服务器密钥存储单元180中存储了用户密钥、ME密钥和服务器密钥。所有三个密钥(即，用户密钥、ME密钥和服务器密钥)接着被组合以创建超级密钥。更具体地，在很多实施方式中，超级密钥创建算法对用户密钥、ME密钥和服务器密钥一起进行散列化，以创建这三个密钥的组合散列的唯一校验和值。这个组合的散列值(即，校验和)被称为“超级密钥”。接着在超级密钥存储单元184中对照已经存储在ME148中的预定超级密钥来检查新创建的超级密钥。作为结果，如果比较匹配，则确认输入的用户密钥是有效的。这种有效性接着以证书的形式通过ME148的退出点186而被发送到0S140，这在过程开始时输入有效的用户密钥的情况下允许软件安装完成。</p>
    <p>[0035]	在很多实施方式中，利用OOB通信信道在不同的起点和目的地逻辑模块(即，用户app./OS,ME和服务器)之间发送用户密钥、ME密钥和服务器密钥。</p>
    <p>[0036]	图2是在实现了加密的情况下利用硬件超级密钥来验证和保护正版软件安装的过程的实施方式的流程图。</p>
    <p>[0037]	该过程由处理逻辑执行，该处理逻辑可包括软件应用、固件代码、硬件电路或处理逻辑的任何所列出的形式的组合。</p>
    <p>[0038]	该过程以用户应用和/或OS中的处理逻辑创建或获取用户密钥(处理块200)开始。处理逻辑接着对用户密钥进行加密(处理块202)。一旦被加密，处理逻辑就将已加密的用户密钥发送到计算机系统中的管理引擎(ME)(处理块204)。</p>
    <p>[0039]	管理引擎中的处理逻辑接收已加密的用户密钥(处理块206)。一旦被接收，处理逻辑就对已加密的用户密钥进行解密以得到用户密钥(处理块208)。然后处理逻辑通过用ME散列键对用户密钥进行散列化来创建ME密钥(处理块210)。如上所述，ME密钥创建算法可利用任何预定的ME散列键来创建用户密钥的唯一散列，其产生ME密钥。</p>
    <p>[0040]	一旦ME密钥被创建，处理逻辑就接着对ME密钥进行加密(处理块212)。并且当ME密钥已经被加密时，处理逻辑会将已加密的ME密钥发送到服务器(处理块214)。</p>
    <p>[0041]	服务器中的处理逻辑接收已加密的ME密钥(处理块216)。一旦被接收，处理逻辑就对已加密的ME密钥进行解密以得到ME密钥(处理块218)。当处理逻辑具有ME密钥时，它确定ME密钥是否是有效的(处理块220)。可通过执行在数据库中查找ME密钥来作出该确定。数据库可具有所有的ME密钥和每个ME密钥的当前状态(例如，用过的、未用过的，等等)。如果ME密钥不是有效的，则该过程停止，并且服务器不返回有效的服务器密钥(这使超级密钥是无效的)。</p>
    <p>[0042]	另一方面，如果ME密钥是有效的，则处理逻辑通过用ME散列键对ME密钥进行散列化来创建服务器密钥(处理块222)。一旦服务器密钥已经被创建，处理逻辑就接着对服务器密钥进行加密(处理块224)。然后处理逻辑将已加密的服务器密钥发送到ME (处理块226)。</p>
    <p>[0043]	ME中的处理逻辑接收已加密的服务器密钥(处理块228)。一旦被接收，处理逻辑就接着对已加密的服务器密钥进行解密以得到服务器密钥(处理块230)。此时，ME中的处理逻辑具有所有三个有效的密钥:用户密钥、ME密钥和服务器密钥。处理逻辑接着对这三个密钥一起进行散列化以创建超级密钥(处理块232)。在装备了超级密钥的情况下，处理逻辑接着认证超级密钥(处理块234)。认证可以像将所创建的超级密钥与存储在ME内的超级密钥的一个版本进行比较一样简单。在其它实施方式中，ME通过所测量的/安全的通信来向远程安全服务器请求对超级密钥的认证。</p>
    <p>[0044]	认证的结果由处理逻辑接收，并且处理逻辑接着确定超级密钥是否是真实的(处理块236)。如果发现超级密钥不是真实的，则处理逻辑停止进一步的密钥验证，并且没有证书被传递回到用户应用来完成安装。但是，如果超级密钥是真实的，则ME中的处理逻辑将证书发送到用户应用或OS (处理块238)以向用户应用或OS通知最初输入的用户密钥是有效的并且是被验证的。最后，用户应用或OS中的处理逻辑接着接收证书(处理块240)，并且软件安装可完成。</p>
    <p>[0045]	图1和图2描述了在超级密钥创建过程期间当在模块(即，用户应用/OS模块逻辑、ME模块逻辑和服务器模块逻辑)之间传递通信时利用加密的过程的实施方式。</p>
    <p>[0046]	另一方面，图3是在没有实现加密的情况下利用硬件超级密钥来验证和保护正版软件安装的过程的实施方式的流程图。更确切地，在图3所示的实施方式中，三个密钥(用户密钥、ME密钥和服务器密钥)中的每一个都是以原始形式在模块之间进行发送的，因此这不需要解密。与图2中的过程相比，该过程不太安全，但由于较少的加密开销而更精简。</p>
    <p>[0047]	该过程由处理逻辑执行，该处理逻辑可包括软件应用、固件代码、硬件电路或处理逻辑的任何所列出的形式的组合。</p>
    <p>[0048]	该过程以用户应用和/或OS中的处理逻辑创建或获取用户密钥(处理块300)开始。处理逻辑接着将用户密钥发送到计算机系统中的管理引擎(ME)(处理块302)。</p>
    <p>[0049]	管理引擎中的处理逻辑接收用户密钥(处理块304)。一旦被接收，处理逻辑就通过用ME散列键对所接收的用户密钥进行散列化来创建ME密钥(处理块306)。如上所述，ME密钥创建算法可利用任何预定的ME散列键来创建用户密钥的唯一散列，其产生了 ME密钥。</p>
    <p>[0050]	一旦ME密钥被创建，处理逻辑就会接着将ME密钥发送到服务器(处理块308)。</p>
    <p>[0051]	服务器中的处理逻辑接收ME密钥(处理块310)。一旦被接收，处理逻辑接着就确定ME密钥是否是有效的(处理块312)。可通过执行在数据库中查找ME密钥来作出该确定。数据库可具有所有的ME密钥和每个ME密钥的当前状态(例如，用过的、未用过的，等等)。如果ME密钥不是有效的，则该过程停止，并且服务器不返回有效的服务器密钥(这使超级密钥是无效的)。在其它实施方式中，可以使ME密钥经历确认算法，其确定密钥是真正的还是编造的。</p>
    <p>[0052]	如果ME密钥是有效的，则处理逻辑通过用ME散列键来对ME密钥进行散列化来创建服务器密钥(处理块314)。一旦服务器密钥已经被创建，处理逻辑就将服务器密钥发送到ME (处理块316)。</p>
    <p>[0053]	ME中的处理逻辑接收服务器密钥(处理块318)。一旦被接收，处理逻辑就接着对三个密钥一起进行散列化以创建超级密钥(处理块320)。在装备了超级密钥的情况下，处理逻辑接着认证超级密钥(处理块322)。认证可以像将所创建的超级密钥与存储在ME内的超级密钥的一个版本进行比较一样简单。在其它实施方式中，ME通过所测量的/安全的通信来向远程安全服务器请求对超级密钥的认证。</p>
    <p>[0054]	认证的结果由处理逻辑接收，并且处理逻辑接着确定超级密钥是否是真实的(处理块324)。如果发现超级密钥不是真实的，则处理逻辑停止进一步的密钥验证，并且没有证书被传递回到用户应用来完成安装。但是，如果超级密钥是真实的，则ME中的处理逻辑将证书发送到用户应用或OS (处理块326)以向用户应用或OS通知最初输入的用户密钥是有效的并且被验证了。最后，用户应用或OS中的处理逻辑接着接收证书(处理块328)，并且软件安装可完成。</p>
    <p>[0055]	在本发明中讨论的散列算法可包括一个或多个有效的散列算法。例如，可以使用SHA-1散列算法来为每个散列函数创建校验和/散列结果。在其它实施方式中，为了散列化的目的，可利用任何其它有效的散列算法中的一个或多个。在所有其它实施方式，利用另一形式的密钥创建算法而不是散列算法。</p>
    <p>[0056]	本发明的实施方式的元素也可被提供为用于存储机器可执行指令的机器可读介质。机器可读介质可包括但不限于闪存、光盘、光盘-只读存储器(CD-ROM)、数字通用/视频盘(DVD) ROM、随机存取存储器(RAM)、可擦除可编程只读存储器(EPR0M)、电可擦除可编程只读存储器(EEPR0M)、磁卡或光卡、传播介质或适合于存储电子指令的其它类型的机器可读介质。</p>
    <p>[0057]	在上面的描述中以及在权利要求书中，可以使用术语“包含”和“包括”以及它们衍生词，并且旨在将这些术语看做彼此的同义词。此外，在下面的描述和权利要求中，可使用术语“耦合”和“连接”以及它们的衍生词。应当理解，这些术语并不旨在作为彼此的同义词。相反，在特定的实施方式中，“连接”可用于指示两个或更多个元件彼此直接物理或电接触。“耦合”可意味着两个或更多个元件处于直接物理或电接触。然而，“耦合”也可意味着两个或更多个元件彼此不处于直接接触，但仍然彼此协作、交互或通信。</p>
    <p>[0058]	在上面的描述中，使用某些术语来描述本发明的实施方式。例如，术语“逻辑”表示执行一个或多个功能的硬件、固件、软件(或其任何组合)。例如，“硬件”的例子包括但不限于集成电路、有限状态机或甚至组合逻辑。集成电路可采取处理器(例如微处理器)、专用集成电路、数字信号处理器、微控制器等的形式。</p>
    <p>[0059]	应当认识到，在整个这个说明书中对“一个实施方式”或“实施方式”的提及意味着结合该实施方式描述的特定特征、结构或特性包括在本发明的至少一个实施方式中。因此，要强调的并且应当认识到的是，在本说明书中的不同部分中对“实施方式”或“一个实施方式”或“可替换的实施方式“的两次或更多次提及不一定都是指同一实施方式。此外，在本发明的一个或多个实施方式中，可以适当地组合所述特定特征、结构或特性。</p>
    <p>[0060]	类似地，应当认识到，在本发明的实施方式的前述描述中，为了使本公开简化的目的，有时将各个特征一起组合在单个实施方式、附图或其描述中，以帮助理解各种创造性方案中的一个或多个。然而，这种公开方法不应被解释为反映所要求保护的主题需要比在每个权利要求中明确记载的特征更多的特征的意图。相反，如下面的权利要求所反映的，创造性方案在于比单个前述公开的实施方式的所有特征更少。因此，在具体实施方式后面的权利要求书在此明确地并入具体实施方式中。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN1407446A?cl=zh">CN1407446A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2001年8月31日</td><td class="patent-data-table-td patent-date-value">2003年4月2日</td><td class="patent-data-table-td ">李光</td><td class="patent-data-table-td ">计算机软件的防盗版技术</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN1514375A?cl=zh">CN1514375A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2003年7月21日</td><td class="patent-data-table-td patent-date-value">2004年7月21日</td><td class="patent-data-table-td ">蒋正华</td><td class="patent-data-table-td ">一种软件保护方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN1561026A?cl=zh">CN1561026A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2004年2月20日</td><td class="patent-data-table-td patent-date-value">2005年1月5日</td><td class="patent-data-table-td ">胡祥义</td><td class="patent-data-table-td ">一种基于加密算法技术的软件防盗版方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101206704A?cl=zh">CN101206704A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年12月6日</td><td class="patent-data-table-td patent-date-value">2008年6月25日</td><td class="patent-data-table-td ">汤姆森许可贸易公司</td><td class="patent-data-table-td ">用于安全软件安装的方法及设备</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101266638A?cl=zh">CN101266638A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2008年4月16日</td><td class="patent-data-table-td patent-date-value">2008年9月17日</td><td class="patent-data-table-td ">北京飞天诚信科技有限公司</td><td class="patent-data-table-td ">软件保护的方法和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101604362A?cl=zh">CN101604362A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2008年6月13日</td><td class="patent-data-table-td patent-date-value">2009年12月16日</td><td class="patent-data-table-td ">鸿富锦精密工业（深圳）有限公司;鸿海精密工业股份有限公司</td><td class="patent-data-table-td ">用于软件加密的计算机系统及方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20080159540">US20080159540</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年12月18日</td><td class="patent-data-table-td patent-date-value">2008年7月3日</td><td class="patent-data-table-td ">Yves Maetz</td><td class="patent-data-table-td ">Methods and a device for secure software installation</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20090106751">US20090106751</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2008年10月16日</td><td class="patent-data-table-td patent-date-value">2009年4月23日</td><td class="patent-data-table-td ">Hong Fu Jin Precision Industry (Shenzhen) Co., Ltd</td><td class="patent-data-table-td ">Data storage medium, software installation method and copyright protection module</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=z4klCAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0009080000">H04L9/08</a></span></td></tr><tr><td class="patent-data-table-td "> 合作分类</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=z4klCAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L9/0822">H04L9/0822</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=z4klCAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L2209/12">H04L2209/12</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2013年5月22日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年6月19日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2015年9月9日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Grant of patent or utility model</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/1e1aa825adb9a24c2955/CN103119889A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%BD%BF%E7%94%A8%E7%A1%AC%E4%BB%B6%E8%B6%85%E7%BA%A7%E5%AF%86%E9%92%A5%E9%AA%8C%E8%AF%81%E5%92%8C%E4%BF%9D%E6%8A%A4.pdf?id=z4klCAABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U1vr9-2tMR_QRJ9_HLUQ_fbCguIJA"},"sample_url":"https://www.google.com/patents/reader?id=z4klCAABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>