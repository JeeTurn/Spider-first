<!DOCTYPE html><html><head><title>专利 CN103714642A - 密钥下载方法、管理方法、下载管理方法及装置和系统 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="密钥下载方法、管理方法、下载管理方法及装置和系统"><meta name="DC.contributor" content="姚承勇" scheme="inventor"><meta name="DC.contributor" content="彭荣收" scheme="inventor"><meta name="DC.contributor" content="孟陆强" scheme="inventor"><meta name="DC.contributor" content="福建联迪商用设备有限公司" scheme="assignee"><meta name="DC.date" content="2013-12-27" scheme="dateSubmitted"><meta name="DC.description" content="本发明公开一种密钥下载管理方法，设备端通过校验RKS服务器的工作证书公钥的数字签名来认证RKS服务器的合法性，RKS服务器生成一个鉴别令牌AT，用设备端的二级身份鉴别密钥DK2加密，将密文发送给设备端，设备端用其保存的二级身份鉴别密钥DK2解密，再用工作证书公钥加密后返回给RKS服务器，RKS服务器用其工作证书私钥解密后再对比鉴别令牌AT与生成的鉴别令牌AT是否一样，一样则表示设备端合法，从而实现双向身份认证。"><meta name="DC.date" content="2014-4-9"><meta name="DC.relation" content="CN:101005357:A" scheme="references"><meta name="DC.relation" content="CN:101056166:A" scheme="references"><meta name="DC.relation" content="CN:102413132:A" scheme="references"><meta name="DC.relation" content="CN:102624710:A" scheme="references"><meta name="DC.relation" content="CN:102647274:A" scheme="references"><meta name="DC.relation" content="US:20030172278:A1" scheme="references"><meta name="citation_patent_publication_number" content="CN:103714642:A"><meta name="citation_patent_application_number" content="CN:201310743191"><link rel="canonical" href="https://www.google.com/patents/CN103714642A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN103714642A?cl=zh"/><meta name="title" content="专利 CN103714642A - 密钥下载方法、管理方法、下载管理方法及装置和系统"/><meta name="description" content="本发明公开一种密钥下载管理方法，设备端通过校验RKS服务器的工作证书公钥的数字签名来认证RKS服务器的合法性，RKS服务器生成一个鉴别令牌AT，用设备端的二级身份鉴别密钥DK2加密，将密文发送给设备端，设备端用其保存的二级身份鉴别密钥DK2解密，再用工作证书公钥加密后返回给RKS服务器，RKS服务器用其工作证书私钥解密后再对比鉴别令牌AT与生成的鉴别令牌AT是否一样，一样则表示设备端合法，从而实现双向身份认证。"/><meta property="og:title" content="专利 CN103714642A - 密钥下载方法、管理方法、下载管理方法及装置和系统"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN103714642A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN103714642A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN103714642A&amp;usg=AFQjCNG7bVbTlOkEOdgn5lj08Q-uSI8KEA" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/92364e3817c9d3e87f19/CN103714642A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/92364e3817c9d3e87f19/CN103714642A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN103714642A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN103714642A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN103714642A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN103714642B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN103714642A?cl=zh" style="display:none"><span itemprop="description">本发明公开一种密钥下载管理方法，设备端通过校验RKS服务器的工作证书公钥的数字签名来认证RKS服务器的合法性，RKS服务器生成一个鉴别令牌AT，用设备端的二级身份鉴别密钥DK2加密，将密文发送给设备端，设备端用其保存的 ...</span><span itemprop="url">https://www.google.com/patents/CN103714642A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN103714642A - 密钥下载方法、管理方法、下载管理方法及装置和系统</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN103714642A - 密钥下载方法、管理方法、下载管理方法及装置和系统" title="专利 CN103714642A - 密钥下载方法、管理方法、下载管理方法及装置和系统"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN103714642 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201310743191</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2014年4月9日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2013年12月27日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2013年3月15日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103220271A?hl=zh-CN&amp;cl=zh">CN103220271A</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103714642B?hl=zh-CN&amp;cl=zh">CN103714642B</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20160028547?hl=zh-CN&amp;cl=zh">US20160028547</a>, </span><span class="patent-bibdata-value"><a href="/patents/WO2014139342A1?hl=zh-CN&amp;cl=zh">WO2014139342A1</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201310743191.6, </span><span class="patent-bibdata-value">CN 103714642 A, </span><span class="patent-bibdata-value">CN 103714642A, </span><span class="patent-bibdata-value">CN 201310743191, </span><span class="patent-bibdata-value">CN-A-103714642, </span><span class="patent-bibdata-value">CN103714642 A, </span><span class="patent-bibdata-value">CN103714642A, </span><span class="patent-bibdata-value">CN201310743191, </span><span class="patent-bibdata-value">CN201310743191.6</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%A7%9A%E6%89%BF%E5%8B%87%22">姚承勇</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%BD%AD%E8%8D%A3%E6%94%B6%22">彭荣收</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%AD%9F%E9%99%86%E5%BC%BA%22">孟陆强</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E7%A6%8F%E5%BB%BA%E8%81%94%E8%BF%AA%E5%95%86%E7%94%A8%E8%AE%BE%E5%A4%87%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">福建联迪商用设备有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103714642A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103714642A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103714642A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (6),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (12),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (5)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201310743191&amp;usg=AFQjCNHeOpBXeoBfq4J1Auv2qrsEZrp-Tw"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D103714642A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNHRuyBAb-FxSH1j7dydgB70vKsNcA"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT135277385" lang="ZH" load-source="patent-office">密钥下载方法、管理方法、下载管理方法及装置和系统</invention-title>
      </span><br><span class="patent-number">CN 103714642 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA132637329" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明公开一种密钥下载管理方法，设备端通过校验RKS服务器的工作证书公钥的数字签名来认证RKS服务器的合法性，RKS服务器生成一个鉴别令牌AT，用设备端的二级身份鉴别密钥DK2加密，将密文发送给设备端，设备端用其保存的二级身份鉴别密钥DK2解密，再用工作证书公钥加密后返回给RKS服务器，RKS服务器用其工作证书私钥解密后再对比鉴别令牌AT与生成的鉴别令牌AT是否一样，一样则表示设备端合法，从而实现双向身份认证。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(6)</span></span></div><div class="patent-text"><div mxw-id="PCLM60131790" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.一种密钥下载方法，其特征在于，包括:  设备端发送设备序列号DSN和设备身份鉴别请求至RKS服务器；  设备端接收RKS服务器发送的工作证书公钥RKS_WCRT_PK ；  设备端使用根公钥证书RKS_RCRT校验RKS_WCRT_PK的数字签名是否合法，如果合法，设备端使用RKS_WCRT_PK加密发散因子得到发散因子密文，并将发散因子密文发送至RKS服务器；  设备端接收RKS服务器发送的AT_TK1密文，所述AT_TK1密文由设备身份鉴别二级密钥DIK2加密鉴别令牌AT和第一传输密钥分量TKl得到，DIK2通过调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和设备身份鉴别一级密钥DIKl生成；  设备端使用DIK2解密AT_TK1密文得到AT和TKl明文；  设备端产生第三随机数作为第二传输密钥分量TK2，将TKl和TK2异或得到传输密钥TK,计算TK的SHA256校验值得到TK_SHA2 ；   设备端使用RKS_WCRT_PK加密AT、TK2和TK_SHA2得到AT_TK2_TK_SHA2密文并将AT_TK2_TK_SHA2密文发送至RKS服务器；  设备端接收RKS服务器发送的密钥密文，所述密钥密文由TK加密需要下载的密钥得到；  设备端使用TK解密密钥密文得到密钥明文，将密钥保存至安全模块；   设备端判断密钥下载是否完成，如果下载完成，清除AT、TK及RKS_WCRT_PK。</div>
    </div>
    </div> <div class="claim"> <div num="2" class="claim">
      <div class="claim-text">2.一种密钥管理方法，其特征在于，包括:  RKS服务器接收至少一个设备端发送的设备序列号DSN和设备身份鉴别请求；  RKS服务器将工作证书公钥RKS_WCRT_PK发送至设备端；  RKS服务器接收设备端发送的发散因子密文；  RKS服务器使用工作证书私钥RKS_WCRT_SK解密发散因子密文得到发散因子明文；  RKS服务器以DSN为索引从设备身份鉴别一级密钥数据库读取相应的设备身份鉴别一级密钥DIKl ；  调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和DIKl生成设备身份鉴别二级密钥DIK2 ；  RKS服务器产生24字节第一随机数作为鉴别令牌AT，并产生第二随机数作为第一传输密钥分量TKl ；  RKS服务器使用DIK2加密AT和TKl得到AT_TK1密文，将AT_TK1密文发送至设备端；RKS服务器接收设备端发送的AT_TK2_TK_SHA2密文，所述AT_TK2_TK_SHA2密文由RKS_WCRT_PK加密AT、第二传输密钥分量TK2和TK_SHA2得到，所述TK_SHA2是传输密钥TK的SHA256校验值，所述TK由TKl和TK2异或得到；  RKS服务器使用工作证书私钥RKS_WCRT_SK解密AT_TK2_TK_SHA2密文得到AT、TK2和TK_SHA2明文，所述RKS_WCRT_PK和RKS_WCRT_SK是非对称密钥对；  RKS服务器判断收到的AT与发送的AT是否相等，如果相等，将TKl和TK2异或得到TK，计算TK的SHA256校验值得到TK_256 ；  RKS服务器判断TK_256与接收到的TK_SHA2是否相等，如果相等，使用TK加密需要下载的密钥得到密钥密文；RKS服务器将密钥密文发送至设备端；  RKS服务器清除AT、TK,完成密钥下载流程。</div>
    </div>
    </div> <div class="claim"> <div num="3" class="claim">
      <div class="claim-text">3.&#8212;种密钥下载管理方法，其特征在于，包括:  设备端发送设备序列号DSN和设备身份鉴别请求至RKS服务器；  RKS服务器将工作证书公钥RKS_WCRT_PK发送至设备端；  设备端使用根公钥证书RKS_RCRT校验RKS_WCRT_PK的数字签名是否合法，如果合法，设备端使用RKS_WCRT_PK加密发散因子得到发散因子密文；  设备端将发散因子密文发送至RKS服务器；  RKS服务器使用工作证书私钥RKS_WCRT_SK解密发散因子密文得到发散因子明文；  RKS服务器以DSN为索引从设备身份鉴别一级密钥数据库读取相应的设备身份鉴别一级密钥DIKl ；  RKS服务器调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和DIKl生成设备身份鉴别二级密钥DIK2 ；  RKS服务器产生24字节第一随机数作为鉴别令牌AT，并产生第二随机数作为第一传输密钥分量TKl ；  RKS服务器使用DIK2加密AT和TKl得到AT_TK1密文，将AT_TK1密文发送至设备端；  设备端使用DIK2解密AT_TK1密文得到AT和TKl明文；  设备端产生第三随机数作为第二传输密钥分量TK2，将TKl和TK2异或得到传输密钥TK,计算TK的SHA256校验值得到TK_SHA2 ；   设备端使用RKS_WCRT_PK加密AT、TK2和TK_SHA2得到AT_TK2_TK_SHA2密文并将AT_TK2_TK_SHA2密文发送至RKS服务器；  RKS服务器使用工作证书私钥RKS_WCRT_SK解密AT_TK2_TK_SHA2密文得到AT、TK2和TK_SHA2明文，所述RKS_WCRT_PK和RKS_WCRT_SK是非对称密钥对；  RKS服务器判断收到的AT与发送的AT是否相等，如果相等，将TKl和TK2异或得到TK，计算TK的SHA256校验值得到TK_256，判断ΤΚ_256与接收到的TK_SHA2是否相等，如果相等，使用TK加密需要下载的密钥得到密钥密文并将密钥密文发送至设备端；  设备端使用TK解密密钥密文得到密钥明文，将密钥保存至安全模块；  设备端判断密钥下载是否完成，如果下载完成，清除AT、TK及RKS_WCRT_PK ；  RKS服务器清除AT、TK,完成密钥下载流程。</div>
    </div>
    </div> <div class="claim"> <div num="4" class="claim">
      <div class="claim-text">4.一种密钥下载装置，其特征在于，包括:  鉴别请求发送单元，用于发送设备序列号DSN和设备身份鉴别请求至RKS服务器；  第一接收单元，用于接收RKS服务器发送的工作证书公钥RKS_WCRT_PK ；  服务器身份校验单元，用于使用根公钥证书RKS_RCRT校验RKS_WCRT_PK的数字签名是否合法；  第一加密单元，用于当服务器校验单元校验合法时，使用RKS_WCRT_PK加密发散因子得到发散因子密文；  第一发送单元，用于将发散因子密文发送至RKS服务器；  第二接收单元，接收RKS服务器发送的AT_TK1密文，所述AT_TK1密文由设备身份鉴别二级密钥DIK2加密鉴别令牌AT和第一传输密钥分量TKl得到，DIK2通过调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和设备身份鉴别一级密钥DIKl生成；  第一解密单元，使用DIK2解密AT_TK1密文得到AT和TKl明文；  第二传输密钥分量生成单元，用于产生第三随机数作为第二传输密钥分量TK2 ；  第一传输密钥运算单元，用于将TKl和TK2异或得到传输密钥TK，计算TK的SHA256校验值得到TK_SHA2 ；  第三接收单元，用于接收RKS服务器发送的密钥密文，所述密钥密文由TK加密需要下载的密钥得到；  第二解密单元，用于使用TK解密密钥密文得到密钥明文；  密钥下载单元，用于将密钥保存至安全模块；  第一清除单元，用于判断密钥下载是否完成，并当下载完成时清除AT、TK及RKS_WCRT_PKo</div>
    </div>
    </div> <div class="claim"> <div num="5" class="claim">
      <div class="claim-text">5.一种密钥管理装置，其特征在于，包括:  鉴别请求接收单元，用于接收至少一个设备端发送的设备序列号DSN和设备身份鉴别请求；  第二发送单元，用于将工作 证书公钥RKS_WCRT_PK发送至设备端；  第四接收单元，用于接收设备端发送的发散因子密文，发散因子密文由RKS_WCRT_PK加密发散因子得到；  第三解密单元，用于使用工作证书私钥RKS_WCRT_SK解密发散因子密文得到发散因子明文；  设备身份鉴别单元，用于以DSN为索引从设备身份鉴别一级密钥数据库读取相应的设备身份鉴别一级密钥DIKl ；  设备身份鉴别二级密钥生成单元，用于调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和DIKl生成设备身份鉴别二级密钥DIK2 ；  鉴别令牌生成单元，用于产生24字节第一随机数作为鉴别令牌AT ；  第一传输密钥生成单元，用于产生第二随机数作为第一传输密钥分量TKl ；  第二加密单元，用于使用DIK2加密AT和TKl得到AT_TK1密文；  第三发送单元，用于将AT_TK1密文发送至设备端；  第四接收单元，用于接收设备端发送的AT_TK2_TK_SHA2密文，所述AT_TK2_TK_SHA2密文由RKS_WCRT_PK加密AT、第二传输密钥分量TK2和TK_SHA2得到，所述TK_SHA2是传输密钥TK的SHA256校验值，所述TK由TKl和TK2异或得到；  第四解密单元，用于使用工作证书私钥RKS_WCRT_SK解密AT_TK2_TK_SHA2密文得到AT、TK2和TK_SHA2明文，所述RKS_WCRT_PK和RKS_WCRT_SK是非对称密钥对；  鉴别令牌校验单元，用于判断收到的AT与发送的AT是否相等；  第二传输密钥运算单元，用于当所述鉴别令牌校验单元判定相等时，将TKl和TK2异或得到TK，计算TK的SHA256校验值得到TK_256 ；  传输密钥校验单元，用于判断第二传输密钥运算单元生成的ΤΚ_256与接收到的ΤΚ_SHA2是否相等；  第三加密单元，用于当所述传输密钥校验单元判定相等时，使用TK加密需要下载的密钥得到密钥密文；第三发送单元，用于将密钥密文发送至设备端；  第二清除单元，用于清除AT、TK,完成密钥下载流程。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.一种密钥下载管理系统，包括RKS服务器和与所述RKS服务器通信连接的至少一个设备端，其特征在于，所述RKS服务器包括密钥管理装置，所述密钥管理装置如权利4所述；所述设备端包括密钥下载装置，所述密钥下载装置如权利要求5所述。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES68111036" lang="ZH" load-source="patent-office" class="description">
    <p>密钥下载方法、管理方法、下载管理方法及装置和系统</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及电子支付领域，尤其涉及一种设备端的密钥下载方法、管理方法、下载管理方法及装置和系统。</p>
    <p>背景技术</p>
    <p>[0002]	银行卡(BANK Card)作为支付工具越来越普及，通常的银行卡支付系统包括销售点终端(Point Of Sale, P0S)、终端管理系统(Terminal ManageSystem, TMS)、密码键盘(PIN PAD)和硬件加密机(Hardware and Security Module, HSM)。其中 POS 终端能够接受银行卡信息，具有通讯功能，并接受柜员的指令完成金融交易信息和有关信息交换的设备；TMS系统对POS终端进行集中管理，包括参数下载，密钥下载，接受、处理或转发POS终端的交易请求，并向POS终端回送交易结果信息，是集中管理和交易处理的系统；密码键盘(PIN PAD)是对各种金融交易相关的密钥进行安全存储保护，以及对PIN进行加密保护的安全设备；硬件加密机(HSM)是对传输数据进行加密的外围硬件设备，用于PIN的加密和解密、验证报文和文件来源的正确性以及存储密钥。个人标识码(Personal I dent i f i cat i onNumber, PIN),即个人密码，是在联机交易中识别持卡人身份合法性的数据信息，在计算机和网络系统中任何环节都不允许以明文的方式出现；终端主密钥(Terminal Master Key,TMK)，POS终端工作时，对工作密钥进行加密的主密钥，保存在系统硬件中，只能使用，不能读取；P0S终端广泛应用于银行卡支付场合，比如厂商购物、酒店住宿等，是一种不可或缺的现代化支付手段，已经融入人们生活的各种场合。银行卡，特别是借记卡，一般都由持卡人设置了 PIN，在进行支付过程中，POS终端除了上送银行卡的磁道信息等资料外，还要持卡人输入PIN供发卡银行验证持卡人的身份合法性，确保银行卡支付安全，保护持卡人的财产安全。为了防止PIN泄露或被破解，要求从终端到发卡银行整个信息交互过程中，全称对PIN进行安全加密保护，不允许在计算机网络系统的任何环节，PIN以密文的方式出现，因此目前接受输入PIN的POS终端都要求配备密钥管理体系。</p>
    <p>[0003]	POS终端的密钥体系分成二级:终端主密钥(TMK)和工作密钥(WK)。其中TMK在WK更新过程中，对WK进行加密保护。每台POS终端与TMS之间共享唯一的TMK，必须要有安全保护，保证只能写入设备并参与计算，不能读取；TMK是一个很关键的根密钥，如果TMK被截取，工作密钥就比较容易都会被破解，将严重威胁银行卡支付安全。所以能否安全下载TMK到POS终端，成为整个POS终端安全性的关键。下面归纳现有的TMK下载方案如下:</p>
    <p>[0004]	1、明文手工输入方案:由TMS生成TMK明文，由手工方式直接输入到POS终端的密码键盘。这种方式存在很大的安全漏洞，操作人员容易截取TMK明文，而且存在手工输入错误的可能性，而且大量的设备需要逐一输入对应的TMK，通常为了提高安全性，每台POS的TMK都不一样，管理成本和工作量都相当复杂和巨大。</p>
    <p>[0005]	2、IC卡密文导入方案:IC卡密文导入。TMK由TMS生成后，存在IC卡中，并由IC卡持有人设置IC卡密码保护IC卡中的TMK，导入POS终端时，通过POS终端密码键盘输入IC卡密码后，从IC卡导入到密码键盘中。该方案需要在TMS生成POS终端时由管理人员一一插入IC卡并设置IC卡片密码。并在POS终端导入时，依然需要手工输入IC卡密码，IC卡片密码泄露依然会导致TMK泄露也存在风险，而且大量的POS采用此方式，其管理成本及工作量也相当巨大。</p>
    <p>[0006]	3、本地密钥母POS方案:当前支付行业的密钥下载多采用本地下载的方式，下载到金融POS终端的主密钥需要本地才能进行安全的下载，即金融POS终端需要携带到管理中心的安全机房，和位于安全机房的密钥母POS进行物理连接，并在管理员的操作下，从密钥母POS下载主密钥，然后将金融POS布放到部署地点，再通过主密钥进行远程下载工作密钥。</p>
    <p>[0007]	上述三种方案都有以下缺点:设备需要到管理中心的安全机房，通过人工集中下载密钥。维护中心机房，工作量大；设备出厂后需要运算到管理中心安全机房下载密钥才能部署到商户。运输成本上升；为了集中下装密钥，需要大量的人手和工作时间，维护成本大、维护周期长。</p>
    <p>[0008]目前也有一种远程密钥下载方案:该方案TMS调用加密机产生一对公私钥，POS终端调用密码键盘随机生成主密钥TMK，并用TMS的公钥进行加密后上传给TMS，TMS调用加密机并用私钥解密TMK后存储，用TMK加密工作密钥下载给POS终端。该方案有以下缺点:TMS对POS终端缺少身份鉴别，无法防止伪终端连接TMS下载工作密钥；P0S终端缺少对TMS的身份鉴别，无法防止伪TMS后台下载伪工作密钥。</p>
    <p>发明内容</p>
    <p>[0009]	为解决上述技术问题，本发明采用的一个技术方案是:</p>
    <p>[0010]	提供一种密钥下载方法，包括:设备端发送设备序列号DSN和设备身份鉴别请求至RKS服务器；设备端接收RKS服务器发送的工作证书公钥RKS_WCRT_PK ;设备端使用根公钥证书RKS_RCRT校验RKS_WCRT_PK的数字签名是否合法，如果合法，设备端使用RKS_WCRT_PK加密发散因子得到发散因子密文，并将发散因子密文发送至RKS服务器；设备端接收RKS服务器发送的AT_TK1密文，所述AT_TK1密文由设备身份鉴别二级密钥DIK2加密鉴别令牌AT和第一传输密钥分量TKl得到，DIK2通过调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和设备身份鉴别一级密钥DIKl生成；设备端使用DIK2解密AT_TK1密文得到AT和TKl明文；设备端产生第三随机数作为第二传输密钥分量TK2，将TKl和TK2异或得到传输密钥TK，计算TK的SHA256校验值得到TK_SHA2 ;设备端使用RKS_WCRT_PK加密AT、TK2和TK_SHA2得到AT_TK2_TK_SHA2密文并将AT_TK2_TK_SHA2密文发送至RKS服务器；设备端接收RKS服务器发送的密钥密文，所述密钥密文由TK加密需要下载的密钥得到；设备端使用TK解密密钥密文得到密钥明文，将密钥保存至安全模块；设备端判断密钥下载是否完成，如果下载完成，清除AT、TK及RKS_WCRT_PK。</p>
    <p>[0011]	本发明采用的另一个技术方案是:</p>
    <p>[0012]	提供一种密钥管理方法，包括:RKS服务器接收至少一个设备端发送的设备序列号DSN和设备身份鉴别请求；RKS服务器将工作证书公钥RKS_WCRT_PK发送至设备端；RKS服务器接收设备端发送的发散因子密文；RKS服务器使用工作证书私钥RKS_WCRT_SK解密发散因子密文得到发散因子明文；RKS服务器以DSN为索引从设备身份鉴别一级密钥数据库读取相应的设备身份鉴别一级密钥DIKl;调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和DIKl生成设备身份鉴别二级密钥DIK2 ；RKS服务器产生24字节第一随机数作为鉴别令牌AT，并产生第二随机数作为第一传输密钥分量TKl ；RKS服务器使用DIK2加密AT和TKl得到AT_TK1密文，将AT_TK1密文发送至设备端；RKS服务器接收设备端发送的AT_TK2_TK_SHA2密文，所述AT_TK2_TK_SHA2密文由RKS_WCRT_PK加密AT、第二传输密钥分量TK2和TK_SHA2得到，所述TK_SHA2是传输密钥TK的SHA256校验值，所述TK由TKl和TK2异或得到；RKS服务器使用工作证书私钥RKS_WCRT_SK解密AT_TK2_TK_SHA2密文得到AT、TK2和TK_SHA2明文，所述RKS_WCRT_PK和RKS_WCRT_SK是非对称密钥对；RKS服务器判断收到的AT与发送的AT是否相等，如果相等，将TKl和TK2异或得到TK，计算TK的SHA256校验值得到TK_256 ；RKS服务器判断TK_256与接收到的TK_SHA2是否相等，如果相等，使用TK加密需要下载的密钥得到密钥密文；RKS服务器将密钥密文发送至设备端；RKS服务器清除AT、TK,完成密钥下载流程。</p>
    <p>[0013]	本发明采用的另一个技术方案是:</p>
    <p>[0014]	提供一种密钥下载管理方法，包括:设备端发送设备序列号DSN和设备身份鉴别请求至RKS服务器；RKS服务器将工作证书公钥RKS_WCRT_PK发送至设备端；设备端使用根公钥证书RKS_RCRT校验RKS_WCRT_PK的数字签名是否合法，如果合法，设备端使用RKS_WCRT_PK加密发散因子得到发散因子密文；设备端将发散因子密文发送至RKS服务器；RKS服务器使用工作证书私钥RKS_WCRT_SK解密发散因子密文得到发散因子明文；RKS服务器以DSN为索引从设备身份鉴别一级密钥数据库读取相应的设备身份鉴别一级密钥DIKl; RKS服务器调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和DIKl生成设备身份鉴别二级密钥DIK2 ；RKS服务器产生24字节第一随机数作为鉴别令牌AT，并产生第二随机数作为第一传输密钥分量TKl ；RKS服务器使用DIK2加密AT和TKl得到AT_TK1密文，将AT_TK1密文发送至设备端；设备端使用DIK2解密AT_TK1密文得到AT和TKl明文；设备端产生第三随机数作为第二传输密钥分量TK2，将TKl和TK2异或得到传输密钥TK，计算TK的SHA256校验值得到TK_SHA2;设备端使用RKS_WCRT_PK加密AT、TK2和TK_SHA2得到AT_TK2_TK_SHA2密文并将AT_TK2_TK_SHA2密文发送至RKS服务器；RKS服务器使用工作证书私钥RKS_WCRT_SK解密AT_TK2_TK_SHA2密文得到AT、TK2和TK_SHA2明文，所述RKS_WCRT_PK和RKS_WCRT_SK是非对称密钥对；RKS服务器判断收到的AT与发送的AT是否相等，如果相等，将TKl和TK2异或得到TK，计算TK的SHA256校验值得到TK_256，判断ΤΚ_256与接收到的TK_SHA2是否相等，如果相等，使用TK加密需要下载的密钥得到密钥密文并将密钥密文发送至设备端；设备端使用TK解密密钥密文得到密钥明文，将密钥保存至安全模块；设备端判断密钥下载是否完成，如果下载完成，清除AT、TK及RKS_WCRT_PK ；RKS服务器清除AT、TK,完成密钥下载流程。</p>
    <p>[0015]	本发明采用的另一个技术方案是:</p>
    <p>[0016]	提供一种密钥下载装置，包括:鉴别请求发送单元，用于发送设备序列号DSN和设备身份鉴别请求至RKS服务器；第一接收单元，用于接收RKS服务器发送的工作证书公钥RKS_WCRT_PK ;服务器身份校验单元，用于使用根公钥证书RKS_RCRT校验RKS_WCRT_PK的数字签名是否合法；第一加密单元，用于当服务器校验单元校验合法时，使用RKS_WCRT_PK加密发散因子得到发散因子密文；第一发送单元，用于将发散因子密文发送至RKS服务器；第二接收单元，接收RKS服务器发送的AT_TK1密文，所述AT_TK1密文由设备身份鉴别二级密钥DIK2加密鉴别令牌AT和第一传输密钥分量TKl得到，DIK2通过调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和设备身份鉴别一级密钥DIKl生成；第一解密单元，使用DIK2解密AT_TK1密文得到AT和TKl明文；第二传输密钥分量生成单元，用于产生第三随机数作为第二传输密钥分量TK2 ;第一传输密钥运算单元，用于将TKl和TK2异或得到传输密钥TK，计算TK的SHA256校验值得到TK_SHA2 ;第三接收单元，用于接收RKS服务器发送的密钥密文，所述密钥密文由TK加密需要下载的密钥得到；第二解密单元，用于使用TK解密密钥密文得到密钥明文；密钥下载单元，用于将密钥保存至安全模块；第一清除单元，用于判断密钥下载是否完成，并当下载完成时清除AT、TK及RKS_WCRT_PK。</p>
    <p>[0017]	本发明采用的另一个技术方案是:</p>
    <p>[0018]	提供一种密钥管理装置包括:鉴别请求接收单元，用于接收至少一个设备端发送的设备序列号DSN和设备身份鉴别请求；第二发送单元，用于将工作证书公钥RKS_WCRT_PK发送至设备端；第四接收单元，用于接收设备端发送的发散因子密文，发散因子密文由RKS_WCRT_PK加密发散因子得到；第三解密单元，用于使用工作证书私钥RKS_WCRT_SK解密发散因子密文得到发散因子明文；设备身份鉴别单元，用于以DSN为索引从设备身份鉴别一级密钥数据库读取相应的设备身份鉴别一级密钥DIKl ;设备身份鉴别二级密钥生成单元，用于调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和DIKl生成设备身份鉴别二级密钥DIK2 ;鉴别令牌生成单元，用于产生24字节第一随机数作为鉴别令牌AT ;第一传输密钥生成单元，用于产生第二随机数作为第一传输密钥分量TKl ;第二加密单元，用于使用DIK2加密AT和TKl得到AT_TK1密文；第三发送单元，用于将AT_TK1密文发送至设备端；第四接收单元，用于接收设备端发送的AT_TK2_TK_SHA2密文，所述AT_TK2_TK_SHA2密文由RKS_WCRT_PK加密AT、第二传输密钥分量TK2和TK_SHA2得到，所述TK_SHA2是传输密钥TK的SHA256校验值，所述TK由TKl和TK2异或得到；第四解密单元，用于使用工作证书私钥RKS_WCRT_SK解密AT_TK2_TK_SHA2密文得到AT、TK2和TK_SHA2明文，所述RKS_WCRT_PK和RKS_WCRT_SK是非对称密钥对；鉴别令牌校验单元，用于判断收到的AT与发送的AT是否相等；第二传输密钥运算单元，用于当所述鉴别令牌校验单元判定相等时，将TKl和TK2异或得到TK，计算TK的SHA256校验值得到TK_256 ;传输密钥校验单元，用于判断第二传输密钥运算单元生成的ΤΚ_256与接收到的TK_SHA2是否相等；第三加密单元，用于当所述传输密钥校验单元判定相等时，使用TK加密需要下载的密钥得到密钥密文；第三发送单元，用于将密钥密文发送至设备端；第二清除单元，用于清除AT、TK，完成密钥下载流程。装置如上所述；所述设备端包括密钥下载装置，所述密钥下载装置如上所述。</p>
    <p>[0019]	本发明的密钥下载方法、管理方法、下载管理方法及装置和系统，实现设备端从RKS服务器远程下载主密钥，避免设备端需要集中下载主密钥后才能布放到商户，设备端出厂后，可以直接布放到部署地点，避免需要将设备端集中到某固定机房下载密钥后再布放到部署地点。</p>
    <p>附图说明</p>
    <p>[0020]	图1是本发明一实施方式中一种密钥下载管理系统的结构框图；</p>
    <p>[0021]	图2是本发明一实施方式中一种密钥下载装置的结构框图；</p>
    <p>[0022]	图3是本发明一实施方式中一种密钥管理装置的结构框图；[0023]	图4是本发明一实施方式中一种密钥下载方法的流程图；</p>
    <p>[0024]	图5是本发明一实施方式中一种密钥管理方法的流程图；</p>
    <p>[0025]	图6是本发明一实施方式中一种密钥下载管理方法的流程图。</p>
    <p>[0026]	主要元件符号说明</p>
    <p>[0027]	设备端I ;密钥下载装置10 ；RKS服务器3 ;密钥管理装置30 ；</p>
    <p>[0028]	鉴别请求发送单元11 ;第一接收单元12 ;服务器身份校验单元13 ；</p>
    <p>[0029]	第一解密单元14 ;第二传输密钥分量生成单元15 ；</p>
    <p>[0030]	第一传输密钥运算单元16 ;第一加密单元17 ;第一发送单元18 ；</p>
    <p>[0031]	第二接收单元19 ;第二解密单元20 ;密钥下载单元21 ;第一清除单元22 ；</p>
    <p>[0032]	第三接收单元23 ;鉴别请求接收单元31 ;设备身份鉴别单元32 ；</p>
    <p>[0033]	鉴别令牌生成单元33 ;第一传输密钥生成单元34 ；</p>
    <p>[0034]	第二加密单元35 ;第三发送单元36 ;第四接收单元37 ；</p>
    <p>[0035]	第三解密单元38 ;鉴别令牌校验单元39 ;第二传输密钥运算单元40 ；</p>
    <p>[0036]	传输密钥校验单元41 ;第三加密单元42 ;第三发送单元43 ；</p>
    <p>[0037]	第二清除单元44 ;设备身份鉴别二级密钥生成单元45 ;第四解密单元46。</p>
    <p>具体实施方式</p>
    <p>[0038]	为详细说明本发明的技术内容、构造特征、所实现目的及效果，以下结合实施方式并配合附图详予说明。</p>
    <p>[0039]	首先，对本发明涉及的缩略语和关键术语进行定义和说明:</p>
    <p>[0040]	对称密钥:发送和接收数据的双方必须使用相同的密钥对明文进行加密和解密运算。对称密钥加密算法主要包括:DES、3DES、IDEA、FEAL, BLOffFISH等。</p>
    <p>[0041]	非对称密钥:非对称加密算法需要两个密钥:公开密钥(public key)和私有密钥(private key)。公开密钥与私有密钥是一对，如果用公开密钥对数据进行加密，只有用对应的私有密钥才能解密；如果用私有密钥对数据进行加密，那么只有用对应的公开密钥才能解密。因为加密和解密使用的是两个不同的密钥，所以这种算法叫作非对称加密算法。非对称加密算法实现机密信息交换的基本过程是:甲方生成一对密钥并将其中的一把作为公用密钥向其它方公开；得到该公用密钥的乙方使用该密钥对机密信息进行加密后再发送给甲方；甲方再用自己保存的另一把专用密钥对加密后的信息进行解密。甲方可以使用乙方的公钥对机密信息进行加密后再发送给乙方；乙方再用自己的私匙对加密后的信息进行解密。主要算法有RSA、Elgamal、背包算法、Rabin、D-H、ECC (椭圆曲线加密算法)。</p>
    <p>[0042]	数字签名:是非对称密钥加密技术与数字摘要技术的应用。数字签名技术是将摘要信息用发送者的私钥加密，与原文一起传送给接收者。接收者只有用发送的公钥才能解密被加密的摘要信息，然后用对收到的原文产生一个摘要信息，与解密的摘要信息对比。如果相同，则说明收到的信息是完整的，在传输过程中没有被修改，否则说明信息被修改过，因此数字签名能够验证信息的完整性和合法性。数字签名是个加密的过程，数字签名验证是个解密的过程。</p>
    <p>[0043]	RSA: &#8212;种非对称密钥算法。RSA公钥加密算法是1977年由Ron Rivest, AdiShamirh和Len Adleman在(美国麻省理工学院)开发的。RSA取名来自开发他们三者的名字。RSA是目前最有影响力的公钥加密算法，它能够抵抗到目前为止已知的所有密码攻击，已被ISO推荐为公钥数据加密标准。RSA算法基于一个十分简单的数论事实:将两个大素数相乘十分容易。RSA算法是第一个能同时用于加密和数字签名的算法，也易于理解和操作。RSA是被研究得最广泛的公钥算法，从提出到现在的三十多年里，经历了各种攻击的考验，逐渐为人们接受，普遍认为是目前最优秀的公钥方案之一。</p>
    <p>[0044]	TDES Triple-DES:DES是一种对称加密算法，密钥是8字节。TDES是基于DES的加密算法，其密钥是16字节或者24字节。TDES/3DES是英文Triple DES的缩语(即三重数据加密标准)，DES则是英文Data Encryption Standard (数据加密标准)的缩语。DES是一种对称密钥加密算法，即数据加密密钥与解密密钥相同的加密算法。DES由IBM公司在20世纪70年代开发并公开，随后为美国政府采用，并被美国国家标准局和美国国家标准协会(ANSI)承认。TDES/3DES是DES加密算法的一种模式，它使用3条64位的密钥对数据进行三次加密。是DES的一个更安全的变形。</p>
    <p>[0045]	请参阅图1，是本发明一实施方式中一种密钥下载管理系统的结构框图，该密钥下载管理系统包括RKS服务器3和与所述RKS服务器3通信连接的至少一个设备端1，所述RKS服务器3包括密钥管理装置30，所述设备端I包括密钥下载装置10，该设备端I为POS终端，该RKS服务器3为远程密钥服务器，位于管理中心机房，负责POS终端主密钥、工作密钥等密钥的生成和维护等，该RKS服务器3包括密钥数据库，即POS终端的主密钥数据库或工作密钥数据库，此处代表需要通过远程下载的TMK密钥数据库，该TMK密钥数据库通常由一台专门的加密机进行产生并存储密钥。</p>
    <p>[0046]	请参阅图2，是本发明一实施方式中一种密钥下载装置的结构框图。一种密钥下载装置10包括鉴别请求发送单元11、第一接收单元12、服务器身份校验单元13、第一解密单元14、第二传输密钥分量生成单元15、第一传输密钥运算单元16、第一加密单元17、第一发送单元18、第二接收单元19、第二解密单元20、密钥下载单元21、第一清除单元22、第三接收单元23。</p>
    <p>[0047]	所述鉴别请求发送单元11用于发送设备序列号DSN和设备身份鉴别请求至RKS服务器，其中，DSN与设备端I 一一对应；第一接收单元12用于接收RKS服务器3发送的工作证书公钥RKS_WCRT_PK，其中，RKS_WCRT_PK包含根私钥证书RKS_RCRT_SK对其的数字签名，确保RKS_WCRT_PK的合法，没有办法进行伪造。工作证书RKS_WCRT是一对非对称密钥对，如果是RSA密钥，位数最低2048位，工作证书RKS_WCRT由工作证书公钥RKS_WCRT_PK和工作证书私钥RKS_WCRT_SK组成，RKS_WCRT需要保存在安全介质中，例如，可以静态存储于IC卡中作为备份，然后导入到RKS服务器3的安全存储介质中。</p>
    <p>[0048]	服务器身份校验单元13用于使用根公钥证书RKS_RCRT_PK校验RKS_WCRT_PK的数字签名是否合法，其中，RKS_RCRT_PK在设备端I出厂时预装在固件中，密钥服务器根证书RKS_RCRT是一对非对称密钥对，如果是RSA密钥，数最低为2048位，RKS_RCRT由根公钥证书RKS_RCRT_PK和根私钥证书RKS_RCRT_SK组成，RKS_RCRT_PK用于校验RKS_WCRT_PK的合法性。RKS_RCRT_SK用于产生数字签名给RKS_WCRT_PK进行签名。RKS_RCRT需要存储在安全介质中，根私钥证书RKS_RCRT_SK需要严格保护，可保存在IC卡中，只能用于对工作证书公钥RKS_WCRT_PK进行签名。</p>
    <p>[0049]	第一加密单元17用于当服务器校验单元13校验合法时，使用RKS_WCRT_PK加密发散因子得到发散因子密文；第一发送单元18用于将发散因子密文发送至RKS服务器3 ；第二接收单元19用于接收AT_TK1密文，所述AT_TK1密文由设备身份鉴别二级密钥DIK2加密鉴别令牌AT和第一传输密钥分量TKl得到，DIK2通过调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和设备身份鉴别一级密钥DIKl生成。其中，设备身份鉴别二级密钥DIK2和发散因子在设备端I生产阶段，由本地密钥母POS生成。发散因子用于参与设备身份鉴别二级密钥产生，是随机数或者用于辅助RKS服务器或本地密钥母POS的数据，例如，可以由本地密钥母POS序列号、生产日期、生产批次号等组成。设备身份鉴别一级密钥由RKS服务器生成，并以安全的方式导入到本地密钥母POS中。在生产阶段，建立一个安全环境，将设备端I和本地密钥母POS进行物理连接，本地密钥母POS从设备读取设备序列号DSN，在本地密钥母POS内部生成设备鉴别二级密钥，以安全的方式将设备鉴别二级密钥DIK2和发散因子导入到设备端I中。设备序列号DSN每设备端唯一，从而保证设备鉴别二级密钥DIK2也能每设备端唯一。设备身份鉴别二级密钥生成函数为单向发散算法，单向发散算法由设备端I和RKS服务器3预先约定而成，保证以设备序列号DSN和发散因子作为输入参数1，设备身份鉴别一级密钥DIKl作为输入参数2，生成输出结果为设备设备鉴别二级密钥DIK2。此过程单向，即知道设备鉴别二级密钥DIK2和输入参数1，不能反推参数</p>
    <p>2。设备身份鉴别密钥采用24字节TDES密钥，发散过程举例如下:St印1:对设备序号生成SHA-256校验值32字节，取前24字节作为被加密数据DATA1。用设备身份鉴别一级密钥DIKl对DATAl做TDES-ECB加密，作为KEYl。St印2:对发散因子生成SHA-256校验值32字节，取前24字节作为被加密数据DATA2。KEYl对DATA2做TDES-ECB解密，作为该设备身份鉴别二级密钥DIK2。</p>
    <p>[0050]	第一解密单元14用于使用DIK2解密AT_TK1密文得到AT和TKl明文；第二传输密钥分量生成单元15用于产生第三随机数作为第二传输密钥分量TK2 ;第一传输密钥运算单元16用于将TKl和TK2异或得到传输密钥TK，计算TK的SHA256校验值得到TK_SHA2;第三接收单元23用于接收RKS服务器3发送的密钥密文，所述密钥密文由TK加密需要下载的密钥得到；第二解密单元20用于使用TK解密密钥密文得到密钥明文；密钥下载单元21用于将密钥保存至安全模块；第一清除单元22用于判断密钥下载是否完成，并当下载完成时清除 AT、TK 及 RKS_WCRT_PK。</p>
    <p>[0051]	请参阅图3，是本发明一实施方式中一种密钥管理装置的结构框图。一种密钥管理装置30包括鉴别请求接收单元31、设备身份鉴别单元32、鉴别令牌生成单元33、第一传输密钥生成单元34、第二加密单元35、第二发送单元36、第四接收单元37、第三解密单元38、鉴别令牌校验单元39、第二传输密钥运算单元40、传输密钥校验单元41、第三加密单元42、第三发送单元43、第二清除单元44、设备身份鉴别二级密钥生成单元45、第四解密单元46。</p>
    <p>[0052]	鉴别请求接收单元31用于接收至少一个设备端I发送的设备序列号DSN和设备身份鉴别请求；第二发送单元36用于将工作证书公钥RKS_WCRT_PK发送至设备端；第四接收单元37用于接收设备端发送的发散因子密文，发散因子密文由RKS_WCRT_PK加密发散因子得到；第三解密单元38用于使用工作证书私钥RKS_WCRT_SK解密发散因子密文得到发散因子明文；设备身份鉴别单元32用于以DSN为索引从设备身份鉴别一级密钥数据库读取相应的设备身份鉴别一级密钥DIKl ;设备身份鉴别二级密钥生成单元45用于调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和DIKl生成设备身份鉴别二级密钥DIK2。[0053]	鉴别令牌生成单元33用于产生24字节第一随机数作为鉴别令牌AT ;第一传输密钥生成单元34用于产生第二随机数作为第一传输密钥分量TKl ;第二加密单元35用于使用DIK2加密AT和TKl得到AT_TK1密文；第三发送单元36用于将AT_TK1密文发送至设备端；第四接收单元37用于接收设备端I发送的AT_TK2_TK_SHA2密文，所述AT_TK2_TK_SHA2密文由RKS_WCRT_PK加密AT、第二传输密钥分量TK2和TK_SHA2得到，所述TK_SHA2是传输密钥TK的SHA256校验值，所述TK由TKl和TK2异或得到；第四解密单元46用于使用工作证书私钥RKS_WCRT_SK解密AT_TK2_TK_SHA2密文得到AT、TK2和TK_SHA2明文，所述RKS_WCRT_PK和RKS_WCRT_SK是非对称密钥对；鉴别令牌校验单元39用于判断收到的AT与发送的AT是否相等；第二传输密钥运算单元40用于当所述鉴别令牌校验单元39判定相等时，将TKl和TK2异或得到TK，计算TK的SHA256校验值得到TK_256 ;传输密钥校验单元41用于判断第二传输密钥运算单元40生成的TK_256与接收到的TK_SHA2是否相等；第三加密单元42用于当所述传输密钥校验单元41判定相等时，使用TK加密需要下载的密钥得到密钥密文；第三发送单元43用于将密钥密文发送至设备端I ;第二清除单元44用于清除AT、TK，完成密钥下载流程。</p>
    <p>[0054]	请参阅图4，是本发明一实施方式中一种密钥下载方法的流程图。该密钥下载方法运行于所述设备端I中，该方法包括:</p>
    <p>[0055]	步骤S101、设备端发送设备序列号DSN和设备身份鉴别请求至RKS服务器；</p>
    <p>[0056]	步骤S102、设备端接收RKS服务器发送的工作证书公钥RKS_WCRT_PK ；</p>
    <p>[0057]	步骤S103、设备端使用根公钥证书RKS_RCRT校验RKS_WCRT_PK的数字签名是否合法，如果合法，则使用RKS_WCRT_PK加密发散因子得到发散因子密文，并将发散因子密文发送至RKS服务器；</p>
    <p>[0058]	步骤S104、设备端接收RKS服务器发送的AT_TK1密文，所述AT_TK1密文由设备身份鉴别公钥DIK_PK加密鉴别令牌AT和第一传输密钥分量TKl得到，DIK2通过调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和设备身份鉴别一级密钥DIKl生成；</p>
    <p>[0059]	步骤S105、设备端使用DIK2解密AT_TK1密文得到AT和TKl明文；</p>
    <p>[0060]	步骤S106、设备端产生第三随机数作为第二传输密钥分量TK2，将TKl和TK2异或得到传输密钥TK，计算TK的SHA256校验值得到TK_SHA2 ；</p>
    <p>[0061 ]步骤 S107、设备端使用 RKS_WCRT_PK 加密 AT、TK2 和 TK_SHA2 得到 AT_TK2_TK_SHA2密文并将AT_TK2_TK_SHA2密文发送至RKS服务器；</p>
    <p>[0062]	步骤S108、设备端接收RKS服务器发送的密钥密文，所述密钥密文由TK加密需要下载的密钥得到；</p>
    <p>[0063]	步骤S109、设备端使用TK解密密钥密文得到密钥明文，将密钥保存至安全模块；</p>
    <p>[0064]	步骤S110、设备端判断密钥下载是否完成，如果下载完成，清除AT、TK及RKS_WCRT_PK0</p>
    <p>[0065]	请参阅图5，是本发明一实施方式中一种密钥管理方法的流程图。该密钥管理方法运行于所述RKS服务器3中，该方法包括:</p>
    <p>[0066]	步骤S201、RKS服务器接收至少一个设备端发送的设备序列号DSN和设备身份鉴别请求；</p>
    <p>[0067]	步骤S202、RKS服务器将工作证书公钥RKS_WCRT_PK发送至设备端；[0068]	步骤S203、RKS服务器接收设备端发送的发散因子密文；</p>
    <p>[0069]	步骤S204、RKS服务器使用工作证书私钥RKS_WCRT_SK解密发散因子密文得到发散因子明文；</p>
    <p>[0070]	步骤S205、RKS服务器以DSN为索引从设备身份鉴别一级密钥数据库读取相应的设备身份鉴别一级密钥DIKl ；</p>
    <p>[0071]	步骤S206、RKS服务器调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和DIKl生成设备身份鉴别二级密钥DIK2 ；</p>
    <p>[0072]	步骤S207、RKS服务器产生24字节第一随机数作为鉴别令牌AT，并产生第二随机数作为第一传输密钥分量TKI ；</p>
    <p>[0073]	步骤S208、RKS服务器使用DIK2加密AT和TKl得到AT_TK1密文；</p>
    <p>[0074]	步骤S209、RKS服务器将AT_TK1密文发送至设备端；</p>
    <p>[0075]	步骤S210、RKS服务器接收设备端发送的AT_TK2_TK_SHA2密文，所述AT_TK2_TK_SHA2密文由RKS_WCRT_PK加密AT、第二传输密钥分量TK2和TK_SHA2得到，所述TK_SHA2是传输密钥TK的SHA256校验值，所述TK由TKl和TK2异或得到；</p>
    <p>[0076]	步骤S211、RKS服务器使用工作证书私钥RKS_WCRT_SK解密AT_TK2_TK_SHA2密文得到AT、TK2和TK_SHA2明文，所述RKS_WCRT_PK和RKS_WCRT_SK是非对称密钥对；</p>
    <p>[0077]	步骤S212、RKS服务器判断收到的AT与发送的AT是否相等，如果相等，将TKl和TK2异或得到TK，计算TK的SHA256校验值得到TK_256 ；</p>
    <p>[0078]	步骤S213、RKS服务器判断TK_256与接收到的TK_SHA2是否相等，如果相等，使用TK加密需要下载的密钥得到密钥密文；</p>
    <p>[0079]	步骤S214、RKS服务器将密钥密文发送至设备端；</p>
    <p>[0080]	步骤S215、RKS服务器清除AT、TK,完成密钥下载流程。</p>
    <p>[0081]	请参阅图6，是本发明一实施方式中一种密钥下载管理方法的流程图。该密钥下载管理方法运行于所述密钥下载管理系统中，该方法包括:</p>
    <p>[0082]	步骤S301、设备端发送设备序列号DSN和设备身份鉴别请求至RKS服务器；</p>
    <p>[0083]	步骤S302、RKS服务器将工作证书公钥RKS_WCRT_PK发送至设备端；</p>
    <p>[0084]	步骤S303、设备端使用根公钥证书RKS_RCRT校验RKS_WCRT_PK的数字签名是否合法，如果合法，执行步骤S304，否则，执行步骤S315 ；</p>
    <p>[0085]	步骤S304、设备端使用RKS_WCRT_PK加密发散因子得到发散因子密文并将发散因子密文发送至RKS服务器；</p>
    <p>[0086]	步骤S305、RKS服务器使用工作证书私钥RKS_WCRT_SK解密发散因子密文得到发散因子明文；</p>
    <p>[0087]	步骤S306、RKS服务器以DSN为索引从设备身份鉴别一级密钥数据库读取相应的设备身份鉴别一级密钥DIKl ；</p>
    <p>[0088]	步骤S307、RKS服务器调用设备身份鉴别二级密钥生成函数根据设备序列号DSN和DIKl生成设备身份鉴别二级密钥DIK2 ；</p>
    <p>[0089]	步骤S308、RKS服务器产生24字节第一随机数作为鉴别令牌AT，并产生第二随机数作为第一传输密钥分量TKI ；</p>
    <p>[0090]	步骤S309、RKS服务器使用DIK2加密AT和TKl得到AT_TK1密文；[0091]	步骤S310、RKS服务器将AT_TK1密文发送至设备端；</p>
    <p>[0092]	步骤S311、设备端使用DIK2解密AT_TK1密文得到AT和TKl明文；</p>
    <p>[0093]	步骤S312、设备端产生第三随机数作为第二传输密钥分量TK2，将TKl和TK2异或得到传输密钥TK，计算TK的SHA256校验值得到TK_SHA2 ；</p>
    <p>[0094]步骤	S313、设备端使用 RKS_WCRT_PK 加密 AT、TK2 和 TK_SHA2 得到 AT_TK2_TK_SHA2密文；</p>
    <p>[0095]	步骤S314、设备端将AT_TK2_TK_SHA2密文发送至RKS服务器；</p>
    <p>[0096]	步骤S315、鉴别RKS服务器失败，结束下载流程；</p>
    <p>[0097]	步骤S316、RKS服务器使用工作证书私钥RKS_WCRT_SK解密AT_TK2_TK_SHA2密文得到AT、TK2和TK_SHA2明文，所述RKS_WCRT_PK和RKS_WCRT_SK是非对称密钥对；</p>
    <p>[0098]	步骤S317、RKS服务器判断收到的AT与发送的AT是否相等，如果相等，执行步骤S318，否则，执行步骤S320 ；</p>
    <p>[0099]	步骤S318、RKS服务器将TKl和TK2异或得到TK，计算TK的SHA256校验值得到TK_256，判断TK_256与接收到的TK_SHA2是否相等，如果相等，执行步骤S319，否则，执行步骤 S320 ；</p>
    <p>[0100]	步骤S319、使用TK加密需要下载的密钥得到密钥密文并将密钥密文发送至设备端;</p>
    <p>[0101]	步骤S320、鉴别设备端失败，结束下载流程；</p>
    <p>[0102]	步骤S321、设备端使用TK解密密钥密文得到密钥明文，将密钥保存至安全模块；</p>
    <p>[0103]	步骤S322、设备端判断密钥下载是否完成，如果下载完成，执行步骤S323，否则，返回步骤S301 ；</p>
    <p>[0104]步骤	S323、设备端清除 AT、TK 及 RKS_WCRT_PK ；</p>
    <p>[0105]	步骤S324、RKS服务器清除AT、TK,完成密钥下载流程。</p>
    <p>[0106]	本发明的密钥下载方法、管理方法、下载管理方法及装置和系统，实现设备端从RKS服务器远程下载主密钥，避免设备端需要集中下载主密钥后才能布放到商户，设备端出厂后，可以直接布放到部署地点，避免需要将设备端集中到某固定机房下载密钥后再布放到部署地点；</p>
    <p>[0107]	利用对称密钥管理技术实现双向合法身份认证，确保RKS服务器和设备端双方身份的合法性，设备端通过校验RKS服务器的工作证书公钥的数字签名来认证RKS服务器的合法性，RKS服务器生成一个鉴别令牌AT，用设备端的二级身份鉴别密钥DK2加密，将密文发送给设备端，设备端用其保存的二级身份鉴别密钥DK2解密，再用工作证书公钥加密后返回给RKS服务器，RKS服务器用其工作证书私钥解密后再对比鉴别令牌AT与生成的鉴别令牌AT是否一样,一样则表不设备端合法,从而实现双向身份认证；</p>
    <p>[0108]	利用随机生成的对称密钥来保护下载的密钥，线路传输的TMK由一个临时传输密钥加密，传输密钥由POS终端和密钥服务器各自生成一个分量，并采用对方的公钥加密后传输给对方，实现临时传输密钥的同步，从而提高TMK传输安全性和效率。</p>
    <p>[0109]	以上所述仅为本发明的实施例，并非因此限制本发明的专利范围，凡是利用本发明说明书及附图内容所作的等效结构或等效流程变换，或直接或间接运用在其他相关的技术领域，均同理包括在本发明的专利保护范围内。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101005357A?cl=zh">CN101005357A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2006年12月28日</td><td class="patent-data-table-td patent-date-value">2007年7月25日</td><td class="patent-data-table-td ">北京飞天诚信科技有限公司</td><td class="patent-data-table-td ">一种更新认证密钥的方法和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101056166A?cl=zh">CN101056166A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年5月28日</td><td class="patent-data-table-td patent-date-value">2007年10月17日</td><td class="patent-data-table-td ">北京飞天诚信科技有限公司</td><td class="patent-data-table-td ">一种提高数据传输安全性的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102413132A?cl=zh">CN102413132A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年11月16日</td><td class="patent-data-table-td patent-date-value">2012年4月11日</td><td class="patent-data-table-td ">北京数码视讯软件技术发展有限公司</td><td class="patent-data-table-td ">基于双向安全认证的数据下载方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102624710A?cl=zh">CN102624710A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年2月27日</td><td class="patent-data-table-td patent-date-value">2012年8月1日</td><td class="patent-data-table-td ">福建联迪商用设备有限公司</td><td class="patent-data-table-td ">一种敏感信息传输方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102647274A?cl=zh">CN102647274A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年4月12日</td><td class="patent-data-table-td patent-date-value">2012年8月22日</td><td class="patent-data-table-td ">福建联迪商用设备有限公司</td><td class="patent-data-table-td ">Pos终端、终端接入前置、主密钥管理系统及其方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20030172278">US20030172278</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2003年1月16日</td><td class="patent-data-table-td patent-date-value">2003年9月11日</td><td class="patent-data-table-td ">Kabushiki Kaisha Toshiba</td><td class="patent-data-table-td ">Data transmission links</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=G07G0001000000">G07G1/00</a></span></td></tr><tr><td class="patent-data-table-td "> 合作分类</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L2209/72">H04L2209/72</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L9/3247">H04L9/3247</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L9/32">H04L9/32</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L2209/24">H04L2209/24</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L9/30">H04L9/30</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L9/3265">H04L9/3265</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L9/0825">H04L9/0825</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L2209/56">H04L2209/56</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L9/0836">H04L9/0836</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L63/0807">H04L63/0807</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=JHr8CAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L63/062">H04L63/062</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2014年4月9日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2014年5月7日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2015年8月5日</td><td class="patent-data-table-td ">C53</td><td class="patent-data-table-td ">Correction of patent for invention or patent application</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2015年8月5日</td><td class="patent-data-table-td ">COR</td><td class="patent-data-table-td ">Change of bibliographic data</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">CORRECT: INVENTOR; FROM: YAO CHENGYONG PENG RONGSHOU MENG LUQIANG TO: YAO CHENGYONG PENG RONGSHOU MENG LUQIANG HONG YIXUAN</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">2016年2月3日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Grant of patent or utility model</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/92364e3817c9d3e87f19/CN103714642A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E5%AF%86%E9%92%A5%E4%B8%8B%E8%BD%BD%E6%96%B9%E6%B3%95_%E7%AE%A1%E7%90%86%E6%96%B9%E6%B3%95_%E4%B8%8B%E8%BD%BD.pdf?id=JHr8CAABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U1ylJehB3g4EY6sJBiR1TB9bwaZpA"},"sample_url":"https://www.google.com/patents/reader?id=JHr8CAABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>