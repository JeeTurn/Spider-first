<!DOCTYPE html><html><head><title>专利 CN103605950A - 一种可信二维码中签名的隐藏方法及系统 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种可信二维码中签名的隐藏方法及系统"><meta name="DC.contributor" content="黄保华" scheme="inventor"><meta name="DC.contributor" content="霍林" scheme="inventor"><meta name="DC.contributor" content="江锋" scheme="inventor"><meta name="DC.contributor" content="广西大学" scheme="assignee"><meta name="DC.date" content="2013-11-25" scheme="dateSubmitted"><meta name="DC.description" content="本发明提供了一种可信二维码中签名的隐藏方法及系统，该隐藏方法包括签名隐藏步骤：信息m经hash得h（m），Ks和Kp是私钥和公钥；用Ks加密h（m）得签名D；编码m和D得m的数据位流Datam和D的数据位流DataD，数据位流由数据码字和纠错码字构成；Datam排布到数据码字和纠错码字区域，DataD排布在签名隐藏区域；签名识别步骤：扫描到终止符时得m0；扫描终止符后的数据得D；用Kp解密D得h（m）；对m0用hash得h（m0），对比h（m）和h（m0）可验证可信性。本发明的有益效果是可信措施不干扰发布的信息，保证了可信二维码的可用性，对设备无特殊要求。"><meta name="DC.date" content="2014-2-26"><meta name="DC.relation" content="CN:102779263:A" scheme="references"><meta name="DC.relation" content="JP:2009093443" scheme="references"><meta name="DC.relation" content="US:20090242650:A1" scheme="references"><meta name="citation_reference" content="孙小兰: &quot;AES加密的二维条码在包装防伪中的应用&quot;, 《印刷质量与标准化》, no. 4, 15 April 2012 (2012-04-15), pages 8 - 11"><meta name="citation_patent_publication_number" content="CN:103605950:A"><meta name="citation_patent_application_number" content="CN:201310599078"><link rel="canonical" href="https://www.google.com/patents/CN103605950A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN103605950A?cl=zh"/><meta name="title" content="专利 CN103605950A - 一种可信二维码中签名的隐藏方法及系统"/><meta name="description" content="本发明提供了一种可信二维码中签名的隐藏方法及系统，该隐藏方法包括签名隐藏步骤：信息m经hash得h（m），Ks和Kp是私钥和公钥；用Ks加密h（m）得签名D；编码m和D得m的数据位流Datam和D的数据位流DataD，数据位流由数据码字和纠错码字构成；Datam排布到数据码字和纠错码字区域，DataD排布在签名隐藏区域；签名识别步骤：扫描到终止符时得m0；扫描终止符后的数据得D；用Kp解密D得h（m）；对m0用hash得h（m0），对比h（m）和h（m0）可验证可信性。本发明的有益效果是可信措施不干扰发布的信息，保证了可信二维码的可用性，对设备无特殊要求。"/><meta property="og:title" content="专利 CN103605950A - 一种可信二维码中签名的隐藏方法及系统"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN103605950A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN103605950A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=UtnzCAABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN103605950A&amp;usg=AFQjCNEHTn_aNhu6zLecpg4D_tOxSFa1Eg" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/163b5383d529e7a09f89/CN103605950A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/163b5383d529e7a09f89/CN103605950A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN103605950A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN103605950A?cl=en&amp;hl=zh-CN"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN103605950A?cl=zh" style="display:none"><span itemprop="description">本发明提供了一种可信二维码中签名的隐藏方法及系统，该隐藏方法包括签名隐藏步骤：信息m经hash得h（m），Ks和Kp是私钥和公钥；用Ks加密h（m）得签名D；编码m和D得m的数据位流Datam和D的数据位流DataD，数据位流由数据码字和纠...</span><span itemprop="url">https://www.google.com/patents/CN103605950A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN103605950A - 一种可信二维码中签名的隐藏方法及系统</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN103605950A - 一种可信二维码中签名的隐藏方法及系统" title="专利 CN103605950A - 一种可信二维码中签名的隐藏方法及系统"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN103605950 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201310599078</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2014年2月26日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2013年11月25日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2013年11月25日</td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201310599078.5, </span><span class="patent-bibdata-value">CN 103605950 A, </span><span class="patent-bibdata-value">CN 103605950A, </span><span class="patent-bibdata-value">CN 201310599078, </span><span class="patent-bibdata-value">CN-A-103605950, </span><span class="patent-bibdata-value">CN103605950 A, </span><span class="patent-bibdata-value">CN103605950A, </span><span class="patent-bibdata-value">CN201310599078, </span><span class="patent-bibdata-value">CN201310599078.5</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%BB%84%E4%BF%9D%E5%8D%8E%22">黄保华</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%9C%8D%E6%9E%97%22">霍林</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%B1%9F%E9%94%8B%22">江锋</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E5%B9%BF%E8%A5%BF%E5%A4%A7%E5%AD%A6%22">广西大学</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103605950A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103605950A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103605950A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (3),</span> <span class="patent-bibdata-value"><a href="#npl-citations">非专利引用</a> (1),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (2),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (1)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=UtnzCAABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201310599078&amp;usg=AFQjCNFAzTi8Pe4-rEvLH1m6taYbKf2Gog"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=UtnzCAABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D103605950A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNGBa_WkjSkb02ebJQ3zVNSZIVabWw"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT133718017" lang="ZH" load-source="patent-office">一种可信二维码中签名的隐藏方法及系统</invention-title>
      </span><br><span class="patent-number">CN 103605950 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA130765568" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明提供了一种可信二维码中签名的隐藏方法及系统，该隐藏方法包括签名隐藏步骤：信息m经hash得h（m），Ks和Kp是私钥和公钥；用Ks加密h（m）得签名D；编码m和D得m的数据位流Datam和D的数据位流DataD，数据位流由数据码字和纠错码字构成；Datam排布到数据码字和纠错码字区域，DataD排布在签名隐藏区域；签名识别步骤：扫描到终止符时得m0；扫描终止符后的数据得D；用Kp解密D得h（m）；对m0用hash得h（m0），对比h（m）和h（m0）可验证可信性。本发明的有益效果是可信措施不干扰发布的信息，保证了可信二维码的可用性，对设备无特殊要求。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(10)</span></span></div><div class="patent-text"><div mxw-id="PCLM59383015" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.一种可信二维码中签名的隐藏方法，其特征在于，包括如下步骤:  签名的隐藏步骤:h (m)是用户发布的信息m经过hash函数生成的消息摘要，Ks和Kp是公钥算法生成的有效私钥与公钥；用自己的私钥Ks加密消息摘要h (m)，得到签名D ;按照二维码编码规则，编码用户发布的信息m和签名D，分别得到信息m的数据位流Data111和签名D的数据位流Data11,数据位流包含数据码字和纠错码字；按照二维码编码规则，分别选择数据位流Datam和Data11的二维码码字排布版本，分别记为Vm和Vd ;选择一个大版本V的二维码，该二维码的编码容量大于或等于Vm和Vd之和，版本V作为隐藏签名的二维码的编码版本；按照二维码编码规则，依次将信息m的数据位流Datam排布到数据码字和纠错码字区域，将签名D的数据位流Data11排布在签名隐藏区域，得到隐藏签名的二维码；  签名的识别步骤:用户扫描具有签名的二维码，按照二维码解码规则，当第一次检测到编码终止符时，则停止解码，得到信息mO ;系统对终止符后的数据进行检测，若有数据，则继续解码，得到签名D，否则，解码结束；用发布者Kp解密D得到消息摘要h Cm);通过对扫描得到的信息mO采用相同的hash函数,得到消息摘要h (mO),对比h Cm)和h (mO)验证签名D的合法性。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.根据权利要求1所述的隐藏方法，其特征在于:用户发布的信息需要经过如下步骤处理:  首先，分析输入数据，确定其内容并且选择合适的模式对序列进行编码；  然后，按照分析的结果对输入数据进行编码，得到数据位流；  然后，对得到的数据位流进行纠错编码；  最后，在二维码矩阵中构造信息的最终码字序列。`</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.根据权利要求1所述的隐藏方法，其特征在于:按照二维码解码标准进行解码时，首先，通过获取二维码的版本与纠错等级，确定其编码容量；然后，根据字节流中的信息长度，读取所发布的信息，直到信息的编码结束符；最后，检测后续字节流，按照相同的解码规则，读取编码在编码结束符后的填充区中的内容，这样就完成了用户发布的信息和隐藏于该二维码中的签名信息的识别。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.根据权利要求1所述的隐藏方法，其特征在于，在纠错级别为E，在二维码版本集合Sv中，用户编码信息m所需要的最小版本为Vm ;编码签名D时，需要的最小版本为VD，隐藏签名的二维码版本为V; (V，E)表示未承载信息的初始二维码，(m，Vm，E)表示编码信息m生成的二维码，隐藏有签名的二维码为(mD，V，E) ;二维码编码规则中编码结束标识位EndMark ；签名D的隐藏过程如下:  步骤1:按照二维码编码规则，将信息m依次拆分为不同的模式段……，mn;  步骤2:按照对应的模式编码规则，对各模式段编码，得到码字序列m i，，m2，，……，mn，；  步骤3:将步骤2中得到的码字序列合并为数据码字m’，长度为Iengthm.;依据纠错等级E，对m’进行纠错编码，得到纠错码字em，长度为Iengthe ;此时待排布到二维码中的数据位流 Datam=m，+em+EndMark,长度为 Iengthm,+lengthe+lengthEndMark ;  步骤4:按照二维码编码规则，在版本集合Sv范围内，从版本I开始在二维码上对步骤3中得到的Datam进行排布，当Datam第一次被完整排满，记下此时的版本数，此版本数记为Vm ；  步骤5:重复步骤f 4，对签名D编码，得到签名D待排布到二维码图中的数据Datan=DJ +eD+ EndMark,长 lengthD,+Iengthe, + lengthEndMark,版本为 Vd ；步骤6:按照二维码编码规则，选择版本V的二维码(V，E)作为隐藏签名的二维码，此二维码编码容量为CC，编码完信息m剩余的填充区冗余容量为RC ;其中:    CC ^ (lengthy +lengthe+lengthEndMark) + (lengthy +lengthy +lengthEndMark)；    RC ^ (lengthD，+lengthe，+lengthEndMark)；   步骤7:按照二维码编码规则，在(V，E)上对信息m的编码数据Datam进行排布；在EndMark+Ι位开始继续对签名D的编码数据Data11进行排布，直到全部排布为止，得到隐藏签名的二维码(mD，V，E)。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.根据权利要求4所述的隐藏方法，其特征在于，用户扫描隐藏有签名的二维码(mD，V，E)，根据二维码的解码标准，验证过程如下:  步骤1:按照二维码解码规则，扫描得到二维码版本V和纠错等级E，对二维码中的数据进行解码，直到EndMark出现，解码暂停，得到信息m ；  步骤2:判断EndMark标志后面是否还有数据:若没有，则解码结束；否则从EndMark+1位开始，对后续数据继续解码，得到签名D。</div>
    </div>
    </div> <div class="claim"> <div num="6" class="claim">
      <div class="claim-text">6.一种可信二维码中签名的隐藏系统，其特征在于，包括:  签名的隐藏单元:h (m)是用户发布的信息m经过hash函数生成的消息摘要，Ks和Kp是公钥算法生成的有效私钥与公钥；用自己的私钥Ks加密消息摘要h (m)，得到签名D ;按照二维码编码规则，编码用户发布的信息m和签名D，分别得到信息m的数据位流Data111和签名D的数据位流Data11,数据位流包含数据码字和纠错码字；按照二维码编码规则，分别选择数据位流Datam和Data11的二维码码字排布版本，分别记为Vm和Vd ;选择一个大版本V的二维码，该二维码的编码容量大于或等于Vm和Vd之和，版本V作为隐藏签名的二维码的编码版本；按照二维码编码规则，依次将信息m的数据位流Datam排布到数据码字和纠错码字区域，将签名D的数据位流Data11排布在签名隐藏区域，得到隐藏签名的二维码；签名的识别单元:用户扫描具有签名的二维码，按照二维码解码规则，当第一次检测到编码终止符时，则停止解码，得到信息mO;系统对终止符后的数据进行检测，若有数据，则继续解码，得到签名D，否则，解码结束；用发布者Kp解密D得到消息摘要h(m);通过对扫描得到的信息mO采用相同的hash函数,得到消息摘要h (mO),对比h (m)和h (mO)可验证签名D的合法性。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.根据权利要求6所述的隐藏系统，其特征在于，用户发布的信息需要经过如下模块处理:  分析模块，用于分析输入数据，确定其内容并且选择合适的模式对序列进行编码；  编码模块，用于按照分析的结果对输入数据进行编码，得到数据位流；  纠错模块，用于对得到的数据位流进行纠错编码；  构造模块，用于在二维码矩阵中构造信息的最终码字序列。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.根据权利要求6所述的隐藏系统，其特征在于，按照二维码解码标准进行解码时，首先，通过获取二维码的版本与纠错等级，确定其编码容量；然后，根据字节流中的信息长度，读取所发布的信息，直到信息的编码结束符；最后，检测后续字节流，按照相同的解码规则，读取编码在编码结束符后的填充区中的内容，这样就完成了用户发布的信息和隐藏于该二维码中的签名信息的识别。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.根据权利要求6所述的隐藏系统，其特征在于，在纠错级别为E，在二维码版本集合Sv中，用户编码信息m所需要的最小版本为Vm ;编码签名D时，需要的最小版本为VD，隐藏签名的二维码版本为V ； (V，E)表示未承载信息的初始二维码，(m, Vffl, E)表示编码信息m生成的二维码，隐藏有签名的二维码为(mD，V，E) ;二维码编码规则中编码结束标识位EndMark ;签名D的隐藏过程执行如下模块:  拆分模块，用于按照二维码编码规则，将信息m依次拆分为不同的模式段Hi1, m2,……，叫；模式段编码模块，用于按照对应的模式编码规则，对各模式段编码，得到码字序列mm 2’，......, m n’ ；  综合处理模块，用于将模式段编码模块中得到的码字序列合并为数据码字m’，长度为lengthm，;依据纠错等级EJf m’进行纠错编码,得到纠错码字em,长度为Iengthe ;此时待排布到二维码中的数据位流 Datam=m’ +em+EndMark,长度为 Iengthm,+lengthe+lengthEndMarii ；排布模块，用于按照二维码编码规则，在版本集合Sv范围内，从版本I开始在二维码上对步骤3中得到的Datam进行排布，当Datam第一次被完整排满，记下此时的版本数，此版本数记为Vni ;   编码模块，用于对签名D编码，得到签名D待排布到二维码图中的数据DataD=D’ +eD+EndMark,长 lengthD’ +lengthe’ + lengthEndMark,版本为 VD ；  选择模块，用于按照二维码编码规则，选择版本V的二维码(V，E)作为隐藏签名的二维码，此二维码编码容量为CC，编码完信息m剩余的填充区冗余容量为RC ;其中:     CC ^ (lengthy +lengthe+lengthEndMark) + (lengthy +lengthy +lengthEndMark)；    RC ^ (lengthD，+lengthe，+lengthEndMark)；  获取模块，用于按照二维码编码规则，在(V，E)上对信息m的编码数据Datam进行排布；在EndMark+Ι位开始继续对签名D的编码数据Data11进行排布，直到全部排布为止，得到隐藏签名的二维码(mD，V，E)。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.根据权利要求9所述的隐藏系统，其特征在于，用户扫描隐藏有签名的二维码(mD，V，E)，根据二维码的解码标准，验证过程执行如下模块:  解码模块，用于按照二维码解码规则，扫描得到二维码版本V和纠错等级E，对二维码中的数据进行解码，直到EndMark出现，解码暂停，得到信息m ；  判断模块，用于判断EndMark标志后面是否还有数据:若没有，则解码结束；否则从EndMark+Ι位开始，对后续数据继续解码，得到签名D。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES66891397" lang="ZH" load-source="patent-office" class="description">
    <p>一种可信二维码中签名的隐藏方法及系统</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及二维码技术领域，尤其涉及一种可信二维码中签名的隐藏方法及系统。</p>
    <p>背景技术</p>
    <p>[0002]	伴随着带有摄像功能的手机使用日益普及，二维码技术得到了越来越广泛的应用。同时，二维码的可信问题也暴露出来，其中主要有三种:其一是二维码版权，攻击者以用户的名义发布二维码；其二是二维码信息可信，扫描者不能确定二维码的信息是否可信；其三是二维码信息完整，用户无法确定扫描二维码所得到的信息是否完整或未被修改。而对于二维码来说，可信技术是二维码的安全可靠保障措施，其主要作用是防止二维码失去可信性。</p>
    <p>[0003]	现有的可信二维码技术有数字水印，公钥密码体制，信息隐藏。</p>
    <p>[0004]	采用数字水印的技术，提出了一种将二维码作为水印嵌入到新的信息二维码中的方案，其思路是先将标识信息生成二维码，作为水印图像，然后通过小波变换，分离出载体二维码图片的中频系数，再通过DCT扩频，将水印信息嵌入到载体二维码图片中。用户通过扫描设备提取载体二维码图片上的水印信息，将水印信息通过特定算法还原成载有标识信息的水印二维码图片，然后提取并验证该水印二维码中的标识信息，依此来实现二维码可信的目的。</p>
    <p>[0005]	利用公钥密码体制技术，提出了一种基于PKI的可信二维码方案，该方案将输入的信息通过发布者的私钥加密，然后将密文生成二维码；译码、解码的时候用户通过扫描其他用户发布的二维码，获取密文信息，然后从CA中心查询发布者的公钥，对密文信息解密，实现了对信息发布者的认证。二维码加密/解密方法包括获得二维码原始信息，将二维码原始信息与实时时钟信息用EK加密密钥进行ECC加密运算，得到一个随时间跳变的加密数据；将得到的加密数据生成二维码图形；解码时，读取二维码，得到随时间跳变的加密数据；对得到的加密数据，使用DK解密密钥进行ECC解密运算，得到解密信息；根据二维码原始数据进行算法加密，生成随时间跳变的二维码，是的用户每次得到的二维码查询都是不同的，减少了验证步骤，保证二维码的安全性和不重复性。</p>
    <p>[0006]	使用信息隐藏的方法，提出了一种具有隐藏码的二维码，该方案是将若干供识别的单元色块按照一定的规律无间隙地排列，将隐藏码设置于所述单元信息块中，单元信息块与隐藏码具有不同的色度，通过切换摄像机具有的高低解析度以及设定的门限值，将隐藏码识别出来。</p>
    <p>[0007]目前的技术存在如下缺陷:</p>
    <p>  1、数字水印可信二维码方案对解码设备的要求高，限制了方案的应用范围；</p>
    <p>  数字水印生成与提取时运算量大，在将数字水印嵌入到二维码图片以及从二维码中提取水印信息的过程中，系统对计算资源的需求大；同时，由于水印信息是嵌在图片DCT域的中低频系数中，所以如果用拍照扫描的方式，则无法实现水印提取，这大大限制了数字水印方案的应用范围。</p>
    <p>[0008]	2、公钥密码体制方案和信息隐藏方案的可信措施都在编码和解码过程中，一定程度上影响用户发布的信息，一旦脱离了专有的扫描设备，则二维码就失去了其可用性。</p>
    <p>[0009]	与数字水印可信二维码方案不同，公钥密码体制方案和信息隐藏的可信措施在二维码的生成过程中，与用户发布的信息发生作用或产生干扰，如公钥密码体制，通过用户的私钥加密，而当扫描时无法获取发布者的公钥，则二维码中的信息不具有可读性；信息隐藏的可信措施则是在二维码图片上通过加入新的色块，这使得一旦扫描设备不可用，则用户的二维码随即失去可用性。</p>
    <p>发明内容</p>
    <p>[0010]	为了解决现有技术中的问题，本发明提供了一种可信二维码中签名的隐藏方法。</p>
    <p>[0011]	本发明提供了一种可信二维码中签名的隐藏方法，包括如下步骤:</p>
    <p>  签名的隐藏步骤:h (m)是用户发布的信息m经过hash函数生成的消息摘要，Ks和Kp是公钥算法生成的有效私钥与公钥；用自己的私钥Ks加密消息摘要h (m)，得到签名D ;按照二维码编码规则，编码用户发布的信息m和签名D，分别得到信息m的数据位流Data111和签名D的数据位流Data11,数据位流包含数据码字和纠错码字；按照二维码编码规则，分别选择数据位流Datam和Data11的二维码码字排布版本，分别记为Vm和Vd ;选择一个大版本V的二维码，该二维码的编码容量大于或等于Vm和Vd之和，版本V作为隐藏签名的二维码的编码版本；按照二维码编码规则，依次将信息m的数据位流Datam排布到数据码字和纠错码字区域，将签名D的数据位流Data11排布在签名隐藏区域，得到隐藏签名的二维码；</p>
    <p>  签名的识别步骤:用户扫描具有签名的二维码，按照二维码解码规则，当第一次检测到编码终止符时，则停止解码，得到信息mO ;系统对终止符后的数据进行检测，若有数据，则继续解码，得到签名D，否则，解码结束；用发布者Kp解密D得到消息摘要h Cm);通过对扫描得到的信息mO采用相同的hash函数,得到消息摘要h (mO),对比h Cm)和h (mO)验证签名D的合法性。</p>
    <p>[0012]	作为本发明的进一步改进，用户发布的信息需要经过如下步骤处理:</p>
    <p>  首先，分析输入数据，确定其内容并且选择合适的模式对序列进行编码；</p>
    <p>  然后，按照分析的结果对输入数据进行编码，得到数据位流；</p>
    <p>  然后，对得到的数据位流进行纠错编码；</p>
    <p>  最后，在二维码矩阵中构造信息的最终码字序列。</p>
    <p>[0013]	作为本发明的进一步改进，按照二维码解码标准进行解码时，首先，通过获取二维码的版本与纠错等级，确定其编码容量；然后，根据字节流中的信息长度，读取所发布的信息，直到信息的编码结束符；最后，检测后续字节流，按照相同的解码规则，读取编码在编码结束符后的填充区中的内容，这样就完成了用户发布的信息和隐藏于该二维码中的签名信息的识别。</p>
    <p>[0014]	作为本发明的进一步改进，在纠错级别为E，在二维码版本集合Sv中，用户编码信息m所需要的最小版本为Vm ;编码签名D时，需要的最小版本为VD，隐藏签名的二维码版本为V ; (V, E)表不未承载信息的初始二维码，(m, Vm, E)表不编码信息m生成的二维码，隐藏有签名的二维码为(mD，V，E);二维码编码规则中编码结束标识位EndMark ;签名D的隐藏过程如下:</p>
    <p>步骤1:按照二维码编码规则，将信息m依次拆分为不同的模式段……，mn;步骤2:按照对应的模式编码规则，对各模式段编码，得到码字序列m i，，m2，，……，mn，；步骤3:将步骤2中得到的码字序列合并为数据码字m’，长度为Iengthm.;依据纠错等级E，对m’进行纠错编码，得到纠错码字em，长度为Iengthe ;此时待排布到二维码中的数据位流 Datam=m’ +em+EndMark,长度为 Iengthm,+lengthe+lengthEndMark ;</p>
    <p>  步骤4:按照二维码编码规则，在版本集合Sv范围内，从版本I开始在二维码上对步骤3中得到的Datam进行排布，当Datam第一次被完整排满，记下此时的版本数，此版本数记为Vm ；步骤5:重复步骤f 4，对签名D编码，得到签名D待排布到二维码图中的数据DataD=D, +eD+ EndMark,长 lengthD,+Iengthe, + lengthEndMark,版本为 Vd ;</p>
    <p>  步骤6:按照二维码编码规则，选择版本V的二维码(V，E)作为隐藏签名的二维码，此二维码编码容量为CC，编码完信息m剩余的填充区冗余容量为RC ;其中:</p>
    <p>    CC ^ (lengthy +lengthe+lengthEndMark) + (lengthy +lengthy +lengthEndMark)；</p>
    <p>    RC ^ (lengthD，+lengthe，+lengthEndMark)；</p>
    <p>  步骤7:按照二维码编码规则，在(V，E)上对信息m的编码数据Datam进行排布；在EndMark+Ι位开始继续对签名D的编码数据Data11进行排布，直到全部排布为止，得到隐藏签名的二维码(mD，V，E)。</p>
    <p>[0015]	作为本发明的进一步改进，用户扫描隐藏有签名的二维码(mD，V，E)，根据二维码的解码标准，验证过程如下:   步骤1:按照二维码解码规则，扫描得到二维码版本V和纠错等级E，对二维码中的数据进行解码，直到EndMark出现，解码暂停，得到信息m ；</p>
    <p>  步骤2:判断EndMark标志后面是否还有数据:若没有，则解码结束；否则从EndMark+1位开始，对后续数据继续解码，得到签名D。</p>
    <p>[0016]	本发明还提供了一种可信二维码中签名的隐藏系统，包括:</p>
    <p>  签名的隐藏单元:h (m)是用户发布的信息m经过hash函数生成的消息摘要，Ks和Kp是公钥算法生成的有效私钥与公钥；用自己的私钥Ks加密消息摘要h (m)，得到签名D ;按照二维码编码规则，编码用户发布的信息m和签名D，分别得到信息m的数据位流Data111和签名D的数据位流Data11,数据位流包含数据码字和纠错码字；按照二维码编码规则，分别选择数据位流Datam和Data11的二维码码字排布版本，分别记为Vm和Vd ;选择一个大版本V的二维码，该二维码的编码容量大于或等于Vm和Vd之和，版本V作为隐藏签名的二维码的编码版本；按照二维码编码规则，依次将信息m的数据位流Datam排布到数据码字和纠错码字区域，将签名D的数据位流Data11排布在签名隐藏区域，得到隐藏签名的二维码；</p>
    <p>  签名的识别单元:用户扫描具有签名的二维码，按照二维码解码规则，当第一次检测到编码终止符时，则停止解码，得到信息m0 ;系统对终止符后的数据进行检测，若有数据，则继续解码，得到签名D，否则，解码结束；用发布者Kp解密D得到消息摘要h Cm);通过对扫描得到的信息mO采用相同的hash函数,得到消息摘要h (mO),对比h (m)和h (mO)可验证签名D的合法性。</p>
    <p>[0017]	作为本发明的进一步改进，用户发布的信息需要经过如下模块处理:</p>
    <p>  分析模块，用于分析输入数据，确定其内容并且选择合适的模式对序列进行编码；编码模块，用于按照分析的结果对输入数据进行编码，得到数据位流；</p>
    <p>  纠错模块，用于对得到的数据位流进行纠错编码；</p>
    <p>  构造模块，用于在二维码矩阵中构造信息的最终码字序列。</p>
    <p>[0018]	作为本发明的进一步改进，按照二维码解码标准进行解码时，首先，通过获取二维码的版本与纠错等级，确定其编码容量；然后，根据字节流中的信息长度，读取所发布的信息，直到信息的编码结束符；最后，检测后续字节流，按照相同的解码规则，读取编码在编码结束符后的填充区中的内容，这样就完成了用户发布的信息和隐藏于该二维码中的签名信息的识别。</p>
    <p>[0019]	作为本发明的进一步改进，在纠错级别为E，在二维码版本集合Sv中，用户编码信息m所需要的最小版本为Vm ;编码签名D时，需要的最小版本为VD，隐藏签名的二维码版本为V ; (V, E)表不未承载信息的初始二维码，(m, Vm, E)表不编码信息m生成的二维码，隐藏有签名的二维码为(mD，V，E);二维码编码规则中编码结束标识位EndMark ;签名D的隐藏过程执行如下模块:</p>
    <p>  拆分模块，用于按照二维码编码规则，将信息m依次拆分为不同的模式段Hi1, m2,……，叫；模式段编码模块，用于按照对应的模式编码规则，对各模式段编码，得到码字序列mm 2’，......, m n’ ；</p>
    <p>  综合处理模块，用于将模式段编码模块中得到的码字序列合并为数据码字m’，长度为lengthm，;依据纠错等级EJf m’进行纠错编码,得到纠错码字em,长度为Iengthe ;此时待排布到二维码中的数据位流 Datam=m’ +em+EndMark,长度为 Iengthm,+lengthe+lengthEndMarii ；排布模块，用于按照二维码编码规则，在版本集合Sv范围内，从版本I开始在二维码上对步骤3中得到的Datam进`行排布，当Datam第一次被完整排满，记下此时的版本数，此版本数记为Vni ;</p>
    <p>  编码模块，用于对签名D编码，得到签名D待排布到二维码图中的数据DataD=D’ +eD+EndMark,长 lengthD’ +lengthe’ + lengthEndMark,版本为 VD ；</p>
    <p>  选择模块，用于按照二维码编码规则，选择版本V的二维码(V，E)作为隐藏签名的二维码，此二维码编码容量为CC，编码完信息m剩余的填充区冗余容量为RC ;其中:</p>
    <p>    CC ^ (lengthy +lengthe+lengthEndMark) + (lengthy +lengthy +lengthEndMark)；</p>
    <p>    RC ^ (IengthD，+lengthe，+lengthEndMark)；</p>
    <p>  获取模块，用于按照二维码编码规则，在(V，E)上对信息m的编码数据Datam进行排布；在EndMark+Ι位开始继续对签名D的编码数据Data11进行排布，直到全部排布为止，得到隐藏签名的二维码(mD，V，E)。</p>
    <p>[0020]	作为本发明的进一步改进，用户扫描隐藏有签名的二维码(mD，V，E)，根据二维码的解码标准，验证过程执行如下模块:</p>
    <p>  解码模块，用于按照二维码解码规则，扫描得到二维码版本V和纠错等级E，对二维码中的数据进行解码，直到EndMark出现，解码暂停，得到信息m ；</p>
    <p>  判断模块，用于判断EndMark标志后面是否还有数据:若没有，则解码结束；否则从EndMark+Ι位开始，对后续数据继续解码，得到签名D。</p>
    <p>[0021]	本发明的有益效果是:本发明的二维码中签名的隐藏及识别方法、系统完全依据二维码编码规则，在编码过程中，可信措施不会干扰用户发布的信息，保证了用户二维码的可用性；对设备无特殊要求，通用的具有摄像、拍照功能的设备即可应用。</p>
    <p>附图说明</p>
    <p>[0022]	图1是本发明选用较大版本后二维码上的数据码字、纠错码字以及签名隐藏的排布示例图。</p>
    <p>具体实施方式</p>
    <p>[0023]	本发明公开了一种可信二维码中签名的隐藏方法，二维码是可以用来发布网址、微博账号、名片等等信息的有效载体。</p>
    <p>[0024]	在可信二维码中签名的隐藏方法中包括:</p>
    <p>  签名的隐藏步骤:h (m)是用户发布的信息m经过hash函数生成的消息摘要，Ks和Kp是公钥算法生成的有效私钥与公钥；用自己的私钥Ks加密消息摘要h (m)，得到签名D ;按照二维码编码规则，编码用户发布的信息m和签名D，分别得到信息m的数据位流Data111和签名D的数据位流Data11,数据位流包含数据码字和纠错码字；按照二维码编码规则，分别选择数据位流Datam和Data11的二维码码字排布版本，分别记为Vm和Vd ;选择一个大版本V的二维码，该二维码的编码容量大于或等于Vm和Vd之和，版本V作为隐藏签名的二维码的编码版本；按照二维码编码规则，依次将信息m的数据位流Datam排布到数据码字和纠错码字区域，将签名D的数据位流Data11排布在签名隐藏区域，得到隐藏签名的二维码；</p>
    <p>  签名的识别步骤:用户扫描具有签名的二维码，按照二维码解码规则，当第一次检测到编码终止符时，则停止解码，得到信息mO ;系统对终止符后的数据进行检测，若有数据，则继续解码，得到签名D，否则，解码结束；用发布者Kp解密D得到消息摘要h Cm);通过对扫描得到的信息mO采用相同的hash函数,得到消息摘要h (mO),对比h Cm)和h (mO)验证签名D的合法性。</p>
    <p>[0025]	基于数字签名的二维码可信性:</p>
    <p>  h (m)是用户发布的信息m经过安全的hash函数生成的消息摘要。Ks和Kp是公钥算法生成的有效私钥与公钥。用户在发布信息的时候，用自己的私钥Ks加密消息摘要h(m)，得到签名D。用户扫描具有签名的二维码，通过查询发布者Kp，验证签名的合法性，并得到消息摘要h (m)0通过对扫描得到的信息mO采用相同的hash函数，得到消息摘要h (mO),对比h (m)和h (mO)，从而确定信息m的完整性。将数字签名应用到二维码中，通过验证签名，达到了二维码中信息的不可否认、内容完整以及可信的目的。</p>
    <p>[0026]	编码容量与填充区冗余容量:</p>
    <p>  在二维码编码的过程中，对用户发布的信息需要经过数据分析、数据编码、纠错编码三步数据处理，本节以QR码编码规则来做说明。</p>
    <p>[0027]	首先，分析输入数据，确定其内容并且选择合适的模式对序列进行编码。从数字模式、字母数字模式、8位字节模式到汉字模式，每种模式的字符所需的位数依次增加。表I列出了 QR码中各模式的位流长度计算公式，表2为表I的变量说明，根据表I中的模式位流计算公式，可以计算出不同的模式段的位流长度。</p>
    <p>[0028]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103605950A/CN103605950AD00101.png"> <img id="idf0001" file="CN103605950AD00101.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103605950A/CN103605950AD00101.png" class="patent-full-image" alt="Figure CN103605950AD00101"> </a> </div>
    <p>表1 QR码模式位流长度计算公式表</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103605950A/CN103605950AD00102.png"> <img id="idf0002" file="CN103605950AD00102.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103605950A/CN103605950AD00102.png" class="patent-full-image" alt="Figure CN103605950AD00102"> </a> </div>
    <p>表2 QR码模式位流长度计算公式变量说明然后，按照分析的结果对输入数据进行编码。二维码在编码的过程中，会将输入的信息转化为模式+字符计数指示符+数据的形式。以混合模式为例，假设输入为“广西大学:http://210.36.16.35”，则数据编码过程如下:</p>
    <p>   输入数据:广西大学:http://210.36.16.35</p>
    <p>  按照二维码编码规则，将用户输入的数据划分成不同的编码模式段:</p>
    <p>   汉字模式:广西大学8字节模式::http:字母数字模式://210.36.16.35   按照二维码编码规则，将(I)中的模式段转换为二进制:</p>
    <p>    广西大学:00111011 00010011 11010101 10001011 00100101 00000001 0000:http::00111010 01101000 01110100 01110100 01110000 00111010//210.36.16.35:11110111 01000001 01101100 00010101 00001000 1101111011000110 01001110 00000100 01100</p>
    <p>  将各模式段字符计数指示符转化为二进制:</p>
    <p>   汉字模式:4-&gt;00000100 8字节模式:6-&gt;00000110 字母数字模式:14_&gt;000001001为各模式段加入相应的模式指示符以及字符计数指示符(汉字模式加上中国汉字指示符，对应GB2312的子集指示符为0001)的二进制数据:</p>
    <p>    汉字模式段:11010001 00000100 00111011 00010011 11010101 10001011 0010010100000001 000</p>
    <p>   8 字节模式段:0100 00000110 00111010 01101000 01110100 01110100 0111000000111010</p>
    <p>   字母数字模式:0010 000001001 11110111 01000001 01101100 00010101 0000100011011110 11000110 01001110 00000100 01100</p>
    <p>  将(4)中得到的各模式段按照用户输入数据的顺序进行组合，即得到待排列到二维码中的数据码字序列，根据表1中的公式计算输入数据编码后的位流长为:</p>
    <p>    length= (4+4+8+13*4)+ (4+8+8*6) + (4+9+11* (14 div 2)+6* (14 mod 2))=218</p>
    <p>(位)</p>
    <p>  最后，对得到的数据位流进行纠错编码。纠错能力从低到高分为L、M、Q以及H四个等级，纠错等级确定二维码中纠错码字数，纠错码字的位流长度表示为length#[0029]	用户发布的信息进行以上三步数据处理后，需要在二维码矩阵中构造信息的最终码字序列。其步骤是:根据版本和纠错等级将数据序列分为η块；依次将得到的每一块的数据码字和纠错码字装配成最终的序列，数据块I的码字1，数据块2的码字1，……，数据块η的码字I，数据块I的码字2，数据块2的码字2，……，数据块η的码字2，……，依次排布，直到数据块η的最后码字；随后，纠错块I的码字1，纠错块2的码字1，纠错块η的码字1，……，纠错块I的码字2，纠错块2的码字2，纠错块η的码字2，……，依次排布，直到纠错块η的最后的码字。表3为版本5-Η的二维码码字排布表。</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103605950A/CN103605950AD00111.png"> <img id="idf0003" file="CN103605950AD00111.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103605950A/CN103605950AD00111.png" class="patent-full-image" alt="Figure CN103605950AD00111"> </a> </div>
    <p>[0030]	表3版本5-H的码字排布 由上文可知表3 二维码码字序列为:D1, D12，D23，D35，D2，D13，D24，D36，......Dll,</p>
    <p>D22, D33, D45, D34, D46, El，E23，E45, E67, E2, E24, E46, E68,......，E22，E44, E66, E88。然</p>
    <p>后按照二维码编码规则，将码字序列依次排布到二维码矩阵中。图1为版本2-M的二维码上数据码字与纠错码字的排布示例。</p>
    <p>[0031]	便于后文说明，根据二维码编码标准做如下定义:</p>
    <p>  定义I编码容量二维码除去版本、格式、定位以及矫正等固有信息后，用来承载用户发布的信息的空间，这个空间可以表示为Ce。</p>
    <p>[0032]	数据码字与纠错码字在二维码中的排布结束后，可能会有剩余位。假设在纠错等级为E时，编码信息m需要的最小版本是V0，此时的编码容量为CC0，则当在相同的纠错等级E下，选择一个大于VO的版本VI，其编码容量为CCl，则信息m的编码数据在二维码上排布后得到的填充区剩余位大于或等于CCl- CCO0如图1为选用较大版本后二维码上的数据码字和纠错码字排布示例图，深度灰色区域为剩余位，即本文所说的填充区。便于说明填充区的位数，根据二维码编码标准做如下定义:</p>
    <p> 定义2填充区冗余容量输入信息的数据码字和纠错码字序列在二维码中排布结束后，将剩下的填充区位数称为填充区冗余容量，字母表示为RC。</p>
    <p>[0033]	此时，填充区冗余容量的大小为RCtl，且RCtl 3 CC1- CCqo假设在纠错等级E时编码某一签名需要的最小编码容量是CCD，则当CCD〈 RCtl时，按照二维码编码规则，在编码完信息m后加上编码结束符，在信息m的结束符后的填充区内对签名继续编码。</p>
    <p>[0034]	填充块中的签名隐藏与验证:</p>
    <p>  按照二维码解码标准进行解码时，首先，通过获取二维码的版本与纠错等级，确定其编码容量；然后，根据字节流中的信息长度，读取所发布的信息，直到信息的编码结束符；最后，检测后续字节流，按照相同的解码规则，读取编码在编码结束符后的填充区中的内容。这样就完成了用户发布的信息和隐藏于该二维码中的签名信息的识别。</p>
    <p>[0035]	纠错级别为E，在二维码版本集合Sv中，用户编码信息m所需要的最小版本为Vm ；编码签名D时，需要的最小版本为VD，隐藏签名的二维码版本为V ； (V，E)表示未承载信息的初始二维码，(m, Vffl, E)表示编码信息m生成的二维码，隐藏有签名的二维码为(mD，V，E);二维码编码规则中编码结束标识位EndMark。签名D的隐藏过程如下:</p>
    <p>  步骤1:按照二维码编码规则，将信息m依次拆分为不同的模式段……，mn。</p>
    <p>[0036]	步骤2:按照对应的模式编码规则，对各模式段编码，得到码字序列m m</p>
    <p>2，，......, Π1 η，ο</p>
    <p>[0037]	步骤3:将步骤2中得到的码字序列合并为数据码字m’，长度为Iengthm.;依据纠错等级E，对m’进行纠错编码，得到纠错码字em，长度为Iengthe ;此时待排布到二维码中的数据位流 Datam=m’ +em+EndMark,长度为 Iengthm,+lengthe+lengthEndMark。</p>
    <p>[0038]	步骤4:按照二维码编码规则，在版本集合Sv范围内，从版本I开始在二维码上对步骤3中得到的Datam进行排布，当Datam第一次被完整排满，记下此时的版本数，此版本数记为Vm。</p>
    <p>[0039]	步骤5:重复步骤f 4，对签名D编码，得到签名D待排布到二维码图中的数据DataD=D，+eD+ EndMark,长 lengthD,+Iengthe, + lengthEndMark,版本为 VD。</p>
    <p>[0040]	步骤6:按照二维码编码规则，选择版本V的二维码(V，E)作为隐藏签名的二维码，此二维码编码容量为Ce，编码完信息m剩余的填充区冗余容量为Re。其中</p>
    <p>    CC ^ (lengthy +lengthe+lengthEndMark) + (lengthy +lengthy +lengthEndMark)；</p>
    <p>    RC ^ (lengthD，+ lengthe，+lengthEndMark)。</p>
    <p>[0041]	步骤7:按照二维码编码规则，在(V，E)上对信息m的编码数据行排布；在EndMark+Ι位开始继续对签名D的编码数据Data11进行排布，直到全部排布为止，得到隐藏签名的二维码(mD，V，E)。</p>
    <p>[0042]	用户扫描隐藏有签名的二维码(mD，V，E)，根据二维码的解码标准，验证过程如下。</p>
    <p>[0043]	步骤1:按照二维码解码规则，扫描得到二维码版本V和纠错等级E，对二维码中的数据进行解码，直到EndMark出现，解码暂停，得到信息m。</p>
    <p>[0044]	步骤2:判断EndMark标志后面是否还有数据:若没有，则解码结束；否则从EndMark+Ι位开始，对后续数据继续解码，得到签名D。</p>
    <p>[0045]	本发明还公开了一种可信二维码中签名的隐藏系统，包括:</p>
    <p>  签名的隐藏单元:h (m)是用户发布的信息m经过hash函数生成的消息摘要，Ks和Kp是公钥算法生成的有效私钥与公钥；用自己的私钥Ks加密消息摘要h (m)，得到签名D ;按照二维码编码规则，编码用户发布的信息m和签名D，分别得到信息m的数据位流Data111和签名D的数据位流Data11,数据位流包含数据码字和纠错码字；按照二维码编码规则，分别选择数据位流Datam和Data11的二维码码字排布版本，分别记为Vm和Vd ;选择一个大版本V的二维码，该二维码的编码容量大于或等于Vm和Vd之和，版本V作为隐藏签名的二维码的编码版本；按照二维码编码规则，依次将信息m的数据位流Datam排布到数据码字和纠错码字区域，将签名D的数据位流Data11排布在签名隐藏区域，得到隐藏签名的二维码；</p>
    <p>  签名的识别单元:用户扫描具有签名的二维码，按照二维码解码规则，当第一次检测到编码终止符时，则停止解码，得到信息mO ;系统对终止符后的数据进行检测，若有数据，则继续解码，得到签名D，否则，解码结束；用发布者Kp解密D得到消息摘要h Cm);通过对扫描得到的信息mO采用相同的hash函数,得到消息摘要h (mO),对比h (m)和h (mO)可验证签名D的合法性。</p>
    <p>[0046]	用户发布的信息需要经过如下模块处理:分析模块，用于分析输入数据，确定其内容并且选择合适的模式对序列进行编码；</p>
    <p>  编码模块，用于按照分析的结果对输入数据进行编码，得到数据位流；</p>
    <p>  纠错模块，用于对得到的数据位流进行纠错编码；</p>
    <p>  构造模块，用于在二维码矩阵中构造信息的最终码字序列。</p>
    <p>[0047]	按照二维码解码标准进行解码时，首先，通过获取二维码的版本与纠错等级，确定其编码容量；然后，根据字节流中的信息长度，读取所发布的信息，直到信息的编码结束符；最后，检测后续字节流，按照相同的解码规则，读取编码在编码结束符后的填充区中的内容，这样就完成了用户发布的信息和隐藏于该二维码中的签名信息的识别。</p>
    <p>[0048]	在纠错级别为E，在二维码版本集合Sv中，用户编码信息m所需要的最小版本为Vm ;编码签名D时，需要的最小版本为VD，隐藏签名的二维码版本为V ； (V，E)表示未承载信息的初始二维码，(m, Vffl, E)表示编码信息m生成的二维码，隐藏有签名的二维码为(mD，V,E) ;二维码编码规则中编码结束标识位EndMark ;签名D的隐藏过程执行如下模块:</p>
    <p>  拆分模块，用于按照二维码编码规则，将信息m依次拆分为不同的模式段Hi1, m2,……，叫；模式段编码模块，用于按照对应的模式编码规则，对各模式段编码，得到码字序列mm 2’，......, m n’ ；</p>
    <p>  综合处理模块，用于将模式段编码模块中得到的码字序列合并为数据码字m’，长度为lengthm，;依据纠错等级EJf m’进行纠错编码,得到纠错码字em,长度为Iengthe ;此时待排布到二维码中的数据位流 Datam=m’ +em+EndMark,长度为 Iengthm,+lengthe+lengthEndMarii ；排布模块，用于按照二维 码编码规则，在版本集合Sv范围内，从版本I开始在二维码上对步骤3中得到的Datam进行排布，当Datam第一次被完整排满，记下此时的版本数，此版本数记为Vni ;</p>
    <p>  编码模块，用于对签名D编码，得到签名D待排布到二维码图中的数据DataD=D’ +eD+EndMark,长 lengthD’ +lengthe’ + lengthEndMark,版本为 VD ；</p>
    <p>  选择模块，用于按照二维码编码规则，选择版本V的二维码(V，E)作为隐藏签名的二维码，此二维码编码容量为CC，编码完信息m剩余的填充区冗余容量为RC ;其中:</p>
    <p>    CC ^ (lengthy +lengthe+lengthEndMark) + (lengthy +lengthy +lengthEndMark)；</p>
    <p>    RC ^ (lengthD，+lengthe，+lengthEndMark)；</p>
    <p>  获取模块，用于按照二维码编码规则，在(V，E)上对信息m的编码数据Datam进行排布；在EndMark+Ι位开始继续对签名D的编码数据Data11进行排布，直到全部排布为止，得到隐藏签名的二维码(mD，V，E)。</p>
    <p>[0049]	用户扫描隐藏有签名的二维码(mD，V，E)，根据二维码的解码标准，验证过程执行如下模块:</p>
    <p>  解码模块，用于按照二维码解码规则，扫描得到二维码版本V和纠错等级E，对二维码中的数据进行解码，直到EndMark出现，解码暂停，得到信息m ；</p>
    <p>  判断模块，用于判断EndMark标志后面是否还有数据:若没有，则解码结束；否则从EndMark+Ι位开始，对后续数据继续解码，得到签名D。</p>
    <p>[0050]	本发明的二维码中签名的隐藏及识别方法、系统选择一个比编码用户发布的信息的最小版本更大版本的二维码作为载体，该大版本二维码可以排布用户信息的码字序列、对应签名的码字序列以及编码结束标识符。因为通用的二维码扫描工具识别到编码结束标识符时，解码结束，从而实现了将签名隐藏在二维码中。</p>
    <p>[0051]	在用户扫描二维码时，当识别到编码结束标识符后，会进行判断，若无后续数据，则解码结束，否则继续解码，从而得到发布者的签名，然后依据签名确定二维码的可信性。</p>
    <p>[0052]	使二维码可信措施与用户发布的信息相互独立存在，确保即使可信措施失效，二维码也是可用的。</p>
    <p>[0053]	完全依照二维码的编码规则，所以对用户的设备无要求，只要具有摄像、拍照功能的设备均可应用。</p>
    <p>[0054]	本发明的二维码中签名的隐藏及识别方法、系统完全依据二维码编码规则，在编码过程中，可信措施不会干扰用户发布的信息，保证了用户二维码的可用性；对设备无特殊要求，通用的具有摄像、拍照功能的设备即可应用。</p>
    <p>[0055]	以上内容是结合具体的优选实施方式对本发明所作的进一步详细说明，不能认定本发明的具体实施只局限于这些说明。对于本发明所属技术领域的普通技术人员来说，在不脱离本发明构思的前提下，还可以做出若干简单推演或替换，都应当视为属于本发明的保护范围。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102779263A?cl=zh">CN102779263A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年6月19日</td><td class="patent-data-table-td patent-date-value">2012年11月14日</td><td class="patent-data-table-td ">袁开国</td><td class="patent-data-table-td ">基于pki和数字签名的可信二维码方案</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="https://www.google.com/url?id=UtnzCAABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DJP%26NR%3D2009093443A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNGzWtf-HJk17np-1guXY2NW9dl-fA">JP2009093443A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td "> </td><td class="patent-data-table-td citation-no-title">没有名称</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20090242650">US20090242650</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2009年3月16日</td><td class="patent-data-table-td patent-date-value">2009年10月1日</td><td class="patent-data-table-td ">Denso Wave Incorporated</td><td class="patent-data-table-td ">Two-dimensional code having rectangular region provided with specific patterns for specification of cell postions and distinction from background</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="npl-citations"></a><div class="patent-section-header"><span class="patent-section-title">非专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th colspan="3"class="patent-data-table-th">参考文献</th></tr></thead><tr><td class="patent-data-table-td ">1</td><td class="patent-data-table-td "><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td ">孙小兰: "<a href='http://scholar.google.com/scholar?q="AES%E5%8A%A0%E5%AF%86%E7%9A%84%E4%BA%8C%E7%BB%B4%E6%9D%A1%E7%A0%81%E5%9C%A8%E5%8C%85%E8%A3%85%E9%98%B2%E4%BC%AA%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8"'>AES加密的二维条码在包装防伪中的应用</a>", 《印刷质量与标准化》, no. 4, 15 April 2012 (2012-04-15), pages 8 - 11</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=UtnzCAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=G06K0019060000">G06K19/06</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=UtnzCAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=G06K0007100000">G06K7/10</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2014年2月26日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/163b5383d529e7a09f89/CN103605950A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E5%8F%AF%E4%BF%A1%E4%BA%8C%E7%BB%B4%E7%A0%81%E4%B8%AD%E7%AD%BE%E5%90%8D%E7%9A%84%E9%9A%90%E8%97%8F.pdf?id=UtnzCAABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U2K5cLyHrWUe-R8oAOypvrM0-j25A"},"sample_url":"https://www.google.com/patents/reader?id=UtnzCAABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>