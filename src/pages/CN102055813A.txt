<!DOCTYPE html><html><head><title>专利 CN102055813A - 一种网络应用的访问控制方法及其装置 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_50a6672b5f82ffbd39b7a9e87fd4594c/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_50a6672b5f82ffbd39b7a9e87fd4594c__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种网络应用的访问控制方法及其装置"><meta name="DC.contributor" content="陈小杰" scheme="inventor"><meta name="DC.contributor" content="杭州华三通信技术有限公司" scheme="assignee"><meta name="DC.date" content="2010-11-22" scheme="dateSubmitted"><meta name="DC.description" content="本发明公开了一种网络应用的访问控制方法及其装置，该方法包括：网络设备在网络应用访问的控制交互阶段，根据监听到的DNS查询报文，获得客户端请求访问的网络应用的DNS域名；或者，在网络应用访问的数据交互阶段，根据监听到的客户端与应用服务器之间交互的报文获得所述应用服务器的IP地址，并通过反向查询DNS服务器获得所述应用服务器的IP地址对应的DNS域名；所述网络设备根据所述DNS域名，从预先设置的DNS域名与访问控制策略的对应关系中查询对应的访问控制策略；所述网络设备根据查询到的访问控制策略确定访问控制规则，并根据所述访问控制规则对所述客户端发往所述网络应用的报文进行相应控制。采用本发明，可提高网络应用识别的准确率。"><meta name="DC.date" content="2011-5-11"><meta name="DC.relation" content="CN:101448264:A" scheme="references"><meta name="DC.relation" content="CN:101453424:A" scheme="references"><meta name="DC.relation" content="CN:1852263:A" scheme="references"><meta name="DC.relation" content="CN:1953455:A" scheme="references"><meta name="DC.relation" content="US:7623518" scheme="references"><meta name="citation_patent_publication_number" content="CN:102055813:A"><meta name="citation_patent_application_number" content="CN:201010551813"><link rel="canonical" href="https://www.google.com/patents/CN102055813A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN102055813A?cl=zh"/><meta name="title" content="专利 CN102055813A - 一种网络应用的访问控制方法及其装置"/><meta name="description" content="本发明公开了一种网络应用的访问控制方法及其装置，该方法包括：网络设备在网络应用访问的控制交互阶段，根据监听到的DNS查询报文，获得客户端请求访问的网络应用的DNS域名；或者，在网络应用访问的数据交互阶段，根据监听到的客户端与应用服务器之间交互的报文获得所述应用服务器的IP地址，并通过反向查询DNS服务器获得所述应用服务器的IP地址对应的DNS域名；所述网络设备根据所述DNS域名，从预先设置的DNS域名与访问控制策略的对应关系中查询对应的访问控制策略；所述网络设备根据查询到的访问控制策略确定访问控制规则，并根据所述访问控制规则对所述客户端发往所述网络应用的报文进行相应控制。采用本发明，可提高网络应用识别的准确率。"/><meta property="og:title" content="专利 CN102055813A - 一种网络应用的访问控制方法及其装置"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN102055813A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN102055813A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=LfCTBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN102055813A&amp;usg=AFQjCNFf_VANu4gsYRBrXVi4J_lTa2ZtRQ" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/fd1592ded970b1e4e577/CN102055813A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/fd1592ded970b1e4e577/CN102055813A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN102055813A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN102055813A?cl=en&amp;hl=zh-CN"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN102055813A?cl=zh" style="display:none"><span itemprop="description">本发明公开了一种网络应用的访问控制方法及其装置，该方法包括：网络设备在网络应用访问的控制交互阶段，根据监听到的DNS查询报文，获得客户端请求访问的网络应用的DNS域名；或者，在网络应用访问的数据交互阶段，根据...</span><span itemprop="url">https://www.google.com/patents/CN102055813A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN102055813A - 一种网络应用的访问控制方法及其装置</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN102055813A - 一种网络应用的访问控制方法及其装置" title="专利 CN102055813A - 一种网络应用的访问控制方法及其装置"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN102055813 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201010551813</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2011年5月11日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2010年11月22日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2010年11月22日</td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201010551813.1, </span><span class="patent-bibdata-value">CN 102055813 A, </span><span class="patent-bibdata-value">CN 102055813A, </span><span class="patent-bibdata-value">CN 201010551813, </span><span class="patent-bibdata-value">CN-A-102055813, </span><span class="patent-bibdata-value">CN102055813 A, </span><span class="patent-bibdata-value">CN102055813A, </span><span class="patent-bibdata-value">CN201010551813, </span><span class="patent-bibdata-value">CN201010551813.1</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%99%88%E5%B0%8F%E6%9D%B0%22">陈小杰</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E6%9D%AD%E5%B7%9E%E5%8D%8E%E4%B8%89%E9%80%9A%E4%BF%A1%E6%8A%80%E6%9C%AF%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">杭州华三通信技术有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102055813A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102055813A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102055813A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (5),</span> <span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (10),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (2),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=LfCTBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201010551813&amp;usg=AFQjCNEGP3CvodOA0-jp_TK3MOYRcjU1rw"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=LfCTBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D102055813A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNFCbaz_2Nvp9WlRceHvYhxmFoowzA"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT103119430" lang="ZH" load-source="patent-office">一种网络应用的访问控制方法及其装置</invention-title>
      </span><br><span class="patent-number">CN 102055813 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA85037321" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明公开了一种网络应用的访问控制方法及其装置，该方法包括：网络设备在网络应用访问的控制交互阶段，根据监听到的DNS查询报文，获得客户端请求访问的网络应用的DNS域名；或者，在网络应用访问的数据交互阶段，根据监听到的客户端与应用服务器之间交互的报文获得所述应用服务器的IP地址，并通过反向查询DNS服务器获得所述应用服务器的IP地址对应的DNS域名；所述网络设备根据所述DNS域名，从预先设置的DNS域名与访问控制策略的对应关系中查询对应的访问控制策略；所述网络设备根据查询到的访问控制策略确定访问控制规则，并根据所述访问控制规则对所述客户端发往所述网络应用的报文进行相应控制。采用本发明，可提高网络应用识别的准确率。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(10)</span></span></div><div class="patent-text"><div mxw-id="PCLM36013199" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.	一种网络应用的访问控制方法，其特征在于，包括：网络设备在网络应用访问的控制交互阶段，根据监听到的客户端发往域名系统DNS服 务器的DNS查询报文，获得客户端请求访问的网络应用的DNS域名；或者，在网络应用访问 的数据交互阶段，根据监听到的客户端与应用服务器之间交互的报文获得所述应用服务器 的IP地址，并通过反向查询DNS服务器获得所述应用服务器的IP地址对应的DNS域名；所述网络设备根据所述DNS域名，从预先设置的DNS域名与访问控制策略的对应关系 中查询对应的访问控制策略；所述网络设备根据查询到的访问控制策略确定访问控制规则，并根据所述访问控制规 则对所述客户端发往所述网络应用的报文进行相应控制。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.如权利要求1所述的方法，其特征在于，在所述网络设备在网络应用访问的控制交 互阶段，根据监听到的客户端发往DNS服务器的DNS查询报文，获得客户端请求访问的网络 应用的DNS域名的情况下，所述网络设备根据查询到的访问控制策略确定访问控制规则， 具体为：所述网络设备通过监听DNS服务器针对所述DNS查询报文返回的查询结果，获得所述 网络应用的DNS域名所对应的IP地址；所述网络设备根据查询到的访问控制策略建立访问控制规则，所述访问控制规则用于 对所述客户端发往所述网络应用的DNS域名所对应的IP地址的报文进行控制。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.如权利要求1所述的方法，其特征在于，所述网络设备在网络应用访问的数据交互 阶段，根据监听到的客户端与应用服务器之间交互的报文获得所述应用服务器的IP地址， 并通过反向查询DNS服务器获得所述应用服务器的IP地址对应的DNS域名，具体为：在网络应用访问的数据交互阶段，所述网络设备通过监听客户端发送的报文获得目的 IP地址，并根据该目的IP地址从DNS服务器查询对应的DNS域名，并将查询到的DNS域名 作为所述客户端所请求访问的网络应用的DNS域名；所述网络设备根据查询到的访问控制策略确定访问控制规则，具体为： 所述网络设备根据查询到的访问控制策略建立访问控制规则，所述访问控制规则用于 对所述客户端发往所述应用服务器的IP地址的报文进行控制。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.如权利要求1至3任一项所述的方法，其特征在于，所述网络设备上已经存在有未验 证的访问控制规则；所述网络设备在网络应用访问的数据交互阶段，根据监听到的客户端与应用服务器之 间交互的报文获得所述应用服务器的IP地址，并通过反向查询DNS服务器获得所述应用服 务器的IP地址对应的DNS域名，具体为：所述网络设备将监听到的客户端发送的报文中的源IP地址和目的IP地址，与所述未 验证的访问控制规则中的相应IP地址进行匹配；如果匹配，则通过反向查询DNS服务器，获 得该目的IP地址对应的DNS域名；所述网络设备根据查询到的访问控制策略确定访问控制规则，具体为： 若所述网络设备查询到的访问控制策略，与匹配到的访问控制规则所对应的访问控制 策略不同，则根据查询到的访问控制策略建立访问控制规则，并将其标识为验证通过，删除 匹配到的访问控制规则；所建立的访问控制规则用于对所述客户端发往所述目的IP地址 的报文进行控制。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.如权利要求1至3任一项所述的方法，其特征在于，所述访问控制策略，包括：固定 配额限制，降低速率或拦截报文。</div>
    </div>
    </div> <div class="claim"> <div num="6" class="claim">
      <div class="claim-text">6.	一种网络设备，其特征在于，包括：存储模块，用于存储网络应用的DNS域名与对应的访问控制策略；监听模块，用于在网络应用访问的控制交互阶段监听客户端发往DNS服务器的DNS查 询报文，或者在网络应用访问的数据交互阶段监听客户端与应用服务器之间交互的报文；获取模块，用于根据所述监听模块监听到的DNS查询报文获得客户端请求访问的网络 应用的DNS域名；或者，根据所述监听模块监听到的客户端与应用服务器之间交互的报文 获得所述应用服务器的IP地址，并通过反向查询DNS服务器获得所述应用服务器的IP地 址对应的DNS域名；查询模块，用于根据所述DNS域名，从所述存储模块存储的DNS域名与访问控制策略的 对应关系中查询对应的访问控制策略；规则确定模块，用于根据查询到的访问控制策略确定访问控制规则；控制模块，用于根据所述规则确定模块确定的访问控制规则，对所述客户端发往所述 网络应用的报文进行相应控制。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.如权利要求6所述的网络设备，其特征在于，所述规则确定模块具体用于，根据所述 监听模块监听到的DNS域名查询结果，获得所述网络应用的DNS域名所对应的IP地址，并 根据所述查询模块查询到的访问控制策略建立访问控制规则，所述访问控制规则用于对所 述客户端发往所述网络应用的DNS域名所对应的IP地址的报文进行控制。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.如权利要求6所述的网络设备，其特征在于，所述获取模块具体用于，在网络应用访 问的数据交互阶段，根据所述监听模块监听到的客户端发送的报文获得目的IP地址，并根 据该目的IP地址从DNS服务器查询对应的DNS域名，并将查询到的DNS域名作为所述客户 端所请求访问的网络应用的DNS域名；所述规则确定模块具体用于，根据查询到的访问控制策略建立访问控制规则，所述访 问控制规则用于对所述客户端发往所述应用服务器的IP地址的报文进行控制。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.如权利要求6至8任一项所述的网络设备，其特征在于，所述网络设备上已经存在有 未验证的访问控制规则；所述获取模块具体用于，将监听到的客户端发送的报文中的源IP地址和目的IP地址， 与所述未验证的访问控制规则中的相应IP地址进行匹配；如果匹配，则通过反向查询DNS 服务器，获得该目的IP地址对应的DNS域名；所述规则确定模块具体用于，若所述网络设备查询到的访问控制策略，与匹配到的访 问控制规则所对应的访问控制策略不同，则根据查询到的访问控制策略建立访问控制规 则，并将其标识为验证通过，删除匹配到的访问控制规则；所建立的访问控制规则用于对所 述客户端发往所述目的IP地址的报文进行控制。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.如权利要求6至8任一项所述的网络设备，其特征在于，所述存储模块存储的访问 控制策略，包括：固定配额限制，降低速率或拦截报文。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES41790621" lang="ZH" load-source="patent-office" class="description">
    <p>一种网络应用的访问控制方法及其装置技术领域</p>
    <p>[0001]	本发明涉及通信领域，尤其涉及一种网络应用的访问控制方法及其装置。 背景技术</p>
    <p>[0002]	网络应用在近年内经历着快速发展与变化的过程，其应用程序由简单到复杂，由 低级到高级，为用户提供了丰富多彩的内容和便捷的服务。为了对访问网络应用的行为进 行管理，以及出于企业安全等方面的考虑，当前企业通常会有对企业员工使用网络应用程 序的行为进行管理和控制的需求。</p>
    <p>[0003]	从流量管理和监控的角度来说，早期的网络应用程序都是使用固定的端口号， 容易被检测到且便于管理。而近期涌现的网络应用程序则模仿HTTP协议（HyperText Transfer Protocol，超文本传输协议）等来逃避识别和检测，一些传统的网络应用程序检 测方法因此失去了作用。</p>
    <p>[0004]	通常，网络应用程序具有如下特点：在使用之初，需要先和服务器建立连接，根据 客户端操作进行一定的控制协商，后续再进行数据交换，即这些应用程序的交互模型可以 认为是先进行控制交互，再进行数据交互。以FTP(File Transfer Protocol，文件传输协 议）下载文件的应用为例，它和服务器建立连接通道后，会先进行“获取文件”控制协商，协 商成功后才会根据协商的结果继续进行文件内容的数据交换。</p>
    <p>[0005]	根据控制协商的特征能较准确识别出大量的网络应用程序。目前一般常采用报文 特征码进行应用程序识别。</p>
    <p>[0006]	报文特征码识别，是一种类似数据报深层扫描（DPI)的技术，即利用高层协议的 特征来识别应用程序。它分析某一应用程序的大量报文后，归纳出所有报文中都含有的或 者出现频率最高的特征字符串即关键字，比如某个报文在某个特定位置携带特定的内容， 或者某个报文的内容符合某种协议的格式等等。在实际使用中，报文特征码识别会对报文 进行查找、匹配，如果其满足了某个应用程序的特征码，那么它就认为这个报文属于该应用 程序。</p>
    <p>[0007]	仍然以“FTP下载文件”应用为例，FTP客户端在下载文件前，会向服务器发送 “RETR”的命令，因此可以得出“FTP下载文件”应用的特征码为：TCP报文内容的起始内容 为“RETR”（字符串“RETR”后面再紧跟一个空格）。这样，如果有报文满足该特征，即可认 为其是在进行FTP下载文件。</p>
    <p>[0008]	由于在数据交互阶段，即使是相同的网络应用所携带的内容也各种各样，难以找 到一般性的规律或特征，而控制交互阶段所交互的内容则相对固定，因此，特征码识别通常 是根据某一网络应用的控制交互报文，经过大量分析，从中提取出一些特征码，并认为当一 定数量的报文匹配中了特征码时，就是在进行与该特征码对应的网络应用。使用特征码识 别能够识别多数的网络应用，因此在目前使用较为广泛。</p>
    <p>[0009]	发明人在实现本发明的过程中，发现现有利用特征码对网络应用进行识别以及根 据识别结果进行网络应用访问控制的技术至少存在如下缺陷：[0010]	(1)使用特征码不可避免地存在误检测的问题，即不同的网络应用程序很可能匹 配到相同的特征码而被识别为相同的网络应用程序，由此导致根据识别结果所采取的访问 控制措施不合理。</p>
    <p>[0011]	(2)对于完成控制交互后的数据交互报文，难以通过特征码进行识别，由此导致 无法根据识别结果进行访问控制。比如，由于某些原因（如前期未打开特征码检测功能等 等），错过网络应用前期控制交互报文后，通过后续数据报文交互无法识别网络应用以及进 行访问控制。发明内容</p>
    <p>[0012]	本发明的目的在于提供一种网络应用的访问控制方法及其装置，用以提高网络应 用识别率和访问控制的合理性，为此，本发明采用以下技术方案：</p>
    <p>[0013]	一种网络应用的访问控制方法，包括：</p>
    <p>[0014]	网络设备在网络应用访问的控制交互阶段，根据监听到的客户端发往域名系统 DNS服务器的DNS查询报文，获得客户端请求访问的网络应用的DNS域名；或者，在网络应 用访问的数据交互阶段，根据监听到的客户端与应用服务器之间交互的报文获得所述应用 服务器的IP地址，并通过反向查询DNS服务器获得所述应用服务器的IP地址对应的DNS 域名；</p>
    <p>[0015]	所述网络设备根据所述DNS域名，从预先设置的DNS域名与访问控制策略的对应 关系中查询对应的访问控制策略；</p>
    <p>[0016]	所述网络设备根据查询到的访问控制策略确定访问控制规则，并根据所述访问控 制规则对所述客户端发往所述网络应用的报文进行相应控制。</p>
    <p>[0017]	上述方法中，在所述网络设备在网络应用访问的控制交互阶段，根据监听到的客 户端发往DNS服务器的DNS查询报文，获得客户端请求访问的网络应用的DNS域名的情况 下，所述网络设备根据查询到的访问控制策略确定访问控制规则，具体为：</p>
    <p>[0018]	所述网络设备通过监听DNS服务器针对所述DNS查询报文返回的查询结果，获得 所述网络应用的DNS域名所对应的IP地址；</p>
    <p>[0019]	所述网络设备根据查询到的访问控制策略建立访问控制规则，所述访问控制规则 用于对所述客户端发往所述网络应用的DNS域名所对应的IP地址的报文进行控制。</p>
    <p>[0020]	上述方法中，所述网络设备在网络应用访问的数据交互阶段，根据监听到的客户 端与应用服务器之间交互的报文获得所述应用服务器的IP地址，并通过反向查询DNS服务 器获得所述应用服务器的IP地址对应的DNS域名，具体为：</p>
    <p>[0021]	在网络应用访问的数据交互阶段，所述网络设备通过监听客户端发送的报文获得 目的IP地址，并根据该目的IP地址从DNS服务器查询对应的DNS域名，并将查询到的DNS 域名作为所述客户端所请求访问的网络应用的DNS域名；</p>
    <p>[0022]	所述网络设备根据查询到的访问控制策略确定访问控制规则，具体为：</p>
    <p>[0023]	所述网络设备根据查询到的访问控制策略建立访问控制规则，所述访问控制规则 用于对所述客户端发往所述应用服务器的IP地址的报文进行控制。</p>
    <p>[0024]	上述方法中，所述网络设备上已经存在有未验证的访问控制规则；</p>
    <p>[0025]	所述网络设备在网络应用访问的数据交互阶段，根据监听到的客户端与应用服务器之间交互的报文获得所述应用服务器的IP地址，并通过反向查询DNS服务器获得所述应 用服务器的IP地址对应的DNS域名，具体为：</p>
    <p>[0026]	所述网络设备将监听到的客户端发送的报文中的源IP地址和目的IP地址，与所 述未验证的访问控制规则中的相应IP地址进行匹配；如果匹配，则通过反向查询DNS服务 器，获得该目的IP地址对应的DNS域名；</p>
    <p>[0027]	所述网络设备根据查询到的访问控制策略确定访问控制规则，具体为：</p>
    <p>[0028]	若所述网络设备查询到的访问控制策略，与匹配到的访问控制规则所对应的访问 控制策略不同，则根据查询到的访问控制策略建立访问控制规则，并将其标识为验证通过， 删除匹配到的访问控制规则；所建立的访问控制规则用于对所述客户端发往所述目的IP 地址的报文进行控制。</p>
    <p>[0029]	上述方法中，所述访问控制策略，包括：固定配额限制，降低速率或拦截报文。</p>
    <p>[0030]	一种网络设备，包括：</p>
    <p>[0031]	存储模块，用于存储网络应用的DNS域名与对应的访问控制策略；</p>
    <p>[0032]	监听模块，用于在网络应用访问的控制交互阶段监听客户端发往DNS服务器的 DNS查询报文，或者在网络应用访问的数据交互阶段监听客户端与应用服务器之间交互的 报文；</p>
    <p>[0033]	获取模块，用于根据所述监听模块监听到的DNS查询报文获得客户端请求访问的 网络应用的DNS域名；或者，根据所述监听模块监听到的客户端与应用服务器之间交互的 报文获得所述应用服务器的IP地址，并通过反向查询DNS服务器获得所述应用服务器的IP 地址对应的DNS域名；</p>
    <p>[0034]	查询模块，用于根据所述DNS域名，从所述存储模块存储的DNS域名与访问控制策 略的对应关系中查询对应的访问控制策略；</p>
    <p>[0035]	规则确定模块，用于根据查询到的访问控制策略确定访问控制规则；</p>
    <p>[0036]	控制模块，用于根据所述规则确定模块确定的访问控制规则，对所述客户端发往 所述网络应用的报文进行相应控制。</p>
    <p>[0037]	上述网络设备中，所述规则确定模块具体用于，根据所述监听模块监听到的DNS 域名查询结果，获得所述网络应用的DNS域名所对应的IP地址，并根据所述查询模块查询 到的访问控制策略建立访问控制规则，所述访问控制规则用于对所述客户端发往所述网络 应用的DNS域名所对应的IP地址的报文进行控制。</p>
    <p>[0038]	上述网络设备中，所述获取模块具体用于，在网络应用访问的数据交互阶段，根据 所述监听模块监听到的客户端发送的报文获得目的IP地址，并根据该目的IP地址从DNS 服务器查询对应的DNS域名，并将查询到的DNS域名作为所述客户端所请求访问的网络应 用的DNS域名；</p>
    <p>[0039]	所述规则确定模块具体用于，根据查询到的访问控制策略建立访问控制规则，所 述访问控制规则用于对所述客户端发往所述应用服务器的IP地址的报文进行控制。</p>
    <p>[0040]	上述网络设备中，所述网络设备上已经存在有未验证的访问控制规则；</p>
    <p>[0041]	所述获取模块具体用于，将监听到的客户端发送的报文中的源IP地址和目的IP 地址，与所述未验证的访问控制规则中的相应IP地址进行匹配；如果匹配，则通过反向查 询DNS服务器，获得该目的IP地址对应的DNS域名；[0042]	所述规则确定模块具体用于，若所述网络设备查询到的访问控制策略，与匹配到 的访问控制规则所对应的访问控制策略不同，则根据查询到的访问控制策略建立访问控制 规则，并将其标识为验证通过，删除匹配到的访问控制规则；所建立的访问控制规则用于对 所述客户端发往所述目的IP地址的报文进行控制。</p>
    <p>[0043]	上述网络设备中，所述存储模块存储的访问控制策略，包括：固定配额限制，降低 速率或拦截报文。</p>
    <p>[0044]	本发明的上述实施例中，网络设备通过监听客户端与DNS服务器之间交互的报 文，获得客户端访问的网络应用的DNS域名，从而可根据获得到的DNS域名依据预设的相应 访问控制策略进行访问控制。与现有技术采用特征码识别网络应用相比，一方面，由于网络 应用的DNS域名通常可以较为准确的标识网络应用，因此根据网络应用的DNS域名来识别 网络应用可以提高网络应用识别的准确率，进而提高访问控制策略使用的合理性；另一方 面，针对于现有技术中完成控制交互后的数据交互报文，难以通过特征码进行识别的问题， 本发明实施例可以在数据交互阶段，通过监听客户端与应用服务器之间交互的报文并通过 反向查询DNS服务器，获得客户端访问的网络应用的DNS域名，从而实现网络应用的识别以 及进行相应的访问控制。附图说明</p>
    <p>[0045]	图1为本发明实施例的系统架构示意图；</p>
    <p>[0046]	图2为本发明实施例中的网络应用识别与访问控制的流程示意图之一；</p>
    <p>[0047]	图3为本发明实施例中的网络应用识别与访问控制的流程示意图之二 ；</p>
    <p>[0048]	图4为本发明实施例中的网络应用识别与访问控制的流程示意图之三；</p>
    <p>[0049]	图5为本发明实施例提供的网络设备的结构示意图。具体实施方式</p>
    <p>[0050]	针对现有技术存在的上述问题，本发明实施例提供了一种利用DNS(Domain Name System，域名系统)服务器进行网络应用的识别以及根据识别结果对客户端访问该网络应 用的行为进行控制的方法及其装置。</p>
    <p>[0051]	众所周知，当前hternet上的通信是通过IP地址来完成的，由于IP地址是全数 字的，人们一般难以记忆，所以又提出了 DNS协议，将“易于记忆的域名地址”转换成IP地址。</p>
    <p>[0052]	比如，ftp. kernel, org域名通过DNS服务器解析后，得到对应的IP地址之一为 204. 152. 191. 37。IP地址为192. 200. 200. 135的客户端会先发起DNS请求进行域名解析， 将待访问的域名“ftp. kernel, org”转换成IP地址204. 152. 191. 37，然后再向该IP地址发 起 TCP (Transmission Control Protocol，传输控制协议）连接。</p>
    <p>[0053]	在全球范围内，目前DNS统一使用UDP^ser Datagram Protocol，用户数据包协 议）的53端口，而且DNS存在一个公共的全球性组织，用户可以开放、自由地查找到DNS域 名与IP地址的对应关系。</p>
    <p>[0054]	一般来说，网站或网络应用所对外提供的域名，都是“service, domain"的形式 (其中service表示服务类型，domain为域名部分），比如之前提到的ftp. kernel, org，通过分析该域名的service部分（即ftp)，可以知道其使用的网络应用的类型，比如ftp对应 FTP文件下载，再结合domain部分（即kernel, org)，就可以区分出是何种网络应用（即对 kernel, org的FTP访问)。类似的，service为video时表示是视频服务，service为map 时表示是地图服务。可见，通过完全的DNS域名可以区分出不同的网络应用。</p>
    <p>[0055]	这样，现有技术中使用特征码识别网络应用程序所存在的一些问题，可藉由本发 明实施例进行解决：</p>
    <p>[0056]	(1)针对使用特征码进行网络应用识别时，识别准确率低的问题，本发明实施例 中，在控制交互阶段，通过监听客户端与DNS服务器之间交互的报文获得客户端所请求访 问的域名，并根据预先设置的域名与网络应用的对应关系，确定出与该域名对应的网络应 用，该网络应用即为网络设备所识别出来的客户端请求的网络应用。仍以上述FTP访问 ftp. kernel, org为例，网络设备在控制交互阶段检测到DNS的请求、应答报文后，可得知客 户端的IP地址为192. 200. 200. 135，所请求访问的域名为ftp. kernel, org，该域名对应的 IP 地址为 204. 152. 191. 37，这样后续从 192. 200. 200. 135 往 204. 152. 191. 37 发起的 TCP 通信，就可以认为是kernel, org的FTP访问，然后再根据管理员的预先配置，采取相应访问 控制策略对客户端的该FTP访问行为进行控制。</p>
    <p>[0057]	由于通常网络应用的服务器，特别是知名网络应用的服务器，其所使用的应用服 务器域名是相对固定的，利用这一特性，可以有效地根据客户端请求访问的域名确定出其 所请求访问的网络应用名称或类型。</p>
    <p>[0058]	(2)对于错过特征码识别阶段后无法进行网络应用识别的情况，本发明实施例可 以通过网络设备实时监测客户端报文的目的IP地址，查询对应的DNS域名，并根据域名查 询结果将其归类到相应的网络应用中去。仍以“FTP下载文件”为例，客户端与应用服务器在 进行FTP数据传输时，路由器可根据客户端报文的目的应用服务器的IP地址，通过DNS反 向查询得知其域名为ftp. xxxxx. yyy(其中，“ftp. xxxxx. yyy”指实际的域名，比如为ftp. kernel, org、ftp. onlinedown. net等形式)，从而得知其为FTP数据交互。</p>
    <p>[0059]	另外，本发明实施例还可结合使用特征码识别网络应用的技术来进一步提高网络 应用的识别率。具体的，当使用特征码识别出某个网络应用后，还可根据客户端报文的目的 IP查询DNS域名，然后根据该域名进一步判断使用特征码识别出的网络应用名称或类型是 否准确。</p>
    <p>[0060]	下面结合附图对本发明实施例进行详细描述。</p>
    <p>[0061]	参见图1，为本发明实施例中的系统架构示意图。如图所示，该系统架构中包括客 户端1，路由器2，Internet网络3，DNS服务器4和SP (Service Provider,服务提供者)服 务器5。其中，DNS服务器4用于提供域名解析服务，其上存储有域名与IP地址的对应关 系，SP服务器5用于提供网络应用服务。</p>
    <p>[0062]	基于图1所示的系统架构，图2示出了本发明实施例提供的网络应用识别与访问 控制的流程，其中，SP服务器5所提供的网络应用的DNS域名为NameA，对应的IP地址为 IPA。客户端1 (IP地址为IPB)请求访问DNS域名为NameA的网络应用时，在控制交互阶段， 其网络应用的识别与访问控制流程可包括：</p>
    <p>[0063]	步骤201，客户端1通过路由器2，向DNS服务器4发送DNS查询报文，以请求查询 域名NameA所对应的IP地址。[0064]	该步骤中，路由器2截获到DNS查询报文，得到查询报文的源IP地址为IPB，以及 客户端请求查询的域名为NameA。具体的，路由器2可通过监听客户端发往端口 53的UDP 报文获得客户端请求查询的DNS域名。</p>
    <p>[0065]	步骤202，DNS服务器4应答客户端的查询请求，返回域名NameA对应的IP地址 IPA。</p>
    <p>[0066]	该步骤中，路由器2截获到DNS应答报文，得到其应答的IP地址IPA。</p>
    <p>[0067]	步骤203，路由器2根据预先设置的DNS域名和对应的访问控制策略，查询域名 NameA对应的访问控制策略，并根据查询到的访问控制策略对源地址为IPB、目的地址为 IPA的报文（即客户端1发往SP服务器5的报文）进行相应处理。</p>
    <p>[0068]	该步骤中，路由器2可根据查询到的访问控制策略建立相应的ACL (Access Control List，访问控制列表），其中规定了对源地址为IPB、目的地址为IPA的报文进行相 应控制的规则，后续在数据交互阶段，路由器2在接收到源地址为IPB、目的地址为IPA的报 文后，就可以根据该ACL进行访问控制了。</p>
    <p>[0069]	基于图1所示的系统架构，图3示出了本发明的另一实施例提供的网络应用识别 与访问控制的流程，其中，SP服务器5所提供的网络应用的DNS域名为NameA，对应的IP地 址为IPA。客户端1与SP服务器5进行数据交互的过程中，若在控制交互阶段错过了网络 应用识别，则在数据交互阶段，其网络应用的识别与访问控制流程可包括：</p>
    <p>[0070]	步骤301，路由器2监听客户端1发送的报文，获得源IP地址B和目的IP地址 IPA。[0071 ] 该步骤中，路由器2可首先根据该报文的源IP地址和目的IP地址，查找是否已经 存在相应的ACL，如果不存在，则继续执行后续步骤；如果存在，则表明在此之前可能已经 对该报文所访问的网络应用进行了识别并相应设置了 ACL，此时路由器2无需再执行后续 步骤，而是根据该已建立的ACL进行访问控制。本实施例中，由于错过了控制交互阶段的网 络应用识别处理，因此不存在相应的ACL。</p>
    <p>[0072]	具体的，路由器2可通过监听客户端1发送的特定协议的报文，如TCP报文，获得 目的IP地址IPA。当然，路由器2也可通过监听发往客户端1的报文获得客户端1的IP地 址和发送端的IP地址。</p>
    <p>[0073]	步骤302，路由器2向DNS服务器4发送查询报文，以查询IPA对应的域名。</p>
    <p>[0074]	步骤303，DNS服务器4返回IPA对应的域名NameA。</p>
    <p>[0075]	步骤304，路由器2根据预先设置的域名和对应的访问控制策略，查询域名NameA 对应的访问控制策略，并根据该访问控制策略对源地址为IPB、目的地址为IPA的报文（即 客户端1发往SP服务器5的报文）进行相应处理。</p>
    <p>[0076]	该步骤中，路由器2可根据查询到的访问控制策略建立相应的ACL，其中规定了对 源地址为IPB、目的地址为IPA的报文进行相应控制的规则，后续，路由器2在接收到源地址 为IPB、目的地址为IPA的报文时，可直接根据该ACL进行访问控制，而无需再进行DNS域名 反查询了。</p>
    <p>[0077]	上述网络应用识别与访问控制过程可单独使用，也可与现有的通过特征码识别网 络应用（或其他网络应用识别方式）进行访问控制的流程结合使用。</p>
    <p>[0078]	在结合使用时，如果在控制交互阶段，已经通过特征识别码（或其他识别方式）识别出了网络应用并相应设置了访问控制规则，则后续在使用本发明实施例提供的方式进行 网络应用识别与访问控制时（如首先开启特征识别码识功能，后续再开启本发明实施例提 供的域名识别功能），网络设备可通过监听客户端与网络侧交互的报文获得客户端所发送 的报文的源IP地址和目的IP地址，然后与已经设置的访问控制规则中的相应IP地址匹 配，如果匹配成功（如源IP地址相同、目的IP地址相同)，则网络设备通过反查DNS域名获 取到该目的IP地址对应的DNS域名，并通过查询预先建立的DNS域名与访问控制策略的对 应关系，得到该DNS域名对应的访问控制策略，如果查询到的访问控制策略与已经建立的 访问控制规则所对应的策略不同，则根据查询到的访问控制策略建立访问控制规则，并在 后续根据该新建立的规则进行访问控制，否则仍使用原有的访问控制规则。</p>
    <p>[0079]	仍以图1所示的系统架构为例，如果在控制交互阶段，通过特征码已经识别出的 网络应用并设置有相应的ACL，则在数据交互阶段开启域名识别功能后，如图4所示，执行 如下流程：</p>
    <p>[0080]	步骤401，路由器2监听客户端1发送的报文，获得源IP地址IPB和目的IP地址 IPA。[0081 ] 步骤402，路由器2将该源IP地址与目的IP地址，与已经存在但未验证通过的ACL 中的相应IP地址进行匹配，如果匹配到ACL (记为ACL1)，则执行步骤403 ；若未匹配到ACL 则返回步骤401继续监听报文。</p>
    <p>[0082]	步骤403，路由器2根据监听到的目的IP地址，通过反查DNS服务器获取到对应的 DNS域名，并根据该DNS域名通过查询预先设置的DNS域名与访问控制策略的对应关系，获 得该DNS域名对应的访问控制策略。</p>
    <p>[0083]	步骤404，路由器2将查询到的访问控制策略与ACLl进行比较，如果两者表达的访 问控制策略不同，则执行步骤405，否则执行步骤406 ；</p>
    <p>[0084]	步骤405，路由器2根据查询到的访问控制策略生成ACL(记为ACL2)并将其标识 为验证通过，路由器2还删除ACLl。</p>
    <p>[0085]	步骤406，将ACLl标识为验证通过。</p>
    <p>[0086]	当开启域名识别功能后，通过域名识别所建立的ACL都需要进行标识（如标识为 验证通过），以与特征码识别功能所建立的ACL进行区别，使域名识别功能对包含有该标识 的ACL不进行返查DNS的处理，以节省网络资源。</p>
    <p>[0087]	根据图4所示流程，如果在控制交互阶段，路由器2通过特征码识别出的网络应用 A和网络应用B的特征码相同，则路由器2为客户端访问网络应用A设置了 ACL10，为访问网 络应用B均设置了 ACLl 1，ACLlO与ACLll的控制策略相同。当在数据交互阶段开启域名识 别功能后，路由器2通过上述流程查询到目的地址为网络应用A的IP地址所对应的DNS域 名，且该DNS域名所对应的访问控制策略与ACLlO不同，则为客户端访问网络应用A生成新 的ACL，并删除ACL10。可以看出，采用上述流程，避免了采用特征码识别所导致的将不同网 络应用识别为相同的网络应用，提高了识别准确率，并提高了访问控制策略设置的合理性。</p>
    <p>[0088]	本发明的上述实施例中，预先设置的与域名对应的访问控制策略可包括：固定配 额管理，降低速率，彻底拦截等。在实际应用中，网络设备（如图2中的路由器2)中可以内 置大部分域名与网络应用信息（如网络应用名称）的对应关系，管理员只需要配置各网络 应用各自对应的访问控制策略即可。管理员也可以根据需要，定制域名与网络应用的对应关系。由于通常知名公司所拥有的域名比较有限且很少变更，因此域名、网络应用名称以及 对应的访问控制策略的维护工作通常较少。</p>
    <p>[0089]	基于相同的技术构思，本发明实施例还提供了一种网络设备，如路由器，可应用于 上述流程。</p>
    <p>[0090]	参见图5，为本发明实施例提供的网络设备的结构示意图。如图所示，该网络设备 可包括：</p>
    <p>[0091]	存储模块501，用于存储网络应用的DNS域名与对应的访问控制策略；</p>
    <p>[0092]	监听模块502，用于在网络应用访问的控制交互阶段监听客户端发往DNS服务器 的DNS查询报文，或者在网络应用访问的数据交互阶段监听客户端与应用服务器之间交互 的报文；</p>
    <p>[0093]	获取模块503，用于根据监听模块501监听到的DNS查询报文获得客户端请求访 问的网络应用的DNS域名；或者，根据监听模块501监听到的客户端与应用服务器之间交互 的报文获得所述应用服务器的IP地址，并通过反向查询DNS服务器获得所述应用服务器的 IP地址对应的DNS域名；</p>
    <p>[0094]	查询模块504，用于根据所述DNS域名，从存储模块501存储的DNS域名与访问控 制策略的对应关系中查询对应的访问控制策略；</p>
    <p>[0095]	规则确定模块505，用于根据查询到的访问控制策略确定访问控制规则；</p>
    <p>[0096]	控制模块506，用于根据规则确定模块505确定的访问控制规则，对所述客户端发 往所述网络应用的报文进行相应控制。</p>
    <p>[0097]	在控制交互阶段：</p>
    <p>[0098]	监听模块502可监听客户端发送的DNS查询报文；以及，监听DNS服务器针对所述 DNS查询报文返回的DNS域名查询结果；</p>
    <p>[0099]	规则确定模块505可根据监听模块502监听到的查询结果，获得所述网络应用的 DNS域名所对应的IP地址，并根据查询模块504查询到的访问控制策略建立访问控制规则， 所述访问控制规则用于对所述客户端发往所述网络应用的DNS域名所对应的IP地址的报 文进行控制。</p>
    <p>[0100]	在数据交互阶段：</p>
    <p>[0101]	监听模块502可监听客户端发送的报文；</p>
    <p>[0102]	获取模块503可根据监听模块502监听到的客户端发送的报文获得目的IP地址， 并根据该目的IP地址从DNS服务器查询对应的DNS域名，并将查询到的DNS域名作为所述 客户端所请求访问的网络应用的DNS域名；</p>
    <p>[0103]	规则确定模块505可根据查询到的访问控制策略建立访问控制规则，所述访问控 制规则用于对所述客户端发往所述应用服务器的IP地址的报文进行控制。</p>
    <p>[0104]	当所述网络设备应用于通过特征码识别网络应用和通过DNS域名识别网络应用 相结合的场景，并且所述网络设备上已经存在有未验证的访问控制规则的情况下：</p>
    <p>[0105]	获取模块503可将监听到的客户端发送的报文中的源IP地址和目的IP地址，与 所述未验证的访问控制规则中的相应IP地址进行匹配；如果匹配，则通过反向查询DNS服 务器，获得该目的IP地址对应的DNS域名；</p>
    <p>[0106]	规则确定模块505可具体用于，若所述网络设备查询到的访问控制策略，与匹配到的访问控制规则所对应的访问控制策略不同，则根据查询到的访问控制策略建立访问控 制规则，并将其标识为验证通过，删除匹配到的访问控制规则；所建立的访问控制规则用于 对所述客户端发往所述目的IP地址的报文进行控制。</p>
    <p>[0107]	上述网络设备中，存储模块501存储的访问控制策略，包括：固定配额限制，降低 速率或拦截报文。</p>
    <p>[0108]	综上所述，本发明实施例中，网络侧设备根据客户端所请求的域名，对客户端所请 求访问的网络应用进行识别，从而为后续做进一步的访问控制等操作打下基础，解决了由 于某些原因（比如前期未打开特征码检测功能等等）而错过网络应用访问请求的控制交互 相关报文后，后续无法根据数据报文准确识别网络应用的问题，以及降低因采用特征码识 别所导致的网络应用误识别率。本发明实施例还可结合特征码检测技术，进一步降低网络 应用的误识别率。</p>
    <p>[0109]	通过以上的实施方式的描述，本领域的技术人员可以清楚地了解到本发明可以通 过硬件实现，也可以借助软件加必要的通用硬件平台的方式来实现。基于这样的理解，本发 明的技术方案可以以软件产品的形式体现出来，该软件产品可以存储在一个非易失性存储 介质（可以是⑶-ROM，U盘，移动硬盘等）中，包括若干指令用以使得一台计算机设备（可 以是个人计算机，服务器，或者网络设备等）执行本发明各个实施例所述的方法。</p>
    <p>[0110]	本领域技术人员可以理解附图只是一个优选实施例的示意图，附图中的模块或流 程并不一定是实施本发明所必须的。</p>
    <p>[0111]	本领域技术人员可以理解实施例中的装置中的模块可以按照实施例描述进行分 布于实施例的装置中，也可以进行相应变化位于不同于本实施例的一个或多个装置中。上 述实施例的模块可以合并为一个模块，也可以进一步拆分成多个子模块。</p>
    <p>[0112]	上述本发明序号仅仅为了描述，不代表实施例的优劣。</p>
    <p>[0113]	以上公开的仅为本发明的几个具体实施例，但是，本发明并非局限于此，任何本领 域的技术人员能思之的变化都应落入本发明的保护范围。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN1852263A?cl=zh">CN1852263A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2006年5月23日</td><td class="patent-data-table-td patent-date-value">2006年10月25日</td><td class="patent-data-table-td ">杭州华为三康技术有限公司</td><td class="patent-data-table-td ">一种报文的访问控制方法及一种网络设备</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN1953455A?cl=zh">CN1953455A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2006年11月15日</td><td class="patent-data-table-td patent-date-value">2007年4月25日</td><td class="patent-data-table-td ">北京北大方正电子有限公司</td><td class="patent-data-table-td ">一种网络资源访问控制的方法、模块和服务器</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101448264A?cl=zh">CN101448264A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2008年12月22日</td><td class="patent-data-table-td patent-date-value">2009年6月3日</td><td class="patent-data-table-td ">杭州华三通信技术有限公司</td><td class="patent-data-table-td ">接入用户的访问控制方法和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101453424A?cl=zh">CN101453424A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2009年1月6日</td><td class="patent-data-table-td patent-date-value">2009年6月10日</td><td class="patent-data-table-td ">中国人民解放军信息工程大学</td><td class="patent-data-table-td ">一种网络信息资源访问控制方法和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US7623518">US7623518</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2004年4月8日</td><td class="patent-data-table-td patent-date-value">2009年11月24日</td><td class="patent-data-table-td ">Hewlett-Packard Development Company, L.P.</td><td class="patent-data-table-td ">Dynamic access control lists</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102420833A?cl=zh">CN102420833A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年12月27日</td><td class="patent-data-table-td patent-date-value">2012年4月18日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">一种网络协议识别的方法、装置及其系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102624878A?cl=zh">CN102624878A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年2月23日</td><td class="patent-data-table-td patent-date-value">2012年8月1日</td><td class="patent-data-table-td ">汉柏科技有限公司</td><td class="patent-data-table-td ">基于dns协议识别p2p协议的方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102624878B?cl=zh">CN102624878B</a></td><td class="patent-data-table-td patent-date-value">2012年2月23日</td><td class="patent-data-table-td patent-date-value">2014年6月18日</td><td class="patent-data-table-td ">汉柏科技有限公司</td><td class="patent-data-table-td ">基于dns协议识别p2p协议的方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102647341A?cl=zh">CN102647341A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年3月28日</td><td class="patent-data-table-td patent-date-value">2012年8月22日</td><td class="patent-data-table-td ">北京星网锐捷网络技术有限公司</td><td class="patent-data-table-td ">一种报文处理方法、装置以及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102647341B?cl=zh">CN102647341B</a></td><td class="patent-data-table-td patent-date-value">2012年3月28日</td><td class="patent-data-table-td patent-date-value">2014年10月29日</td><td class="patent-data-table-td ">北京星网锐捷网络技术有限公司</td><td class="patent-data-table-td ">一种报文处理方法、装置以及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103457878A?cl=zh">CN103457878A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年9月5日</td><td class="patent-data-table-td patent-date-value">2013年12月18日</td><td class="patent-data-table-td ">电子科技大学</td><td class="patent-data-table-td ">一种基于流的网络接入控制方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103457878B?cl=zh">CN103457878B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年9月5日</td><td class="patent-data-table-td patent-date-value">2016年3月23日</td><td class="patent-data-table-td ">电子科技大学</td><td class="patent-data-table-td ">一种基于流的网络接入控制方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103621044A?cl=zh">CN103621044A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年11月11日</td><td class="patent-data-table-td patent-date-value">2014年3月5日</td><td class="patent-data-table-td ">柏思科技有限公司</td><td class="patent-data-table-td ">允许在推行网络策略过程中使用域名的方法和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103986769B?cl=zh">CN103986769B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2014年5月20日</td><td class="patent-data-table-td patent-date-value">2015年1月21日</td><td class="patent-data-table-td ">东南大学</td><td class="patent-data-table-td ">一种标识网业务访问控制方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2013068789A1?cl=zh">WO2013068789A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年11月11日</td><td class="patent-data-table-td patent-date-value">2013年5月16日</td><td class="patent-data-table-td ">Pismo Labs Technology Ltd.</td><td class="patent-data-table-td ">Method and system for allowing the use of domain names in enforcing network policy</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=LfCTBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029080000">H04L29/08</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=LfCTBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029120000">H04L29/12</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2011年5月11日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2011年7月27日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年11月6日</td><td class="patent-data-table-td ">C02</td><td class="patent-data-table-td ">Deemed withdrawal of patent application after publication (patent law 2001)</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/fd1592ded970b1e4e577/CN102055813A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_50a6672b5f82ffbd39b7a9e87fd4594c.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%96%B9%E6%B3%95.pdf?id=LfCTBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U326eCX9JzGRDZIlNOCCS7-yi5KdQ"},"sample_url":"https://www.google.com/patents/reader?id=LfCTBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>