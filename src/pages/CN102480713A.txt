<!DOCTYPE html><html><head><title>专利 CN102480713A - 一种汇聚节点与移动通信网络间的通信方法、系统及装置 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种汇聚节点与移动通信网络间的通信方法、系统及装置"><meta name="DC.contributor" content="李捷" scheme="inventor"><meta name="DC.contributor" content="温雪垠" scheme="inventor"><meta name="DC.contributor" content="韩志杰" scheme="inventor"><meta name="DC.contributor" content="中国移动通信集团河南有限公司" scheme="assignee"><meta name="DC.date" content="2010-11-25" scheme="dateSubmitted"><meta name="DC.description" content="本发明公开了一种汇聚节点与移动通信网络间的通信方法、系统及装置，用以解决现有技术汇聚节点发送给VLR的数据信息安全性低的问题。该方法汇聚节点接收VLR返回的第一随机数，采用第二私钥对该第一随机数加密，并将第二公钥及加密后的第一随机数返回，该VLR采用第二公钥对加密后的第一随机数解密，当解密结果与第一随机数相同时，接收该汇聚节点发送的数据信息。由于本发明实施例中汇聚节点采用第二私钥对第一随机数加密，VLR采用第二公钥对加密后的第一随机数解密，并根据解密结果是否与该第一随机数相同，判断该汇聚节点是否安全，当安全时接收该汇聚节点发送的数据信息，提高了该汇聚节点发送给该VLR的数据信息的安全性。"><meta name="DC.date" content="2012-5-30"><meta name="DC.relation" content="CN:101114901:A" scheme="references"><meta name="DC.relation" content="US:20100034377:A1" scheme="references"><meta name="citation_patent_publication_number" content="CN:102480713:A"><meta name="citation_patent_application_number" content="CN:201010560178"><link rel="canonical" href="https://www.google.com/patents/CN102480713A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN102480713A?cl=zh"/><meta name="title" content="专利 CN102480713A - 一种汇聚节点与移动通信网络间的通信方法、系统及装置"/><meta name="description" content="本发明公开了一种汇聚节点与移动通信网络间的通信方法、系统及装置，用以解决现有技术汇聚节点发送给VLR的数据信息安全性低的问题。该方法汇聚节点接收VLR返回的第一随机数，采用第二私钥对该第一随机数加密，并将第二公钥及加密后的第一随机数返回，该VLR采用第二公钥对加密后的第一随机数解密，当解密结果与第一随机数相同时，接收该汇聚节点发送的数据信息。由于本发明实施例中汇聚节点采用第二私钥对第一随机数加密，VLR采用第二公钥对加密后的第一随机数解密，并根据解密结果是否与该第一随机数相同，判断该汇聚节点是否安全，当安全时接收该汇聚节点发送的数据信息，提高了该汇聚节点发送给该VLR的数据信息的安全性。"/><meta property="og:title" content="专利 CN102480713A - 一种汇聚节点与移动通信网络间的通信方法、系统及装置"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN102480713A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN102480713A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=U0mMBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN102480713A&amp;usg=AFQjCNHemnzPIJsrh1WmVzgxtgJz4tk9Gw" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/9bae086c3a69e3b38231/CN102480713A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/9bae086c3a69e3b38231/CN102480713A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN102480713A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN102480713A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN102480713A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN102480713B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN102480713A?cl=zh" style="display:none"><span itemprop="description">本发明公开了一种汇聚节点与移动通信网络间的通信方法、系统及装置，用以解决现有技术汇聚节点发送给VLR的数据信息安全性低的问题。该方法汇聚节点接收VLR返回的第一随机数，采用第二私钥对该第一随机数加密，并将第二...</span><span itemprop="url">https://www.google.com/patents/CN102480713A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN102480713A - 一种汇聚节点与移动通信网络间的通信方法、系统及装置</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN102480713A - 一种汇聚节点与移动通信网络间的通信方法、系统及装置" title="专利 CN102480713A - 一种汇聚节点与移动通信网络间的通信方法、系统及装置"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN102480713 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201010560178</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2012年5月30日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2010年11月25日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2010年11月25日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102480713B?hl=zh-CN&amp;cl=zh">CN102480713B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201010560178.3, </span><span class="patent-bibdata-value">CN 102480713 A, </span><span class="patent-bibdata-value">CN 102480713A, </span><span class="patent-bibdata-value">CN 201010560178, </span><span class="patent-bibdata-value">CN-A-102480713, </span><span class="patent-bibdata-value">CN102480713 A, </span><span class="patent-bibdata-value">CN102480713A, </span><span class="patent-bibdata-value">CN201010560178, </span><span class="patent-bibdata-value">CN201010560178.3</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%9D%8E%E6%8D%B7%22">李捷</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%B8%A9%E9%9B%AA%E5%9E%A0%22">温雪垠</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%9F%A9%E5%BF%97%E6%9D%B0%22">韩志杰</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8%E9%80%9A%E4%BF%A1%E9%9B%86%E5%9B%A2%E6%B2%B3%E5%8D%97%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">中国移动通信集团河南有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102480713A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102480713A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102480713A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (2),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (3),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=U0mMBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201010560178&amp;usg=AFQjCNHTBTbGW33c17zor95pM20IbPPzjQ"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=U0mMBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D102480713A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNGqXIyIThg3EAm6pLaMX76aEek16Q"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT113055327" lang="ZH" load-source="patent-office">一种汇聚节点与移动通信网络间的通信方法、系统及装置</invention-title>
      </span><br><span class="patent-number">CN 102480713 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA96674702" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明公开了一种汇聚节点与移动通信网络间的通信方法、系统及装置，用以解决现有技术汇聚节点发送给VLR的数据信息安全性低的问题。该方法汇聚节点接收VLR返回的第一随机数，采用第二私钥对该第一随机数加密，并将第二公钥及加密后的第一随机数返回，该VLR采用第二公钥对加密后的第一随机数解密，当解密结果与第一随机数相同时，接收该汇聚节点发送的数据信息。由于本发明实施例中汇聚节点采用第二私钥对第一随机数加密，VLR采用第二公钥对加密后的第一随机数解密，并根据解密结果是否与该第一随机数相同，判断该汇聚节点是否安全，当安全时接收该汇聚节点发送的数据信息，提高了该汇聚节点发送给该VLR的数据信息的安全性。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(11)</span></span></div><div class="patent-text"><div mxw-id="PCLM42349837" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.	一种汇聚节点与移动通信网络间的通信方法，其特征在于，包括：汇聚节点向拜访位置寄存器VLR发送入网登记请求，并接收所述VLR根据所述入网登记请求返回的第一随机数；以及所述汇聚节点采用自身保存的第二私钥对所述第一随机数加密； 所述汇聚节点将自身保存的第二公钥以及加密后的第一随机数发送到所述VLR ；以及当接收到VLR返回的确认通知后，向所述VLR发送数据信息，其中所述确认通知为所述 VLR采用接收到的第二公钥，对加密后的第一随机数解密，且解密结果与所述VLR自身发送的第一随机数相同时发送的。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.如权利要求1所述的方法，其特征在于，采用自身保存的第二私钥对所述第一随机数加密包括：所述汇聚节点接收所述VLR返回的第一数字证书认证中心CA证书； 根据自身保存的CA公钥，及接收到的所述第一 CA证书，对所述VLR进行验证； 当对所述VLR验证通过时，获取所述第一 CA证书中携带的第一公钥； 采用第二私钥对所述第一随机数加密；并采用获取的所述第一公钥对第二私钥加密后的第一随机数再进行加密。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.如权利要求2所述的方法，其特征在于，将自身保存的第二公钥发送到所述VLR包括：所述汇聚节点将所述第二公钥携带在自身保存的第二 CA证书中； 采用获取的所述第一公钥对所述第二 CA证书进行加密，并将加密后的第二 CA证书发送到所述VLR。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.如权利要求3所述的方法，其特征在于，VLR采用接收到的第二公钥，对加密后的第一随机数解密包括：所述VLR采用自身保存的第一私钥，对接收到的所述加密后的第二 CA证书解密，获取第二 CA证书；根据自身保存的CA公钥对获取的所述第二 CA证书进行验证，并在验证通过后获取所述第二 CA证书中携带的所述第二公钥，将获取的所述第二公钥作为接收到的所述第二公钥；采用自身保存的第一私钥，对所述再加密后的第一随机数解密；并， 采用接收到的第二公钥，对解密后的第一随机数再解密。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.如权利要求4所述的方法，其特征在于，对接收到的所述加密后的第二	CA证书解密包括：所述VLR接收所述汇聚节点发送的加密后的序列号ID，其中，所述加密后的ID为所述汇聚节点采用所述第一公钥加密的；采用自身保存的所述第一私钥对所述加密后的ID解密，获取所述ID，并在验证所述ID 合法时，采用自身保存的所述第一私钥，对接收到的所述加密后的第二 CA证书解密。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.如权利要求1所述的方法，其特征在于，向所述VLR发送数据信息包括： 所述汇聚节点接收所述VLR返回的第二随机数；采用接收到的所述第二随机数，对所述数据信息加密，并将加密后的数据信息发送给所述VLR。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.如权利要求6所述的方法，其特征在于，汇聚节点接收所述VLR返回的第二随机数包括：所述汇聚节点接收所述VLR返回的采用所述第二公钥加密后的第二随机数； 采用自身保存的所述第二私钥对所述加密后的第二随机数解密，获取所述第二随机数，并将获取的所述第二随机数作为接收到的所述VLR返回的第二随机数。</div>
    </div>
    </div> <div class="claim"> <div num="8" class="claim">
      <div class="claim-text">8.	&#8212;种汇聚节点与移动通信网络间的通信系统，其特征在于，包括：汇聚节点，用于向拜访位置寄存器VLR发送入网登记请求，并接收所述VLR根据所述入网登记请求返回的第一随机数，采用自身保存的第二私钥对所述第一随机数加密，将自身保存的第二公钥以及加密后的第一随机数发送到所述VLR，当接收到VLR返回的确认通知后，向所述VLR发送数据信息，其中所述确认通知为所述VLR采用接收到的第二公钥，对加密后的第一随机数解密，且解密结果与所述VLR自身发送的第一随机数相同时发送的；VLR，用于接收所述汇聚节点发送的所述入网登记请求，根据所述入网登记请求向所述汇聚节点返回所述第一随机数，接收汇聚节点发送的所述第二公钥以及所述加密后的第一随机数，采用接收到的第二公钥，对加密后的第一随机数解密，且解密结果与自身发送的第一随机数相同时，向所述汇聚节点发送所述确认通知，并接收所述汇聚节点发送的数据信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.如权利要求8所述的系统，其特征在于，所述汇聚节点具体用于，接收所述VLR返回的第一数字证书认证中心CA证书，根据自身保存的CA公钥，及接收到的所述第一 CA证书， 对所述VLR进行验证，当对所述VLR验证通过时，获取所述第一 CA证书中携带的第一公钥， 采用第二私钥对所述第一随机数加密，并采用获取的所述第一公钥对第二私钥加密后的第一随机数再进行加密；所述VLR还用于，向所述汇聚节点返回所述第一 CA证书。</div>
    </div>
    </div> <div class="claim"> <div num="10" class="claim">
      <div class="claim-text">10.	一种汇聚节点与移动通信网络间的通信装置，其特征在于，包括：发送模块，用于向拜访位置寄存器VLR发送入网登记请求，将自身保存的第二公钥以及加密后的第一随机数发送到所述VLR，并当接收到VLR返回的确认通知后，向所述VLR发送数据信息，其中所述确认通知为所述VLR采用接收到的第二公钥，对加密后的第一随机数解密，且解密结果与所述VLR自身发送的第一随机数相同时发送的；接收模块，用于接收所述VLR根据所述入网登记请求返回的第一随机数，并接收VLR返回的所述确认通知；加密模块，用于采用自身保存的第二私钥对所述第一随机数加密。</div>
    </div>
    </div> <div class="claim"> <div num="11" class="claim">
      <div class="claim-text">11.	一种汇聚节点与移动通信网络间的通信装置，其特征在于，包括：接收模块，用于接收汇聚节点发送的入网登记请求，接收所述汇聚节点发送的第二公钥以及加密后的第一随机数，并接收所述汇聚节点发送的数据信息；发送模块，用于根据所述入网登记请求向所述汇聚节点返回第一随机数，并在确定解密结果与自身发送的所述第一随机数相同时，向所述汇聚节点返回确认通知； 解密模块，用于采用接收到的第二公钥，对加密后的第一随机数解密； 判断模块，用于判断解密结果是否与自身发送的所述第一随机数相同。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES47192461" lang="ZH" load-source="patent-office" class="description">
    <p>一种汇聚节点与移动通信网络间的通信方法、系统及装置</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及无线通信领域，尤其涉及一种汇聚节点与移动通信网络间的通信方法、系统及装置。</p>
    <p>背景技术</p>
    <p>[0002]	物联网是新一代信息技术的重要组成部分，物联网可以由无线传感器网络和移动通信网络组成。其中，无线传感器网络包括配备有各种类型传感器的传感器节点和汇聚节点，传感器节点用于对周围环境的探测与感知，汇聚节点用于接收其他传感器节点发送的数据信息，并将接收到的数据信息通过移动通信网络发送到用户的终端，使用户能够获知其感兴趣的数据信息。因此，如何保证该汇聚节点与移动通信网络间的通信安全至关重要。 图1为现有技术中无线传感器网络与移动通信网络通信的系统结构图，具体包括：</p>
    <p>[0003]	传感器节点101，用于对周围环境的探测与感知，并将感知到的数据信息通过多跳传输的方式发送给汇聚节点102 ；</p>
    <p>[0004]	汇聚节点102，用于接收传感器节点101发送的数据信息，并将接收到的数据信息发送到基站103 ；</p>
    <p>[0005]	基站103，用于接收汇聚节点102发送的数据信息，并将接收到的数据信息通过移动通信网络104发送到用户的终端105 ；</p>
    <p>[0006]	用户的终端105，用于接收移动通信网络104发送的数据信息。</p>
    <p>[0007]	为了保证汇聚节点与移动通信网络间的通信安全，采用基站103中的拜访位置寄存器（Visitor Location Register, VLR)对接入移动通信网络的汇聚节点进行认证。其中，汇聚节点和VLR都保存相同的认证密钥。</p>
    <p>[0008]	现有技术中VLR对汇聚节点进行认证的方法具体方法为，当汇聚节点接入该移动通信网络时，向VLR发送入网登记请求，VLR接收到该入网登记请求后，向该汇聚节点发送认证通知，该汇聚节点接收到认证通知后，根据保存的认证密钥，采用相应的算法得到第一结果，并将得到的第一结果发送到该VLR，该VLR也根据保存的相同的认证密钥，采用相应的算法得到第二结果，判断该第一结果和第二结果是否相等，若相等则确定该汇聚节点安全，接收该汇聚节点发送的数据信息，否则确定该汇聚节点不安全，拒绝接收该汇聚节点发送的数据信息。</p>
    <p>[0009]	该认证方法虽然可以在一定程度上保证汇聚节点与移动通信网络间的通信安全， 但是由于汇聚节点和VLR都保存相同的认证密钥，并且该VLR采用该认证密钥对该汇聚节点进行认证，若该认证密钥被窃取，则其他的非法汇聚节点可以冒充该汇聚节点，并通过该 VLR将非法的数据信息发送给用户的终端，即该方法不能有效的保证汇聚节点发送给VLR 的数据信息的安全性。</p>
    <p>发明内容</p>
    <p>[0010]	有鉴于此，本发明实施例提供一种汇聚节点与移动通信网络间的通信方法、系统</p>
    <p>4及装置，用以解决现有技术汇聚节点发送给VLR的数据信息安全性低的问题。</p>
    <p>[0011]	本发明实施例提供的一种汇聚节点与移动通信网络间的通信方法，包括：</p>
    <p>[0012]	汇聚节点向拜访位置寄存器VLR发送入网登记请求，并接收所述VLR根据所述入网登记请求返回的第一随机数；以及</p>
    <p>[0013]	所述汇聚节点采用自身保存的第二私钥对所述第一随机数加密；</p>
    <p>[0014]	所述汇聚节点将自身保存的第二公钥以及加密后的第一随机数发送到所述VLR; 以及</p>
    <p>[0015]	当接收到VLR返回的确认通知后，向所述VLR发送数据信息，其中所述确认通知为所述VLR采用接收到的第二公钥，对加密后的第一随机数解密，且解密结果与所述VLR自身发送的第一随机数相同时发送的。</p>
    <p>[0016]	本发明实施例提供的一种汇聚节点与移动通信网络间的通信系统，包括：</p>
    <p>[0017]	汇聚节点，用于向拜访位置寄存器VLR发送入网登记请求，并接收所述VLR根据所述入网登记请求返回的第一随机数，采用自身保存的第二私钥对所述第一随机数加密，将自身保存的第二公钥以及加密后的第一随机数发送到所述VLR，当接收到VLR返回的确认通知后，向所述VLR发送数据信息，其中所述确认通知为所述VLR采用接收到的第二公钥， 对加密后的第一随机数解密，且解密结果与所述VLR自身发送的第一随机数相同时发送的；</p>
    <p>[0018]	VLR，用于接收所述汇聚节点发送的所述入网登记请求，根据所述入网登记请求向所述汇聚节点返回所述第一随机数，接收汇聚节点发送的所述第二公钥以及所述加密后的第一随机数，采用接收到的第二公钥，对加密后的第一随机数解密，且解密结果与自身发送的第一随机数相同时，向所述汇聚节点发送所述确认通知，并接收所述汇聚节点发送的数据信息。</p>
    <p>[0019]	本发明实施例提供的一种汇聚节点与移动通信网络间的通信装置，包括：</p>
    <p>[0020]	发送模块，用于向拜访位置寄存器VLR发送入网登记请求，将自身保存的第二公钥以及加密后的第一随机数发送到所述VLR，并当接收到VLR返回的确认通知后，向所述 VLR发送数据信息，其中所述确认通知为所述VLR采用接收到的第二公钥，对加密后的第一随机数解密，且解密结果与所述VLR自身发送的第一随机数相同时发送的；</p>
    <p>[0021]	接收模块，用于接收所述VLR根据所述入网登记请求返回的第一随机数，并接收 VLR返回的所述确认通知；</p>
    <p>[0022]	加密模块，用于采用自身保存的第二私钥对所述第一随机数加密。</p>
    <p>[0023]	本发明实施例提供的一种汇聚节点与移动通信网络间的通信装置，包括：</p>
    <p>[0024]	接收模块，用于接收汇聚节点发送的入网登记请求，接收所述汇聚节点发送的第二公钥以及加密后的第一随机数，并接收所述汇聚节点发送的数据信息；</p>
    <p>[0025]	发送模块，用于根据所述入网登记请求向所述汇聚节点返回第一随机数，并在确定解密结果与自身发送的所述第一随机数相同时，向所述汇聚节点返回确认通知；</p>
    <p>[0026]	解密模块，用于采用接收到的第二公钥，对加密后的第一随机数解密；</p>
    <p>[0027]	判断模块，用于判断解密结果是否与自身发送的所述第一随机数相同。</p>
    <p>[0028]	本发明实施例提供一种汇聚节点与移动通信网络间的通信方法、系统及装置，该方法汇聚节点接收VLR返回的第一随机数，采用自身保存的第二私钥对该第一随机数加密，并将自身保存的第二公钥及加密后的第一随机数返回，该VLR采用第二公钥对加密后的第一随机数进行解密，当解密结果与该第一随机数相同时，接收该汇聚节点发送的数据信息。由于本发明实施例中汇聚节点采用第二私钥对第一随机数加密，该VLR采用第二公钥对加密后的第一随机数解密，并根据解密结果是否与该第一随机数相同，判断该汇聚节点是否安全，当安全时接收该汇聚节点发送的数据信息，提高了该汇聚节点发送给该VLR 的数据信息的安全性。</p>
    <p>附图说明</p>
    <p>[0029]	图1为现有技术中无线传感器网络与移动通信网络通信的系统结构图；</p>
    <p>[0030]	图2为本发明实施例提供的汇聚节点与移动通信网络间的通信的过程；</p>
    <p>[0031]	图3为本发明实施例提供的汇聚节点验证VLR，并在验证通过后对该第一随机数加密，以及VLR对加密后的第一随机数进行解密的过程；</p>
    <p>[0032]	图4为本发明实施例提供的汇聚节点与移动通信网络间的通信的详细过程；</p>
    <p>[0033]	图5为本发明实施例提供的汇聚节点与移动通信网络间的通信系统；</p>
    <p>[0034]	图6为本发明实施例提供的汇聚节点与移动通信网络间的通信装置；</p>
    <p>[0035]	图7为本发明实施例提供的汇聚节点与移动通信网络间的通信装置。</p>
    <p>具体实施方式</p>
    <p>[0036]	本发明实施例提供一种汇聚节点与移动通信网络间的通信方法、系统及装置，该方法汇聚节点接收VLR返回的第一随机数，采用自身保存的第二私钥对该第一随机数加密，并将自身保存的第二公钥及加密后的第一随机数返回，该VLR采用第二公钥对加密后的第一随机数进行解密，当解密结果与该第一随机数相同时，接收该汇聚节点发送的数据信息。由于本发明实施例中汇聚节点采用第二私钥对第一随机数加密，该VLR采用第二公钥对加密后的第一随机数解密，并根据解密结果是否与该第一随机数相同，判断该汇聚节点是否安全，当安全时接收该汇聚节点发送的数据信息，提高了该汇聚节点发送给该VLR 的数据信息的安全性。</p>
    <p>[0037]	下面结合说明书附图，对本发明实施里进行详细描述。</p>
    <p>[0038]	图2为本发明实施例提供的汇聚节点与移动通信网络间的通信的过程，具体包括以下步骤：</p>
    <p>[0039]	S201 ：汇聚节点向拜访位置寄存器VLR发送入网登记请求，并接收VLR根据该入网登记请求返回的第一随机数。</p>
    <p>[0040]	在本发明实施例中，当汇聚节点接入移动通信网络时，先要向VLR发送入网登记请求，VLR接收到该入网登记请求后，生成第一随机数，并向该汇聚节点返回该第一随机数。</p>
    <p>[0041]	S202 ：采用自身保存的第二私钥对该第一随机数加密。</p>
    <p>[0042]	在本发明实施例中，汇聚节点接收到该第一随机数后，采用自身保存的该第二私钥对该第一随机数进行加密。</p>
    <p>[0043]	S203 ：将自身保存的第二公钥以及加密后的第一随机数发送到VLR。</p>
    <p>[0044]	该汇聚节点将自身保存的第二公钥，以及加密后的第一随机数发送给VLR。</p>
    <p>[0045]	S204:VLR采用接收到的第二公钥，对加密后的第一随机数解密，判断解密结果是否与自身发送的第一随机数相同，若相同，则进行步骤S205，否则进行步骤S206。</p>
    <p>[0046]	在本发明实施例中，VLR采用接收到的该第二公钥，对加密后的第一随机数进行解密，得到解密结果，并根据得到的该解密结果是否与自身发送的该第一随机数相同，判断该汇聚节点是否安全。其中，采用该第二私钥进行加密的数据信息，只能采用该第二公钥进行解密，同样的，采用该第二公钥进行加密的数据信息，也只能采用该第二私钥进行解密。</p>
    <p>[0047]	S205 ：该VLR向该汇聚节点返回确认通知，该汇聚节点接收到该确认通知后，向 VLR发送数据信息。</p>
    <p>[0048]	当确定该解密结果与自身发送的该第一随机数相同时，确定该汇聚节点安全，即确定该汇聚节点为合法的汇聚节点，VLR向该汇聚节点返回确认通知。该汇聚节点接收到该确认通知后，向VLR发送数据信息，VLR接收该汇聚节点发送的数据信息，并对接收到的数据信息进行处理。</p>
    <p>[0049]	S206 =VLR拒绝接收该汇聚节点发送的数据信息。</p>
    <p>[0050]	当确定该解密结果与自身发送的该第一随机数不相同时，确定该汇聚节点不安全，即确定该汇聚节点为非法的汇聚节点，拒绝接收该汇聚节点发送的数据信息。</p>
    <p>[0051]	在上述过程中，汇聚节点接收VLR返回的第一随机数，采用自身保存的第二私钥对该第一随机数加密，并将自身保存的第二公钥及加密后的第一随机数返回，该VLR采用第二公钥对加密后的第一随机数进行解密，根据解密结果是否与自身发送的该第一随机数相同，判断该汇聚节点是否安全，当确定安全时，接收该汇聚节点发送的数据信息。由于本发明实施例中汇聚节点自身保存第二私钥，在汇聚节点与VLR进行信息交互的过程中，只传输第二公钥，而不传输第二私钥，如果该第二公钥被非法的汇聚节点窃取，则该非法的汇聚节点只能采用窃取的第二公钥对该第一随机数进行加密，而采用该第二公钥进行加密的第一随机数，只能采用该第二私钥解密，由于VLR并没有保存该第二私钥，因此VLR不能对采用第二公钥加密后的第一随机数进行解密，从而不能正确的获取该第一随机数，拒绝该非法的汇聚节点发送的数据信息，因此提高了该汇聚节点发送给该VLR的数据信息的安全性。</p>
    <p>[0052]	并且，在上述过程中，汇聚节点保存第二私钥的方法可以为，在汇聚节点内置用户识别(Subscriber Identity Module, SIM)卡，采用SIM卡保存第二私钥。但考虑到汇聚节点的能量和计算能力有限，不能很好的支持SIM卡，若采用SIM卡保存该第二私钥，汇聚节点从SIM卡中获取第二私钥的过程较长，从而导致汇聚节点与移动通信网络间的通信效率降低。另外，SIM卡的成本较高，如果在汇聚节点中内置SIM卡，则会造成运营和管理成本增加。因此本发明实施例中为了提高汇聚节点与该移动通信网络间的通信效率，降低运营和管理成本，采用汇聚节点能够有效支持，并且成本较低的其他方法保存该第二私钥，例如，可以在该汇聚节点中内置可信芯片，采用该可信芯片保存该第二私钥，或者采用该汇聚节点中的射频识别（Radio Frequency Identification, RFID)芯片保存该第二私钥，也可以在汇聚节点的内存中单独设置独立区域，采用该独立区域对该第二私钥进行加密存储， 或者采用该汇聚节点的嵌入式系统中具有较高安全性的软件保存该第二私钥。</p>
    <p>[0053]	在本发明实施例中，为了进一步提高汇聚节点发送给VLR的数据信息的安全性， 该汇聚节点还要对VLR进行验证，具体方法为，该汇聚节点采用自身保存的第二私钥对该第一随机数加密之前，接收该VLR返回的第一数字认证中心（Certificate Authority, CA)证书，根据自身保存的CA公钥，及接收到的该第一 CA证书，对该VLR进行验证。</p>
    <p>[0054]	在上述过程中，该VLR自身保存该第一 CA证书，该汇聚节点可以根据自身保存的 CA公钥，对该第一 CA证书进行验证，即对该VLR进行验证，当验证通过时，说明该VLR为合法的VLR，继续进行后续步骤，否则说明该VLR为非法的VLR，拒绝向该VLR发送数据信息。 并且，只有当该VLR确定该汇聚节点为合法的汇聚节点，且该汇聚节点确定该VLR为合法的 VLR时，该汇聚节点才向该VLR发送数据信息，即该汇聚节点当接收到该VLR发送的该确认通知，且对该VLR验证通过时，向该VLR发送数据信息。</p>
    <p>[0055]	在本发明实施例中，该第一 CA证书中携带第一公钥，为了进一步提高该汇聚节点发送给该VLR的数据信息的安全性，在该汇聚节点验证该VLR通过后，获取该第一 CA证书中携带的该第一公钥，采用获取的该第一公钥，对第二私钥加密后的第一随机数再进行加密。具体为，当对该VLR验证通过时，获取该第一 CA证书中携带的第一公钥，采用第二私钥对该第一随机数加密，并采用获取的该第一公钥对第二私钥加密后的第一随机数在进行加密。其中，采用该第一公钥加密的数据信息，只能用第一私钥进行解密，同样的，采用该第一私钥加密的数据信息，也只能用该第一公钥进行解密。</p>
    <p>[0056]	在上述过程中，当汇聚节点采用获取的该第一公钥对第二私钥加密后的第一随机数在进行加密时，VLR对加密后的第一随机数进行解密的方法具体为，该VLR采用自身保存的第一私钥，对该再加密后第一随机数解密，并采用第二公钥，对解密后的第一随机数再解</p>
    <p>Γ t [ O</p>
    <p>[0057]	由于VLR自身保存第一私钥，在汇聚节点与VLR进行信息交互的过程中，只传输第一公钥，而不传输第一私钥，因此VLR自身保存的第一私钥很难被窃取。采用该方法对该第一随机数再进行加密时，非法的VLR窃取了该第一公钥后，该汇聚节点采用该第一公钥对该第二私钥加密后的第一随机数再进行加密，由于采用该第一公钥进行加密的第一随机数，只能采用该第一私钥解密，而该非法的VLR由于没有该第一私钥，则不能对再加密后的第一随机数进行解密，也就不能正确的获取该第一随机数，因此无法与该汇聚节点进行后续步骤，也就不能接收该汇聚节点发送的数据信息，进一步提高了该汇聚节点发送的数据信息的安全性。</p>
    <p>[0058]	在本发明实施例中，为了进一步提高该汇聚节点发送的数据信息的安全性，该汇聚节点将自身保存的第二公钥发送到该VLR的方法可以为，将该第二公钥携带在自身保存的第二 CA证书中，并采用获取的该第一公钥对该第二 CA证书进行加密，并将加密后的第二 CA证书发送到该VLR。</p>
    <p>[0059]	此时VLR接收该第二公钥的方法具体为，采用自身保存的第一私钥，对接收到的该加密后的第二 CA证书解密，获取第二 CA证书，根据自身保存的CA公钥对获取的该第二 CA证书进行验证，并在验证通过后获取该第二 CA证书中携带的该第二公钥，将获取的第二公钥作为接收到的该第二公钥。</p>
    <p>[0060]	图3为本发明实施例提供的汇聚节点验证VLR，并在验证通过后对该第一随机数加密，以及VLR对加密后的第一随机数进行解密的过程，具体包括以下步骤：</p>
    <p>[0061]	S301 ：汇聚节点向VLR发送入网登记请求，并接收VLR根据该入网登记请求返回的第一随机数和第一 CA证书。</p>
    <p>[0062]	为了进一步提高该汇聚节点发送的数据信息的安全性，该VLR还要向该汇聚节点返回自身保存的该第一 CA证书。</p>
    <p>[0063]	S302 ：该汇聚节点根据自身保存的CA公钥，及接收到的该第一 CA证书，对该VLR 进行验证，若通过验证，则进行步骤S303，否则进行步骤S304。</p>
    <p>[0064]	在本发明实施例中，该汇聚节点可以根据自身保存的CA公钥，对接收到的该第一 CA证书进行验证，即对该VLR进行验证。</p>
    <p>[0065]	S303 ：该汇聚节点获取该第一 CA证书中携带的第一公钥，采用自身保存的第二私钥对该第一随机数进行加密，并采用获取的该第一公钥对第二私钥加密后的第一随机数再进行加密。</p>
    <p>[0066]	当验证通过时，即确定该VLR合法时，该汇聚节点获取该第一 CA证书中携带的该第一公钥，采用该第二私钥对该第一随机数进行加密，并采用该第一公钥对加密后的第一随机数再进行加密。</p>
    <p>[0067]	S304 ：该汇聚节点确定该VLR为非法的VLR，拒绝向该VLR发送数据信息。</p>
    <p>[0068]	当验证不通过时，即确定该VLR非法时，该汇聚节点拒绝向该VLR发送数据信息。</p>
    <p>[0069]	S305:该汇聚节点将第二公钥携带在自身保存的第二 CA证书中，采用获取的该第一公钥对该第二 CA证书进行加密，并将加密后的第二 CA证书，以及再加密后的第一随机数发送到该VLR。</p>
    <p>[0070]	在本发明实施例中，为了进一步提高该汇聚节点发送的数据信息的安全性，该汇聚节点将自身保存的该第二公钥携带在第二 CA证书中，并采用该第一公钥对该第二 CA证书进行加密，将加密后的该第二 CA证书，以及步骤S303中该再加密后的第一随机数发送到该 VLR。</p>
    <p>[0071]	S306 ：该VLR采用自身保存的第一私钥，对接收到的该加密后的第二CA证书解密， 获取第二 CA证书，根据自身保存的CA公钥对获取的该第二 CA证书进行验证，若验证通过， 则进行步骤S307，否则进行步骤S309。</p>
    <p>[0072]	该VLR采用该第一私钥对加密后的第二 CA证书解密，获取第二 CA证书，先根据自身保存的CA公钥，验证该第二 CA证书，即对该汇聚节点进行验证。</p>
    <p>[0073]	S307 ：该VLR获取该第二CA证书中携带的第二公钥，采用自身保存的第一私钥，对该再加密后的第一随机数解密，并采用第二公钥，对解密后的第一随机数再解密。</p>
    <p>[0074]	当验证通过时，获取该第二 CA证书中携带的第二公钥，将获取的该第二公钥作为接收到的该第二公钥，并采用第一私钥对该再加密后的第一随机数进行解密，采用该第二公钥，对解密后的第一随机数再进行解密。</p>
    <p>[0075]	S308:该VLR确定解密结果与自身发送的第一随机数相同时，向该汇聚节点返回确认通知，接收该汇聚节点发送的数据信息。</p>
    <p>[0076]	在本发明实施例中，当VLR对再加密后的第一随机数进行两次解密后的解密结果，与自身发送的该第一随机数相同时，确定该汇聚节点安全，向该汇聚节点返回确认通知，该汇聚节点接收到该确认通知后，向该VLR发送数据信息，该VLR接收该汇聚节点发送的数据信息，并对数据信息进行处理</p>
    <p>[0077]	S309 ：该VLR拒绝接收该汇聚节点发送的数据信息。</p>
    <p>[0078]	当验证不通过时，该VLR确定该汇聚节点为非法的汇聚节点，拒绝接收该汇聚节点发送的数据信息。</p>
    <p>9[0079]	在上述过程中，该汇聚节点在验证接收到的第一 CA证书通过时，即验证VLR通过时，获取该第一 CA证书中携带的第一公钥，采用自身保存的第二私钥对接收到的第一随机数进行加密，并采用第一公钥对第二私钥加密后的第一随机数再进行加密，采用第一公钥对携带第二公钥的第二 CA证书进行加密，将加密后的第二 CA证书，以及再加密后的第一随机数发送到VLR，该VLR采用自身保存的第一私钥对加密后的第二 CA证书解密，并在验证该第二 CA证书通过时，获取第二公钥，采用自身保存的第一私钥对再加密后的第一随机数解密，并采用第二公钥对解密后的第一随机数再解密，在确定解密结果与自身发送的第一随机数相同时，向该汇聚节点返回确认通知，接收该汇聚节点发送的数据信息，极大的提高了该汇聚节点发送的数据信息的安全性。</p>
    <p>[0080]	在实际应用中，非法的汇聚节点可能会使用两个以上的不同序列号（Identity， ID)频繁的向VLR发送入网登记请求，即对该VLR进行恶意攻击，由于VLR与汇聚节点的验证过程需要一定的时间，因此会导致该VLR由于同时进行的验证过程过多而产生数据积压，最终使该VLR瘫痪。为了防止非法的汇聚节点对VLR的攻击，在本发明实施例中，该VLR 对接收到的加密后的第二 CA证书解密之前，还要接收汇聚节点发送的该汇聚节点的ID，并对该ID进行验证，当验证该ID合法时，再进行后续步骤，即对接收到的加密后的第二 CA证书解密。具体方法为，VLR接收该汇聚节点发送的加密后的ID，其中，该加密后的ID为该汇聚节点采用该第一公钥加密的，该VLR采用自身保存的第一私钥对加密后的ID解密，获取该ID，并在验证该ID合法时，采用自身保存的该第一私钥，对接收到的加密后的第二 CA证书解密。</p>
    <p>[0081]	采用上述方法时，对该汇聚节点的ID的验证方法可以有多种，例如可以根据该ID 的位数、首字节或关键字段来验证该ID的合法性。为了避免因非法汇聚节点的攻击而产生的数据积压，当验证通过时，再进行后续步骤，当验证不通过时，拒绝接收该汇聚节点的数据信息。</p>
    <p>[0082]	在本发明实施例中，当该VLR确定解密结果与自身发送的第一随机数相同时，即该VLR确定该汇聚节点安全时，生成第二随机数，并向汇聚节点返回确认通知和生成的第二随机数。该汇聚节点接收该VLR返回的第二随机数，采用接收到的该第二随机数，对该数据信息加密，并将加密后的数据信息发送给该VLR，即该VLR与该汇聚节点约定采用该第二随机数作为后续的会话密钥。</p>
    <p>[0083]	并且，为了进一步提高汇聚节点发送的数据信息的安全性，VLR采用第二公钥对该第二随机数进行加密，并将加密后的第二随机数返回该汇聚节点。该汇聚节点接收该VLR 返回的采用第二公钥加密后的第二随机数，采用自身保存的第二私钥对加密后的第二随机数解密，获取该第二随机数，并将获取的第二随机数作为接收到的该VLR返回的第二随机数。</p>
    <p>[0084]	在本发明实施例中，由于该汇聚节点的计算能力有限，不能有效的支持运算复杂度较大的算法，例如公钥加密RSA算法，当采用RSA算法进行认证时，会消耗很长的认证时间，从而降低汇聚节点与移动通信网络间的通信效率。因此为了提高该汇聚节点与移动通信网络间的通信效率，该VLR采用错误检查纠正（Error Correcting Code, ECC)算法生成并保存该第一公钥和该第一私钥，该汇聚节点采用ECC算法生成并保存该第二公钥和该第二私钥，其相应的加密和解密算法也是根据ECC算法进行加密和解密的。[0085]	图4为本发明实施例提供的汇聚节点与移动通信网络间的通信的详细过程，具体包括以下步骤：</p>
    <p>[0086]	S401 ：汇聚节点向VLR发送入网登记请求，并接收该VLR根据该入网登记请求返回的第一 CA证书和第一随机数。</p>
    <p>[0087]	在本发明实施例中，当汇聚节点接入移动通信网络时，先要向VLR发送入网登记请求，VLR接收到该入网登记请求后，生成第一随机数，并向该汇聚节点返回该第一随机数。 并且，为了进一步提高该汇聚节点发送的数据信息的安全性，该VLR还要向该汇聚节点返回自身保存的该第一 CA证书。</p>
    <p>[0088]	S402 ：该汇聚节点根据自身保存的CA公钥，及接收到的该第一 CA证书，对该VLR 进行验证，若通过验证，则进行步骤S403，否则进行步骤S404。</p>
    <p>[0089]	在本发明实施例中，该汇聚节点可以根据自身保存的CA公钥，对接收到的该第一 CA证书进行验证，即对该VLR进行验证。</p>
    <p>[0090]	S403 ：该汇聚节点获取该第一 CA证书中携带的第一公钥，采用第二私钥对该第一随机数加密，并采用获取的该第一公钥对第二私钥加密后的第一随机数再进行加密。</p>
    <p>[0091]	当验证通过时，即确定该VLR合法时，该汇聚节点获取该第一 CA证书中携带的该第一公钥，采用该第二私钥对该第一随机数进行加密，并采用该第一公钥对加密后的第一随机数再进行加密。</p>
    <p>[0092]	S404 ：该汇聚节点确定该VLR为非法的VLR，拒绝向该VLR发送数据信息。</p>
    <p>[0093]	当验证不通过时，即确定该VLR非法时，该汇聚节点拒绝向该VLR发送数据信息。</p>
    <p>[0094]	S405:该汇聚节点将第二公钥携带在自身保存的第二 CA证书中，采用获取的该第一公钥对其自身的ID进行加密，对该第二 CA证书进行加密，并将加密后的ID、第二 CA证书，以及再加密后的第一随机数发送给VLR。</p>
    <p>[0095]	在本发明实施例中，为了进一步提高该汇聚节点发送的数据信息的安全性，该汇聚节点将自身保存的该第二公钥携带在第二 CA证书中，并采用该第一公钥对该第二 CA证书进行加密，将加密后的该第二 CA证书，以及步骤S403中该再加密后的第一随机数发送到该VLR。并且，为了防止非法的汇聚节点对VLR的攻击，该汇聚节点还要采用第一公钥对自身的ID加密，并将加密后的ID也发送给VLR。</p>
    <p>[0096]	S406 ：该VLR采用自身保存的第一私钥，对加密后的ID解密，获取该ID，验证该ID 的合法性，若验证通过，则进行步骤S407，否则进行步骤S412。</p>
    <p>[0097]	该VLR先采用第一私钥对加密后的ID解密，获取该汇聚节点的ID，并判断该ID是否合法。其中判断该汇聚节点的ID是否合法的方法可以为，根据该ID的位数、首字节或关键字段来验证该ID的合法性。</p>
    <p>[0098]	S407 ：该VLR采用自身保存的第一私钥，对加密后的该第二CA证书解密，获取该第二 CA证书，根据自身保存的CA公钥对获取的该第二 CA证书进行验证，若验证通过，则进行步骤S408，否则进行步骤S412。</p>
    <p>[0099]	当该VLR确定该汇聚节点的ID合法时，采用第一私钥对加密后的第二 CA证书进行解密，获取该第二 CA证书，并根据自身保存的CA公钥对该第二 CA证书进行验证，即进一步验证该汇聚节点是否安全。</p>
    <p>[0100]	S408:该VLR获取该第二 CA证书中携带的第二公钥，采用自身保存的第一私钥，对该加密后的第一随机数解密，并采用第二公钥，对解密后的第一随机数再解密。</p>
    <p>[0101]	当验证该第二 CA证书通过时，获取该第二 CA证书中携带的第二公钥，采用第一私钥对再加密后的第一随机数进行解密，并采用该第二公钥对解密后的第一随机数再进行解密，获得解密结果。</p>
    <p>[0102]	S409:该VLR判断解密结果与自身发送的该第一随机数是否相同，若相同，则进行步骤S410，否则进行步骤S412。</p>
    <p>[0103]	在本发明实施例中，该VLR根据获得的解密结果与自身发送的该第一随机数是否相同，判断该汇聚节点是否安全。</p>
    <p>[0104]	S410 ：该VLR采用第二公钥对第二随机数进行加密，将确认通知和加密后的第二随机数返回该汇聚节点。</p>
    <p>[0105]	当确定该解密结果与自身发送的第一随机数相同时，确定该汇聚节点安全，生成该确认通知和第二随机数，采用第二公钥对该第二随机数进行加密，将该确认通知和加密后的第二随机数发送给该汇聚节点。</p>
    <p>[0106]	S411 ：该汇聚节点接收该VLR返回的确认通知和加密后的第二随机数，采用自身保存的第二私钥对加密后的第二随机数解密，获取该第二随机数，采用该第二随机数对数据信息加密，并将加密后的数据信息发送给该VLR。</p>
    <p>[0107]	该汇聚节点接收到该确认通知后，采用第二私钥对该加密后的第二随机数进行解密，获取该第二随机数，采用该第二随机数对待发送的数据信息加密，并将加密后的数据信息发送给该VLR，即该VLR与该汇聚节点约定采用该第二随机数作为后续的会话密钥。</p>
    <p>[0108]	S412:确定该汇聚节点不安全，拒绝接收该汇聚节点发送的数据信息。</p>
    <p>[0109]	当该VLR确定该汇聚节点的ID不合法时，或验证该第二 CA证书不通过时，或确定该解密结果与自身发送的第一随机数不相同时，确定该汇聚节点不安全，拒绝接收该汇聚节点发送的数据信息。</p>
    <p>[0110]	其中，上述过程中的第一公钥和第一私钥为该VLR根据ECC算法生成并保存的，第二公钥和第二私钥为该汇聚节点根据ECC算法生成并保存的，其相应的加密和解密算法也是根据ECC算法进行加密和解密的。</p>
    <p>[0111]	在上述过程中，汇聚节点接收VLR返回的第一随机数，采用自身保存的第二私钥对该第一随机数加密，并将自身保存的第二公钥及加密后的第一随机数返回，该VLR采用第二公钥对加密后的第一随机数进行解密，根据解密结果是否与自身发送的该第一随机数相同，判断该汇聚节点是否安全，当确定安全时，接收该汇聚节点发送的数据信息。由于本发明实施例中采用该第二私钥进行加密的第一随机数，只能采用该第二公钥解密，如果该第二公钥被非法的汇聚节点窃取，则该非法的汇聚节点采用窃取的第二公钥对该第一随机数进行加密后，VLR不能采用该第二公钥对加密后的第一随机数进行解密，从而不能正确的获取该第一随机数，拒绝该非法的汇聚节点发送的数据信息，因此提高了该汇聚节点发送给该VLR的数据信息的安全性。</p>
    <p>[0112]	并且，为了防止非法的汇聚节点对VLR的攻击，导致该VLR因数据积压而瘫痪，该汇聚节点还向该VLR发送其自身的ID，该VLR验证该ID的合法性，当验证通过时才进行后续的步骤，否则确定该汇聚节点不安全，拒绝接收该汇聚节点发送的数据信息。</p>
    <p>[0113]	同时，该VLR还向该汇聚节点返回第一 CA证书，该汇聚节点在验证该第一 CA证书通过后，确定该VLR合法，获取该第一 CA证书中携带的第一公钥，采用该第一公钥对自身的 ID和携带第二公钥的第二 CA证书进行加密，并对第二私钥加密后的第一随机数再进行加密，将加密后的ID和第二 CA证书，以及再加密后的第一随机数返回该VLR，该VLR在确定该汇聚节点的ID和第二 CA证书合法后，采用相应的解密方式对该再加密后的第一随机数进行解密，获得解密结果，再根据该解密结果与该第一随机数是否相同，判断该汇聚节点是否安全，进一步提高了该汇聚节点发送的数据信息的安全性。</p>
    <p>[0114]	另外，上述过程中的第一公钥、第一私钥、第二公钥和第二私钥均为根据ECC算法生成的，由于该汇聚节点能够有效的支持该ECC算法，因此提高了该汇聚节点与移动通信网络间的通信效率。</p>
    <p>[0115]	图5为本发明实施例提供的汇聚节点与移动通信网络间的通信系统，具体包括：</p>
    <p>[0116]	汇聚节点501，用于向拜访位置寄存器VLR502发送入网登记请求，并接收所述 VLR502根据所述入网登记请求返回的第一随机数，采用自身保存的第二私钥对所述第一随机数加密，将自身保存的第二公钥以及加密后的第一随机数发送到所述VLR502，当接收到 VLR502返回的确认通知后，向所述VLR502发送数据信息，其中所述确认通知为所述VLR502 采用接收到的第二公钥，对加密后的第一随机数解密，且解密结果与所述VLR自身发送的第一随机数相同时发送的；</p>
    <p>[0117]	VLR502，用于接收所述汇聚节点501发送的所述入网登记请求，根据所述入网登记请求向所述汇聚节点501返回所述第一随机数，接收汇聚节点501发送的所述第二公钥以及所述加密后的第一随机数，采用接收到的第二公钥，对加密后的第一随机数解密，且解密结果与自身发送的第一随机数相同时，向所述汇聚节点501发送所述确认通知，并接收所述汇聚节点501发送的数据信息。</p>
    <p>[0118]	所述汇聚节点501具体用于，接收所述VLR502返回的第一数字证书认证中心CA 证书，根据自身保存的CA公钥，及接收到的所述第一 CA证书，对所述VLR502进行验证，当对所述VLR502验证通过时，获取所述第一 CA证书中携带的第一公钥，采用第二私钥对所述第一随机数加密，并采用获取的所述第一公钥对第二私钥加密后的第一随机数再进行加密；</p>
    <p>[0119]	所述VLR502还用于，向所述汇聚节点501返回所述第一 CA证书。</p>
    <p>[0120]	图6为本发明实施例提供的汇聚节点与移动通信网络间的通信装置，具体包括：</p>
    <p>[0121]	发送模块601，用于向拜访位置寄存器VLR发送入网登记请求，将自身保存的第二公钥以及加密后的第一随机数发送到所述VLR，并当接收到VLR返回的确认通知后，向所述 VLR发送数据信息，其中所述确认通知为所述VLR采用接收到的第二公钥，对加密后的第一随机数解密，且解密结果与所述VLR自身发送的第一随机数相同时发送的；</p>
    <p>[0122]	接收模块602，用于接收所述VLR根据所述入网登记请求返回的第一随机数，并接收VLR返回的所述确认通知；</p>
    <p>[0123]	加密模块603，用于采用自身保存的第二私钥对所述第一随机数加密。</p>
    <p>[0124]	图7为本发明实施例提供的汇聚节点与移动通信网络间的通信装置，具体包括：</p>
    <p>[0125]	接收模块701，用于接收汇聚节点发送的入网登记请求，接收所述汇聚节点发送的第二公钥以及加密后的第一随机数，并接收所述汇聚节点发送的数据信息；</p>
    <p>[0126]	发送模块702，用于根据所述入网登记请求向所述汇聚节点返回第一随机数，并在</p>
    <p>13确定解密结果与自身发送的所述第一随机数相同时，向所述汇聚节点返回确认通知；</p>
    <p>[0127]	解密模块703，用于采用接收到的第二公钥，对加密后的第一随机数解密；</p>
    <p>[0128]	判断模块704，用于判断解密结果是否与自身发送的所述第一随机数相同。</p>
    <p>[0129]	本发明实施例提供一种汇聚节点与移动通信网络间的通信方法、系统及装置，该方法汇聚节点接收VLR返回的第一随机数，采用自身保存的第二私钥对该第一随机数加密，并将自身保存的第二公钥及加密后的第一随机数返回，该VLR采用第二公钥对加密后的第一随机数进行解密，当解密结果与该第一随机数相同时，接收该汇聚节点发送的数据信息。由于本发明实施例中汇聚节点采用第二私钥对第一随机数加密，该VLR采用第二公钥对加密后的第一随机数解密，并根据解密结果是否与该第一随机数相同，判断该汇聚节点是否安全，当安全时接收该汇聚节点发送的数据信息，提高了该汇聚节点发送给该VLR 的数据信息的安全性。</p>
    <p>[0130]	显然，本领域的技术人员可以对本发明进行各种改动和变型而不脱离本发明的精神和范围。这样，倘若本发明的这些修改和变型属于本发明权利要求及其等同技术的范围之内，则本发明也意图包含这些改动和变型在内。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101114901A?cl=zh">CN101114901A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2006年7月26日</td><td class="patent-data-table-td patent-date-value">2008年1月30日</td><td class="patent-data-table-td ">联想(北京)有限公司</td><td class="patent-data-table-td ">非接触式无线数据传输的安全认证系统、设备及方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20100034377">US20100034377</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2008年12月5日</td><td class="patent-data-table-td patent-date-value">2010年2月11日</td><td class="patent-data-table-td ">Universiti Putra Malaysia</td><td class="patent-data-table-td ">Chaotic asymmetric encryption process for data security</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=U0mMBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04W0012020000">H04W12/02</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=U0mMBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04W0012040000">H04W12/04</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=U0mMBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04W0008020000">H04W8/02</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2012年5月30日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年7月11日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2014年5月28日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Grant of patent or utility model</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/9bae086c3a69e3b38231/CN102480713A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E6%B1%87%E8%81%9A%E8%8A%82%E7%82%B9%E4%B8%8E%E7%A7%BB%E5%8A%A8%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C.pdf?id=U0mMBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U2DBR0xOocf9HMjacVXB7sjAnJZhA"},"sample_url":"https://www.google.com/patents/reader?id=U0mMBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>