<!DOCTYPE html><html><head><title>专利 CN101977190A - 数字内容加密传送方法以及服务器端 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="数字内容加密传送方法以及服务器端"><meta name="DC.contributor" content="王浩" scheme="inventor"><meta name="DC.contributor" content="郑保夏" scheme="inventor"><meta name="DC.contributor" content="陈滨" scheme="inventor"><meta name="DC.contributor" content="北京中科联众科技有限公司" scheme="assignee"><meta name="DC.date" content="2010-10-25" scheme="dateSubmitted"><meta name="DC.description" content="本发明提供一种数字内容加密传送方法以及一种用于以加密方式提供数字内容的服务器端，其中，由服务器端向客户端提供数字内容，其特征在于，所述服务器端以与所述客户端的硬件ID有关的方式来加密数字内容，并且所述数字内容加密传送方法依次包括：数字内容划分步骤、初始加密步骤、后续加密步骤、换码控制器生成步骤和解密步骤。本发明的优点在于，在验证过程中和加密过程中均利用了客户端的硬件ID信息，一方面保证了通信过程中的安全性，另一方面提高了加密效率。"><meta name="DC.date" content="2011-2-16"><meta name="DC.relation" content="CN:101207794:A" scheme="references"><meta name="DC.relation" content="CN:101729550:A" scheme="references"><meta name="DC.relation" content="US:6892306" scheme="references"><meta name="citation_patent_publication_number" content="CN:101977190:A"><meta name="citation_patent_application_number" content="CN:201010518019"><link rel="canonical" href="https://www.google.com/patents/CN101977190A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101977190A?cl=zh"/><meta name="title" content="专利 CN101977190A - 数字内容加密传送方法以及服务器端"/><meta name="description" content="本发明提供一种数字内容加密传送方法以及一种用于以加密方式提供数字内容的服务器端，其中，由服务器端向客户端提供数字内容，其特征在于，所述服务器端以与所述客户端的硬件ID有关的方式来加密数字内容，并且所述数字内容加密传送方法依次包括：数字内容划分步骤、初始加密步骤、后续加密步骤、换码控制器生成步骤和解密步骤。本发明的优点在于，在验证过程中和加密过程中均利用了客户端的硬件ID信息，一方面保证了通信过程中的安全性，另一方面提高了加密效率。"/><meta property="og:title" content="专利 CN101977190A - 数字内容加密传送方法以及服务器端"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101977190A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101977190A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=9a6OBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101977190A&amp;usg=AFQjCNGURNsTF-gi3oPqzc55lKEd55MjUw" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/4b3253ed9583424b9998/CN101977190A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/4b3253ed9583424b9998/CN101977190A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101977190A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101977190A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN101977190A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN101977190B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101977190A?cl=zh" style="display:none"><span itemprop="description">本发明提供一种数字内容加密传送方法以及一种用于以加密方式提供数字内容的服务器端，其中，由服务器端向客户端提供数字内容，其特征在于，所述服务器端以与所述客户端的硬件ID有关的方式来加密数字内容，并且所述数 ...</span><span itemprop="url">https://www.google.com/patents/CN101977190A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101977190A - 数字内容加密传送方法以及服务器端</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101977190A - 数字内容加密传送方法以及服务器端" title="专利 CN101977190A - 数字内容加密传送方法以及服务器端"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101977190 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201010518019</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2011年2月16日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2010年10月25日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2010年10月25日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101977190B?hl=zh-CN&amp;cl=zh">CN101977190B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201010518019.7, </span><span class="patent-bibdata-value">CN 101977190 A, </span><span class="patent-bibdata-value">CN 101977190A, </span><span class="patent-bibdata-value">CN 201010518019, </span><span class="patent-bibdata-value">CN-A-101977190, </span><span class="patent-bibdata-value">CN101977190 A, </span><span class="patent-bibdata-value">CN101977190A, </span><span class="patent-bibdata-value">CN201010518019, </span><span class="patent-bibdata-value">CN201010518019.7</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%8E%8B%E6%B5%A9%22">王浩</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%83%91%E4%BF%9D%E5%A4%8F%22">郑保夏</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%99%88%E6%BB%A8%22">陈滨</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E5%8C%97%E4%BA%AC%E4%B8%AD%E7%A7%91%E8%81%94%E4%BC%97%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">北京中科联众科技有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101977190A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101977190A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101977190A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (3),</span> <span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (7),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (1),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=9a6OBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201010518019&amp;usg=AFQjCNFWPF8TLbeANZnl1i6YClZLY6PBMQ"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=9a6OBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101977190A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNGzBAxiCbgOAeLGLEitcpQoKKHBUw"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT101216464" lang="ZH" load-source="patent-office">数字内容加密传送方法以及服务器端</invention-title>
      </span><br><span class="patent-number">CN 101977190 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA83328772" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明提供一种数字内容加密传送方法以及一种用于以加密方式提供数字内容的服务器端，其中，由服务器端向客户端提供数字内容，其特征在于，所述服务器端以与所述客户端的硬件ID有关的方式来加密数字内容，并且所述数字内容加密传送方法依次包括：数字内容划分步骤、初始加密步骤、后续加密步骤、换码控制器生成步骤和解密步骤。本发明的优点在于，在验证过程中和加密过程中均利用了客户端的硬件ID信息，一方面保证了通信过程中的安全性，另一方面提高了加密效率。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(9)</span></span></div><div class="patent-text"><ol mxw-id="PCLM35097283" lang="ZH" load-source="patent-office" class="claims">
    <li class="claim"> <div num="1" class="claim">
      <div class="claim-text">一种数字内容加密传送方法，其中，由服务器端向客户端提供数字内容，并且所述服务器端以与所述客户端的硬件ID有关的方式来加密数字内容，其特征在于，所述数字内容加密传送方法依次包括：数字内容划分步骤、初始加密步骤、后续加密步骤、换码控制器生成步骤和解密步骤；在所述数字内容划分步骤中，按照一预定顺序或一预定时序将数字内容划分成多个内容块；在所述初始加密步骤中，利用与客户端的硬件ID有关的信息作为初始加密密钥，加密数字内容的第一内容块以得到第一密文内容块；在所述后续加密步骤中，以第一密文内容块为第二加密密钥来加密数字内容的第二内容块以得到第二密文内容块，随后以第二密文内容块为第三加密密钥来加密数字内容的第三内容块以得到第三密文内容块，以此类推直至全部数字内容均被加密为止；在所述换码控制器生成步骤中，由所述服务器端读取经过加密的所述第一密文内容块指定位置的值并生成识别码，并且所述服务器端记录对应于所述第一密文内容块的顺序或时序作为时间戳，并且所述服务器端将所述识别码和所述时间戳记录在换码控制器中；以此类推，直到所述服务器端将针对各个密文内容块的所有所述识别码和所述时间戳均记录在所述换码控制器中为止，随后所述服务器端将所述换码控制器发送到所述客户端；在所述解密步骤中，所述客户端利用所述与客户端的硬件ID有关的信息作为初始解密密钥，通过所述换码控制器的所述识别码、所述时间戳找到各个密文内容块的位置和所述顺序或时序，随后利用所述初始解密密钥对所述第一密文内容块进行解密以得到所述第一内容块，随后通过所述第二密文内容块的所述识别码、所述时间戳找到所述第二密文内容块的位置和所述顺序或时序并利用所述第一内容块对所述第二密文内容块进行解密以得到所述第二内容块，然后对所述第一内容块和第二内容块按所述顺序或时序进行组合，再利用所述第二内容块对所述第三密文内容块进行解密以得到所述第三内容块，并按所述顺序或时序与所述第一内容块和所述第二内容块组合，以此类推，直到所有密文内容均被解密并按所述顺序或时序组合，最终所述客户端得到所述数字内容的明文。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.如权利要求1所述的数字内容加密传送方法，其特征在于，在所述数字内容划分步 骤之前还包括注册步骤，其中，所述客户端将其硬件ID信息发送给所述服务端，所述服务 端记录所述硬件ID信息，并且所述服务器端生成私有密钥和公共密钥，所述服务器端将所 述私有密钥发送给所述客户端，并且将所述私有密钥和所述公共密钥储存在所述服务器 端。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.如权利要求2所述的数字内容加密传送方法，其特征在于，在所述注册步骤之后、所述数字内容划分步骤之前，所述数字内容加密传送方法还包 括服务请求步骤， 其中，所述客户端利用所述私有密钥来加密服务请求消息，所述服务请求消息包括所述客户 端的硬件ID信息和所述客户端对数字内容的请求消息，随后所述客户端将加密后的所述 服务请求消息发送至所述服务器端；所述服务器端利用所述公共密钥来解密加密后的所述服务请求消息，以得到所述客户 端的硬件ID信息和所述客户端对数字内容的请求消息。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.如权利要求3所述的数字内容加密传送方法，其特征在于，在所述服务请求步骤之 后，所述数字内容加密传送方法还包括硬件ID匹配步骤，其中，在所述服务器端通过解密所述服务请求消息得到所述客户端的硬件ID信息和所述客 户端对数字内容的请求消息后，所述服务器端对硬件ID信息与由其存储的所述硬件ID信 息进行比较。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.如权利要求4所述的数字内容加密传送方法，其特征在于，在所述硬件ID匹配步骤之后，所述数字内容加密传送方法还包括初始加密密钥生成 步骤，其中，如果由所述服务器端接收到的硬件ID信息与所述服务器端预先存储的硬件ID信息彼 此匹配，则所述服务器端生成授权密钥，将所述授权密钥发送给所述客户端，并且所述服务 器端利用所述授权密钥来加密所述硬件ID信息以得到所述初始加密密钥。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.如权利要求1至5之一所述的数字内容加密传送方法，其中，由服务器端向客户端提 供数字内容，其特征在于，所述客户端以与其硬件ID有关的方式来解密由所述服务器端发 送的数字内容。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.如权利要求5所述的数字内容加密传送方法，其特征在于，所述方法还包括许可证 生成步骤，其中，所述服务端利用所述公共密钥来加密所述初始加密密钥从而生成许可证，并将 所述许可证发送给所述客户端；所述客户端利用所述私有密钥来解密接收到的经过加密的所述许可证得到所述初始 加密密钥，作为所述客户端的初始解密密钥。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.如权利要求7所述的数字内容加密传送方法，其特征在于，在所述许可证生成步骤之后，所述客户端利用所接收到的授权密钥对所述初始解密密 钥进行解密，从而得到硬件ID信息，所述客户端将通过解密得到的硬件ID信息与其自己的 硬件ID信息相互比较；如果所述客户端的硬件ID信息与通过解密所述初始解密密钥得到的硬件ID信息彼此 匹配，那么所述客户端利用所述初始解密密钥执行所述解密步骤。</div>
    </div>
    </li> <li class="claim"> <div num="9" class="claim">
      <div class="claim-text">9.	一种用于以加密方式提供数字内容的服务器端，其包括：用户管理模块、授权模块 和内容模块，所述用户管理模块负责客户端在所述服务器端的注册任务，并且负责存储所述客户端 的硬件ID信息，在客户端注册成功之后，所述用户管理模块生成私有密钥和公共密钥，并 且所述用户管理模块将所述私有密钥发送给所述客户端，并且将所述私有密钥和所述公共 密钥储存在所述用户管理模块中，同时所述用户管理模块还负责利用硬件ID信息来认证 客户端，仅当认证通过后，所述用户管理模块才将所述公共密钥发放给所述授权模块；所述授权模块负责响应于客户端的请求，利用所述公共密钥来解密所接收到的服务 请求消息，以便得到所述硬件ID信息和所述客户端所数字内容请求，并且所述授权模块向 所述用户管理模块提交所述硬件ID信息，仅当与所述用户管理模块存储的硬件ID信息匹 配一致时，所述授权模块才生成授权密钥并且将所述授权密钥发送给所述客户端，所述授 权模块利用所述授权密钥来加密所述硬件ID信息以得到初始加密密钥；并且所述授权模 块能够利用所述公共密钥来加密所述初始加密密钥从而生成许可证，并且将所述许可证发送给所述客户端，并且所述授权模块还将所述客户端对数字内容的请求转发给所述内容模 块；其特征在于，所述内容模块负责响应于所述客户端的所述请求对由所述授权模块转发来的所述客 户端所请求的数字内容进行分块，并利用所述初始加密密钥对多个内容块按照预定顺序或 时序进行依次加密以得到多个密文内容块，并且负责将这些密文内容块发送至所述客户 端，同时所述内容模块还读取经过加密的所述第一密文内容块指定位置的值并生成识别 码，并且记录对应于所述第一密文内容块的顺序或时序作为时间戳，依次类推，直到所述服 务器端将所有所述识别码和所述时间戳记录在换码控制器中为止，随后所述服务器端将所 述换码控制器发送到所述客户端。</div>
    </div>
  </li> </ol>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES40938034" lang="ZH" load-source="patent-office" class="description">
    <p>数字内容加密传送方法以及服务器端</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及一种数字内容加密传送方法以及一种用于以加密方式提供数字内容 的服务器端。</p>
    <p>背景技术</p>
    <p>[0002]	随着互联网的飞速发展和普及，广大用户越来越多地通过互联网进行数椐的传 输、资源的发布以及资源的下载等。从网上下载音乐、下载影视剧或者下载电脑软件等各 种数字资源早已屡见不鲜。互联网的高速发展固然方便了用户对信息快速获取的需求，但 另一方面也对各种数字资源的版权保护带来了挑战。在日常生活中，提供未经授权的音乐 资源、影视剧资源、软件资源的网站多种多样，用户可以很方便地从这些网站得到免费的盗 版资源。而电驴（eMule)软件等P2P软件的广泛普及和应用，进一步方便了盗版资源的扩 散，为版权保护带来了更大的难度。互联网上盗版资源的肆意传播固然与广大用户的法律 意识不高有关，但和正版数字资源缺乏相应的版权管理系统不无关系。现有技术中虽然也 存在对数字资源的版权保护方法，如对数字资源做加密、为数字内容的获取者做认证等，但 这些方法没有在一个完整的版权管理系统中实现，使得现有方法虽然实现了对数字资源的 保护，但同时也不便于合法用户通过合法手段对数字资源的获取。此外，数字资源的拥有者 若要在网上安全地发布数字资源，以扩大其商业影响，同样也需要有一个安全、可靠的版权 管理系统。数字版权管理（Digital Right Management，简称DRM)是随着数字音视频节目 等数字媒体节目在互联网等环境中的广泛传播而发展起来的一种与应用需求相关的新技 术。DRM通常会采用加密技术：对于经过编码压缩处理的数字化节目，建立数字节目授权中 心（License Issuer)，利用密钥对节目中需要保护的内容进行加密。用户回放上述节目时， 需要得到数字节目授权中心的提供相关密钥对节目进行解密，方可播放。由于节目是被加 密的，即使被用户下载保存并散播给他人，如果没有得到数字节目授权中心的验证授权也 无法回放，从而保护了节目的版权。在DRM条件下，只具有解码功能的媒体处理装置已不再 适用，而需要在解码的基础上加入解密功能。现有技术中，有一种具有解密功能的媒体处理 器，该处理器的解密模块和解码模块独立地处于两个装置上，例如，解密模块和解码模块分 属独立的两块芯片或软件，解密后的媒体数据流在解码前仍然可能会被非法截取。现有技 术中，还有一种媒体处理器，该处理器的解密和解码功能模块集中在一个装置内，这样，解 密后的媒体数据流可以有效地受到保护，但是在此种装置中，来自外界（通常是数字节目 授权中心）的密钥仍有可能被窃取，需要专门的解决办法。</p>
    <p>[0003]	另一方面，在流媒体各种相关业务的开展中，流媒体内容易于复制和分发，当缺少 安全措施来保护流媒体内容时，盗版问题就不可避免的出现。由此引入了流媒体加密保护 技术，通过对流媒体内容的加密保护，内容提供商可以保护自己的内容并控制内容的分发。 CA系统（Conditional Access System，条件接收系统）是现行的流媒体加密保护系统之 一，它通过对流媒体内容的加密和访问控制实现对流媒体内容的保护。CA系统主要产生两 类报文，其一是ECM(Entitlement Control Message，授权控制信息）报文，又称授权控制信息，它是一种特殊形式的电子密钥信号，它在发送端被加密后与流媒体内容一道传送至接 收端，在接收端，ECM被用来控制解扰器。另一种是EMM (Ent i 11 ement Management Message， 授权管理信息）报文，又称授权管理信息，它是一种授权某个或某些用户对某个或某些业 务进行解扰的信息。它与授权控制信息一样，在发送端被加密后与流媒体内容一道传送至 接收端。</p>
    <p>[0004]	由于对流媒体内容的加密保护大大提高了流媒体内容的安全性，从一定程度上遏 制了盗版，保护了内容提供商和运营商的利益，所以该项技术已经得到广泛应用。下面说明 现有技术中提供的流媒体内容的加密保护方案。在现有技术中已经公开了这样一种技术方 案，其中，实时流媒体业务在经过加密设备加密后立即通过传输网络到达用户终端设备。从 流媒体内容源发出的媒体内容经过CA系统、加密设备及其它相关设备的处理，生成流媒体 内容密文，流媒体内容密文经过传输网络到达终端设备。其中流媒体加密设备可为CA系统 的一部分，具体视各产商的实现而定。</p>
    <p>[0005]	根据现有技术还已知这样一种解决方案，其中，非实时流媒体业务中媒体内容在 经过加密保护后会存储在网络存储设备上，待用户需要收看该媒体内容时，终端设备从网 络存储设备上申请并获取相关媒体内容密文，该网络存储设备一般称为流服务器端。非实 时流媒体内容在加密后没有直接通过网络传输给终端设备，而是以文件的形式存储到流服 务器端上，ECM与媒体内容同时存储到流服务器端上，并按一定的时序与媒体内容存储在同 一个文件里。</p>
    <p>[0006]	由于现有数字版权保护技术通常只考虑了数字内容在服务器上的安全存储和密 钥在传输过程的安全性，对版权的保护随着解密密钥安全地发送到授权用户就停止了，没 有保证媒体数据在读取过程中及读取结束后的安全性。该一般框架对数字内容的加密是静 态的、一次性的，经过一次破解则数字内容完全暴露，安全系数比较低。</p>
    <p>发明内容</p>
    <p>[0007]	针对上述现有技术中存在的问题，本发明提出一种数字内容加密传送方法以及一 种用于以加密方式提供数字内容的服务器端，通过利用该方法和该服务器端能够更为安全 地发送数字内容。</p>
    <p>[0008]	为了达到本发明的这种目的，根据本发明的一个优选实施方式公开了一种数字内 容加密传送方法，其中，由服务器端向客户端提供数字内容，所述服务器端以与所述客户端 的硬件ID有关的方式来加密数字内容。在该优选实施方式中，数字内容是由服务器端预先 保存或者该服务器端能够从其他服务器处调用并加以处理的。在本文中“与客户端的硬件 ID有关的方式”意指：将客户端的硬件ID信息直接或间接用于加密，其中，可以将硬件ID 信息全部直接作为加密密钥，也可以将其中的部分作为加密密钥，或者也可以将硬件ID信 息加以处理（逻辑运算或算术运算）。客户的硬件ID信息包括但不限于：CPU ID信息、硬 盘卷号信息、BIOS信息、网卡MAC地址、IP地址、其他可采集的硬件编码或以上信息的组合。</p>
    <p>[0009]	根据本发明的一个优选实施方式，所述数字内容加密传送方法依次包括：数字内 容划分步骤、初始加密步骤、后续加密步骤、换码控制器生成步骤和解密步骤；在所述数字 内容划分步骤中，按照一预定顺序或一预定时序将数字内容划分成多个内容块；在所述初 始加密步骤中，利用与客户端的硬件ID有关的信息作为初始加密密钥，加密数字内容的第</p>
    <p>6一内容块以得到第一密文内容块；在所述后续加密步骤中，以第一密文内容块为第二加密 密钥来加密数字内容的第二内容块以得到第二密文内容块，随后以第二密文内容块为第三 加密密钥来加密数字内容的第三内容块以得到第三密文内容块，以此类推直至全部数字内 容均被加密为止；在所述换码控制器生成步骤中，由所述服务器端读取经过加密的所述第 一密文内容块指定位置的值并生成识别码，并且所述服务器端记录对应于所述第一密文内 容块的顺序或时序作为时间戳，并且所述服务器端将所述识别码和所述时间戳记录在换码 控制器中，以此类推，直到所述服务器端将针对各个密文内容块的所有所述识别码和所述 时间戳均记录在所述换码控制器中为止，随后所述服务器端将所述换码控制器发送到所述 客户端；在所述解密步骤中，所述客户端利用所述与客户端的硬件ID有关的信息作为初 始解密密钥，通过所述换码控制器的所述识别码和所述时间戳找到各个密文内容块的位置 和所述顺序或时序，随后利用所述初始解密密钥对所述第一密文内容块进行解密以得到所 述第一内容块，随后通过所述第二密文内容块的所述识别码和所述时间戳找到所述第二密 文内容块的位置和所述顺序或时序并利用所述第一内容块对所述第二密文内容块进行解 密以得到所述第二内容块，然后对所述第一内容块和第二内容块按所述顺序或时序进行组 合，再利用所述第二内容块对所述第三密文内容块进行解密以得到所述第三内容块，并按 所述顺序或时序与所述第一内容块和所述第二内容块组合，以此类推，直到所有密文内容 均被解密并按所述顺序或时序组合，最终所述客户端得到所述数字内容的明文。</p>
    <p>[0010]	在该优选实施方式中，数字内容划分步骤、初始加密步骤、后续加密步骤、换码控 制器生成步骤和解密步骤是依次执行的，但是在各个步骤之间和第一步骤之前还可以增加 额外的方法步骤。在数字内容划分步骤中，若所请求的数字内容是如文本信息、PDF格式 文件、JPG图片这样的静态数字内容，那么可以按照预定顺序来划分该数字内容；若所请求 的数字内容是如在线流媒体这样的流式数字内容，那么可以按照预定时序来划分该数字内 容。当然本发明不限于这两种方式，而是可以采用各种本领域技术人员常见的方式来划分 这些数字内容。例如可以采用中国专利申请200510021479中所提到的数据分块方法，以及 在《计算机科学》2004年08期中公开的一种基于数据分块的快速原地归并算法。客户端接 收分块加密后的密文内容块并对其进行排列，属于本领域技术人员已知的技术。此处，例如 可以采用增加索引的方式来实现；也可以通过约定规则，由服务器端向客户端提供各个密 文内容块的特征；据此，客户端可以在接收到相应的各个密文内容块之后，依据所述约定规 则来排列各个密文内容块。并且按照加密的“逆顺序”对各个密文内容块进行解密。</p>
    <p>[0011]	根据本发明的一个优选实施方式，在所述数字内容划分步骤之前还包括注册步 骤，其中，所述客户端将其硬件ID信息发送给所述服务端，所述服务端记录所述硬件ID信 息，并且所述服务器端生成私有密钥和公共密钥，所述服务器端将所述私有密钥发送给所 述客户端，并且将所述私有密钥和所述公共密钥储存在所述服务器端。在该优选实施方式 中，采用了额外的注册步骤，预先注册有利于后期的鉴权，保证了请求的针对性和有效性。 采用私有密钥和公共密钥这种非对称加密方式，进一步提升了安全性。当然在此处，本发明 也可以采用对称密钥。</p>
    <p>[0012]	根据本发明的一个优选实施方式，在所述注册步骤之后、所述数字内容划分步骤 之前，所述数字内容加密传送方法还包括服务请求步骤，其中，所述客户端利用所述私有密 钥来加密服务请求消息，所述服务请求消息包括所述客户端的硬件ID信息和所述客户端</p>
    <p>7对数字内容的请求消息，随后所述客户端将加密后的所述服务请求消息发送至所述服务器 端；所述服务器端利用所述公共密钥来解密加密后的所述服务请求消息，以得到所述客户 端的硬件ID信息和所述客户端对数字内容的请求消息。在该优选实施方式中，在服务请求 步骤中利用了硬件ID信息，在鉴权过程中这种方式可靠且快速。</p>
    <p>[0013]	根据本发明的一个优选实施方式，在所述服务请求步骤之后，所述数字内容加密 传送方法还包括硬件ID匹配步骤，其中，在所述服务器端通过解密所述服务请求消息得到 所述客户端的硬件ID信息和所述客户端对数字内容的请求消息后，所述服务器端对硬件 ID信息与由其存储的所述硬件ID信息进行比较。在该优选实施方式中，利用硬件ID信息 进行鉴权，而硬件ID信息是经加密发送给服务器端的。服务器端在接收到服务请求消息 时，如何判断该服务请求消息来自哪个客户端属于现有技术，简明起见不再重复。服务器端 在利用公有密钥解密后，才能够得到硬件ID信息，在这一过程中可以明确判断出该客户端 是否为“假冒的”客户端。</p>
    <p>[0014]	根据本发明的一个优选实施方式，在所述硬件ID匹配步骤之后，所述数字内容加 密传送方法还包括初始加密密钥生成步骤，其中，如果由所述服务器端接收到的硬件ID信 息与所述服务器端预先存储的硬件ID信息彼此匹配，则所述服务器端生成授权密钥，将所 述授权密钥发送给所述客户端，并且所述授权模块利用所述授权密钥来加密所述硬件ID 信息以得到所述初始加密密钥。此处具体规定了一种优选的初始加密密钥生成方式，但本 发明不限于这种方式，而是只要能够将硬件ID信息间接地用于生成初始加密密钥，就落入 本发明的保护范围。</p>
    <p>[0015]	在根据本发明的由服务器端向客户端提供数字内容的数字内容加密传送方法中， 其中，所述客户端以与其硬件ID有关的方式来解密由所述服务器端发送的数字内容。这种 解密方式是根据本发明加密方式的“逆运算”。这里，客户端也按照“与其硬件ID有关的方 式”来执行解密操作。此处，服务器端如何处理客户端的硬件ID信息以用于加密，则客户端 也相应地处理客户端的硬件ID信息以用于解密。</p>
    <p>[0016]	根据本发明的一个优选实施方式，所述方法还包括许可证生成步骤，其中，所述服 务端利用所述公共密钥来加密所述初始加密密钥从而生成许可证，并将所述许可证发送给 所述客户端；所述客户端利用所述私有密钥来解密接收到的经过加密的所述许可证得到所 述初始加密密钥，作为所述客户端的初始解密密钥。采用许可证可以进一步增强安全性。也 可以不采用许可证，而是由服务器端直接向客户端发送初始加密密钥。</p>
    <p>[0017]	根据本发明的一个优选实施方式，在所述许可证生成步骤之后，所述客户端利用 所接收到的授权密钥对所述初始解密密钥进行解密，从而得到硬件ID信息，所述客户端将 通过解密得到的硬件ID信息与其自己的硬件ID信息相互比较；如果所述客户端的硬件ID 信息与通过解密所述初始解密密钥得到的硬件ID信息彼此匹配，那么所述客户端利用所 述初始解密密钥执行所述解密步骤。按照该优选实施方式，客户端可以在执行解密之前，先 行判断所接收的数字内容是否是错误地发送给它的错误内容。从而避免了耗时耗力地解 密，而又得到无法使用的数字内容的情况。</p>
    <p>[0018]	根据本发明的另一个方面，本发明还公开了一种用于以加密方式提供数字内容的 服务器端，其包括：用户管理模块、授权模块内容模块和换码控制器，其中，所述用户管理模 块负责客户端在所述服务器端的注册任务，并且负责存储所述客户端的硬件ID信息，在客户端注册成功之后，所述用户管理模块生成私有密钥和公共密钥，并且所述用户管理模块 将所述私有密钥发送给所述客户端，并且将所述私有密钥和所述公共密钥储存在所述用户 管理模块中，同时所述用户管理模块还负责利用硬件ID信息来认证客户端，仅当认证通过 后，所述用户管理模块才将所述公共密钥发放给所述授权模块；所述授权模块负责响应于 客户端的请求，利用所述公共密钥来解密所接收到的服务请求消息，以便得到所述硬件ID 信息和所述客户端所数字内容请求，并且所述授权模块向所述用户管理模块提交所述硬件 ID信息，仅当与所述用户管理模块存储的硬件ID信息匹配一致时，所述授权模块才生成 授权密钥并且将所述授权密钥发送给所述客户端，并且所述授权模块利用所述授权密钥来 加密所述硬件ID信息以得到初始加密密钥；并且所述授权模块能够利用所述公共密钥来 加密所述初始加密密钥从而生成许可证，并且将所述许可证发送给所述客户端，并且所述 授权模块还将所述客户端对数字内容的请求转发给所述内容模块；所述内容模块负责响应 于所述客户端的所述请求对由所述授权模块转发来的所述客户端所请求的数字内容进行 分块，并利用所述初始加密密钥对多个内容块按照预定顺序或时序进行依次加密以得到多 个密文内容块，并且负责将这些密文内容块发送至所述客户端，同时所述内容模块还读取 经过加密的所述第一密文内容块指定位置的值并生成识别码，并且记录对应于所述第一密 文内容块的顺序或时序作为时间戳，依次类推，直到所述服务器端将所有所述识别码和所 述时间戳记录在换码控制器中为止，随后所述服务器端将所述换码控制器发送到所述客户 端。</p>
    <p>[0019]	本发明所公开的方法和设备利用数据分割技术将数字内容分割为多个块，利用 “与客户端的硬件ID有关的信息”对各个内容块依次加密和解密。最终加密数字内容分块 传输，即便被黑客窃取也必须先分析加密原理后再对数字内容块重新排序，逐个破解，攻破 难度随内容块数成倍提高。此外本方法还纳入了用户硬件ID的校验过程，进一步防止了非 法拷贝和非法传播。本方法利用硬件信息绑定技术解决了传统技术仅对版权的保护随着解 密密钥安全地发送到授权用户即停止的弊端，利用分块换码多路复用技术解决了传统技术 对数字内容的加密是静态的、一次性的，经过一次破解则数字内容完全暴露的弊端，实现了 数字内容在传播全过程中的高安全性，防止非法拷贝和非法传播、篡改。</p>
    <p>[0020]	尽管本文仅描述了本发明上述实施方式中的一种或几种组合方式，但并不意味着 本发明仅限于这些组合方式，而是能够以任意有意义的方式对这些优选实施方式加以组合。</p>
    <p>附图说明</p>
    <p>[0021]	图1示出根据第一优选实施方式的本发明方法；</p>
    <p>[0022]	图2示出根据第二优选实施方式的本发明方法；</p>
    <p>[0023]	图3示出根据本发明方法的加密方法；</p>
    <p>[0024]	图4示出根据本发明方法的解密方法；</p>
    <p>[0025]	图5示出换码控制器模型的示意图；</p>
    <p>[0026]	图6示出换码控制器内记录的数据包格式示意图。</p>
    <p>具体实施方式</p>
    <p>[0027]	以下结合附图，详细描述根据本发明的实施方式。需要指出的是，这些附图仅仅是</p>
    <p>9示意性的，不构成对本发明的保护范围的限定。</p>
    <p>[0028]	图1示出本发明方法的第一优选实施方式的流程图。如图1所示，由服务器端向 客户端进行数字内容传送，其中是利用与所述客户端的硬件ID有关的方式进行加密和解 密的。该方法依次包括：数字内容划分步骤S104、初始加密步骤S105、后续加密步骤S106、 换码控制器生成步骤SllO和解密步骤S109。所述的数字内容传送可以是利用无线传输方 式如蓝牙、GPRS、GSM、WCDMA, WiFi、ZigBee、微波通信和/或TD-SCDMA来实现的，也可以按 照有线传输方式来实现的，例如通过分组交换和光纤通信等方式。利用与所述客户端的硬 件ID有关的方式进行加密和解密意指：“将硬件ID信息转换为二进制代码后直接将所述代 码作为密钥进行加密和解密，或者将其一部分用作为密钥，也可以是对该代码进行一定规 则的运算后将运算结果作为密钥进行加密和解密”。</p>
    <p>[0029]	在数字内容划分步骤S104中，按照一预定顺序或一预定时序将数字内容划分成 多个内容块，数字内容的划分可以利用数据分割技术，例如按照每128bit &#8212;段，将原始数 据分割成多段。由于数字内容的划分方法为公知技术，因此省略了该方法的具体实现方式， 详见专利号为200380106529. 1的《数据分割方法和使用异或运算的装置》中的介绍；所述 的预定顺序或预定时序是指由于音、视频等媒体数据或流媒体数据及文本数据在传输过程 中是以分数据包的形式进行的，在传输过程中各个数据包选择的路由可能不尽相同，到达 客户端所需的时间也就不一样，有可能会出现先发的数据包却后到的情况，导致传输后得 到不正确的结果，因此会在数据包传输之前可以先将固定的顺序或时序标记在相应的数据 包中，客户端在收到数据包时，根据所标记的顺序或时序对数据包按序排列从而得到正确 的结果。</p>
    <p>[0030]	在所述初始加密步骤S105中，利用与客户端的硬件ID有关的信息作为初始加密 密钥，加密数字内容的第一内容块以得到第一密文内容块，并将所述第一密文内容块发送 至所述客户端。客户的硬件ID信息包括但不限于：CPU ID信息、硬盘卷号信息、BIOS信息、 网卡MAC地址、IP地址、其他可采集的硬件编码或以上信息的组合。</p>
    <p>[0031]	在所述后续加密步骤S106中，随后以第一密文内容块为第二加密密钥来加密数 字内容的第二内容块以得到第二密文内容块，并将所述第二密文内容块发送至所述客户 端，随后以第二密文内容块为第三加密密钥来加密数字内容的第三内容块以得到第三密文 内容块，并将所述第三密文内容块发送至所述客户端，以此类推直至全部数字内容均被加 密并发送至所述客户端为止。</p>
    <p>[0032]	在所述换码控制器生成步骤SllO中，由所述服务器端读取经过加密的所述第一 密文内容块指定位置的值并生成识别码，并且所述服务器端记录对应于所述第一密文内容 块的顺序或时序作为时间戳，并且所述服务器端将所述识别码和所述时间戳记录在换码控 制器中；以此类推，直到所述服务器端将针对各个密文内容块的所有所述识别码和所述时 间戳均记录在所述换码控制器中为止，随后所述服务器端将所述换码控制器发送到所述客 户端。其中，所述服务器端可以读取所述各个密文块的首位值、末位值或任意一位或多位值 或者这些方式的组合作为识别码，也可以将所读取的值按照预定规则如函数变换规则进行 运算后的结果作为识别码。</p>
    <p>[0033]	在所述解密步骤S109中，所述客户端利用所述与客户端的硬件ID有关的信息作 为初始解密密钥，通过所述换码控制器的所述识别码、所述时间戳找到各个密文内容块的</p>
    <p>10位置和所述顺序或时序，随后利用所述初始解密密钥对所述第一密文内容块进行解密以得 到所述第一内容块，随后通过所述第二密文内容块的所述识别码、所述时间戳找到所述第 二密文内容块的位置和所述顺序或时序并利用所述第一内容块对所述第二密文内容块进 行解密以得到所述第二内容块，然后对所述第一内容块和第二内容块按所述顺序或时序进 行组合，再利用所述第二内容块对所述第三密文内容块进行解密以得到所述第三内容块， 并按所述顺序或时序与所述第一内容块和所述第二内容块组合，以此类推，直到所有密文 内容均被解密并按所述顺序或时序组合，最终所述客户端得到所述数字内容的明文。图2 示出了本发明方法的第二优选实施方式的流程图。</p>
    <p>[0034]	如图2所示，根据本发明的方法依次包括：注册步骤S200、服务请求步骤S201、硬 件ID匹配步骤S202、初始加密密钥生成步骤S203、数字内容划分步骤S104、初始加密步骤 S105、后续加密步骤S106、换码控制器生成步骤S110、许可证生成步骤S207、客户端硬件ID 匹配步骤S208和解密步骤S109。</p>
    <p>[0035]	在所述注册步骤S200中，客户端向服务器端的用户管理模块申请注册，客户端将 其硬件ID信息发送给所述用户管理模块，所述硬件ID信息可以包括如硬件序列号、CPU的 ID、MAC的地址等一切具有唯一性的硬件指纹信息中的一个或多个的组合，所述用户管理模 块记录硬件ID信息，在注册成功之后，用户管理模块生成作为一对非对称密钥的私有密钥 和公共密钥，并且用户管理模块将私有密钥发送给客户端，并且将私有密钥和公共密钥储 存在用户管理模块中。</p>
    <p>[0036]	在服务请求步骤S201中，所述客户端生成服务请求消息，所述服务请求消息包括 所述客户端的硬件ID信息和所述客户端对数字内容的请求消息，并且客户端利用私有密 钥来加密服务请求消息，并将加密后的服务请求消息发送至服务器端的授权模块，随后，所 述用户管理模块发放所述公共密钥至授权模块，所述授权模块利用公共密钥来解密加密后 的服务请求消息，以得到客户端的硬件ID信息和客户端对数字内容的请求消息。</p>
    <p>[0037]	硬件ID匹配步骤S202中，所述授权模块对硬件ID信息发送给所述用户管理模 块，所述用户管理模块将接收到的硬件ID信息与由其存储的硬件ID信息进行比较。</p>
    <p>[0038]	在初始加密密钥生成步骤S203中，如果用户管理模块所接收到的所述硬件ID信 息与其预先存储的硬件ID信息彼此匹配，则所述授权模块生成授权密钥，将授权密钥发送 给客户端，并且所述授权模块利用所述授权密钥来加密所述硬件ID信息以得到所述初始 加密密钥，所述授权模块将所请求的数字内容转发给所述服务器端的内容模块。</p>
    <p>[0039]	在数字内容划分步骤S104中，所述内容模块按照一预定顺序或一预定时序将所 述数字内容划分成多个内容块。</p>
    <p>[0040]	在初始加密步骤S105中，所述内容模块利用所述初始加密密钥，加密数字内容的 第一内容块以得到第一密文内容块。</p>
    <p>[0041]	在后续加密步骤中S106中，所述内容模块以第一密文内容块为第二加密密钥来 加密数字内容的第二内容块以得到第二密文内容块，随后以第二密文内容块为第三加密密 钥来加密数字内容的第三内容块以得到第三密文内容块，以此类推直至全部数字内容均被 加密为止。</p>
    <p>[0042]	在所述换码控制器生成步骤SllO中，由所述服务器端读取经过加密的所述第一 密文内容块指定位置的值并生成识别码，并且所述服务器端记录对应于所述第一密文内容块的顺序或时序作为时间戳，并且所述服务器端将所述识别码和所述时间戳记录在换码控 制器中；以此类推，直到所述服务器端将针对各个密文内容块的所有所述识别码和所述时 间戳均记录在所述换码控制器中为止，随后所述服务器端将所述换码控制器发送到所述客户端。</p>
    <p>[0043]	在所述许可证生成步骤S207中，所述授权模块利用所述公共密钥来加密所述初 始加密密钥从而生成许可证，并且所述授权模块将所述许可证发送给所述客户端；所述客 户端利用所述私有密钥来解密接收到的经过加密的所述许可证得到所述初始加密密钥，作 为所述客户端的初始解密密钥。</p>
    <p>[0044]	在客户端硬件ID匹配步骤S208中，所述客户端利用所接收到的授权密钥对所述 初始解密密钥进行解密，从而得到硬件ID信息，所述客户端将通过解密得到的硬件ID信息 与其自己的硬件ID信息相互比较。</p>
    <p>[0045]	如果所述客户端的硬件ID信息与通过解密所述初始解密密钥得到的硬件ID信息 彼此匹配，那么所述客户端利用所述初始解密密钥执行解密步骤S109。</p>
    <p>[0046]	在解密步骤S109中，所述客户端利用所述与客户端的硬件ID有关的信息作为初 始解密密钥，通过所述换码控制器的所述识别码、所述时间戳找到各个密文内容块的位置 和所述顺序或时序，随后利用所述初始解密密钥对所述第一密文内容块进行解密以得到所 述第一内容块，随后通过所述换码控制器提供的所述第二密文内容块的所述识别码、所述 时间戳找到所述第二密文内容块的位置和所述顺序或时序并利用所述第一内容块对所述 第二密文内容块进行解密以得到所述第二内容块，然后对所述第一内容块和第二内容块按 所述顺序或时序进行组合，再利用所述第二内容块对所述第三密文内容块进行解密以得到 所述第三内容块，并按所述顺序或时序与所述第一内容块和所述第二内容块组合，以此类 推，直到所有密文内容均被解密并按所述顺序或时序组合，最终所述客户端得到所述数字 内容的明文。</p>
    <p>[0047]	虽然图中未示出，但是上述这些步骤并非一定要按照按照图2所示的流程执行。 其中某些步骤也可以省略以便构成其他优选实施方式，某些步骤可以相互组合以便形成另 外的优选实施方式。</p>
    <p>[0048]	图3示出了一种用于以加密方式提供数字内容的服务器端，其包括：用户管理模 块、授权模块内容模块和换码控制器，其中，所述用户管理模块负责客户端在所述服务器端 的注册任务，并且负责存储所述客户端的硬件ID信息，在客户端注册成功之后，所述用户 管理模块生成私有密钥和公共密钥，并且所述用户管理模块将所述私有密钥发送给所述客 户端，并且将所述私有密钥和所述公共密钥储存在所述用户管理模块中，同时所述用户管 理模块还负责利用硬件ID信息来认证客户端，仅当认证通过后，所述用户管理模块才将所 述公共密钥发放给所述授权模块；所述授权模块负责响应于客户端的请求，利用所述公共 密钥来解密所接收到的服务请求消息，以便得到所述硬件ID信息和所述客户端所数字内 容请求，并且所述授权模块向所述用户管理模块提交所述硬件ID信息，仅当与所述用户管 理模块存储的硬件ID信息匹配一致时，所述授权模块才生成授权密钥并且将所述授权密 钥发送给所述客户端，并且所述授权模块利用所述授权密钥来加密所述硬件ID信息以得 到初始加密密钥；并且所述授权模块能够利用所述公共密钥来加密所述初始加密密钥从而 生成许可证，并且将所述许可证发送给所述客户端，并且所述授权模块还将所述客户端对</p>
    <p>12数字内容的请求转发给所述内容模块；所述内容模块负责响应于所述客户端的所述请求对 由所述授权模块转发来的所述客户端所请求的数字内容进行分块，并利用所述初始加密密 钥对多个内容块按照预定顺序或时序进行依次加密以得到多个密文内容块，并且负责将这 些密文内容块发送至所述客户端；同时所述内容模块还读取经过加密的所述第一密文内容 块指定位置的值并生成识别码，并且记录对应于所述第一密文内容块的顺序或时序作为时 间戳，依次类推，直到所述服务器端将所有所述识别码和所述时间戳记录在换码控制器中 为止，随后所述服务器端将所述换码控制器发送到所述客户端。</p>
    <p>[0049]	图4示出了客户端的解密方法。该解密方法包括下列步骤：客户端利用所述私有 密钥来解密接收到的经过加密的所述许可证得到所述初始加密密钥，作为所述客户端的初 始解密密钥；所述客户端利用所接收到的授权密钥对所述初始解密密钥进行解密，从而得 到硬件ID信息，所述客户端将通过解密得到的硬件ID信息与其自己的硬件ID信息相互 比较；如果所述客户端的硬件ID信息与通过解密所述初始解密密钥得到的硬件ID信息彼 此匹配，那么所述客户端利用所述初始解密密钥执行所述解密步骤S109，即，所述换码控制 器提供所述第一密文内容块的所述识别码、所述时间戳从而使所述客户端找到所述第一密 文内容块的位置和所述顺序或时序，随后所述客户端利用所述初始解密密钥对所述第一密 文内容块进行解密以得到所述第一内容块，然后所述换码控制器提供所述第二密文内容块 的所述识别码、所述时间戳从而使所述客户端找到所述第二密文内容块的位置和所述顺序 或时序，再利用所述第一内容块对所述第二密文内容块进行解密以得到所述第二内容块， 对所述第一内容块和第二内容块按所述顺序或时序进行组合，以此类推，再利用所述第二 内容块对所述第三密文内容块进行解密以得到所述第三内容块，并按所述顺序或时序与所 述第一内容块和所述第二内容块组合，直到所有密文内容均被解密并按所述顺序或时序组 合，最终所述客户端得到所述数字内容的明文。</p>
    <p>[0050]	图5为换码控制器模型示意图，其中是以所述换码控制器读取所述各个密文内容 块的末位值，并且不经过运算而直接生成识别码的情况为例说明的，其中A、B、……、N代表 所述各个密文内容块的末位值，与序列号1、2、……、η直接组合构成所述各个密文内容块 的识别码作为位置标记。此处可以想到其他实施方式，例如采集各个密文内容块的首位值、 特定位置的值或者不同位置的多个值、或者这些方式的组合。</p>
    <p>[0051]	图6为换码控制器中记录识别码、时间戳、密文内容块后的数据包格式示意图。其 中，时间戳是以所述数字内容按所述时序分块为前提的举例说明，Data Field表示存放密 文内容块的部分，而且，识别码、时间戳和密文内容块的存储顺序可以任意互换。在换码控 制器中记录每个加密内容块的位置标记，使得所述客户端能够方便找到各个密文块的时序 便于“拼合”所接收到的各个密文内容块，同时，“识别码+时间戳”的组合也保障了每个密 文内容块识别的唯一性。</p>
    <p>[0052]	根据本发明的服务器端适于执行本发明的方法。</p>
    <p>[0053]	本发明所公开的方法和设备利用数据分割技术将数字内容分割为多个块，利用 “与客户端的硬件ID有关的信息”对各个内容块依次加密和解密。最终加密数字内容分块 传输，即便被黑客窃取也必须先分析加密原理后再对数字内容块重新排序，逐个破解，攻破 难度随内容块数成倍提高。此外本方法还纳入了用户硬件ID的校验过程，进一步防止了非 法拷贝和非法传播。本方法利用硬件信息绑定技术解决了传统技术仅对版权的保护随着解密密钥安全地发送到授权用户即停止的弊端，利用分块换码多路复用技术解决了传统技术 对数字内容的加密是静态的、一次性的，经过一次破解则数字内容完全暴露的弊端，实现了 数字内容在传播全过程中的高安全性，防止非法拷贝和非法传播、篡改。 [0054] 本文中所描述的具体实施例仅仅是对本发明精神作的举例说明。本发明所属技术 领域的技术人员可以对所描述的具体实施例做各种修改或补充或采用类似的方式加以替 代，但不会偏离本发明的精神或者超越所附权利要求书所定义的范围。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101207794A?cl=zh">CN101207794A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2006年12月19日</td><td class="patent-data-table-td patent-date-value">2008年6月25日</td><td class="patent-data-table-td ">中兴通讯股份有限公司</td><td class="patent-data-table-td ">Iptv系统的数字版权管理加密和解密方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101729550A?cl=zh">CN101729550A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2009年11月9日</td><td class="patent-data-table-td patent-date-value">2010年6月9日</td><td class="patent-data-table-td ">西北大学</td><td class="patent-data-table-td ">基于透明加解密的数字内容安全防护系统及加解密方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US6892306">US6892306</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">1998年12月22日</td><td class="patent-data-table-td patent-date-value">2005年5月10日</td><td class="patent-data-table-td ">Samsung Electronics Co., Ltd.</td><td class="patent-data-table-td ">Digital content cryptograph and process</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102103778A?cl=zh">CN102103778A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年2月23日</td><td class="patent-data-table-td patent-date-value">2011年6月22日</td><td class="patent-data-table-td ">中兴通讯股份有限公司</td><td class="patent-data-table-td ">移动支付系统、移动终端及移动支付业务的实现方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102103778B?cl=zh">CN102103778B</a></td><td class="patent-data-table-td patent-date-value">2011年2月23日</td><td class="patent-data-table-td patent-date-value">2014年4月30日</td><td class="patent-data-table-td ">中兴通讯股份有限公司</td><td class="patent-data-table-td ">移动支付系统、移动终端及移动支付业务的实现方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102624708A?cl=zh">CN102624708A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年2月23日</td><td class="patent-data-table-td patent-date-value">2012年8月1日</td><td class="patent-data-table-td ">浙江工商大学</td><td class="patent-data-table-td ">一种面向云存储的高效数据加密、更新和访问控制方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102833077A?cl=zh">CN102833077A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年9月25日</td><td class="patent-data-table-td patent-date-value">2012年12月19日</td><td class="patent-data-table-td ">东信和平科技股份有限公司</td><td class="patent-data-table-td ">金融ic及金融社保ic卡远程发卡数据传输加解密方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103138922A?cl=zh">CN103138922A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年11月24日</td><td class="patent-data-table-td patent-date-value">2013年6月5日</td><td class="patent-data-table-td ">北大方正集团有限公司</td><td class="patent-data-table-td ">一种数字内容传输的方法、系统及装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103532712A?cl=zh">CN103532712A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年7月4日</td><td class="patent-data-table-td patent-date-value">2014年1月22日</td><td class="patent-data-table-td ">侯光敏</td><td class="patent-data-table-td ">数字媒体文件保护方法、系统及客户端</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2013075674A1?cl=zh">WO2013075674A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年12月12日</td><td class="patent-data-table-td patent-date-value">2013年5月30日</td><td class="patent-data-table-td ">Peking University Founder Group Co., Ltd.</td><td class="patent-data-table-td ">一种数字内容传输的方法、系统及装置</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=9a6OBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029060000">H04L29/06</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2011年2月16日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2011年3月30日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年5月8日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Grant of patent or utility model</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/4b3253ed9583424b9998/CN101977190A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E6%95%B0%E5%AD%97%E5%86%85%E5%AE%B9%E5%8A%A0%E5%AF%86%E4%BC%A0%E9%80%81%E6%96%B9%E6%B3%95%E4%BB%A5%E5%8F%8A%E6%9C%8D.pdf?id=9a6OBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U1urunJtqzOu9F9OMCGMfDIjyp2_Q"},"sample_url":"https://www.google.com/patents/reader?id=9a6OBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>