<!DOCTYPE html><html><head><title>专利 CN103220372A - 数据业务访问方法及系统 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_50a6672b5f82ffbd39b7a9e87fd4594c/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_50a6672b5f82ffbd39b7a9e87fd4594c__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="数据业务访问方法及系统"><meta name="DC.contributor" content="杨波" scheme="inventor"><meta name="DC.contributor" content="武威" scheme="inventor"><meta name="DC.contributor" content="毕娅娜" scheme="inventor"><meta name="DC.contributor" content="于蓉蓉" scheme="inventor"><meta name="DC.contributor" content="中国移动通信集团公司" scheme="assignee"><meta name="DC.date" content="2012-1-19" scheme="dateSubmitted"><meta name="DC.description" content="本发明公开了数据业务访问方法及系统。方法包括：在GPRS网络中增加智能DNS，智能DNS保存需代理服务器进行代理处理的业务域名，同时记录代理服务器的IP地址；GGSN接收UE发来的PDP上下文激活请求消息，向UE返回智能DNS的IP地址；UE向智能DNS发起携带待访问网站域名的DNS查询请求，智能DNS发现该域名为需代理服务器进行代理处理的业务域名，向UE返回代理服务器的IP地址，UE向代理服务器发起携带所述URL的业务请求；代理服务器若根据该请求中的目的网站信息发现需要自身进行代理处理，则进行代理处理，处理完毕向目的网站服务器发送该业务请求。本发明有效降低了代理服务器的处理压力及GGSN与代理服务器之间的流量。"><meta name="DC.date" content="2013-7-24"><meta name="DC.relation" content="CN:101064936:A" scheme="references"><meta name="DC.relation" content="CN:101631133:A" scheme="references"><meta name="DC.relation" content="CN:101959250:A" scheme="references"><meta name="DC.relation" content="CN:103220371:A" scheme="references"><meta name="DC.relation" content="US:20040120296:A1" scheme="references"><meta name="citation_patent_publication_number" content="CN:103220372:A"><meta name="citation_patent_application_number" content="CN:201210018012"><link rel="canonical" href="https://www.google.com/patents/CN103220372A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN103220372A?cl=zh"/><meta name="title" content="专利 CN103220372A - 数据业务访问方法及系统"/><meta name="description" content="本发明公开了数据业务访问方法及系统。方法包括：在GPRS网络中增加智能DNS，智能DNS保存需代理服务器进行代理处理的业务域名，同时记录代理服务器的IP地址；GGSN接收UE发来的PDP上下文激活请求消息，向UE返回智能DNS的IP地址；UE向智能DNS发起携带待访问网站域名的DNS查询请求，智能DNS发现该域名为需代理服务器进行代理处理的业务域名，向UE返回代理服务器的IP地址，UE向代理服务器发起携带所述URL的业务请求；代理服务器若根据该请求中的目的网站信息发现需要自身进行代理处理，则进行代理处理，处理完毕向目的网站服务器发送该业务请求。本发明有效降低了代理服务器的处理压力及GGSN与代理服务器之间的流量。"/><meta property="og:title" content="专利 CN103220372A - 数据业务访问方法及系统"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN103220372A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN103220372A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=0LrHCAABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN103220372A&amp;usg=AFQjCNFo8PcMpYQW2_QkdzW_sM0asZLaww" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/83d7798df12b24ecd223/CN103220372A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/83d7798df12b24ecd223/CN103220372A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN103220372A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN103220372A?cl=en&amp;hl=zh-CN"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN103220372A?cl=zh" style="display:none"><span itemprop="description">本发明公开了数据业务访问方法及系统。方法包括：在GPRS网络中增加智能DNS，智能DNS保存需代理服务器进行代理处理的业务域名，同时记录代理服务器的IP地址；GGSN接收UE发来的PDP上下文激活请求消息，向UE返回智能DNS的IP地址 ...</span><span itemprop="url">https://www.google.com/patents/CN103220372A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN103220372A - 数据业务访问方法及系统</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN103220372A - 数据业务访问方法及系统" title="专利 CN103220372A - 数据业务访问方法及系统"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN103220372 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201210018012</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2013年7月24日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2012年1月19日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2012年1月19日</td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201210018012.8, </span><span class="patent-bibdata-value">CN 103220372 A, </span><span class="patent-bibdata-value">CN 103220372A, </span><span class="patent-bibdata-value">CN 201210018012, </span><span class="patent-bibdata-value">CN-A-103220372, </span><span class="patent-bibdata-value">CN103220372 A, </span><span class="patent-bibdata-value">CN103220372A, </span><span class="patent-bibdata-value">CN201210018012, </span><span class="patent-bibdata-value">CN201210018012.8</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%9D%A8%E6%B3%A2%22">杨波</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%AD%A6%E5%A8%81%22">武威</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%AF%95%E5%A8%85%E5%A8%9C%22">毕娅娜</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E4%BA%8E%E8%93%89%E8%93%89%22">于蓉蓉</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8%E9%80%9A%E4%BF%A1%E9%9B%86%E5%9B%A2%E5%85%AC%E5%8F%B8%22">中国移动通信集团公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103220372A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103220372A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103220372A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (5),</span> <span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (2),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (3),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (2)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=0LrHCAABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201210018012&amp;usg=AFQjCNFiXZzohe7HPUWD_b6HTdVW9MdyAw"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=0LrHCAABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D103220372A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNEIztAyu9qJ39vl5PU2rTDVCbu2VA"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT126602504" lang="ZH" load-source="patent-office">数据业务访问方法及系统</invention-title>
      </span><br><span class="patent-number">CN 103220372 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA118039770" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明公开了数据业务访问方法及系统。方法包括：在GPRS网络中增加智能DNS，智能DNS保存需代理服务器进行代理处理的业务域名，同时记录代理服务器的IP地址；GGSN接收UE发来的PDP上下文激活请求消息，向UE返回智能DNS的IP地址；UE向智能DNS发起携带待访问网站域名的DNS查询请求，智能DNS发现该域名为需代理服务器进行代理处理的业务域名，向UE返回代理服务器的IP地址，UE向代理服务器发起携带所述URL的业务请求；代理服务器若根据该请求中的目的网站信息发现需要自身进行代理处理，则进行代理处理，处理完毕向目的网站服务器发送该业务请求。本发明有效降低了代理服务器的处理压力及GGSN与代理服务器之间的流量。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(20)</span></span></div><div class="patent-text"><div mxw-id="PCLM53772265" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.一种数据业务访问方法，其特征在于，在通用分组无线服务GPRS网络中增加智能域名系统DNS，智能DNS保存需代理服务器进行代理处理的业务域名，同时记录代理服务器的IP地址，该方法包括:  GGSN接收用户设备UE发来的分组数据协议PDP上下文激活请求消息，为UE分配IP地址，并向UE返回智能DNS的IP地址；  UE根据用户输入的待访问网站的统一资源定位符URL，向智能DNS发起携带待访问网站域名的DNS查询请求，智能DNS发现该域名为需代理服务器进行代理处理的业务域名，则向UE返回代理服务器的IP地址，UE向代理服务器发起携带所述URL的业务请求；  代理服务器接收所述业务请求，若根据该请求中的目的网站信息发现需要自身进行代理处理，则进行代理处理，处理完毕向目的网站服务器发送该业务请求。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.根据权利要求1所述的方法，其特征在于，所述代理服务器为:无线应用协议WAP网关。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.根据权利要求1所述的方法，其特征在于，所述代理服务器进行代理处理包括:获取用户身份信息，将用户身份信息插 入该业务请求中；  或者包括:获取用户的归属服务器。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.根据权利要求1所述的方法，其特征在于，所述UE向智能DNS发起携带待访问网站域名的DNS查询请求之后进一步包括:  若智能DNS发现该域名为不需代理服务器进行代理处理的业务域名，则向因特网的DNS查询该域名对应的目的数据业务服务器的IP地址，向UE返回携带该IP地址的DNS查询响应消息，UE接收到该消息后，直接向该数据业务服务器发送业务请求。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.根据权利要求1所述的方法，其特征在于，所述UE向代理服务器发起携带所述URL的业务请求之后进一步包括:  代理服务器接收该业务请求，若发现该请求中的目的网站信息未位于自身配置的传送用户身份标识白名单中，则向因特网的DNS查询该URL的域名对应的目的数据业务服务器的IP地址，向UE返回携带该IP地址的业务重定向消息，UE接收到该业务重定向消息后，直接向该数据业务服务器发送业务请求。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.根据权利要求1所述的方法，其特征在于，所述GGSN接收UE发来的PDP上下文激活请求消息之前进一步包括:  SGSN接收该PDP上下文激活请求消息，检查该消息的PDP激活参数中的APN的设置，若APN未设置或设置错误，则将APN设置为正确APN，将该PDP上下文激活请求消息转发给GGSN。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.根据权利要求3所述的方法，其特征在于，所述GGSN为UE分配IP地址之后进一步包括:  GGSN将UE的IP地址、用户身份信息、漫游位置注册到用户信息注册服务器；  所述代理服务器获取用户身份信息为:代理服务器根据业务请求的源IP地址向用户信息注册服务器查询到对应的用户身份信息；  所述代理服务器获取用户的归属服务器为:代理服务器根据业务请求的源IP地址向用户信息注册服务器查询到对应的用户身份信息或漫游位置，根据用户身份标识或漫游位置，同时根据业务请求中的目的网站的域名，向Enum DNS查询到用户的归属服务器，以便将该业务请求发送给该归属服务器。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.根据权利要求1至7任一所述的方法，其特征在于，所述业务为基于传输控制协议TCP承载的、使用文本型控制协议的业务。</div>
    </div>
    </div> <div class="claim"> <div num="9" class="claim">
      <div class="claim-text">9.一种数据业务访问系统，其特征在于，包括:  智能DNS:保存需代理服务器进行代理处理的业务域名，同时记录代理服务器的IP地址；接收UE发来的携带待访问网站域名的DNS查询请求，若发现该域名为需代理服务器进行代理处理的业务域名，则向UE返回代理服务器的IP地址，以便向UE向该代理服务器发起业务请求；  GGSN:接收UE发来的PDP上下文激活请求消息，为UE分配IP地址，并向UE返回智能DNS的IP地址；  代理服务器:接收UE发来的所述业务请求，若根据该请求中的目的网站信息发现需要自身进行代理处理，则进行代理处理，处理完毕向目的网站服务器发送该业务请求。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.如权利要求9所述的系统，其特征在于，所述智能DNS进一步用于，当接收到UE发来的携带待访问网站域名的DNS查询请求后，若发现该域名为不需代理服务器进行代理处理的业务域名，则向因特网的DNS查询该域名对应的目的数据业务服务器的IP地址，向UE返回携带该IP地址的DNS查询响应消息，以便UE不经过代理服务器直接向该数据业务服务器发送业务请求。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="11" class="claim">
      <div class="claim-text">11.根据权利要求9所述的系统，其特征在于，所述代理服务器进一步用于，当接收到UE发来的所述业务请求后，若发现该请求中的目的网站信息未位于自身配置的传送用户身份标识白名单中，则向因特网的DNS查询该URL的域名对应的目的数据业务服务器的IP地址，向UE返回携带该IP地址的业务重定向消息，以便UE不经过代理服务器直接向该数据业务服务器发送业务 请求。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12.根据权利要求9所述的系统，其特征在于，所述系统进一步包括:SGSN，用于接收UE发来的所述PDP上下文激活请求消息，检查该消息的PDP激活参数中的APN的设置，若APN未设置或设置错误，则将APN设置为正确APN，将该PDP上下文激活请求消息转发给GGSN。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13.根据权利要求9所述的系统，其特征在于，所述GGSN进一步用于，在为UE分配IP地址后，将UE的IP地址和用户身份信息注册到用户信息注册服务器；  且所述代理服务器进一步用于，当根据所述业务请求中的目的网站信息发现需要进行代理处理时，根据所述业务请求的源IP地址向用户信息注册服务器查询到对应的用户身份信息，将该用户身份信息插入该业务请求中；  或者进一步用于，当根据所述业务请求中的目的网站信息发现需要进行代理处理时，根据业务请求的源IP地址向用户信息注册服务器查询到对应的用户身份信息或漫游位置，根据用户身份标识或漫游位置，同时根据业务请求中的目的网站的域名，向Enum DNS查询到用户的归属服务器，以便将该业务请求发送给该归属服务器。</div>
    </div>
    </div> <div class="claim"> <div num="14" class="claim">
      <div class="claim-text">14.一种智能DNS，位于GPRS网络中，其特征在于，包括:  第一模块:保存需代理服务器进行代理处理的业务域名，同时记录代理服务器的IP地址；  第二模块:接收UE发来的携带待访问网站域名的DNS查询请求，若向第一模块查询到该域名为需代理服务器进行代理处理的业务域名，则向UE返回代理服务器的IP地址，以便UE向代理服务器发起业务请求。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="15" class="claim">
      <div class="claim-text">15.根据权利要求14所述的智能DNS，其特征在于，所述第二模块进一步用于，当接收到UE发来的携带待访问网站域名的DNS查询请求后，若向第一模块未查询到该域名为需代理服务器进行代理处理的业务域名，则向因特网的DNS查询该域名对应的目的数据业务服务器的IP地址，向UE返回携带该IP地址的DNS查询响应消息，以便UE不经过代理服务器直接向该数据业务服务器发送业务请求。</div>
    </div>
    </div> <div class="claim"> <div num="16" class="claim">
      <div class="claim-text">16.一种GGSN，其特征在于，包括:  第三模块:接收UE发来的PDP上下文激活请求消息，为UE分配IP地址，并向UE返回智能DNS的IP地址；  第四模块:接收UE发来的业务请求，若发现该请求的目的IP地址为代理服务器的IP地址，则将该请求发送给代理服务器；否则，将该请求直接发送给目的数据业务服务器。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="17" class="claim">
      <div class="claim-text">17.根据权利要求16所述的GGSN，其特征在于，所述第三模块进一步用于，当为UE分配了 IP地址后，将UE的IP地址和用户身份信息注册到用户信息注册服务器，以便WAP网关根据UE的IP地址查询用户身份信息或漫游位置。</div>
    </div>
    </div> <div class="claim"> <div num="18" class="claim">
      <div class="claim-text">18.一种代理 服务器，其特征在于，包括:  第五模块:接收UE发来的业务请求，若根据该请求中的目的网站信息发现需要自身进行代理处理，则获取用户身份信息，将用户身份信息插入该业务请求中，向目的网站服务器发送该业务请求；或者获取用户身份信息或漫游位置，根据用户身份信息或漫游位置，同时根据业务请求中的目的网站的域名，向ENUM DNS查询到用户的归属服务器，向用户的归属服务器发送该业务请求。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="19" class="claim">
      <div class="claim-text">19.根据权利要求18所述的代理服务器，其特征在于，所述第五模块进一步用于，当接收到UE发来的所述业务请求后，若发现该请求中的目的网站信息未位于自身配置的传送用户身份标识白名单中，则向因特网的DNS查询该URL的域名对应的目的数据业务服务器的IP地址，向UE返回携带该IP地址的业务重定向消息，以便UE不经过代理服务器直接向该数据业务服务器发送业务请求。</div>
    </div>
    </div> <div class="claim"> <div num="20" class="claim">
      <div class="claim-text">20.&#8212;种SGSN，其特征在于，包括:  第六模块:接收UE发来的PDP上下文激活请求消息，检查该消息的PDP激活参数中的APN的设置，若APN未设置或设置错误，则将APN设置为正确APN，将该PDP上下文激活请求消息转发给GGSN。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES60803556" lang="ZH" load-source="patent-office" class="description">
    <p>数据业务访问方法及系统</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及数据业务技术领域，具体涉及数据业务访问方法及系统。</p>
    <p>背景技术</p>
    <p>[0002]	移动数据网络中，通常通过接入点名称(APN，Access Point Name)标识不同的业务域，终端通过配置APN来确定接入移动数据业务的方式，运营商通过APN区隔不同的数据通信业务网络。通过APN机制，运营商可以依据业务和组网的需要，在特定的APN上实施业务控制、路由和管道增值能力如:用户号码插入、用户身份识别、公私网地址转换和应用层网关、内容计费、Web网页适配和内容缓存加速等。</p>
    <p>[0003]	图1为现有的APN处理机制示意图，如图1所示，APN处理机制为:①终端发送数据通道建立请求；②&#12316;③服务GPRS支持节点(SGSN，Serving GPRS Support Node)接收该请求，检查请求中的APN是否属于归属位置寄存器(HLR,Home Location Register)中用户的签约APN，若是，执行后续步骤；④&#12316;⑤SGSN根据APN路由到网关GPRS支持节点(GGSN，Gateway GPRS Support Node) GGSN:SGSN 从域名系统(DNS, Domain Name System)中查询APN对应的GGSN地址，并进行路由逾GGSN根据APN路由到指定网络，并实现内容计费功能:GGSN根据APN将请求路由到相应的网络，如无线应用协议(WAP，Wireless ApplicationProtocol)、NET,针对指定APN进行内容计费。</p>
    <p>[0004]	为了更好满足自有业务和合作业务发展需要，运营商通常设立WAP、NET两个全网通用的APN，其中WAP APN定位于为自有业务和合作业务提供接入、访问适配和增值服务，而NET APN侧重于透明的因特网(Internet)数据接入。</p>
    <p>[0005]	为了支持在WAP APN上开展自有业务和合作业务，提供了两种业务访问机制:分别是:①WAP代理模式套接字(Socket)直通模式。图2为现有的WAP APN处理机制示意图，如图2所不,其中:</p>
    <p>[0006]	方式①:WAP代理模式。通过WAP网关的超文本传输协议(HTTP，Hyper-TextTransfer Protocol)代理功能，提供对自有业务、第三方业务的HTTP流量代理访问，并根据既定的策略决定是否在HTTP访问过程中插入用户的主叫移动终端号码、终端型号信息(UA Profile);该方式支持所有的HTTP访问，包括自有业务、合作业务和第三方业务；</p>
    <p>[0007]	方式②:Socket直通模式。通过在WAP网关的防火墙上开启白名单机制，目的地址、端口位于该名单中的流量可直接经防火墙映射后访问公网地址；该方式支持授信的非HTTP访问，包括自有业务、合作业务。</p>
    <p>[0008]	现网实现移动终端号码插入的方案为:在移动终端分组数据协议(H)P，PacketData Protocol)建立阶段，由GGSN获取用户IP地址和移动用户综合业务数字网/公共交换电话网码(MSISDN, Mobile Subscriber International ISDN/PSTN Number)的对应关系，并将该对应关系推送给该GGSN对应的WAP网关；WAP网关保存用户的MSISDN与IP地址的对应关系；当用户发起HTTP访问请求时，WAP网关收到用户HTTP数据包后，根据该数据包的源IP地址，查询本地数 据库中保存的用户IP地址和MSISDN号码对应关系，得到该用户的MSISDN，并将用户的MSISDN插入HTTP数据包头的特殊字段中，再将该HTTP数据包转发出去，因此业务平台在收到用户的HTTP数据包后，可通过解析数据包头中的特定字段获得用户MSISDN，从而实现对用户身份的识别与认证。</p>
    <p>[0009]	基于WAP APN实施的流量增值服务造成了运营商网络复杂、扩容成本高等问题。另夕卜，通过APN区分不同的业务域，在不同的业务域中提供不同的增值能力的现有技术方案在业务能力支持、业务路由机制上存在如下问题:</p>
    <p>[0010]	一、对用户有较高的门槛限制:针对具体数据业务，由于业务组网及应用鉴权要求，必须使用通用分组无线服务(GPRS, General Packet Radio Service)网络提供的用户身份信息对用户进行认证，此时，要求用户在终端上正确配置APN参数，方可正确访问业务</p>
    <p>T D O</p>
    <p>[0011]	二、对移动终端提出了较高的要求:随着移动终端的智能化，多任务已经成为新型终端的基本功能，支持的移动业务越来越丰富，为了保证多个应用正常使用，就必须支持多APN并发,但大部分智能终端平台(如:Android、iPhone等)均不支持多APN并发。</p>
    <p>[0012]	三、对业务体验有较大的影响:用户在不支持多APN并发的终端(如:Android、iPhone、Windows Mobile等)上使用多个业务时，由于不支持APN并发,往往会导致切换到后台运行的应用的APN被断开，对有实时访问请求的业务(如:即时消息、文件下载)等应用造成较大的用户体验影响。</p>
    <p>[0013]	四、对运营商的网络规划和流量经营造成影响:运营商在不同的APN上提供不同的增值能力，用户在使用不同APN时获得的业务体验差距大，从而导致大量的与APN设置、APN并发、APN使用、流量计费相关的投诉，对运营商的网络规划、流量经营造成了障碍。</p>
    <p>[0014]	因此，现有GPRS网络路由和APN机制已经阻碍了移动互联网业务的发展。</p>
    <p>发明内容</p>
    <p>[0015]	本发明提供数据业务访问方法及系统，以降低代理服务器的处理压力及代理服务器与GGSN之间的处理压力。</p>
    <p>[0016]	本发明的技术方案是这样实现的:</p>
    <p>[0017]	一种数据业务访问方法，在通用分组无线服务GPRS网络中增加智能域名系统DNS,智能DNS保存需代理服务器进行代理处理的业务域名，同时记录代理服务器的IP地址，该方法包括:</p>
    <p>[0018]	GGSN接收用户设备UE发来的分组数据协议PDP上下文激活请求消息，为UE分配IP地址，并向UE返回智能DNS的IP地址；</p>
    <p>[0019]	UE根据用户输入的待访问网站的统一资源定位符URL，向智能DNS发起携带待访问网站域名的DNS查询请求，智能DNS发现该域名为需代理服务器进行代理处理的业务域名，则向UE返回代理服务器的IP地址，UE向代理服务器发起携带所述URL的业务请求；</p>
    <p>[0020]	代理服务器接收所述业务请求，若根据该请求中的目的网站信息发现需要自身进行代理处理，则进行代理处理，处理完毕向目的网站服务器发送该业务请求。</p>
    <p>[0021]	所述代理服务器为:无线应用协议WAP网关。</p>
    <p>[0022]	所述代理服务器进行 代理处理包括:获取用户身份信息，将用户身份信息插入该业务请求中；[0023]	或者包括:获取用户的归属服务器。</p>
    <p>[0024]	所述UE向智能DNS发起携带待访问网站域名的DNS查询请求之后进一步包括:</p>
    <p>[0025]	若智能DNS发现该域名为不需代理服务器进行代理处理的业务域名，则向因特网的DNS查询该域名对应的目的数据业务服务器的IP地址，向UE返回携带该IP地址的DNS查询响应消息，UE接收到该消息后，直接向该数据业务服务器发送业务请求。</p>
    <p>[0026]	所述UE向代理服务器发起携带所述URL的业务请求之后进一步包括:</p>
    <p>[0027]	代理服务器接收该业务请求，若发现该请求中的目的网站信息未位于自身配置的传送用户身份标识白名单中，则向因特网的DNS查询该URL的域名对应的目的数据业务服务器的IP地址，向UE返回携带该IP地址的业务重定向消息，UE接收到该业务重定向消息后，直接向该数据业务服务器发送业务请求。</p>
    <p>[0028]	所述GGSN接收UE发来的PDP上下文激活请求消息之前进一步包括:</p>
    <p>[0029]	SGSN接收该PDP上下文激活请求消息，检查该消息的PDP激活参数中的APN的设置，若APN未设置或设置错误，则将APN设置为正确APN，将该PDP上下文激活请求消息转发给 GGSN。</p>
    <p>[0030]	所述GGSN为UE分配IP地址之后进一步包括:</p>
    <p>[0031]	GGSN将UE的IP地址、用户身份信息、漫游位置注册到用户信息注册服务器；</p>
    <p>[0032]	所述代理服务器获取用户身份信息为:代理服务器根据业务请求的源IP地址向用户信息注册服务器查询到对应的用户身份信息；</p>
    <p>[0033]	所述代理服务器获取用户的归属服务器为:代理服务器根据业务请求的源IP地址向用户信息注册服务器查询到对应的用户身份信息或漫游位置，根据用户身份标识或漫游位置，同时根据业务请求中的目的网站的域名，向Enum DNS查询到用户的归属服务器，以便将该业务请求发送给该归属服务器。</p>
    <p>[0034]	所述业务为基于传输控制协议TCP承载的、使用文本型控制协议的业务。</p>
    <p>[0035]	一种数据业务访问系统，包括:</p>
    <p>[0036]	智能DNS:保存需代理服务器进行代理处理的业务域名，同时记录代理服务器的IP地址；接收UE发来的携带待访问网站域名的DNS查询请求，若发现该域名为需代理服务器进行代理处理的业务域名，则向UE返回代理服务器的IP地址，以便向UE向该代理服务器发起业务请求；</p>
    <p>[0037]	GGSN:接收UE发来的PDP上下文激活请求消息，为UE分配IP地址，并向UE返回智能DNS的IP地址；</p>
    <p>[0038]	代理服务器:接收UE发来的所述业务请求，若根据该请求中的目的网站信息发现需要自身进行代理处理，则进行代理处理，处理完毕向目的网站服务器发送该业务请求。</p>
    <p>[0039]	所述智能DNS进一步用于，当接收到UE发来的携带待访问网站域名的DNS查询请求后，若发现该域名为不需代理服务器进行代理处理的业务域名，则向因特网的DNS查询该域名对应的目的数据业务服务器的IP地址，向UE返回携带该IP地址的DNS查询响应消息，以便UE不经过代理服务器直接向该数据业务服务器发送业务请求。</p>
    <p>[0040]	所述代理服务器进一步用于，当接收到UE发来的所述业务请求后，若发现该请求中的目的网站信息未位于自身 配置的传送用户身份标识白名单中，则向因特网的DNS查询该URL的域名对应的目的数据业务服务器的IP地址，向UE返回携带该IP地址的业务重定向消息，以便UE不经过代理服务器直接向该数据业务服务器发送业务请求。</p>
    <p>[0041]	所述系统进一步包括:SGSN，用于接收UE发来的所述PDP上下文激活请求消息，检查该消息的PDP激活参数中的APN的设置，若APN未设置或设置错误，则将APN设置为正确APN,将该PDP上下文激活请求消息转发给GGSN。</p>
    <p>[0042]	所述GGSN进一步用于，在为UE分配IP地址后，将UE的IP地址和用户身份信息注册到用户信息注册服务器；</p>
    <p>[0043]	且所述代理服务器进一步用于，当根据所述业务请求中的目的网站信息发现需要进行代理处理时，根据所述业务请求的源IP地址向用户信息注册服务器查询到对应的用户身份信息，将该用户身份信息插入该业务请求中；</p>
    <p>[0044]	或者进一步用于，当根据所述业务请求中的目的网站信息发现需要进行代理处理时，根据业务请求的源IP地址向用户信息注册服务器查询到对应的用户身份信息或漫游位置，根据用户身份标识或漫游位置，同时根据业务请求中的目的网站的域名，向Enum DNS查询到用户的归属服务器，以便将该业务请求发送给该归属服务器。</p>
    <p>[0045]	一种智能DNS，位于GPRS网络中，包括:</p>
    <p>[0046]	第一模块:保存需代理服务器进行代理处理的业务域名，同时记录代理服务器的IP地址；</p>
    <p>[0047]	第二模块:接收UE发来的携带待访问网站域名的DNS查询请求，若向第一模块查询到该域名为需代理服务器进行代理处理的业务域名，则向UE返回代理服务器的IP地址，以便UE向代理服务器发起业务请求。</p>
    <p>[0048]	所述第二模块进一步用于，当接收到UE发来的携带待访问网站域名的DNS查询请求后，若向第一模块未查询到该域名为需代理服务器进行代理处理的业务域名，则向因特网的DNS查询该域名对应的目的数据业务服务器的IP地址，向UE返回携带该IP地址的DNS查询响应消息，以便UE不经过代理服务器直接向该数据业务服务器发送业务请求。</p>
    <p>[0049]	一种 GGSN，包括:</p>
    <p>[0050]	第三模块:接收UE发来的PDP上下文激活请求消息，为UE分配IP地址，并向UE返回智能DNS的IP地址；</p>
    <p>[0051]	第四模块:接收UE发来的业务请求，若发现该请求的目的IP地址为代理服务器的IP地址，则将该请求发送给代理服务器；否则，将该请求直接发送给目的数据业务服务器。</p>
    <p>[0052]	所述第三模块进一步用于，当为UE分配了 IP地址后，将UE的IP地址和用户身份信息注册到用户信息注册服务器，以便WAP网关根据UE的IP地址查询用户身份信息或漫游位置。</p>
    <p>[0053]	一种代理服务器，包括:</p>
    <p>[0054]	第五模块:接收UE发来的业务请求，若根据该请求中的目的网站信息发现需要自身进行代理处理，则获取用户身份信息，将用户身份信息插入该业务请求中，向目的网站服务器发送该业务请求；或者获取用户身份信息或漫游位置，根据用户身份信息或漫游位置，同时根据业务请求中的目的网站的域名，向ENUM DNS查询到用户的归属服务器，向用户的归属服务器发送该业务请求。</p>
    <p>[0055]	所述第五模块进一步用于，当接收到UE发来的所述业务请求后，若发现该请求中的目的网站信息未位于自身配 置的传送用户身份标识白名单中，则向因特网的DNS查询该URL的域名对应的目的数据业务服务器的IP地址，向UE返回携带该IP地址的业务重定向消息，以便UE不经过代理服务器直接向该数据业务服务器发送业务请求。</p>
    <p>[0056]	一种 SGSN，包括:</p>
    <p>[0057]	第六模块:接收UE发来的PDP上下文激活请求消息，检查该消息的PDP激活参数中的APN的设置，若APN未设置或设置错误，则将APN设置为正确APN，将该PDP上下文激活请求消息转发给GGSN。</p>
    <p>[0058]	与现有技术相比，本发明中，只将需要代理服务器进行代理处理的业务请求经过GGSN发送给了代理服务器，而不需代理服务器进行代理处理的业务请求都不经代理服务器直接传送给了目的数据业务服务器，从而降低了代理服务器的处理压力，降低了 GGSN与代理服务器之间的流量，降低了业务传送成本；且无需在UE上配置代理服务器的IP地址。</p>
    <p>[0059]	另外，本发明实施例中，通过SGSN的APN纠错功能，使得用户未在终端上正确配置APN时，或者，终端不支持多APN并发时，仍能成功进行代理处理，提高了用户体验。</p>
    <p>附图说明</p>
    <p>[0060]	图1为现有的APN处理机制示意图；</p>
    <p>[0061]	图2为现有的WAP APN处理机制示意图；</p>
    <p>[0062]	图3为本发明实施例提供的数据业务访问方法流程图；</p>
    <p>[0063]	图4为本发明实施例一提供的数据业务访问方法的消息流程示意图；</p>
    <p>[0064]	图5为本发明实施例提供的数据业务访问系统的组成示意图；</p>
    <p>[0065]	图6为本发明实施例提供的智能DNS的组成示意图。</p>
    <p>具体实施方式</p>
    <p>[0066]	下面结合附图及具体实施例对本发明再作进一步详细的说明。</p>
    <p>[0067]	图3为本发明实施例提供的数据业务访问方法流程图，如图3所示，其具体步骤如下:</p>
    <p>[0068]	步骤300:在通用分组无线服务(GPRS, General Packet Radio Service)网络中增加智能DNS，智能DNS保存需代理服务器进行代理处理的业务域名，同时记录代理服务器的IP地址。</p>
    <p>[0069]	这里，可以为不同的业务域名配置不同的代理服务器。</p>
    <p>[0070]	步骤301:GGSN接收用户设备(UE, User Equipment)发来的PDP上下文激活请求消息，为UE分配IP地址，并向UE返回智能DNS的IP地址。</p>
    <p>[0071 ] 步骤302:UE根据用户输入的待访问网站的统一资源定位符(URL，UniformResource Locator),向智能DNS发起携带待访问网站域名的DNS查询请求。</p>
    <p>[0072]	步骤303:智能DNS发现待访问网站域名为需代理服务器进行代理处理的业务域名，则向UE返回代理服务器的IP地址。</p>
    <p>[0073]	步骤304:UE向代理服务器发起携带待访问网站的URL的业务请求。</p>
    <p>[0074]	步骤305:代理服务器接收该业务请求，若根据该请求中的目的网站信息发现需要自身进行代理处理，则进行代理处理，处理完毕向目的网站服务器发送该业务请求。</p>
    <p>[0075]	其中，图3所示实 施例提到的业务为基于传输控制协议(TCP, TransmissionControl Protocol)承载的、使用文本型控制协议的业务，如:HTTP业务、实时流协议(RTSP, Real Time Streaming Protocol)业务。</p>
    <p>[0076]	其中，代理服务器可以是WAP网关，代理服务器进行的代理处理可以是获取并插入用户身份标识、获取用户的归属服务器等。</p>
    <p>[0077]	图4为本发明实施例一提供的数据业务访问方法的消息流程示意图，本实施例中代理服务器进行的代理处理是获取并插入用户身份标识，如图4所示，其具体步骤如下:</p>
    <p>[0078]	步骤400:在通用分组无线服务(GPRS, General Packet Radio Service)网络中增加智能DNS，在智能DNS上配置域名数据库，用于保存需WAP代理的域名，同时在智能DNS上配置A记录数据，用于记录WAP网关的IP地址。</p>
    <p>[0079]	步骤401:用户设备(UE,User Equipment)基于自身的数据连接设置，向网络侧发送PDP上下文激活请求消息。</p>
    <p>[0080]	这里，数据连接设置即接入GPRS网络的设置。</p>
    <p>[0081]	步骤402 =SGSN接收该PDP上下文激活请求消息，检查该消息的PDP激活参数中的APN的设置，若APN未设置或设置错误，则按照预定规则将APN设置为正确APN。</p>
    <p>[0082]	SGSN可以预先根据用户类型、终端类型等，为不同类型的用户、不同类型的终端设置不同的APN，即预先配置用户类型标识、终端类型标识等与APN的对应关系。当接收到TOP上下文激活请求消息时，若发现该消息中未设置APN，或者，发现该消息中的APN不为合法APN，则根据用户类型标识、终端类型标识等在预先配置中查询对应的APN，在该消息中设置该查询到的APN，或者将该消息中的APN替换为查询到的APN。</p>
    <p>[0083]	步骤403 =SGSN将该PDP上下文激活请求消息转发给GGSN。</p>
    <p>[0084]	步骤404 =GGSN接收该PDP上下文激活请求消息，为UE分配IP地址，并向用户信息注册服务器发送访问请求消息，如:针对CMWAP APN向WAP网关发送远程用户拨号认证系统(RADIUS, Remote Authentication Dial In User Service)消息，该消息包括 UE 的 IP地址、UE的漫游位置、用户身份标识如:移动终端号码、GGSN标识等。</p>
    <p>[0085]	步骤405:用户信息注册服务器接收该访问请求消息，首先经接入控制模块根据该消息中的GGSN标识对GGSN进行认证，认证通过后根据该消息中的UE的用户身份标识和IP地址对数据库中的数据进行检查、更新，具体操作为:查询该消息中的UE的用户身份标识和IP地址是否在数据库中，若是，按照该UE的用户身份标识和IP地址更新数据库，若否，则将该UE的用户身份标识和IP地址作为新的记录表项插入数据库；随后向GGSN返回指示上网接入的访问响应消息。</p>
    <p>[0086]	步骤406&#12316;407:GGSN接收该访问响应消息，经SGSN向UE返回PDP上下文激活成功响应消息，该响应消息中包含为该UE分配的IP地址、智能DNS地址。至此UE已经具备了访问数据业务服务器的条件。</p>
    <p>[0087]	步骤408:用户在UE上打开一项应用或在浏览器中输入待访问网站的统一资源定位符(URL, Uniform Resource Locator)。</p>
    <p>[0088]	步骤409:UE根据用户待访问的URL，获取待访问网站的域名，并向步骤407中GGSN返回的智能DNS发起携带该域名的DNS查询请求消息。</p>
    <p> [0089]	步骤410&#12316;411:智能DNS接收该DNS查询请求消息，查询自身的域名数据库，若发现该消息中的域名为需要进行WAP代理的域名，则在自身配置的A记录数据中，查找到WAP网关的IP地址，向UE返回DNS查询响应消息，该消息携带域名解析结果即WAP网关的IP地址。</p>
    <p>[0090]	当智能DNS在自身的域名数据库中未找到该消息中的域名时，若智能DNS之前已经从Internet的DNS处获得了该域名对应的目的数据业务服务器的IP地址，则智能DNS会在缓存中保留该域名与该数据业务服务器的IP地址的对应关系，因此，此时智能DNS可以先在缓存中查询该域名，若查询到，则可直接获得目的数据业务服务器的IP地址；否则，再向Internet的DNS发起域名递归查询请求消息。智能DNS查询到目的数据业务服务器的IP地址时，会向UE返回DNS查询响应消息，该消息携带目的数据业务服务器的IP地址，UE收到该IP地址后，向该IP地址发起HTTP请求消息。</p>
    <p>[0091]	步骤412:UE接收该DNS查询响应消息，将该消息中的WAP网关的IP地址作为HTTP请求消息的目的地址，并在报文的URL的host部分中填入数据业务服务器的域名，向WAP网关发送该HTTP请求消息。</p>
    <p>[0092]	HTTP请求消息的URL即步骤408中用户输入的待访问网站的URL，HTTP请求消息的URL的host部分中的数据业务服务器的域名即步骤409中待访问网站的域名。</p>
    <p>[0093]	步骤413 =SGSN接收该HTTP请求消息，将该消息发送给GGSN，GGSN接收该消息，发现该消息的目的地址为WAP网关的IP地址，则将该消息发送给WAP网关。</p>
    <p>[0094]	对于目的地址不为WAP网关的HTTP请求消息，GGSN不会将该消息发送给WAP网关，而是直接发送至目的服务器；同样，对于非HTTP消息，GGSN也会直接发送至目的服务器。</p>
    <p>[0095]	步骤414 =WAP网关接收该HTTP请求消息，查询该消息中待访问网站信息是否位于传送用户身份标识的白名单中，若是，向用户信息注册服务器发送用户身份信息查询请求消息，该消息携带HTTP请求消息的源IP地址即UE的IP地址。</p>
    <p>[0096]	这里,待访问网站信息可以是待访问网站的URL,或者，当HTTP请求消息的Host部分为待访问网站的域名时，这里的待访问网站信息可以是待访问网站的域名，当HTTP请求消息的Host部分为待访问网站的IP地址时，这里的待访问网站信息可以是待访问网站的IP地址。</p>
    <p>[0097]	步骤415 =WAP网关接收用户信息注册服务器返回的携带UE用户身份标识的用户身份信息查询响应消息，根据预定WAP代理策略在HTTP请求消息中插入用户身份标识。</p>
    <p>[0098]	这里，预定WAP代理策略可以与现有技术相同。</p>
    <p>[0099]	用户身份标识可以是UE的MSISDN等，也可以是按照预定WAP代理策略转换后的其它表示。</p>
    <p>[0100]	步骤416 =WAP网关作为代理服务器，向HTTP请求消息的Host部分所指向的目的地址发送该HTTP请求消息。</p>
    <p>[0101]	本步骤中,WAP网关首先要向Internet的DNS查询HTTP请求消息的Host部分中的域名对应的IP地址，该IP地址即为目的数据业务服务器的IP地址，查询到后，向该IP地址发送该HTTP请求消息。</p>
    <p>[0102]	步骤417&#12316;418:数据业务服务器接收该HTTP请求消息，在确认该消息来自WAP网关的前提下，根据消息中的用户身份标识确认用户身份，然后获取业务内容，将业务内容放入HTTP响应消息中发送给WAP网 关。[0103]	这里，确认该HTTP请求消息来自WAP网关可以是:信任WAP网关的IP地址、或者已经与WAP网关建立了安全传输通道，等。</p>
    <p>[0104]	步骤419 =WAP网关接收该HTTP响应消息，根据预定策略，确认是否需要对HTTP响应消息进行处理如:压缩或协议适配，若需要，则进行相应处理。</p>
    <p>[0105]	步骤420 =WAP网关向UE转发该HTTP响应消息。</p>
    <p>[0106]	当代理服务器如:WAP网关进行的代理处理是获取用户的归属服务器时，此时的处理流程与图4所示流程的区别如下:</p>
    <p>[0107]	步骤415更改为:WAP网关接收用户信息注册服务器返回的携带UE用户身份标识的用户身份信息查询响应消息后，根据该用户身份标识和HTTP请求中的待访问网站的域名，向ENUM DNS查询到用户的归属服务器。</p>
    <p>[0108]	或者，本步骤中的用户身份信息查询响应消息可以进一步携带UE的漫游位置，WAP网关根据UE的漫游位置和HTTP请求中的待访问网站的域名，向ENUM DNS查询到用户的归属服务器。</p>
    <p>[0109]	同时，步骤416更改为:WAP网关作为代理服务器，向用户的归属服务器发送该HTTP请求消息。</p>
    <p>[0110]	同时，步骤417&#12316;418中的数据业务服务器为:用户的归属服务器。</p>
    <p>[0111]	从图4所示实施可以看出:当用户发起一项业务访问时，UE会先向智能DNS查询待访问网站的域名是否为需要进行WAP代理的域名，若是，直接将HTTP请求消息的目的地址填写为WAP网关的IP地址，并在HTTP请求消息的URL的host部分中填写目的数据业务服务器的域名；否则，将HTTP请求消息的目的地址填写为目的数据业务服务器的域名，从而使得:只将需要进行WAP代理的HTTP请求经过GGSN发送给了 WAP网关，而不需进行WAP代理的HTTP请求和非HTTP请求都不经WAP网关直接传送给了目的数据业务服务器，从而降低了 WAP网关的处理压力，降低了 GGSN与WAP网关之间的流量，降低了业务传送成本。</p>
    <p>[0112]	图5为本发明实施例提供的数据业务访问系统的组成示意图，如图5所示，其主要包括:UE51、SGSN52、GGSN53、智能DNS54、用户信息注册服务器55、代理服务器56、数据业务服务器57，其中:</p>
    <p>[0113]	UE51:基于自身的数据连接设置，向网络侧发送PDP上下文激活请求消息；当用户打开了一项应用或在浏览器中输入了待访问网站的URL时，获取待访问网站的域名，并向智能DNS54发起携带该域名的DNS查询请求消息，接收智能DNS54返回的DNS查询响应消息，将该消息中的代理服务器的IP地址作为HTTP请求消息的目的地址，并在报文的URL的host部分中填入待访问网站的域名，向代理服务器56发送该HTTP请求消息。</p>
    <p>[0114]	SGSN52:接收UE51发来的PDP上下文激活请求消息，检查该消息的PDP激活参数中的APN的设置，若APN未设置或设置错误，则按照预定规则将APN设置为正确APN，将该PDP上下文激活请求消息转发给GGSN53 ;接收UE51发来的HTTP请求消息，将该消息发送给GGSN53。</p>
    <p>[0115]	GGSN53:接收SGSN52转发来的来自UE51的PDP上下文激活请求消息，为UE分配IP地址，并向用户信息注册服务器55发送访问请求消息，该消息包括UE的IP地址、UE的漫游位置、用户身份标识如:移动终端号码、GGSN标识等，接收用户信息注册服务器55返回的指示上网接入的访问响应消息 ，经SGSN52向UE51返回PDP上下文激活成功响应消息，该响应消息中包含为该UE51分配的IP地址、智能DNS54的IP地址；接收SGSN52转发来的HTTP请求消息，若发现该消息的目的地址为代理服务器的IP地址，则将该消息发送给代理服务器56。</p>
    <p>[0116]	智能DNS54:配置有域名数据库，用于保存需代理服务器进行代理处理的业务域名，同时配置有A记录数据，用于记录代理服务器的IP地址；接收UE51发来的DNS查询请求消息，查询自身的域名数据库，若发现该消息中的域名为需要代理服务器进行代理处理的域名，则在自身配置的A记录数据中，查找到代理服务器56的IP地址，向UE51返回DNS查询响应消息，该消息携带域名解析结果即代理服务器56的IP地址。</p>
    <p>[0117]	智能DNS54进一步用于，当接收到UE51发来的携带待访问网站域名的DNS查询请求消息后，若发现该域名为不需代理服务器进行代理处理的业务域名，则向因特网的DNS查询该域名对应的目的数据业务服务器的IP地址，向UE51返回携带该IP地址的DNS查询响应消息，以便UE51不经过代理服务器直接向该数据业务服务器发送HTTP请求消息。</p>
    <p>[0118]	用户信息注册服务器55:接收GGSN53发来的访问请求消息，根据该消息中的GGSN标识对GGSN进行认证，认证通过后根据该消息中的UE的用户身份标识和IP地址对数据库中的数据进行检查、更新，随后向GGSN53返回指示上网接入的访问响应消息；接收代理服务器56发来的用户身份信息查询请求消息，查询该消息中的UE的IP地址对应的用户身份标识，将该用户身份标识携带在用户身份信息查询响应消息中返回给代理服务器56。</p>
    <p>[0119]	代理服务器56:接收GGSN53转发来的HTTP请求消息，查询该消息中待访问网站信息是否位于传送用户身份标识的白名单中，若是，向用户信息注册服务器55发送用户身份信息查询请求消息，该消息携带HTTP请求消息的源IP地址即UE的IP地址，接收用户信息注册服务器55返回的携带UE用户身份标识的用户身份信息查询响应消息，根据预定代理策略进行代理处理，处理完毕作为代理服务器，向HTTP请求消息的数据业务服务器发送该HTTP请求消息；接收数据业务服务器57发来的HTTP响应消息，向UE51转发该消息。</p>
    <p>[0120]	代理服务器56进一 步用于，当接收到GGSN53转发来的HTTP请求消息时，若发现该消息中的待访问网站信息未位于自身配置的传送用户身份标识白名单中，则向因特网的DNS查询该URL的域名对应的目的数据业务服务器的IP地址，向UE51返回携带该IP地址的HTTP重定向消息，以便UE51不经过代理服务器56直接向该数据业务服务器发送HTTP请求消息。</p>
    <p>[0121]	数据业务服务器57:接收代理服务器56发来的HTTP请求消息，在确认该消息来自代理服务器56的前提下，根据消息中的用户身份标识确认用户身份，然后获取业务内容，将业务内容放入HTTP响应消息中发送给代理服务器56。</p>
    <p>[0122]	图6为本发明实施例提供的位于GPRS网络中的智能DNS的组成示意图，如图6所不，其主要包括:第一模块541和第二模块542,其中:</p>
    <p>[0123]	第一模块541:保存需代理服务器进行代理处理的业务域名，同时记录代理服务器的IP地址。</p>
    <p>[0124]	第二模块542:接收UE51发来的携带待访问网站域名的DNS查询请求消息，向第一模块541查询该域名是否为需代理服务器进行代理处理的业务域名，若是，向UE51返回携带代理服务器的IP地址的DNS查询响应消息，以便UE51向代理服务器56发起HTTP请求；否则，向Internet的DNS查询该域名对应的IP地址，将该IP地址携带在DNS查询响应消息返回给UE51。</p>
    <p>[0125]以下给出本发明实施例提供的GGSN的组成，其主要包括:第三模块和第四模块，其中:</p>
    <p>[0126]	第三模块:接收SGSN52转发来的来自UE51的PDP上下文激活请求消息，为UE分配IP地址，并向用户信息注册服务器55发送访问请求消息，该消息包括UE的IP地址、UE的漫游位置、用户身份标识如:移动终端号码、GGSN标识等，接收用户信息注册服务器55返回的指示上网接入的访问响应消息，经SGSN52向UE51返回PDP上下文激活成功响应消息，该响应消息中包含为该UE51分配的IP地址、智能DNS54的IP地址。</p>
    <p>[0127]	第四模块:接收SGSN52转发来的HTTP请求消息，若发现该消息的目的地址为代理服务器的IP地址，则将该消息发送给代理服务器56 ;否则，不经过代理服务器直接将该消息发送至目的服务器。</p>
    <p>[0128]	以下给出本发明实施例提供的代理服务器的组成，该代理服务器主要包括:第五模块，用于接收GGSN53转发来的来自UE51的HTTP请求消息，若根据该请求消息中的目的网站信息发现需要代理服务器进行代理处理，则根据该消息的源IP地址从用户信息注册服务器55获取对应的用户身份信息，根据预定策略进行代理处理，处理完毕向目的数据业务服务器57发送该HTTP请求消息。</p>
    <p>[0129]	以下给出本发明实施例提供的SGSN的组成，该SGSN主要包括:第六模块，用于接收UE51发来的PDP上下文激活请求消息，检查该消息的PDP激活参数中的APN的设置，若APN未设置或设置错误，则将APN设置为正确APN，将该PDP上下文激活请求消息转发给GGSN53。</p>
    <p>[0130]	以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所做的任何修改 、等同替换、改进等，均应包含在本发明保护的范围之内。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101064936A?cl=zh">CN101064936A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2006年4月28日</td><td class="patent-data-table-td patent-date-value">2007年10月31日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">一种漫游用户的归属地的接入方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101631133A?cl=zh">CN101631133A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2008年7月15日</td><td class="patent-data-table-td patent-date-value">2010年1月20日</td><td class="patent-data-table-td ">华为技术有限公司;中国移动通信集团公司</td><td class="patent-data-table-td ">一种域名解析系统、设备及方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101959250A?cl=zh">CN101959250A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年11月4日</td><td class="patent-data-table-td patent-date-value">2011年1月26日</td><td class="patent-data-table-td ">广州瀚信通信科技股份有限公司</td><td class="patent-data-table-td ">一种移动通信系统的可引导终端接入方法和网络设备</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103220371A?cl=zh">CN103220371A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年1月18日</td><td class="patent-data-table-td patent-date-value">2013年7月24日</td><td class="patent-data-table-td ">中国移动通信集团公司</td><td class="patent-data-table-td ">内容适配方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20040120296">US20040120296</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2003年5月14日</td><td class="patent-data-table-td patent-date-value">2004年6月24日</td><td class="patent-data-table-td ">Seung-Que Lee</td><td class="patent-data-table-td ">GPRS (general packet radio service) system with multiple GGSNS (gateway GPRS supporting nodes) and method for selecting GGSN</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102684974A?cl=zh">CN102684974A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年3月10日</td><td class="patent-data-table-td patent-date-value">2012年9月19日</td><td class="patent-data-table-td ">中国移动通信集团公司</td><td class="patent-data-table-td ">业务访问的路由方法、装置及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102684974B?cl=zh">CN102684974B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年3月10日</td><td class="patent-data-table-td patent-date-value">2015年4月22日</td><td class="patent-data-table-td ">中国移动通信集团公司</td><td class="patent-data-table-td ">业务访问的路由方法、装置及系统</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=0LrHCAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029120000">H04L29/12</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=0LrHCAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029080000">H04L29/08</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=0LrHCAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04W0008260000">H04W8/26</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2013年7月24日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年8月21日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/83d7798df12b24ecd223/CN103220372A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_50a6672b5f82ffbd39b7a9e87fd4594c.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E6%95%B0%E6%8D%AE%E4%B8%9A%E5%8A%A1%E8%AE%BF%E9%97%AE%E6%96%B9%E6%B3%95%E5%8F%8A%E7%B3%BB%E7%BB%9F.pdf?id=0LrHCAABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U3mvd9YUiQopho6WcGXA8FqkGDuNQ"},"sample_url":"https://www.google.com/patents/reader?id=0LrHCAABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>