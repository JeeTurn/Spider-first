<!DOCTYPE html><html><head><title>专利 CN102521104A - 高安全性系统运行进度的监控方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_5115ea495017d9115e613207d3810e5a/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_5115ea495017d9115e613207d3810e5a__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="高安全性系统运行进度的监控方法"><meta name="DC.contributor" content="徐晓燕" scheme="inventor"><meta name="DC.contributor" content="束元" scheme="inventor"><meta name="DC.contributor" content="蔡李峰" scheme="inventor"><meta name="DC.contributor" content="南京恩瑞特实业有限公司" scheme="assignee"><meta name="DC.date" content="2011-12-13" scheme="dateSubmitted"><meta name="DC.description" content="一种高安全性系统运行进度的监控方法，其特征是：1）采用计算机外部的专用时钟中断作为定时器计数，在故障-安全计算机中设置一个专用时钟，向多个CPU发送同步信号；CPU上的软件采用该同步信号作为定时器计数，就能保证多个CPU的定时器到期时间的一致性；2）在接收通信数据时采用消息队列方式；3）在系统运行流程中增加监控代码；4）使用监控到期处理函数；5）对所有监控进行统一管理。本发明的方法既能对系统的“运行滞后”故障做到及时准确地识别，又能对“系统停滞”故障进行及时修复，解决了轨道交通中对进度监控的安全性和可用性要求。"><meta name="DC.date" content="2012-6-27"><meta name="DC.relation" content="CN:101268447:A" scheme="references"><meta name="DC.relation" content="CN:101847107:A" scheme="references"><meta name="DC.relation" content="CN:102129393:A" scheme="references"><meta name="DC.relation" content="US:20020152446:A1" scheme="references"><meta name="citation_reference" content="陈文赛: &quot;一种高可靠性、高安全性系统&#8212;&#8212;三取二计算机系统&quot;, 《现代雷达》, vol. 26, no. 6, 30 June 2004 (2004-06-30), pages 21 - 2"><meta name="citation_patent_publication_number" content="CN:102521104:A"><meta name="citation_patent_application_number" content="CN:201110413974"><link rel="canonical" href="https://www.google.com/patents/CN102521104A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN102521104A?cl=zh"/><meta name="title" content="专利 CN102521104A - 高安全性系统运行进度的监控方法"/><meta name="description" content="一种高安全性系统运行进度的监控方法，其特征是：1）采用计算机外部的专用时钟中断作为定时器计数，在故障-安全计算机中设置一个专用时钟，向多个CPU发送同步信号；CPU上的软件采用该同步信号作为定时器计数，就能保证多个CPU的定时器到期时间的一致性；2）在接收通信数据时采用消息队列方式；3）在系统运行流程中增加监控代码；4）使用监控到期处理函数；5）对所有监控进行统一管理。本发明的方法既能对系统的“运行滞后”故障做到及时准确地识别，又能对“系统停滞”故障进行及时修复，解决了轨道交通中对进度监控的安全性和可用性要求。"/><meta property="og:title" content="专利 CN102521104A - 高安全性系统运行进度的监控方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN102521104A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN102521104A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=ZwpbBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN102521104A&amp;usg=AFQjCNFWtltfHJJPjDe3vLaM7XIpRygLow" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/0cc0551406c253c0d702/CN102521104A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/0cc0551406c253c0d702/CN102521104A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN102521104A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN102521104A?cl=en&amp;hl=zh-CN"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN102521104A?cl=zh" style="display:none"><span itemprop="description">一种高安全性系统运行进度的监控方法，其特征是：1）采用计算机外部的专用时钟中断作为定时器计数，在故障-安全计算机中设置一个专用时钟，向多个CPU发送同步信号；CPU上的软件采用该同步信号作为定时器计数，就能保证 ...</span><span itemprop="url">https://www.google.com/patents/CN102521104A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN102521104A - 高安全性系统运行进度的监控方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN102521104A - 高安全性系统运行进度的监控方法" title="专利 CN102521104A - 高安全性系统运行进度的监控方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN102521104 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201110413974</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2012年6月27日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2011年12月13日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2011年12月13日</td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201110413974.9, </span><span class="patent-bibdata-value">CN 102521104 A, </span><span class="patent-bibdata-value">CN 102521104A, </span><span class="patent-bibdata-value">CN 201110413974, </span><span class="patent-bibdata-value">CN-A-102521104, </span><span class="patent-bibdata-value">CN102521104 A, </span><span class="patent-bibdata-value">CN102521104A, </span><span class="patent-bibdata-value">CN201110413974, </span><span class="patent-bibdata-value">CN201110413974.9</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%BE%90%E6%99%93%E7%87%95%22">徐晓燕</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%9D%9F%E5%85%83%22">束元</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E8%94%A1%E6%9D%8E%E5%B3%B0%22">蔡李峰</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E5%8D%97%E4%BA%AC%E6%81%A9%E7%91%9E%E7%89%B9%E5%AE%9E%E4%B8%9A%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">南京恩瑞特实业有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102521104A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102521104A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102521104A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (4),</span> <span class="patent-bibdata-value"><a href="#npl-citations">非专利引用</a> (1),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (1),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=ZwpbBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201110413974&amp;usg=AFQjCNHUwH0IGvoNywPdf96vEs2iV9JLoQ"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=ZwpbBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D102521104A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNHOsC4H37AomOsedOmjUqVejjSogg"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT113600345" lang="ZH" load-source="patent-office">高安全性系统运行进度的监控方法</invention-title>
      </span><br><span class="patent-number">CN 102521104 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA97599948" lang="ZH" load-source="patent-office">
    <div class="abstract">一种高安全性系统运行进度的监控方法，其特征是：1）采用计算机外部的专用时钟中断作为定时器计数，在故障-安全计算机中设置一个专用时钟，向多个CPU发送同步信号；CPU上的软件采用该同步信号作为定时器计数，就能保证多个CPU的定时器到期时间的一致性；2）在接收通信数据时采用消息队列方式；3）在系统运行流程中增加监控代码；4）使用监控到期处理函数；5）对所有监控进行统一管理。本发明的方法既能对系统的“运行滞后”故障做到及时准确地识别，又能对“系统停滞”故障进行及时修复，解决了轨道交通中对进度监控的安全性和可用性要求。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(3)</span></span></div><div class="patent-text"><div mxw-id="PCLM43131022" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.	一种高安全性系统运行进度的监控方法，其特征是：1)采用计算机外部的专用时钟中断作为定时器计数，在故障-安全计算机中设置一个专用时钟，向多个CPU发送同步信号；CPU上的软件采用该同步信号作为定时器计数，就能保证多个CPU的定时器到期时间的一致性；2)在接收通信数据时采用消息队列方式，在系统的某个处理流程中，如果存在等待接收通信数据的行为，则定义一个消息队列作为该流程所处的线程接收外界事件通知的唯一方式；3)在系统运行流程中增加监控代码，对不包含接收通信数据的流程，只需在流程的头尾加上监控代码，分别是启动监控函数和取消监控函数；对包含接收通信数据的流程，在流程的头部加上启动监控函数，在流程中间收到数据接收完毕消息时，加上取消监控函数；在收到数据接收超时消息时，加上检查监控是否有效函数；4)使用监控到期处理函数，对不包含接收通信数据的流程，监控到期时，即检测出“运行滞后”故障，对包含接收通信数据的流程，监控到期时，即检测出“系统停滞”故障，处理的措施就是发送监控到期消息，通知主线程进行故障处理；5)对所有监控进行统一管理，不管是对“运行滞后”的监控，还是对“系统停滞”的监控，都采用统一的方式进行监控，这样，可以定义一个通用的监控方案，当某个程序过程需要监控时，只需调用相应的监控方案进行监控即可，所述的监控方案中应包含的信息有：监控ID、监控初始化函数、监控到期处理函数、监控取消函数和监控的定时器时延。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.根据权利要求1所述的方法，其特征是所述的处理流程只会在消息队列收到新消息时中断，将等待外界传入数据的过程函数放到专门的接收线程中，该接收线程收到数据后会给主线程发数据接收完毕消息，主线程在while循环中使用msgQReceive等待所有外界事件通知；当收到数据接收完毕消息时，取消该监控，退出循环，去获取相应的数据；当收到数据接收到由定时器触发的超时消息时，退出循环，采取发送重发请求的故障处理措施， 如果三次重发后还是没收到，则跳过该数据处理新的数据。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.根据权利要求1所述的方法，其特征是所述的检查监控是否有效的作用是：当某个流程的运行时间非常接近定时器的计数时，可能存在这样的情况，消息队列先收到数据接收完毕消息，紧接着又收到定时器触发的监控到期消息，然后msgQReceive取出了数据接收完毕消息，取消了监控，并退出了循环，但此时消息队列中还残留着已失效的监控到期消息，当启动下一次监控时，如果不对其有效性进行判断，则会导致监控刚启动就到期，该函数就是用来防止出现该情况的。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES47687330" lang="ZH" load-source="patent-office" class="description">
    <p>高安全性系统运行进度的监控方法技术领域[0001]	本发明涉及一种轨道交通技术，尤其是一种轨道交通中的安全监控技术，具体地说是一种轨道交通中使用的中高安全性系统运行进度的监控方法。背景技术[0002]	目前，在一些涉及重大人身安全的自动控制系统领域，要求系统具有极高的安全性，为此，对系统中出现的故障要采取防护措施。在这些故障中，有部分故障是跟系统的运行进度相关的。如某种逻辑运算的运行时间过长，导致该有的输出延迟了，这里称之为“运行滞后”故障；如在通信过程中（包括系统内部通信和外部通信）因为干扰没有收到特定的数据，导致系统流程停留在某个位置，这里称之为“系统停滞”故障。出现这两类故障会使系统无法满足实时性，导致严重的后果。因此，要对系统的运行进度进行监控，一旦出现故障， 一方面需要及时准确地检测出来，另一方面要尽快修复故障，如果是不可修复的，则要采取安全措施(如输出安全信号)，防止产生危险。这样系统才能满足安全性和可用性的要求。[0003]	目前，越来越多的高安全性系统的核心逻辑已经由故障-安全计算机来完成。故障-安全计算机中有多块进行逻辑运算的CPU，它们运算的结果会经过表决后再对外输出。 为检测系统的某个操作是否在规定时间内完成，运行在CPU上的软件需要启动定时器进行倒计时。通常定时器是由操作系统提供，采用计算机内自带的时钟源。但在故障-安全计算机中，因为无法保证多个CPU上的时钟精度一致，可能会导致定时器到期的时间不一致。 如果时钟误差达到一定值，可能会造成多个CPU之间产生不同的行为，从而影响表决结果。 因此，为满足安全性指标，需要有可靠的定时器方式来实现计时准确且多个CPU &#8212;致。[0004]	在系统的运行流程中如果有等待接收通信数据的行为，那么就有可能产生“系统停滞”故障。传统的等待通信数据的方法是采用recv函数，当数据收到时，该函数返回。但问题时，如果在规定时间内没有收到数据，即产生了 “系统停滞”故障，该流程无法被中断， 因为它被“卡”在recv函数中。此时，如果要想修复该故障，唯一能做的就是杀死该流程所处的线程。但这种做法通常是很“粗鲁”的，并且可能会有安全风险。因此，为满足可用性和安全性指标，需要有一种设计方法保证在发生“系统停滞”故障时，系统能安全地运行下去。发明内容[0005]	本发明的目的是针对现有的高安全性系统运行中易出现运行滞后和系统滞后两种严重影响安全运行的问题，发明一种既能对系统的“运行滞后”故障做到及时准确地识别，又能对“系统停滞”故障进行及时修复的高安全性系统运行进度的监控方法，以满足轨道交通高安全性系统对进度监控的安全性和可用性要求。[0006]	本发明的技术方案是：一种高安全性系统运行进度的监控方法，其特征是：1)采用计算机外部的专用时钟中断作为定时器计数，在故障-安全计算机中设置一个专用时钟，向多个CPU发送同步信号；CPU上的软件采用该同步信号作为定时器计数，就能保证多个CPU的定时器到期时间的一致性；2)在接收通信数据时采用消息队列方式，在系统的某个处理流程中，如果存在等待接收通信数据的行为，则定义一个消息队列作为该流程所处的线程接收外界事件通知的唯一方式；3)在系统运行流程中增加监控代码，对不包含接收通信数据的流程，只需在流程的头尾加上监控代码，分别是启动监控函数和取消监控函数；对包含接收通信数据的流程，在流程的头部加上启动监控函数，在流程中间收到数据接收完毕消息时，加上取消监控函数；在收到数据接收超时消息时，加上检查监控是否有效函数；4)使用监控到期处理函数，对不包含接收通信数据的流程，监控到期时，即检测出“运行滞后”故障，对包含接收通信数据的流程，监控到期时，即检测出“系统停滞”故障，处理的措施就是发送监控到期消息，通知主线程进行故障处理；5)对所有监控进行统一管理，不管是对“运行滞后”的监控，还是对“系统停滞”的监控，都采用统一的方式进行监控，这样，可以定义一个通用的监控方案，当某个程序过程需要监控时，只需调用相应的监控方案进行监控即可，所述的监控方案中应包含的信息有：监控ID、监控初始化函数、监控到期处理函数、监控取消函数和监控的定时器时延。[0007]	所述的处理流程只会在消息队列收到新消息时中断，将等待外界传入数据的过程函数放到专门的接收线程中，该接收线程收到数据后会给主线程发数据接收完毕消息，主线程在while循环中使用msgQReceive等待所有外界事件通知；当收到数据接收完毕消息时，取消该监控，退出循环，去获取相应的数据；当收到数据接收到由定时器触发的超时消息时，退出循环，采取发送重发请求的故障处理措施，如果三次重发后还是没收到，则跳过该数据处理新的数据。[0008]	所述的检查监控是否有效的作用是：当某个流程的运行时间非常接近定时器的计数时，可能存在这样的情况，消息队列先收到数据接收完毕消息，紧接着又收到定时器触发的监控到期消息，然后msgQReceive取出了数据接收完毕消息，取消了监控，并退出了循环，但此时消息队列中还残留着已失效的监控到期消息，当启动下一次监控时，如果不对其有效性进行判断，则会导致监控刚启动就到期，该函数就是用来防止出现该情况的。[0009]	本发明的有益效果：本发明的方法既能对系统的“运行滞后”故障做到及时准确地识别，又能对“系统停滞” 故障进行及时修复，解决了轨道交通中对进度监控的安全性和可用性要求。附图说明[0010]	图1是本发明的采用消息队列方式接收通信数据示意图。[0011]	图2是本发明的出现失效的监控到期消息的场景示意图。[0012]	图3是本发明的故障-安全计算机从二取二变为三取二的示意图。[0013]	图4是本发明的故障-安全计算机学习过程监控的示意图。[0014]	图5是本发明的故障-安全计算机逻辑运算监控的示意图。具体实施方式[0015]	下面结合附图和实施例对本发明作进一步的说明。[0016]	如图1-5所示。[0017]	一种高安全性系统运行进度的监控方法，它采用了以下措施： 1)采用计算机外部的专用时钟中断作为定时器计数在故障-安全计算机中设置一个专用时钟，向多个CPU发送同步信号。CPU上的软件采用该同步信号作为定时器计数，就能保证多个CPU的定时器到期时间的一致性。[0018]	2)在接收通信数据时采用消息队列方式在系统的某个处理流程中，如果存在等待接收通信数据的行为，则定义一个消息队列作为该流程所处的线程(假设为主线程）接收外界事件通知的唯一方式。这样，该处理流程只会在该消息队列收到新消息时中断。将等待外界传入数据的过程函数(如recv)放到专门的接收线程中，该接收线程收到数据后会给主线程发数据接收完毕消息。主线程在while 循环中使用msgQReceive等待所有外界事件通知。当收到数据接收完毕消息时，取消该监控，退出循环，去获取相应的数据；当收到数据接收超时消息（由定时器触发）时，退出循环， 采取相应的故障处理措施，如发送重发请求。如果三次重发后还是没收到，则跳过该数据处理新的数据等。采用消息队列方式接收通信数据的流程如图1所示。[0019]	3)在系统运行流程中增加监控代码对不包含接收通信数据的流程，只需在流程的头尾加上监控代码，分别是启动监控函数和取消监控函数。[0020]	对包含接收通信数据的流程，在流程的头部加上启动监控函数，在流程中间收到数据接收完毕消息时，加上取消监控函数；在收到数据接收超时消息（即监控到期消息）时， 加上检查监控是否有效函数。[0021]	监控的各种函数的作用如下：启动监控：启动该监控预先定制的定时器。[0022]	取消监控：取消该监控已经启动的定时器。[0023]	检查监控是否有效：当某个流程的运行时间非常接近定时器的计数时，可能存在这样的情况，消息队列先收到数据接收完毕消息，紧接着又收到定时器触发的监控到期消息，然后msgQReceive取出了数据接收完毕消息，取消了监控，并退出了循环。但此时消息队列中还残留着已失效的监控到期消息，当启动下一次监控时，如果不对其有效性进行判断，则会导致监控刚启动就到期。该函数就是用来防止出现该情况的。出现失效的监控到期消息的场景如图2所示。[0024]	4)使用监控到期处理函数对不包含接收通信数据的流程，监控到期时，即检测出“运行滞后”故障，至于具体的措施，取决于系统的策略。因为“运行滞后”故障通常是设计错误导致的，如对CPU运算性能和系统负载的估计不正确等，所以该故障发生后，比较安全的做法是关闭CPU，同时，由于整个系统是故障-安全的，当所有CPU关闭后，系统就会对外输出安全的信号。[0025]	对包含接收通信数据的流程，监控到期时，即检测出“系统停滞”故障，处理的措施就是发送监控到期消息，通知主线程进行故障处理。[0026]	5)对所有监控进行统一管理不管是对“运行滞后”的监控，还是对“系统停滞”的监控，都采用统一的方式进行监控。这样，可以定义一个通用的监控方案，当某个程序过程需要监控时，只需调用相应的监控方案进行监控即可。监控方案中包含的信息有：监控ID (用来唯一标识该监控)，监控初始化函数，监控到期处理函数，监控取消函数，监控的定时器时延。[0027]	下面以三取二故障-安全计算机为例作进一步说明。[0028]	1) “系统停滞”故障的监控正常情况下，该计算机有3个CPU进行三取二工作，当其中有一块CPU损坏取走后，剩下两块CPU进行二取二工作。当再插入一块新的CPU时，会与原有的两块CPU进行协商，重新进行三取二工作。该过程的流程如图3所示。在协商过程中，新的CPU需要学习原有CPU 的数据，此时系统处于“非工作”状态。但是，系统停留在该状态的时间必须很短，因为如果停留的时间超过规定时间，就会产生“系统停滞”故障，就有可能产生危险。因此，需要对该学习过程进行监控。如果在规定时间内没能完成学习过程，原有的两块CPU需要强制回到二取二状态继续工作。[0029]	在学习过程中，原有CPU需要发送数据给新CPU，发送完后，等待新CPU反馈学习结果。在等待新CPU反馈学习结果前，启动监控M1，监控的时延为tl。在while循环中使用msgQReceive等待所有外界事件通知。当收到学习结果且为成功时，取消监控M1，退出循环，在规定的时间点转为三取二状态；当收到学习结果且为失败时，取消监控M1，退出循环，在规定的时间点转为二取二状态；当收到监控到期消息时，退出循环，直接转为二取二状态。学习过程监控的流程如图4所示。[0030]	Ml的监控方案配置如下：{M0NIT0R_ID_STUDY, // 监控 ID &amp;study_monitor_init，// 监控初始化函数 &amp;study_monitor_expire, // 监控至棚函数 &amp;study_monitor_cancel, // 监控取消函数20 //监控时延（以专用时钟节拍计数）}当监控Ml启动时，首先会调用studyjiionitorjnit，增加相应的定时器，定时器的计数值为20。CPU中的软件会有一个线程维护定时器，该线程由外部专用时钟中断驱动。每次时钟中断过来，则检查所有的定时器，看是否有到期的。若Ml定时器的计数值减为0，则调用study_monitor_expire。若主线程在到期前调用study_monitor_cancel，则会提前取消该定时器。[0031]	在studyjnonitoi^expire中，会往主线程发送监控到期消息。主线程都到该消息后，会检查监控是否有效，如果有效，则退出循环，转为二取二状态。[0032]	2) “运行滞后”故障的监控该计算机中的3个CPU进入三取二工作状态后，开始进行逻辑处理。通常，逻辑处理是周期性运行的。周期的大小(如300ms)是根据应用的特点决定的，例如应用会有要求每隔一个周期必须往外输出指令。如果一个周期内的逻辑运算超过了规定时间，导致应用完成输出的时间超过了一个周期，就会产生“运行滞后”故障，就有可能产生危险。因此，需要对逻辑运算进行监控。如果在规定时间内没能完成特定的逻辑运算，系统就要关闭相应的CPU。如果只有1个CPU运算超期，则剩下的2个CPU仍能进行二取二工作。如果有2个CPU运算超期，则先是2个CPU被关闭，紧接着因为系统不允许单个CPU工作，最后所有CPU都会关闭，系统对外输出安全的信号。[0033]	在特定逻辑运算的开头，启动监控M2，监控的时延为t2。在该逻辑运算的结尾，取消监控M2。如果在运算期间监控到期，则说明产生了 “运行滞后”故障，会进行相应的故障处理。逻辑运算监控的流程如图5所示。[0034]	M2的监控方案配置如下：{M0NIT0R_ID_L0GIC, // 监控 ID &amp;logic_monitor_init, // 监控初始化函数 &amp;logic_monitor_expire, // 监控至棚函数 &amp;logic_monitor_cancel, // 监控取消函数5 //监控时延（以专用时钟节拍计数）}当监控M2启动时，首先会调用logicjiionitorjnit，增加相应的定时器，定时器的计数值为5。若M2定时器的计数值减为0，则调用l0giC_m0nit0r_eXpire。[0035]	在logic_monitor_expire中，会通知系统进行自身CPU的关闭操作。[0036]	本发明未涉及部分均与现有技术相同或可采用现有技术加以实现。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101268447A?cl=zh">CN101268447A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2006年5月19日</td><td class="patent-data-table-td patent-date-value">2008年9月17日</td><td class="patent-data-table-td ">美国联合包裹服务公司</td><td class="patent-data-table-td ">软件进程监控</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101847107A?cl=zh">CN101847107A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年3月30日</td><td class="patent-data-table-td patent-date-value">2010年9月29日</td><td class="patent-data-table-td ">南京恩瑞特实业有限公司</td><td class="patent-data-table-td ">基于消息队列的外界数据接收方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102129393A?cl=zh">CN102129393A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年3月9日</td><td class="patent-data-table-td patent-date-value">2011年7月20日</td><td class="patent-data-table-td ">南京恩瑞特实业有限公司</td><td class="patent-data-table-td ">通用定时任务管理的实现方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US20020152446">US20020152446</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2001年4月13日</td><td class="patent-data-table-td patent-date-value">2002年10月17日</td><td class="patent-data-table-td ">Fleming Roger A.</td><td class="patent-data-table-td ">Adaptive heartbeats</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="npl-citations"></a><div class="patent-section-header"><span class="patent-section-title">非专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th colspan="3"class="patent-data-table-th">参考文献</th></tr></thead><tr><td class="patent-data-table-td ">1</td><td class="patent-data-table-td "><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td ">陈文赛: "<a href='http://scholar.google.com/scholar?q="%E4%B8%80%E7%A7%8D%E9%AB%98%E5%8F%AF%E9%9D%A0%E6%80%A7%E3%80%81%E9%AB%98%E5%AE%89%E5%85%A8%E6%80%A7%E7%B3%BB%E7%BB%9F%E2%80%94%E2%80%94%E4%B8%89%E5%8F%96%E4%BA%8C%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F"'>一种高可靠性、高安全性系统&#8212;&#8212;三取二计算机系统</a>", 《现代雷达》, vol. 26, no. 6, 30 June 2004 (2004-06-30), pages 21 - 2</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=ZwpbBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=G06F0011300000">G06F11/30</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2012年6月27日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年9月5日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2015年2月18日</td><td class="patent-data-table-td ">C02</td><td class="patent-data-table-td ">Deemed withdrawal of patent application after publication (patent law 2001)</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/0cc0551406c253c0d702/CN102521104A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_5115ea495017d9115e613207d3810e5a.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E9%AB%98%E5%AE%89%E5%85%A8%E6%80%A7%E7%B3%BB%E7%BB%9F%E8%BF%90%E8%A1%8C%E8%BF%9B%E5%BA%A6%E7%9A%84%E7%9B%91%E6%8E%A7.pdf?id=ZwpbBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U2jX_hxVEPtbD3Fgq8Bo8gE8B7nrQ"},"sample_url":"https://www.google.com/patents/reader?id=ZwpbBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>