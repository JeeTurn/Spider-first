<!DOCTYPE html><html><head><title>专利 CN101467131A - 网络用户验证系统和方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="网络用户验证系统和方法"><meta name="DC.contributor" content="罗伯特&#183;T&#183;库拉考维斯基" scheme="inventor"><meta name="DC.contributor" content="罗宾&#183;R&#183;库珀" scheme="inventor"><meta name="DC.contributor" content="美国唯美安视国际有限公司" scheme="assignee"><meta name="DC.date" content="2006-7-20" scheme="dateSubmitted"><meta name="DC.description" content="在网络用户验证系统中，使用与该网络用户位于其中的建筑物相关联的专用物理通信线的唯一标识符，或者与物理连接到建筑物的安全组件或通信线路相关联的数字证书，识别网络用户以便进行验证。验证服务器首先检验将与网络服务用户相关联的专用通信线的身份，或者发出要与专用通信线相关联的唯一数字证书以便进行验证。数字证书可被存储在连接到多个建筑物的安全组件并且存储每个建筑物的唯一数字证书的建筑物网关或边缘站点模块内。"><meta name="DC.date" content="2009-6-24"><meta name="citation_patent_publication_number" content="CN:101467131:A"><meta name="citation_patent_application_number" content="CN:200680032760"><link rel="canonical" href="https://www.google.com/patents/CN101467131A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101467131A?cl=zh"/><meta name="title" content="专利 CN101467131A - 网络用户验证系统和方法"/><meta name="description" content="在网络用户验证系统中，使用与该网络用户位于其中的建筑物相关联的专用物理通信线的唯一标识符，或者与物理连接到建筑物的安全组件或通信线路相关联的数字证书，识别网络用户以便进行验证。验证服务器首先检验将与网络服务用户相关联的专用通信线的身份，或者发出要与专用通信线相关联的唯一数字证书以便进行验证。数字证书可被存储在连接到多个建筑物的安全组件并且存储每个建筑物的唯一数字证书的建筑物网关或边缘站点模块内。"/><meta property="og:title" content="专利 CN101467131A - 网络用户验证系统和方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101467131A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101467131A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=wNlqBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101467131A&amp;usg=AFQjCNHC0kGmjfBZjyRFuOdJ6xQE-4J5CQ" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/17d817b3d7d07a0127ac/CN101467131A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/17d817b3d7d07a0127ac/CN101467131A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101467131A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101467131A?cl=en&amp;hl=zh-CN"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101467131A?cl=zh" style="display:none"><span itemprop="description">在网络用户验证系统中，使用与该网络用户位于其中的建筑物相关联的专用物理通信线的唯一标识符，或者与物理连接到建筑物的安全组件或通信线路相关联的数字证书，识别网络用户以便进行验证。验证服务器首先检验将与网...</span><span itemprop="url">https://www.google.com/patents/CN101467131A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101467131A - 网络用户验证系统和方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101467131A - 网络用户验证系统和方法" title="专利 CN101467131A - 网络用户验证系统和方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101467131 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200680032760</td></tr><tr><td class="patent-bibdata-heading"> 专利合作条约 (PCT) 编号</td><td class="single-patent-bibdata">PCT/US2006/028505</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2009年6月24日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2006年7月20日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2005年7月20日</td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200680032760.4, </span><span class="patent-bibdata-value">CN 101467131 A, </span><span class="patent-bibdata-value">CN 101467131A, </span><span class="patent-bibdata-value">CN 200680032760, </span><span class="patent-bibdata-value">CN-A-101467131, </span><span class="patent-bibdata-value">CN101467131 A, </span><span class="patent-bibdata-value">CN101467131A, </span><span class="patent-bibdata-value">CN200680032760, </span><span class="patent-bibdata-value">CN200680032760.4, </span><span class="patent-bibdata-value">PCT/2006/28505, </span><span class="patent-bibdata-value">PCT/US/2006/028505, </span><span class="patent-bibdata-value">PCT/US/2006/28505, </span><span class="patent-bibdata-value">PCT/US/6/028505, </span><span class="patent-bibdata-value">PCT/US/6/28505, </span><span class="patent-bibdata-value">PCT/US2006/028505, </span><span class="patent-bibdata-value">PCT/US2006/28505, </span><span class="patent-bibdata-value">PCT/US2006028505, </span><span class="patent-bibdata-value">PCT/US200628505, </span><span class="patent-bibdata-value">PCT/US6/028505, </span><span class="patent-bibdata-value">PCT/US6/28505, </span><span class="patent-bibdata-value">PCT/US6028505, </span><span class="patent-bibdata-value">PCT/US628505</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%BD%97%E4%BC%AF%E7%89%B9%C2%B7T%C2%B7%E5%BA%93%E6%8B%89%E8%80%83%E7%BB%B4%E6%96%AF%E5%9F%BA%22">罗伯特&#183;T&#183;库拉考维斯基</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%BD%97%E5%AE%BE%C2%B7R%C2%B7%E5%BA%93%E7%8F%80%22">罗宾&#183;R&#183;库珀</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E7%BE%8E%E5%9B%BD%E5%94%AF%E7%BE%8E%E5%AE%89%E8%A7%86%E5%9B%BD%E9%99%85%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">美国唯美安视国际有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101467131A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101467131A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101467131A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (14),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (1),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=wNlqBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200680032760&amp;usg=AFQjCNE7o95_P1J5AzAY5hP65_NmyyaICg"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=wNlqBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101467131A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNFZG4OG3To1vnln4U9MP-4So1FA3A"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT75794750" lang="ZH" load-source="patent-office">网络用户验证系统和方法</invention-title>
      </span><br><span class="patent-number">CN 101467131 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA53549751" lang="ZH" load-source="patent-office">
    <div class="abstract">在网络用户验证系统中，使用与该网络用户位于其中的建筑物相关联的专用物理通信线的唯一标识符，或者与物理连接到建筑物的安全组件或通信线路相关联的数字证书，识别网络用户以便进行验证。验证服务器首先检验将与网络服务用户相关联的专用通信线的身份，或者发出要与专用通信线相关联的唯一数字证书以便进行验证。数字证书可被存储在连接到多个建筑物的安全组件并且存储每个建筑物的唯一数字证书的建筑物网关或边缘站点模块内。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(44)</span></span></div><div class="patent-text"><div mxw-id="PCLM13531891" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1. 一种网络用户验证系统，包括：物理连接到建筑的安全组件；链接到该安全组件的建筑内的至少一个用户设备；安全服务器；将该安全服务器链接到该安全组件的至少一个网络；以及配置成确定该安全组件的物理连接标识(ID)并且使该物理连接ID与使用该用户设备的网络服务用户相关联的安全服务器。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2. 根据权利要求1的系统，其中所述安全组件是连接到建筑的 专用线路。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3. 根据权利要求2的系统，其中所述线路是一端连接到建筑的 宽带电信线路。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4. 根据权利要求2的系统，其中所述线路是数字用户线路 (DSU 。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5. 根据权利要求2的系统，其中所述线路是光纤线路。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6. 根据权利要求2的系统，其中所述线路是到建筑的专用无线链路。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7. 根据权利要求l的系统，其中所述安全服务器是在至少一个 网络上链接到所述安全组件的独立的服务器。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8. 根据权利要求l的系统，其中该系统还包括服务提供商网络 边缘站点，和在该边缘站点和建筑之间提供通信的至少一个连接线， 以及链接到边缘站点的服务器提供商数据中心，所述安全组件包含从 边缘站点到建筑的连接线。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9. 根据权利要求8的系统，其中该系统还包括建筑内的链接到 所述连接线的建筑网关模块，该建筑网关模块配置成在所述连接线和 建筑内的每个用户设备之间提供接口 。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10. 根据权利要求9的系统，其中所述用户设备包含至少一个个 人计算机。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="11" class="claim">
      <div class="claim-text">11. 根据权利要求10的系统，其中所述用户设备还包括至少一个机顶盒。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12. 根据权利要求10的系统，其中所述用户设备还包括至少一 个无线通信设备。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13. 根据权利要求12的系统，其中所述无线设备选自由移动电 话、个人数字助理和无线计算机构成的组。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="14" class="claim">
      <div class="claim-text">14. 根据权利要求9的系统，其中所述边缘站点服务器具有为本 地群组内的多个建筑提供专用通信的专用连线，所述边缘站点服务器 具有处理器模块，该处理器模块配置成在所述数据存储模块内存储多 个唯一的数字证书，并且将每个数字证书与连接到与所述数字证书相 关联的建筑的相应专用线路相链接。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="15" class="claim">
      <div class="claim-text">15，根据权利要求14的系统，其中该系统还包括每个建筑内的 多个用户设备，该用户设备链接到所述网关模块，并且配置用于使用 与将各个建筑连接到所述边缘站点服务器的专用线路相关联的唯一 数字证书进行安全的网络通信。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="16" class="claim">
      <div class="claim-text">16. 根据权利要求14的系统，其中所述网关模块具有与所述唯 一数字证书相关联的第 一硬件安全元件。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="17" class="claim">
      <div class="claim-text">17. 根据权利要求16的系统，其中所述硬件安全元件选自由通 用串行总线（USB)软件狗、智能卡、SIM卡和可信平台模块（TPM) 构成的组。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="18" class="claim">
      <div class="claim-text">18. 根据权利要求16的系统，其中所述用户设备具有与在所述 网关模块内的所述第 一硬件安全元件密码调准和同步的第二硬件安 全元件。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="19" class="claim">
      <div class="claim-text">19. 根据权利要求14的系统，其中所述网关模块具有与所述唯 一数字证书相关联的至少一个硬件安全元件，并且每个用户设备具有 与所述网关模块内的硬件安全元件加密校准和同步的硬件安全元件。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="20" class="claim">
      <div class="claim-text">20. 根据权利要求19的系统，其中至少一个所述用户设备是具 有包含第一用户识别模块（SIM)芯片的安全元件的无线设备，并且 所述网关模块具有配置成与所述第一 SIM芯片通信以便进行被验证的无线通信的第二 SIM芯片。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="21" class="claim">
      <div class="claim-text">21. 根据权利要求1的系统，其中该系统还包括基于会话的水印 模块，该模块与所述用户设备相关联并且配置成在所述用户设备在公 共网络上接收的所有内容文件内插入唯一水印有效载荷。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="22" class="claim">
      <div class="claim-text">22. 根据权利要求21的系统，其中所述基于会话的水印模块还 配置成使用与唯一数字证书相关联的用户私有密钥给水印有效载荷 密码签名。</div>
    </div>
    </div> <div class="claim"> <div num="23" class="claim">
      <div class="claim-text">23. &#8212;种用于验证建筑内的用户设备的网络用户验证系统，包括：物理连接到建筑并且与用户设备相关联的安全组件； 验证服务器；将该验证服务器链接到该安全组件的至少 一个网络； 该验证服务器具有可信路径认证模块，该模块配置成创建与该用户设备相关联的客户ID,识别该安全组件，并且使唯一数字证书与该安全组件相关联，以及用于存储该客户ID和相关联的数字证书的数据存储模块；以及该验证服务器还包括检验模块，该检验模块用于使用该客户ID和相关联的数字证书在公共网上在用户设备和其它用户设备之间进行安全通信。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="24" class="claim">
      <div class="claim-text">24. 根据权利要求23的系统，其中所述安全组件包括连接到建 筑的专用线，并且所述数字证书包含该专用线的基于网络的标识。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="25" class="claim">
      <div class="claim-text">25. 根据权利要求23的系统，其中所述数字证书包括基于X.509 的数字证书。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="26" class="claim">
      <div class="claim-text">26. 根据权利要求23的系统，其中该系统还包括与所述安全组 件相关联的控制单元，该控制单元具有处理器模块和数据存储模块， 所述验证服务器还包括配置成将数字证书传递给控制单元的证书传 输模块，该处理器模块配置成在所述数据存储模块内存储所述数字证 书，并且使用所述数字证书在公用网上在所述用户设备和其它网络服 务器之间进行安全通信。</div>
    </div>
    </div> <div class="claim"> <div num="27" class="claim">
      <div class="claim-text">27. &#8212;种用于验证网络用户以便在公用网上安全通信的方法，包括：在验证服务器通过物理连接到建筑的安全组件和至少一个专用 网接收到来自该建筑内的用户设备的建筑验证请求； 确定用户设备的用户的用户身份（用户ID); 检验安全组件的物理连接身份（物理连接ID); 存储用户ID和相关物理连接ID的记录；在接收到来自连接用户的每个服务请求时，确定该连接用户使用 的安全组件的当前物理连接ID;比较当前物理连接ID与相同用户ID的先前存储的物理连接ID 以便进行检验；以及只有检验成功才提供该服务。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="28" class="claim">
      <div class="claim-text">28. 根据权利要求27的方法，其中该方法还包括从网络数据结 构内可用的信息确定物理连接识别。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="29" class="claim">
      <div class="claim-text">29. 根据权利要求27的方法，其中还包括使唯一数字证书与物 理连接相关联，该数字证书包含物理连接ID，在与该物理连接相关联 的数据存储区域内存储唯一数字证书，并且使用该唯一数字证书在与 公用网上的预期网络伙伴的网络通信内进行检验。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="30" class="claim">
      <div class="claim-text">30. 根据权利要求29的方法，其中还包括使所述安全组件内的 第一硬件安全元件与所述唯一数字证书相关联，并且密码地调准建筑 内的至少一个用户设备内的硬件安全元件与该第 一硬件安全元件。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="31" class="claim">
      <div class="claim-text">31. 根据权利要求27的方法，其中还包括将与建筑相关联的唯 一水印有效载荷插入建筑内的用户设备通过网络接收到的内容文件。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="32" class="claim">
      <div class="claim-text">32. 根据权利要求31的方法，其中还包括使用在所述安全组件 处的用于确定所述安全组件的地理坐标的位置传感器检验建筑的地 理位置。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="33" class="claim">
      <div class="claim-text">33. 根据权利要求32的方法，其中每当建筑内的用户设备开始 在公用网上与预期网络伙伴进行安全通信时，检验建筑的地理位置。</div>
    </div>
    </div> <div class="claim"> <div num="34" class="claim">
      <div class="claim-text">34. &#8212;种网络用户验证系统，包括：物理连接到建筑并且与建筑内的至少一个用户设备相关联的安全组件；与所述安全组件相关联的控制单元，该控制单元具有处理器才莫块 和与该处理器模块相关联的数据存储模块； 验证服务器；将该验证服务器链接到该控制单元的至少 一个网络； 该验证服务器配置成使唯一数字证书与该安全组件相关联，并且将该唯一数字证书传递给与该安全组件相关联的控制单元；以及 该处理器模块配置成在所述数据存储模块内存储该唯一数字证书，并且使用该数字证书在公用网上在用户设备与其它网络服务器之间进行安全通信。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="35" class="claim">
      <div class="claim-text">35. 根据权利要求34的系统，其中所述验证服务器是公用事业 公司服务器。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="36" class="claim">
      <div class="claim-text">36. 根据权利要求34的系统，其中所迷控制单元包括配置成向 附近多个建筑提供验证服务的边缘站点服务器，该边缘站点服务器具 有多条专用线，每条专用线连接到对应的建筑之一，所述处理器模块 配置成在所述数据存储模块内存储多个唯一数字证书，并且使每个数 字证书与连接到与所述数字证书相关联的建筑的对应专用线相链接。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="37" class="claim">
      <div class="claim-text">37. 根据权利要求36的系统，其中所述验证服务器是链接到所 述边缘站点服务器的公用事业公司服务器。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="38" class="claim">
      <div class="claim-text">38. 根据权利要求36的系统，其中还包括在公用事业公司网络 上链接到该边缘站点服务器的公用事业公司服务器，该验证服务器包 括链接到公用事业公司服务器以便与所述边缘站点服务器通信的单 独服务器。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="39" class="claim">
      <div class="claim-text">39. 根据权利要求34的系统，其中还包括连接到所述专用线的 建筑内的网关模块，该网关模块链接到用户设备。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="40" class="claim">
      <div class="claim-text">40. 根据权利要求39的系统，其中还包括所述建筑内的多个额 外用户设备，所述处理器模块配置成与所述建筑内的所述额外用户设 备通信。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="41" class="claim">
      <div class="claim-text">41. 根据权利要求34的系统，其中所述安全组件是物理连接到 建筑的结构组件的安全箱，并且所述控制单元被包含在所述安全箱 内，所述处理器模块配置成与所述用户设备通信。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="42" class="claim">
      <div class="claim-text">42. 根据权利要求41的系统，其中所述控制单元还包括连接到 所述处理器模块以便提供地理位置坐标的位置传感器，所述处理器模 块配置成将所述地理位置坐标传递给所述验证服务器，并且所迷验证 服务器配置成使用所述地理位置坐标来检验建筑位置。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="43" class="claim">
      <div class="claim-text">43. 根据权利要求34的系统，其中所述控制单元还包括与所述 数字证书密码调准的第一硬件安全元件。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="44" class="claim">
      <div class="claim-text">44. 根据权利要求43的系统，其中所述用户设备具有与所述第 一硬件安全元件密码调准的第二硬件安全元件。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES18918904" lang="ZH" load-source="patent-office" class="description">
    <p>网络用户验证系统和方法</p>
    <p>本申请要求共同申请的2005年7月20日提出的美国临时专利申 请No. 60/701239和2006年6月1日提出的美国临时专利申请 No.60/803679的优先权，这两个临时专利申请全文并入此作为参考。</p>
    <p>技术领域</p>
    <p>本发明涉及一种用于验证网络用户或者在网络设备之间建立可 信通信路径的系统和方法。</p>
    <p>背景技术</p>
    <p>随着互联网通信量增加，对更好的验证网络用户的装置的需求显 著增加。网络已经证明是非常有价值和必要的工具。但是，欺诈和错 误使用的可能性也日益增加。</p>
    <p>近年来，证券公司例如Verisign、 Thawt等等已经通过提供验证 网络用户的装置建立了有吸引力的商业模型。通过发出和撤消使用公 钥基础设施（PKI)的数字证书，网络用户可确信一些交易被安全处 理。"Verisign，，模型的问题是服务器侧通常&#37318;取验证自身的必要步骤， 但是，客户和其它网络客户已经表现出对获得可帮助他们同样被验证 的解决方案不感兴趣。在很大程度上，网络客户由于不清楚可获得的 好处而不愿意为他们所有的验证装置付费。另外，验证机构如何在多 种平台（PC、膝上型电脑、移动装置等等）之间工作也不是很清楚。</p>
    <p>由于实际上，公用网上的所有客户没有被以任何方式验证，所以 欺诈及危害的潜在可能性仍然严重且日益恶化。</p>
    <p>近些年来，已经提出了多种创新以帮助识别网络客户。这些创新 中的一些包括：</p>
    <p>-安全软件狗</p>
    <p>8*智能卡技术</p>
    <p>.芯片内的安全的、可唯一识别的元件</p>
    <p>这些创新从开始就存在缺陷，这是因为这些（及其它）硬件部件 容易丢失、被盗窃或交换。尽管这些解决方案提供了最低水平的验证， 但是它们的有效性由于客户不能保证它们安全而有限。</p>
    <p>因此，在今天的网络世界中，存在足够的对主机系统（服务器侧 系统）的验证，但是对客户机侧只有很少验证或没有验证。如果存在 一种可行的可靠验证每个客户的方式，则将开始出现新的且有获利潜 力的商业机会，并且端到端"可信"的网络将变为现实。</p>
    <p>因此，需要一种克服如上所述的传统系统内发现的那些严重问题 的系统和方法。</p>
    <p>发明内容</p>
    <p>文中所述的实施例提供了 一种验证系统和方法，其可验证网络客 户并且在两方或多方之间建立可信的通信路径。</p>
    <p>根据本发明的一个方面，提供了一种网络用户验证系统，其中使 用与建筑相关联的安全组件或物理网络连接验证建筑内的一个或多 个网络设备，使得安全的网络通信与建筑所有者或占据者直接关联。 建筑内的至少一个用户设备链接到该安全组件，并且安全服务器链接 到该安全组件或连接。安全服务器被配置成确定该安全组件的物理连</p>
    <p>接标识（ID )，并且使该物理连接ID与客户ID相关联，以便跟踪在 公用网上请求服务的建筑内的特定客户或用户设备。</p>
    <p>安全服务器可以是商业网站或网络的一部分，或向多个家庭和企 业提供服务的服务提供商网站例如电话服务提供商或电话公司 (Telco )，或链接到附近建筑的网络边缘站点例如电话公司边缘站点、 有线电视边缘站点或电力公司边缘站点的一部分，或链接到附近建筑 的无线网络基站，或者可以是经由网络连接到安全组件的单独的安全 服务器。安全服务器不管是独立的还是结合到远程网站或本地边缘站 点中，都可以被不同的商户或网络用户使用，以便验证希望与该商户或网络用户做生意的其它网络用户。此系统使用户设备与固定建筑或</p>
    <p>与该建筑永久关联的物理连接ID相关联，验证这两方之间的通信路 径可信，即建立可信通信路径。这两方可以是网络商户或服务提供商 和网络用户或例如两个网络用户。</p>
    <p>安全组件可以是任何与建筑建立的通信线路，包括基于线缆调制 解调器、数字用户线路（DSL)或DSL衍生物、无线输入端口、光学 输入或线路等等的物理连接，或者可以是被公用事业公司用于跟踪建 筑物的公用设施使用情况以便收费的仪表箱等等，其具有用于经由网 络与公用事业公司服务器通信的内置通信设备。在一个实施例中，安</p>
    <p>全组件可以是从网络接入点或边缘站点到用户的物理网络接入设备 例如数字调制解调器、线缆调制解调器、异步传送模式（ATM)调制 解调器、光纤调制解调器、DSL调制解调器或其它家用调制解调器的 最后一英里（last mile)连接。验证的关键是建立为家庭或其它物理 位置提供服务的最后一里连接，并且使该连接与家庭或物理位置的用 户相关联以实现安全目的。该连接可以是到家庭的物理铜线对连接， 或线缆调制解调器终端服务器（CMTS)上的有线电缆数据服务接口 规范（DOCSIS)地址，或家庭和网络之间的无线最后一里连接上的 介质存取控制（MAC)或逻辑链路控制（LLC)或无线电链路地址， 动态主机配置协议（DHCP)服务或中继代理所报告的数字用户线路 接入复用器（DSLAM)电路ID或连接端口，或将无线客户连接到无 线网络的基站中的任何一个。客户ID可以是对于用户具有永久固定 值的任意值，或者仅对于单个连接是临时值。客户ID可基于IP地址、 IP地址和端口号、用户ID、得自用户ID的随机数、网络边缘站点提 供的标识符例如网络地址翻译（NAT)地址，和可用于使客户设备与 通信线路ID相关联的任何数据值。</p>
    <p>安全服务器可使用网络设备建立连接或通信线路ID。在一个实 施例中，可遵循跟踪路由映射以确定网络拓朴，从而可识别服务边缘 站点例如Telco边缘站点。 一旦边缘站点被识别，则安全服务器通过 请求用户或客户的互联网协议（IP)地址向该边缘站点发送查询，请</p>
    <p>10求识别将Telco边缘站点连接到该用户设备位于其中的建筑的通信线 路。</p>
    <p>其中可使用该验证系统识别 一个网络元件的情况的一个示例是 机顶盒（STB)通过其经由铜线对至Telco的物理连接（用于DSL和 拨号）而被验证。如果STB涉及电子商务交易例如请求购买电影，则 电影服务提供商或Telco可使用此验证系统通过比较该物理连接ID 和用户或客户ID,来检验请求STB是否来自连接到该建筑的正确的 物理铜线对。</p>
    <p>在另 一个实施例中，可通过在系统中添加签名或安全码来提供另 一个附加的安全层。在一个实施例中，安全控制单元与安全组件相关 联，并且具有其中存储唯一的数字证书的数据存储模块，并且处理器 被配置成经由专用网与该安全服务器通信。安全服务器首先检验建筑 位置，并且将与该建筑位置相关联的唯一数字证书发给该安全控制单 元。该安全控制单元可安装在位于该建筑位置处的安全&#32068;件内或者连 接到该安全组件，或者可位于连接到多个建筑的安全组件的边缘站点 模块内。在此情况下，边缘站点模块存储每个建筑的唯一数字证书。</p>
    <p>安全组件可以是用户网关或连接端口 ，例如永久连接在建筑和电 信公司边缘站点之间的现有宽带电信线路，或者与到建筑的专用无线 链路相关联的无线网关。唯一数字证书然后仅与到该特定建筑的线路 相关联。由于数字证书直接与物理建筑（或物理安全或与该建筑集成 的网关）相关联，所以其可用于可靠地验证该建筑内居住的、拥有该 建筑或在该建筑内工作的人员。数字证书可在位于线路的建筑端部的 安全控制单元内或在提供商边缘站点处附连在到建筑的专用宽带存 取线路上。在一个实施例中，每个服务提供商边缘站点包含具有数据 存储模块的控制单元，该模块保存与该站点连接并且订购验证服务的 所有建筑的数字证书。每个数字证书然后仅与到与该数字证书相关联 的特定建筑的通信线路相关联。由于建筑通常不移动，并且安全组件 连接到建筑以便其难以或不能在不中断与建筑的连接的情况下移动， 所以数字证书可经由该数字证书提供在网络上通信的客户的身份的可靠指示。</p>
    <p>在另一个实施例中，安全组件包括安全箱或壳体，该安全箱或壳 体以某种方式物理连接到建筑内部或外部，并且包含保持对于该建筑 特定的数字证书的安全控制单元。在一个示例中，安全控制单元可包 括用于特定公用设施的计量设备，并且可与公用事业服务器通信以便</p>
    <p>计量读取和验证。专用网或虚拟专用网（VPN)在此情况下是公用事 业公司网络，并且验证服务器可被该公用事业服务器或链接到该公用 商业服务器的单独验证服务器执行。</p>
    <p>安全网关模块可设置在建筑处以便连接到建筑内的多个用户设 备。在一个实施例中，安全控制单元包含网关模块。在另一个实施例 中，安全控制单元连接到网关模块。网关模块可以是路由器或增强路 由器模块。</p>
    <p>该系统还可包括与该网关模块相关联的至少 一个硬件安全设备， 以及与建筑内的每个用户设备相关联的硬件安全设备。安全设备可以 是通用串行总线（USB)软件狗、智能卡、可信平台模块（TSM)、 用于无线设备的用户信息模块（SIM)芯片等等。在本发明的示例性 实施例中，特定建筑专用的数字证书可与连接到该建筑的网关模块的 硬件安全设备内存储的对应密钥相匹配，以便网络成功地操作。网关 模块内的硬件安全设备继而在每个用户设备内与安全设备密码同步 以便成功进行验证并且进行网络通信。这提供了两级验证，具体来说 是认证实体或验证服务器到建筑，以及建筑到该建筑内的用户设备。</p>
    <p>根据本发明的另一个方面，提供了一种验证方法，该验证方法包 括通过使用户标识（ID)与预期用户位于其中的建筑的物理连接或安 全组件的ID相关联来向网络服务注册一个用户，存储用户ID和物理 连接ID的记录，在从用户接收到每个随后的对服务的请求时确定连 接用户的物理连接ID，将该物理连接ID与先前建立的用户ID进行 比较以便进行检验，并且如果检验成功则提供服务。</p>
    <p>在一个实施例中，位于验证服务器处的建筑的地理位置基于安全 &#32068;件或物理连接的位置而被检验，唯一的数字证书与被检验的建筑位置相关联，并且该唯一的数字证书被发送给与该安全组件或物理连接 相关联的安全控制单元，并且该唯一的数字证书被存储在安全控制单 元的数据存储模块内。在另一个实施例中，用户用来与网络通信的先</p>
    <p>前针对到建筑的物理连接所创建的连接ID由安全服务器所确定，并 且该物理连接ID与用户的用户ID相关联。</p>
    <p>通常，在现代密码技术中，为了进行安全通信在实体可以被认为 完全安全和可靠之前希望进行三级验证。这些等级包括：</p>
    <p>1. 具有什么</p>
    <p>2. 知道什么</p>
    <p>3. 是谁</p>
    <p>第一项可通过向客户设备提供某些类型的具有安全的嵌入密钥 的安全硬件设备例如智能卡、USB软件狗、安全芯片或芯片内的安全 元件、以及其它基于硬件的密码方案来实现。第二项可通过使用用户 特有的用户名和密码实现。第三项更难以实现。生物测定识别技术包 括视网膜扫描器和指&#32011;分析器，但是这种设备的安装通常很昂贵并且 难以管理。文中所述的实施例通过利用物理结构例如建筑或家庭、或 连接到该物理结构的安全组件作为生物测定设备提供了 "是谁"的识 别。实际上，所有物理结构、尤其是配备有宽带访问的那些物理结构 具有一个所有者和数量有限的在该结构内居住或工作的个人。通过基 于到建筑内的物理连接或网络通信线路的唯一 ID识别服务用户，在 本发明中，用户可与唯&#8212;&#8212;个不可移动的物理结构相关联。该方法和 系统可用于识别拥有物理结构、在其中工作或居住的人员。</p>
    <p>在查看下文的详细说明和附图之后，本发明的其它特征和优点对 于本领域技术人员来说更加显而易见。</p>
    <p>附图说明</p>
    <p>可通过研究附图部分地了解本发明的关于其结构和操作的细节， 在附图中类似的附图标记表示类似的部件，并且其中：</p>
    <p>图1是示出使用根据本发明的一个示例性实施例的身份验证系统和方法的网络的框图；</p>
    <p>图2是示出根据本发明的一个示例性实施例的最初向服务提供 商注册被验证服务的客户的方法的流程图；</p>
    <p>图3是示出在图2的初始注册之后识别用户或客户的方法的流程</p>
    <p>图；</p>
    <p>图4是示出根据本发明的一个实施例内的用于用户的实时验证</p>
    <p>的逻辑处理步骤和数据存储模块的逻辑图；</p>
    <p>图5是示出根据本发明的另一个实施例的验证系统的框图；</p>
    <p>图6是示出提供二级验证的图5的系统的变型的框图；</p>
    <p>图7是示出图5和6的验证系统的初始设定的流程图；</p>
    <p>图8是示出使用本发明的一个实施例的验证系统以验证作为该</p>
    <p>系统的客户的潜在网络合作伙伴的流程图；</p>
    <p>图9是示出修改的提供内容文件的水印的验证系统的框图；</p>
    <p>图10是示出根据本发明的另 一个实施例的修改的验证系统的框</p>
    <p>图；</p>
    <p>图11是图10的实施例的家庭或建筑单元的框图；</p>
    <p>图12是类似于图9但是提供双向验证的修改的验证系统的框图；</p>
    <p>图13是示出根据本发明的一个实施例的验证方法的流程图；并</p>
    <p>且</p>
    <p>图14是示出源自商业网络并且寻址至连接到被验证网关的用户 设备或连接到建筑物的安全组件的消息中的加密层的框图。</p>
    <p>具体实施方式</p>
    <p>文中公开的一些实施例提供了基于固定物理建筑物地址或位置 的用户验证。例如，文中公开的一种方法允许使唯一数字证书与家庭 或建筑单元相关联，或者物理连接到家庭或建筑物。</p>
    <p>在阅读此说明之后，在各种可选实施例和可选应用内如何实现本 发明对于本领域技术人员来说是很清楚的。但是，尽管文中说明了本 发明的各种实施例，但是应理解这些实施例仅是作为示例而不是限</p>
    <p>14制。因而，各种实施例的详细说明不应被理解为限制如所附权利要求 内阐述的本发明的范围或广度。</p>
    <p>下文的说明使用术语Telco (电话公司）作为任何服务提供商的 通称，并且用于识别任何类型的通信或网络服务提供商，如电话公司、 有线电视服务提供商、有线电视（tv)操作员、因特网服务提供商、 卫星电视提供商、光纤网络连接公司、无线服务提供商、蜂窝电话服 务提供商等等。</p>
    <p>图l是具有各种网络部件的通信网络系统的框图。如下文将更详 细说明的，根据本发明的 一 个示例性实施例的验证系统结合到网络系 统中，并且当用户设备例如物理设备或建筑物40内的机顶盒（STB) 370连接到商业应用/网络388时被使用。STB 370是连接到通信信道 的电子设备，如电话、因特网服务数字网（ISDN)或有线电视线路， 并且在传统电视屏幕上产生输出。机顶盒通常用于接收并解码数字电 路广播，并且通过用户的电视而不是PC与因特网接口连接。机顶盒 分为几类，从最简单的接收并还原译出输入电视信号的机顶盒，到更 为复杂的也可用作多媒体台式计算机的机顶盒，该多媒体台式计算机 可运行多种先进的服务，如视频会议、家庭内部联网、互联网协议（IP) 电话、视频点播（VoD)和高速因特网TV服务。但是，应理解，图 1内的家庭网络可连接到许多其它类型的用户电子通信设备，并且结 合图1使用的术语机顶盒（STB )将是覆盖任何类型的电子通信设备， 包含STB、个人计算机（PC)、个人数字助理（PDA)、网络MP3/ 视频播放器（其中MP3是MPEG-1 Audio Layer-3设备，并且MPEG 代表运动图象专家组）、蜂窝电话等等的通称。</p>
    <p>STB 370在所示的实施例中示出为连接到电视372,并且经由家 内或建筑物内网络385连接到客户前端设备380。客户前端设^( CPE ) 380代表任何形式的客户前端设备，如路由器、调制解调器、交换机、 网关或任何网络处理设备，其可用于在本地网络设备内接口连接到通 到外部世界的可接收和传输数据的连接或通信线路305。连接305可 以是与外部网络边缘设备、边缘站点或接入点303的有线、无线、电缆或光互联，并且可基于点对点、星形、环形或其它网络拓朴。在此</p>
    <p>实施例中，如下文参照图l-4详细说明的，验证系统使用物理连接305 的标识符，以便验证住宅或住宅网络385内的设备的用户。</p>
    <p>客户端设备例如STB 370可直接连接到CPE调制解调器380， 或可选地服务于使用网络地址转换（NAT ) /防火墙的局部接入点路由 器子网络。NAT是一种使局域网（LAN)能够使用一组用于内部传 输的IP地址和用于外部传输的第二组地址的互联网标准。</p>
    <p>网络边缘设备或站点303经由网络315连接到商业应用和网络 388。商业应用和网络388可以是独立的基于电子商务或网络的公司 服务，或者可以是电话公司（TelCo)或其它第三方提供的公用服务。 网络315可以是专用或公司网络、或者公用网例如因特网，并且边缘 站点303与商业应用和网络388之间的通信可经由一个或多个网络 315实现。网络边缘设备303适合于用于向用户提供服务的物理网络 层，并且包含但不局限于基于电缆调制解调器、数字用户线路（DSL) 和DSL衍生物、无线和光技术的物理连接。DSL技术使用复杂的调 制方案以将数据打包到铜线上。它们有时被称为最后一英里技术，这 是因为它们仅用于从电话交换站到家庭或办公室的连接而不是交换 站之间的连接。在图1中，网络边缘设备是通信线路305连接到CPE 设备380的边缘位置的示例。网络系统还可包含网络操作中心（未示 出，位于网络边缘设备303和网络315之间）。网络数据中心处理功 能可分配在其它位置或者使用其它服务器。</p>
    <p>安全服务器310经由网络315连接到网络边缘设备。尽管安全服 务器310在图1内为单独站点，但是它也可以是网络边缘设备或边缘 站点303的一部分，网络操作中心的一部分，或商业应用站点388的 一部分。图1还示出动态主机配置协议（DHCP)服务器320,该服 务器320连接到DHCP数据库330，用于经由网络315与客户CPE 设备380通信。DHCP服务器320可以是用于向CPE设备或其它计 算机设备提供互联网协议（IP)地址的标准的基于互联网协议的服务 器，该CPE设备或其它计算机设备被分配IP地址以便接入网络。DHCP是已知的用于向网络上的设备分配动态IP地址的协议。可选 地，DHCP服务器320可包含可用于向计算机或其它客户设备（STB、 PDA、 PC、蜂窝电话等等）分配地址信息或接入信息以便连接到网络 的其它设备。DHCP服务器320还可实现为具有地址信息的数据库， 该地址信息用于使计算机或其它客户设备经由主机网络边缘设备303 例如Telco边缘站点连接到网络315。</p>
    <p>根据一个实施例的验证过程（即，用于启动可信通信路径）如下 所述。该过程在STB 370所代表的客户设备上电并且尝试连接到Telco 服务或商业应用388时开始。STB 370通常可从表示为CPE 380设备 的一部分的路由器、交换机或网关设备请求IP地址。STB 370的IP 地址是网络边缘设备303或DHCP服务器320可能不知道的局部互联 网（IP)地址。图2示出根据本发明的一个实施例的用于开始向服务 提供商例如商业应用388为被验证或可信服务注册客户的方法。当建 筑物内的任何客户设备联系服务提供商以在网络上获得任何类型的 服务时可使用此方法。这种服务的一个示例是当用户设备例如机顶盒 联系安全电影或视频输送服务以获得视频解密的应用密钥时。</p>
    <p>客户设备例如STB 370首先上电并从CPE 380获得IP地址（步 骤340)。客户设备然后连接到服务提供商（步骤342)并请求服务。 STB使用CPE 380设备的IP地址而不是STB的IP地址连接到网络 边缘设备303。STB的IP地址对于家庭或住宅内网络385来说是本地 的，并且呈现给商业或服务提供商的客户（STB) IP地址可能与 CPE380的家庭内网络路由器、交换机或网关分配给STB的IP地址 不同。呈现给STB的IP地址是网络边缘设备303为CPE 380设备提 供的IP地址。</p>
    <p>当STB联系商业应用和网络388以便注册来自商户的服务时， 注册过程可使用客户或CPE 380的IP地址，并且可从适当的网络设 备确定网络边缘设备303和STB 370之间的物理连接305的身份，该 物理连接305经由CPE 380连接到网络边缘设备（步骤344 )。下文 详细说明用于确定物理连接305的身份的技术。注册过程可使用如图</p>
    <p>171所示的独立的安全服务器310,或者可以是商业应用或站点388的 一部分。客户注册信息包含被称为针对网络边缘设备303和CPE 380 之间的连接305的物理连接ID的标识符。</p>
    <p>物理连接ID是唯一标识网络边缘设备303和CPE 380之间的物 理连接305的标识符。存在多种可用于获得物理连接305的身份的技 术。物理连接ID的DSL示例是用于DSL数字用户线路接入复用器</p>
    <p>(DSLAM )设备的物理端口 ID,该DSLAM设备用于将DSL服务连 接到铜线对电话线路，该电话线路将Telco中心或本地电话局连接到 用户。DSLAM将多个客户的DSL连接链接到单个高速异步传输模式</p>
    <p>(ATM)线路。对于光纤连接、基于有线电视的互联网服务的线缆调 制解调器系统可获得物理连接ID,而对于无线设备可获得虚拟连接 ID。例如，在光纤到户（FTTH)网络中，连接ID可以是用于使用户 通过接口连接到光网络的光纤网络单元（ONU)的标识符。ONU标 识符可用于使视频（或其它）服务用户与到该用户的物理光纤连接或 ONU连接相关联。还可想象，可使用跟踪路由程序或其它网络映射 资源获得物理连接305的标识符，以确定物理连接305。尽管标准的 跟踪路由程序资源没有识别物理连接305，但是可想象，可创建类似 于跟踪路由程序的可将物理连接305和信号路由一起提供给计算机节 点的资源。</p>
    <p>在许多网络系统中，当客户设备（STB、 PC、 PDA等等）使用 DHCP协议请求网络IP地址时，网络边缘设备303可以将DHCP请 求转发给DHCP服务器。除了用作DHCP中继代理之外，在通过网 络边缘设备303转发DHCP请求时，网络边缘设备303还添加物理连 接标识符（例如DHCP选项82 )。当网络边缘设备303添加物理连 接标识符时，DHCP服务器可将该物理连接标识符存储在DHCP服务 器租约文件中，该文件是包含关于DHCP处理的信息并且通常包含关 于IP地址、CPE媒介存取控制（MAC)地址、租约状态、租约持续 时间的信息以及其它信息的文件。对基于DSL的网络的当天DHCP 处理包括DSL DSLAM添加指示经由DSLAM端口号连接到家中的物</p>
    <p>18理线的端口标识符。DSLAM端口号是唯一的，并且当铜线连接到 DSLAM端口时，家庭和Telco网络之间的物理铜线可^皮唯一地识别。 在许多系统中，DHCP租约文件信息还包括被网络边缘设备303添加 到DHCP请求中的任何物理连接标识符（例如DHCP选项82 )。</p>
    <p>在网络边缘设备303和CPE 380设备之间的物理连接305的物 理连接标识符不可用的情况下，可写软件以通过探测网络边缘设备 303以获得可用于使标识符与物理连接305相关联的数据来访问此信 息。此探测的示例是使用DSLAM设备提供的任何方法从该DSL DSLAM设备中读电路ID。探测网络边缘设备303可应用于任何网络 类型（无线、线缆、光纤、DSL、以太网等等），并且探测可基于从 设备获得物理连接305的方法。典型的获得物理连接305的标识符的 方法包括读数据库文件，执行远程登录对话，访问网络或网络边缘设 备303上的暴露接口，访问网络服务以获得信息，经由文件传输协议 (FTP)或超文本传输协议（HTTP)接口访问信息，或其它方法。</p>
    <p>在已经确定物理连接ID之后，在此实施例中验证过程使物理连 接305与服务用户相关联（步骤345)，并且存储关于该用户的信息 和相关联的物理连接标识（步骤346)。这使得服务提供商可使用包 含物理连接305的信息验证用户，从而将该用户链接到识别出的物理 连接与其链接的物理结构或建筑物。 一旦该信息被存储，则客户被为</p>
    <p>服务注册，并且然后可从商户388接收服务。在注册之后，物理连接 305用于如图3所示在每个随后的对服务的请求中验证用户。</p>
    <p>通过此应用还可想象，可提供这样的网络服务，即该网络服务使 服务提供商可使用网络边缘设备303或Telco网络设备或DHCP服务 器320或安全服务器310或其它网络位置提供的暴露接口从Telco或 服务提供商获得物理连接305标识符。</p>
    <p>尽管当在验证客户时在当天系统内有时使用物理连接305信息， 但是此使用局限于网络服务提供商验证用户的CPE 380设备时，并且 此信息并不用于验证超出物理连接层之外的用户，例如在服务的应用 层或者在验证电子商务系统的用户的电子商务层、互联网系统、网络服务、电子邮件系统等等中的用户。</p>
    <p>图3示出用于在注册后识别用户或客户以便检测试图访问服务 的欺诈尝试的验证过程。被称为黑客的欺诈个体试图抢夺或盗窃服务 的方法有很多种。例如，黑客可使用具有复制的用户信息的克隆客户 设备例如STB或PC，并且试图冒充授权用户。图3内所示的验证过 程可证实客户从与注册该服务所使用的物理连接相同的物理连接305 访问该服务，并且具有相同证书的多个客户不会同时在该服务上活 动。</p>
    <p>如图3所示，在步骤350接收来自已注册客户（或者试图使用克 隆设备等冒充已注册客户的未授权用户）的交易请求。然后，读取连 接用户的家庭网关IP地址（家庭网关或CPE 380的IP地址，而不是 STB 370的IP地址）（步骤352 )。用户的网关IP地址被用于获得 该用户的物理通信线路或物理连接ID (步骤354)。这可由包含针对 该网关IP地址的物理通信线路标识符的网络数据项获得。这可以多 种不同方式获得，例如可读取DHCP租约文件以获得此映射。还可通 过从DSLAM读取DSL DSLAM端口 ID向网络设备查询此信息。根 据网络可使用其它方法。由于大多数系统通过临时租约应用DHCP IP 地址管理，所以用户网关IP地址是临时关联。因而，用户被识别为 连接到物理通信线路而不是IP地址。物理连接线路标识符对于每个 用户是唯一的， 并且一个示例是 DSLAM IP&#8212;ADDRESS.PortNumber,其中DSLAM&#8212;IP&#8212;ADDRESS 是网络中的许多DSLAM之一的IP地址，并且.PortNumber字段是 将铜线连接到用户的位置的DSLAM上的物理端口 。</p>
    <p>然后，通过比较用户的当前DSLAM&#8212;IP&#8212;ADDRESS.PortNumber 或物理连接ID与当用户首次为该服务注册时获得的物理连接ID，验 证连接客户（步骤356)。软件可监控用户物理连接，并且检查多个 用户同时在网络和该用户的不同物理连接上活动。用户的客户前端设 备可位于家庭网关或防火墙之后，并且用户的客户IP地址是对于家 庭或前端来说是本地的但是验证系统不会看到的IP地址。此方法使用户与到建筑物的物理连接305而不是客户IP地址相关联，这为验 证提供了更好的基础。软件确定用户的新的或当前物理连接ID与注 册的物理连接ID之间是否匹配（步骤358)。如果匹配的话，则该连 接是可信的，并且交易可继续进行（步骤362 )。如果物理连接ID与 注册信息不匹配，则报告该改变（步骤360 )，并且根据该改变是出 于合理原因还是其被怀疑是网络上的克隆，交易可以继续进行或不继 续进行。</p>
    <p>在步骤360中，处理软件可报告用户使用的设备目前位于与为该 服务注册的DSLAM端口不同的DSLAM端口上。用户设备物理连接 可能因多种不同的合理原因而改变，包含技术员将用户移动到 DSLAM上的不同端口，或者技术员在字段内移动STB而没有更新用 户的信息，乃至当用户移动STB时。尽管这些条件没有构成网络上的 克隆，但是处理过程可报告这些类型的事件。</p>
    <p>通过MAC地址唯一识别的合法STB在任何给定时刻可仅存在 于单个DSLAM物理端口地址上。在一个实施例中，如下文参照图1 至4更详细说明的，验证系统和方法通过搜索连接到多于一个物理线 路的STB的DHCP租约记录，使用具有中继代理信息扩展选项的 DHCP服务来检测克隆STB。图4示出用于图l的系统以便进行如图 2和3所示的实时注册验证以及对潜在克隆的存在的扫描报告的逻辑 处理过程和数据存储。用于执行验证过程的验证服务器可驻留在单独 的安全或验证服务器310上，或者可被设置在连接到网络边缘站点303 的网络操作中心，或者在其它实施例中被设置在商业应用站点388上。</p>
    <p>如图4所示，DHCP服务器和中继代理363连接到DHCP租约 文件存储模块364。 DHCP表构造器365被连接到DHCP租约文件存 储模块364和DHCP目录366。由表构造器365所创建的表被存储在 DHCP租约表模块367中。所有STB关联数据与特定电路信息一起 被存储在电路管理（CM)注册表368内，即客户注册信息和关联的 物理连接ID。当从STB接收到密钥请求或服务请求时（369 ),系统 通过比较DHCP租约表内存储的信息与电路管理（CM)注册表368内存储的信息，确定该请求所源自的租用电路是否对应于已注册的电</p>
    <p>路（374 )。如果电路不匹配，则生成验证异常并且将其存储在验证 异常模块375内以便稍后在扫描报告中处理（376)。当在步骤374 没有发现匹配时，STB可被拒绝服务或者默默记下以便稍后调查。如 果电路识别中的改变存在合理原因，则CM注册表可被更新以指示此 特定客户的已注册电路对应于租用电路。</p>
    <p>现在将更详细地说明如图1至4所述的验证系统的一个示例。为 了验证用户或客户，对于任何给定IP地址，可从DHCP服务器或中 继服务器获得MAC地址和DSL端口号（opt.82)。在图4所示的实 施例中，从DHCP租约文件中访问DHCP状态。在可选实施例中， 等效状态信息可使用为客户获得标题和其它信息的Myvo/Siemens的 全面管理（TM)中波来获得。可选地，DHCP状态日志可输出给验 证服务器，或者可发觉来自验证服务器的DHCP请求业务量。</p>
    <p>DHCP活动性被保持在/etc/dchpd.leases或DHCP租约文件365 内，该文件包含从网络边缘DHCP中继代理363收获的这些任选字段。</p>
    <p>&lt;table&gt;table see original document page 22&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;</p>
    <p>尽管远程ID被假设为是全局唯一的，但是电路ID仅对于 DSLAM是唯一的，并且可用子网络地址限定以确保对于验证服务器 的唯一性。考虑其中STB被克隆但是碰巧占据两个不同子网络上的相 同电路的退化情况。为了检测此克隆，可测试两个子网络和电路的唯 一性。在giaddr字段内引用DHCP协议中继代理，该字段是中继代 理的IP地址。租约文件内的电路ID选项是giaddr和电路的拼接。 "giaddr"字段是网关IP地址，即用来指DHCP服务器和电路（例如 DSLAM、网关等等）之间的任何中继代理的IP地址的术语。租约文件可被保持为平面的美国信息互换标准代码（ASCII)文本文件，或 者可在内容和布局上改变。租约文件插件用于抽象本地文件存取。</p>
    <p>对于大规模安装，仍然要确定所有租约文件是否具有相同格式。 在概念上，异构系统可具有不同的DHCP服务器、租约文件格式并因 而具有不同的租约文件插件。来自当天DHCP服务器的DHCP租约 信息可类似于示出被发出的IP租约和电路选项的下文示例： Lease 172.22.22.254{</p>
    <p>starts 1 2006/02/06 15:46:27;</p>
    <p>ends 1 2006/02/06 16:46:27;</p>
    <p>tstp 1 2006〃02/06 16:46:27;</p>
    <p>binding state free;</p>
    <p>hardware ethernet 00:03:e6:00:3c:84j</p>
    <p>option agent.circuit-id "10.160.220,232:l-3-26-0-adsl-0-36";</p>
    <p>在这个示例中，giaddr字段是10.160.220.232。对于直接连接的 STB， DHCP租约文件项具有该STB的IP地址和MAC地址。在接 入点（AC )情况中，DHCP租约文件项具有AP而不是STB的IP地 址和MAC地址。在此说明中，术语"接入点，，是指用作有线LAN的 用户的通信集线器的硬件设备或计算机软件。但是，电路信息对于 CPE域内的所有设备、包括AP和STB都是共用的。</p>
    <p>为了便于电路ID的注册时间求解，创建DHCP租约表367。该 租约表输入关于IP地址的所有租约平面文件信息和密钥，以使该地 址和与IP租约相关联的连接305的电路ID相关联。这在与注册期间 的平面文件处理相比提高了性能水平。在一个实施例中，该表可包含：</p>
    <p>&lt;table&gt;table see original document page 23&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;执行批处理以解析DHCP租约文件364，并且将数据输入DHCP 租约表367。构造器可作为后台处理运行。租约表构造器应服从于更 高优先级的系统任务，包括注册服务器。表构造器可使用DHCP目录 定位DHCP租约文件。目录包含其租约文件被处理的所有DHCP服 务器的总清单。目录可被手工添加，被操作员UI管理并且最终被 DHCP探索自动生成。</p>
    <p>验证系统可直接注册STB，或者可注册STB的接入点（AP)。 对于直接连接的STB 370,在步骤369， STB发出具有其IP地址和 MAC或STB ID的密钥请求。注册或验证服务器（安全服务器310 或设置在商业应用站点的服务器）可在注册时使用租约IP地址使该 STB MAC与该电路相关联。</p>
    <p>对于AP注册，当STB注册时，其发出包含其STBID (MAC) 的密钥请求369。请求IP是接入点或CPE 380翻译的NAT,从而密 钥请求包含STB MAC加上接入点IP地址。验证或注册服务器在注 册时使用租约IP地址使该STB MAC与该电路相关联。</p>
    <p>对于多个STB或用户设备，注册过程以相同方式处理，在这种 情况下使用多个STB发出的唯一MAC。在每种情况下，注册服务器 接收到具有用于检索电路ID的唯一的MAC和接入点或AP IP的密 钥请求。</p>
    <p>该过程对于直接STB和AP注册是类似的，因为IP总是分解到 CPE电路。注册在执行基于电路的验证时起重要作用。由于STB MAC 可能仅在初始密钥请求时被知道，所以其是驱动验证的注册事件。基 于电路的验证可使用商业逻辑来检测克隆STB。任何这种STB可以 是被主动拒绝的密钥，或被默默告知以便稍后调查。</p>
    <p>被拒绝或可疑的电路验证的结果被插入到验证异常表375内，以 便稍后在扫描报告376内处理。未授权请求可被拒绝然后被记录在异 常表375内。其它类型的异常也可被存储在此表内。在一个实施例中， 验证异常表375内存储的记录包含：&lt;table&gt;table see original document page 25&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;相同CPE内的克隆STB不能被容易地检测到，这是因为它们共 享相同的电路。其中S T B被动力循环或者从房间移动到房间的合法使 用情况也会导致这种状况。为了扩展这种限制，共享公共AP的多层 住户单元可服务多个STB。作为对策，注册服务器可使用在相同电路 上每单位时间的注册数的实际上限或其它防御措施。</p>
    <p>可使用开放式数据库连接（ODBC)驱动器访问客户数据库或注 册表368。该安装可修改客户数据库以插入注册证实字段。数据字段 可是通用变换格式（UTF ) -8或UNICODE ( UNICODE是代表整数 字符的类似于ASCII的标准）。下文的字段可被包含在CM注册表 368内以1更用于验证：字段名	描迷	数据类型和大小	唯一性</p>
    <p>电路ID	DHCP/中继代理报 告的DSLAM电路 ID或连接端口	自由格式字符串 (样品中34个字 符）	是-通过预先考虑的 中继代理地址使电 路是唯一的</p>
    <p>远程ID	STB唯一远程标识 符	MAC地址的动态范 围，虚线十六进制 字符串中的48位	是</p>
    <p>警告计数	用于对相对于STB 的克隆警告计数的 累加器，用于报告警 报阈值和趋势	INT	N/A</p>
    <p>控制	用于网络操作员白 名单、黑名单和警告 抑制优先级的列举 控制字段	EN画	N/A</p>
    <p>使用这些字段，网络操作员可按线路、地点、子网络等等构造特 定监督报告。</p>
    <p>DHCP IP租约可能在租约文件已经被租约表构造器收获之时与 租约文件被注册服务器使用之时之间期满。注册或验证服务器可通过 向验证异常表375写DHCP租约期满和时刻以及相关字段，使边界情 况过滤遵从扫描报告规则。扫描报告逻辑可测试这些字段以考虑它们 的边界情况。被授予的密钥可在期满时间内被租用。</p>
    <p>验证系统被设计成与内容授权服务（CAS )基本兼容，并且可与 简单对象存取协议（SOAP)代理结合，从而向远程程序调用（RPC) 变换提供SOAP/可扩展标记语言（XML)。验证系统可在不受攻击 威胁的非保护区（DMZ)内运行。DMZ是位于可信的内部网络例如 公司专用局域网（LAN)和不可信的外部网络例如公共因特网之间的 计算机或小型子网络。通常，DHCP服务器和中继代理具有信任关系， 而DHCP客户（包含STB的CPE设备）被假定为是不可信的。在一个实施例中，使用许可密钥保护验证系统不被未授权地使用。管理级 功能被局限于移位管理器登录。</p>
    <p>验证系统的用户界面可用Java或类似的互联网程序设计语言实 现，并且包含以下功能：</p>
    <p>&lt;table&gt;table see original document page 27&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;</p>
    <p>验证系统安装可包含更新后的注册权限服务器，该服务器与相关 联的软件一起实现基于电路的验证。作为安装的一部分更新/创建数据</p>
    <p>库模式和新表格。在Windows操作系统中，Installshield EXE产生新 的Windows服务。对于Solaris/Linux系统，解决方案应可作为磁带 档案（TAR) 、 Red-hat包管理器（RPM)等等安装。如果验证服务 是单独许可的选项，则其将被添加唯一的LICENSE&#8212;KEY以便管理 验证服务的安装和卸载。在一些情况下，允许卸载以将CM数据库恢 复到验证前的状态，删除验证服务相关的表格和字段。</p>
    <p>所提出的解决方案最小化或降低了对实时注册的影响，并且允许 DHCP租约表构造器和扫描报告进行脱机处理。扫描报告执行时间与 验证异常记录的数量有关，并且交互（对等）地运行或可能以每日报告的周期运行。DHCP租约表367可包含为整个接受服务的交互网络 发布的所有CPE IP租约。最坏情况的大型安装可服务于1M CPE。 假设每个均具有一个租用的IP，则租约表具有大约1M的记录。验证 系统的主要业务影响或操作影响在注册或验证阶段。在DHCP租约表 离线的情况下，IP地址查找失败，或者验证异常更新失败，系统将恢 复并且后退回当前功能。验证系统可被单独许可，并且向后兼容未意 识到验证和意识到验证的商业逻辑。</p>
    <p>DHCP租约表构造器365可处理DHCP租约文件的拷贝，而保 持存储模块364内的实时租约文件不动。构造过程不会影响服务。租 约表367可以重复周期从暂存区（scratch )重建，使得它是自恢复的。</p>
    <p>使用验证异常表的扫描报告可以是离线的而不会影响服务。异常 表或报告内的故障可通过定期数据库维护而被恢复。验证异常表的定 期维护可清除陈旧的记录。</p>
    <p>DHCP租约文件可被收集到一个中央网络文件系统（NFS)导出 目录内以便进行处理。可扫描所有DHCP服务器租约文件的总集合以 检查克隆STB。 DHCP租约文件可被DHCP服务器定期推送到中央 收集位置，或者被表构造器以各种方式（FTP、网络文件系统（NFS) 等等）拉出。</p>
    <p>DHCP可在统计报告（包含其MIB (管理信息块））和日志内 报告当前租约的代理电路ID值。由于电路ID仅对于特定中继代理是 局部的，所以电路ID可被识别中继代理的giaddr值限定。在电路信 息现在未被写入租约文件的情况下，DHCP服务器和/或中继代理必须 被增强。远程ID可以是DSL调制解调器ID。</p>
    <p>在上述系统中，实现为计算机数据结构或数据库记录的与建筑相 关联的物理网络连接ID的识别被用于验证建筑内的一个或多个网络 设备，使得安全的网络通信直接与建筑的拥有者或占据者相关联。这 通过在它们签名进行服务时使用户与到建筑的物理连接ID相关联、 然后检查来自相同物理连接ID的用户的随后的服务请求来完成。由 于建筑不能移动，这提供了依赖用户可靠性的基础。图5示出根据本发明的另一个实施例的验证系统，其也依赖于物理组件或与建筑的连接进行验证，但是使用数字证书来识别该连接，这样在系统中添加了另 一个安全层。验证系统被"捎带，，在现有的物理安全的双向网络例如像具有到特定家庭和建筑的专用线路的电话公司那样的效用网络上。但是，在可选实施例中可提供单独的、独立的验证系统。在图5中，验证系统被捎带或添加到电话公司的现有数字用户线路（DSL)服务中。此系统可选地可与提供到建筑的宽带线路连接的其它服务例如电缆服务提供商、电路公司、FTTH等等一起使用。</p>
    <p>图5的系统被链接到已认证的验证中心20的公用设施服务器或数据中心10管理，该中心可被信任以执行验证服务。在此实施例中，验证中心或服务器可以是公知的认证实体，如Verisign、 Thawt或Baltimore,其它实体只要被类似地认证为可信则也可参与。在可选实施例中，公用设施数据中心IO和验证中心20可被组合为单个实体，并且公用设施服务器执行可信的验证服务。但是，公用设施通常不已知为有资格执行验证功能，从而所示实施例内的系统使用单独的验证服务。</p>
    <p>公用设施服务器或数据中心10连接到各种公用事业公司边缘站点或服务盒30,并继而通过专用物理通信线路35连接到订购该服务的每个家庭内的网关模块36或建筑40。在此情况下，通信线路35是基本上很安全的组件，每个通信线路连接到一个特定的建筑。家庭网关模块36继而通过有线或无线通信链路38连接到建筑内的多种用户设备，如机顶盒或电视45、个人计算机或膝上型计算机50，以及各种基于载体的无线设备55。每个通信线路38仅连接到一个建筑或物理位置。</p>
    <p>术语"基于栽体的无线设备"是指连接到无线网络的客户设备或其它设备。无线网络可以是任何人均可连接的开放网络，如电气和电子工程师协会（IEEE) 802.11，或服务提供商、如便携式电话公司或其它无线通信栽体或无线通信设备提供的服务。基于载体的无线设备的示例是蜂窝电话、无线调制解调器、无线PDA及其它无线设备。音频和视频回放装置及网络浏览器应用程序是在基于载体的无线设备上运行的应用的示例。还可想到其它在基于栽体的无线设备上运行的应用，并且这些应用受益于文中所述的验证方法。</p>
    <p>此实施例内的网关模块36与前一实施例中的客户前端设备(CPE ) 380是等效的，并且可以是终止Telco信号或将Telco信号传递给网络的任何设备。家庭网关模块的示例包括DSL调制解调器、线缆调制解调器、光纤调制解调器、无线调制解调器、专用电路连接例如Tl设备，以及使通信线路连接到网络的其它设备。家庭网关模块36可包含多个通信、调制解调器式功能，并且可包含NAT、内部到家庭DHCP服务器、防火墙以及其他网络功能例如VPN、无线接入点等等。术语"家庭网关"或"CPE"是对上述项中任一项的上位描述，并且除了上述网络功能之外，还可包含唯一的标识符例如DSL调制解调器标识符、有线电缆数据服务接口规范（DOCSIS)标识符、增强基线私有接口 （BPI+)及其它标识符。</p>
    <p>在所示实施例中，建筑内的用户设备经由公用设施服务器连接到内容提供商，并且经由互联网65或专用网（未示出）连接到其它用户60。但是，经由公用设施服务器的与外部世界的连接并不是必需的，并且图5的验证系统可选地可仅用与验证用户建筑。建筑或物理结构40可具有其它的与各种其它站点的宽带有线或无线连接以便发送和接收数据。</p>
    <p>公用设施边缘站点模块30是负责将家庭和建筑连接到主干网上的分立集群内的物理结构。在图5的示例性实施例中，每个边缘站点模块30包含与连接到附近每个建筑的安全组件或线路35相关联的安全控制单元。边缘站点模块30具有足够的物理安全措施和结构，以确保边缘站点模块本身不会因驻留者进入且破坏系统而泄密。当边缘站点模块是DSL边缘站点时，其可包含用于指引去往和来自每个建筑的通信的数字用户线路接入复用器（DSLAM),该边缘站点经由相关联的专用线路35连接到该建筑，并且还可如下文所述包含形成验证系统的一部分的控制模块。</p>
    <p>边缘站点模块30包含如下两个安全等级：</p>
    <p>1. 边缘站点本身在物理上受到保护，并且其访问仅局限于授权个人，该授权个人应使得数据中心10以及还可能验证服务器知道他们的进入和离开。</p>
    <p>2. DSLAM服务器（以及用于支持DSLAM的服务器）也在物理上受到保护。DSLAM可具有它们自身的独立的安全装置和设备，这些安全装置和设备与用于将人们阻隔在边缘站点的物理结构之外的安全装置和设备分开。</p>
    <p>在图1至4的实施例中，用户证明或验证依赖于建立注册用户与连接家庭或建筑和网络边缘站点的物理线路之间的关联性。该关联性是通过在注册时以及当注册用户随后使用该设备时确定用户的物理网络连接ID而创建的。在图5的实施例中，不是使用各种源例如DHCP租约表识别到建筑的唯一通信线路35的连接或电路ID,而是使附加的安全凭证与建筑或者到建筑的物理连接相关联。安全凭证可以是数字证书。在一个实施例中，每个边缘站点模块30包含多个数字证书70，这些数字证书经由将边缘站点模块70链接到物理结构40的一个或多个通信线路35被发布给边缘站点模块所服务的群集内的每个分立物理结构40。这些数字证书被存储在数据存储区域内。边缘站点模块还可具有包含用于验证的密码例程的长期存储器，在边缘站点模块内可添加被编程以执行必要的验证步骤的附加处理器，或者如果合适的话，这些功能可由现有的边缘站点处理器执行。</p>
    <p>此实施例的验证系统使用公钥基础结构（PKI)发出和撤消数字证书70，该数字证书是不可变的软件对象。这些数字证书是承载两个唯一密钥的包封。这两个密钥各不相同。 一个密钥是另一个密钥的反</p>
    <p>向密码。如果一个密钥被用于加密数据包，则全域内的唯--个可成</p>
    <p>功解密该数据包的密钥就是该数字证书内保持的另一个密钥。 一个密钥通常被称为公钥，而另一个密钥通常被称为私钥。私钥总是安全地附加在不可变的对象上。公钥在用户和预期的网络各方之间共享。一旦数字证书70已经被认证实体或验证服务器20发给在此情况下是不可变对象的特定建筑（或者安全组件，即连接到该建筑的线路35)，则可使用以下步骤来验证建筑内的网络用户：</p>
    <p>-用户使用私钥加密数据包，并且将加密的数据包和未加密（明文）数据包发送给另一个网络用户；</p>
    <p>-接收方接收到这两个数据包，并使用来自认证实体20的与用户建筑相关联的对应公钥对以前加密的数据包进行解密；</p>
    <p>-接收方执行操作以匹配未加密数据包和明文数据包；</p>
    <p>-如果匹配操作成功，则验证远程网络用户。</p>
    <p>在此实施例中，通过将此验证过程内使用的数字证书联系到不可移动的特定建筑或者可被检验的连接到该特定建筑的安全组件，提供了更高的安全等级。这不同于以往的这种数字证书的使用，其中证书例如通过认证实体发送给用户以便安装在诸如计算机的硬件设备内的通用串行总线（USB)软件狗等等与可移动的物理组件相联系。代替或者除了其中物理连接标识符被定位和存储以便验证注册用户的上文结合第一实施例说明的技术之外，可使用数字证书与物理连接35或305 (图1)的关联性。</p>
    <p>针对特定建筑专用的边缘站点数字证书与安全地存储在建筑内、例如在家庭网关模块36内的对应密钥相匹配。提供了这样的保护机制，即该保护机制可确保设备例如家庭网关模块36不能移动到另一个物理位置，并且仍成功验证用户。已知的密钥系统可创建用于将不</p>
    <p>可变对象与极低的出错率相联系的标准和系统。换句话说，只要组成部件（在此情况下，边缘站点模块、线路35、家庭网关模块）不可变，</p>
    <p>则可使用数学来确保组成部件之间的联系非常好。</p>
    <p>由于每个数字证书70与固定物理结构（或者与该固定物理结构的分立连接）相关联，所以此系统使得可对拥有该物理结构或建筑、在该物理结构或建筑内居住或工作的用户进行可信赖的验证，而不仅是用户设备的验证，这样没有识别或确保设备的实际用户的可靠性。每个数字证书可具有其自身的专用于唯一一个通信线路并因此专用于一个物理站点的私钥。</p>
    <p>边缘站点模块30和物理结构40之间的物理通信线路35可以是物理线连接例如双绞线（铜线）、DSL线、光纤线，专用和分立无线连接，或执行类似的专用功能的其它专用端口或连接或专用线路。验证设备20可发出并撤销群集（community )内的各种边缘站点模块内的数字证书以便验证该群集内的物理结构。数字证书可以是携带两个唯一密钥的X.509数字证书。X.509是ITU-T (国际电信联盟-电信）发布的数字证书的说明。</p>
    <p>其他家庭和办公建筑可被指定它们自己的分立数字证书。因此，整个群集可使用此验证系统和方法。</p>
    <p>当通信线路35是DSL线路时，其通常连接到家庭网关模块36以便实现到和来自建筑内的用户设备的DSL连接。可选地，网关模块36可以是连接到家庭内的用户设备的简单路由器，或者用于管理终端用户的数据流的改进路由器。在另一个实施例中，建筑内的一个或多个用户设备可直接连接到通信线路35并因此连接到数字证书。</p>
    <p>一旦已经为特定建筑设置了数字证书70,则该数字证书还可用于验证该建筑内的用户设备。尽管在此实施例中数字证书没有安全地附连到建筑本身，但是该数字证书在供应商边缘站点模块30处安全地附连到DSLAM或其它服务器内的用于该特定建筑的专用访问线路。这都是非常必要的，因为DSLAM被保持在物理安全的边缘站点内并且确认其专门用于正确的建筑，这都是因为服务被专用访问线路转交给该建筑，并且存在该建筑内的用户对服务的付费历史记录。与需要自己的网络的验证系统，以及具有双向网络连接性的物理上安全的盒与订购验证服务的每个建筑的连接相比，"捎带"在已有网络上的此系统的设置要便宜得多。</p>
    <p>图5的实施例提供了使用公钥基础结构（PKI)或等同物以便发出X.509数字证书70 (或类似验证证书）的&#34395;拟专用网络，每个证书与地面上的固定物理位置相关联，而不是与可能被移动、盗窃、克隆等等的可移动或相对活动的用户设备相关联。这使得可对电子商务、电子邮件和其他电子交易进行安全的双向验证。图l-5的系统利用公用事业公司例如电话、电力公司、有线电视公司等等的已有硬件、软件和专用网络作为客户验证系统的基础。如果需要的话，所有需要的验证系统硬件和软件在网络内的每个位置被添加到现有硬件和软件中。这可大大减少初始设置费用。但是，这些系统可选地可被设定为具有自己的专用网络、验证服务器和数据库的单独的、独立的客户验证系统，并且网络服务器提供商使用该系统进行注册和用户验证。这在新建筑开发的情况下尤其可行。</p>
    <p>图5示出认证授权验证用户电子设备位于其中的家庭或其它物理结构40的一级验证系统和方法。用户设备还可在如图6所示的两级验证系统内由与建筑相连接的安全组件验证。在该系统内，认证授权20提供数字证书70,该数字证书70验证与该数字证书相关联的建筑的物理位置（或者连接到建筑的安全组件，如连接到建筑的线路35、建筑内的连接端口 、连接到线路35的家庭网关模块36等等的位置）。这是第一级验证。在第二级验证中，家庭网关模块36继而验证建筑内的每个用户设备。图6示出图5的实施例的两级验证系统，但是在图1至4的实施例内可使用类似的系统，该系统具有合当的如图5内所示的附加硬件和软件。</p>
    <p>在图5的实施例中，家庭网关模块36可具有存储在数据存储模块中的对应于与其特定建筑相关联的边缘站点数字证书70的密钥。如图5所示，公用事业公司（例如电话公司或Telco)或可信认证授权可选地向建筑用户提供包含与数字证书70的配对数字证书的硬件安全元件。硬件安全元件可以是USB软件狗95,或任何其它硬件安全元件，如安全芯片、可信平台模块（TPM)、智能卡等等。TPM用于为计算机设备提供基于硬件的安全性。通常，TPM包含嵌入芯片内的密码硬件或单独的硬件模块。在图4的实施例中，安全USB软件狗95安装在家庭网关模块36内。</p>
    <p>在图5的实施例内，为了网络通信正常操作，可在家庭网关模块36和电话公司边缘站点数字证书70之间成功执行加密"签名，，功能，以便验证功能获得正面结果。这可确保给定的家庭网关模块36 (或其它类型的路由器设备）不会在不同的物理位置工作。加密签名功能可使用合适的加密软件，例如马萨诸塞州的RSA Security of Bedford公司所提供的软件执行。该公司具有用于确保在网络行为被正确地执行之前对应数字证书被正确地匹配的方法、技术和算法。RSA-类型的验证过程可用于文中所述的每个实施例。在一个实施例中，数字证书验证过程用于检验授权设备没有从一个物理位置移动到另 一个物理位置。</p>
    <p>如图5内的虚线轮廓所示，系统可在家庭网关模块内使用TPM96而不是软件狗95。可使用任何合适的硬件安全元件代替软件狗95或TPM 96以便安全地使家庭网关模块与数字证书70例如智能卡、安全芯片技术等等相关联。</p>
    <p>可在与建筑相关联的每个用户设备内设置类似的硬件或软件安全设备。例如，机顶盒45可具有基于硬件的安全元件例如智能卡98,其包含证书70的对应数字证书。智能卡98可选地被软件狗、安全芯片等等代替。个人计算机50可具有基于硬件的安全元件例如图5内所示的软件狗100、或智能卡、TPM、安全芯片等等，其也包含数字证书70的对应物。</p>
    <p>为了支持无线设备55，家庭网关模块36可具有其自身的用户识别模块或SIM 110,该模块使得可与属于建筑物所有者和/或建筑物占据者的所有无线设备55进行安全通信。SIM卡或芯片包含存储客户帐户或信用信息的安全存储器。每个无线设备继而可具有SIM卡112，该SIM卡被配置成仅通过使用加密套接字协议层（SSL )或类似技术的安全隧道或链路114与家庭网关模块的SIM卡通信。用户识别模块可选地用于基于载波的无线设备，该模块存储设备的服务识别，以及可选地用于账单信用或其它会计信息。通常，SIM是用于识别用户的安全加密处理器。安全隧道114可基于&#34395;拟专用网络（VPN) 、 IPSec或SSL隧道或其它已验证和加密的通信链路，或例如本发明所述的专用内部通信链路。安全隧道可以是在有线和无线通信路径之间连接的</p>
    <p>35两个网络端点之间的&#34395;拟隧道。</p>
    <p>在系统的初始设置时，或者每当添加新的用户设备时，每个用户</p>
    <p>设备被家庭网关模块36验证以使用户设备的安全元件98、 100、 112和与软件狗95或TPM 96以及SIM卡110关联的相同数字证书70加密地相关联。类似措施可用于图5的实施例以使每个用户设备与家庭单元80内存储的数字证书70相关联。这提供了建筑家庭单元或到用户设备的网关的第二级验证。</p>
    <p>在图5和6的实施例中，建筑内的设备仅在DSLAM边缘站点30通过已被分配给建筑的数字证书通信。因此，实现以下通信：DSLAM边缘站点1&#8212;DSLAM数字证书1&#8212;建筑1DSLAM边缘站点2&#8212;DSLAM数字证书2&#8212;建筑2DSLAM边缘站点3&#8212;DSLAM数字证书3&#8212;建筑3在一个实施例中，建筑2不能与DSLAM数字证书l或3通信，而建筑3不能与DSLAM数字证书1或2 (或除了数字证书3之外的任何其它数字证书）通信。因此，每个建筑或物理结构可仅通过其自己的数字证书通信。</p>
    <p>在一个实施例中，如图5所示，Telco或公用数据中心也具有关联的数据证书71。数据证书71可对于连接到数据中心的每个边缘站点30是唯一的，或者可与单个或多个Telco数据中心相关联。每条路径例如图5所示的路径内的所有安全元件可被加密地校准和同步，以便验证功能可获得正面结果并且进行正常网络通信。换句话说，主机数字证书71、边缘站点数字证书70、家庭网关软件狗95或TPM 96以及STB智能卡可被加密地同步，以便提供付费电视服务或电影。类似地，主机或服务操作员数字证书71、边缘站点数字证书70、家庭</p>
    <p>以启用PC和其它网络服务器或用户60之间的安全公用网通信。最后，主机或服务操作员数字证书71、边缘站点数字证书70、家庭网关SIM芯片IIO和无线设备SIM芯片112可加密地校准和同步，以便可进行无线通信。如果硬件安全元件被影响或者被从用户设备中去除并移动到别处，不可能发生加密校准，这是因为安全元件不再连接到适当的家庭网关安全元件。所有网络流通量依赖于在任何其它网络过程可能</p>
    <p>发生之前在家庭网关模块处的在数字证书和安全软件狗95或TPM 96之间的成功的RSA类型验证过程。</p>
    <p>图7是示出使用图5和6的系统的验证方法的流程图。在第一步200内，预期用户或客户将他们使用服务的意图通知验证服务（可由公用事业公司提供，或者是独立的验证服务提供商20)。验证服务器20然后尝试使用关联的专用网络例如电话公司或其它服务提供商网络或可选实施例中的专用验证网络连接到该预期用户位于其中的建筑（步骤202 )。当电话公司网络用作验证系统的一部分时，验证服务20尝试通过电话公司操作中心或数据中心10、与该预期用户位于其中的建筑40相关联的电话公司边缘站点30、以及将边缘站点连接到建筑的家庭网关模块的专用线路35连接到建筑。如果连接成功，则使用电话公司存储的记录和/或位置传感器一如果设置的话一检验建筑的物理位置（204)。然后使用已知的PKI技术创建唯一的数字证书70 ( 205 ),并且在远程验证服务20处的数据库内存储的验证记录内此数字证书70与建筑相关联。在步骤206，唯一的数字证书70被提供给边缘站点30，并且在边缘站点30或建筑网关模块37内存储在永久存储器内。这是如图4的系统内所示的第一级验证。</p>
    <p>然后可执行第二级验证。与该唯一数字证书相关联并且包含用于该证书的密钥的基于硬件的安全设备被提供给在建筑地址处的服务用户，并且被用户安装在建筑网关模块内（步骤208 )。此安全设备可只有在安装在网关模块36内时才可被检验，该网关模块36物理连接到该建筑地址的专用线或链路35，从而其对于试图偷窃和重新安置该服务的任何人是无用的。安全设备还可被设置成安装在在建筑位置处的每个用户设备上，并且在步骤210，这些设备的安全密钥与网关模块36的安全设备95、 96或IIO加密地相关联。同样，这些安全设备可仅在被本地连接到网关模块36内的合适设备时被检验，从而它们不能用于任何其它位置。这意味着使用数字证书70的所有安全网</p>
    <p>37络通信可被可靠地仅与一个具有可识别的占据者和/或用户的物理结</p>
    <p>构相关联。然后， 一个信任链可离开网络达到结构40，并且从结构40到用户设备和关联用户。</p>
    <p>通过此系统可容易地实现高粒度。当建筑物具有多个承租人时，每个承租人可具有基于树形结构发布的他或她自己的数字证书，在该</p>
    <p>树形结构内房东或建筑所有者是"父"分支。验证模型然后可以是：网络&#8212;结构&#8212;房东&#8212;承租人。此树形结构可差不多无限地扩展。例如，</p>
    <p>在人们不具有他们自身与其相关联的物理地址，并且经由&#34395;拟专用网</p>
    <p>连接到验证服务器的情况下，可允许与已有的物理地址相关联以计</p>
    <p>费。这种服务可采取额外措施以例如在如Verisign的公司当前使用的</p>
    <p>成功会谈过程之后检验在建筑外部的用户。</p>
    <p>图8是示出当例如出于商业用途例如安全的金融业务或购物、安全的电子邮件通信等等，订购验证服务的用户希望与具有网络服务器60的潜在网络伙伴进行安全通信时所执行的验证步骤的流程图。系统向用户提供例如通过调节每个网络应用内的优选项设置在内部或外部操作安全网络以开启或关断验证系统的选项。当不需要验证时，例如如果用户仅是在互联网上搜索以获得信息，则用户可能选择不激活验证服务。当安全或验证服务被激活时，用户可将数字证书的公钥发送给潜在的网络伙伴（步骤250)。这可通过专用网、专用网公用服务器IO、公共网或互联网65被发送给所选择的网络伙伴60，或者可通过另一个连接被从建筑40直接发送给公共网65 (例如，如图9的可选实施例所示）。在图1的实施例中可提供类似的离开建筑到互联网和其它公共网或专用网的直接有线和无线连接。</p>
    <p>在一个实施例中，验证服务用户可能需要输入用户名和密码以便访问验证服务。这为验证系统提供了额外的安全等级。这个实施例中提供的三个安全等级是：（i)你知道什么（即，用户名和密码）；（ii)你有什么（即，硬件安全元件或诸如USB软件狗等等的元件）；以及（iii)你是谁（附连到建筑或物理结构的数字证书提供来源的安全识别）。在图l至4的实施例中，通过识别与建筑的物理连接例如已</p>
    <p>38有的IP地址端口号提供第三安全等级（你是谁）。</p>
    <p>在接收到公钥之后，潜在的网络伙伴然后要求验证服务器10确 定密钥的有效性（步骤252 )。验证服务器可检验密钥是否和与建筑 物理地址或位置相关联的有效数字证书70相匹配（步骤254 )，并且 可&#37318;取步骤以例如通过边缘站点模块和线路35经由专用网来联系设 备，检验被授权设备还没有从一个物理位置移动到另一个物理位置。 如果检验成功，则允许进行正常网络通信（256)。如果检验不成功， 则不允许进行通信（255 )。</p>
    <p>图9示出提供另一安全级的图4和5的系统的变型。这个附加的 安全级也可在图l至4的系统内提供。在图9的实施例中，用户设备 45、 50通过家庭网关模块连接到建筑40和边缘站点30之间的专用线 路35，并且可使用此线路访问连接到主机系统的其它网络（如图l所 示）。建筑40可具有其它的固定线路宽带连接280，并且用户设备还 可获得且发送数据内容文件，否则通过这些连接通信。在此情况下， 经由固定线路宽带连接280接收的任何高价值内容将必须被加密以保 安全。高价值内容通常不会不受障碍地传递到STB或PC (即，在图 9的安全专用网外部）。固定线路宽带连接280示出用于可能不提供 不包含因特网的实际互联网服务例如电缆网络。但是，对于许多应用， 固定线路宽带连接280仅由通信线路35提供。</p>
    <p>无线设备55可经由高速无线链路或源290接收和发送通信。这 代表了无线网络或服务例如IEEE 802.11、或提供商例如移动电话/^ 司、或提供与网络或通信端口的无线连接的其它无线通信载体或无线 通信设备所提供的服务。当无线设备从其它无线载体例如移动手机服 务提供商订购无线服务时，该载体具有它们自己的验证用户的方法， 本发明的方法为整个网络提供了更多的验证和安全。但是，本发明的 系统和方法不需要单独的无线栽体。</p>
    <p>在图9的修改实施例中，基于会话的水印软件模块300被安装在 每个用户设备45、 50、 55例如建筑内的每个机顶盒、计算机和无线 设备上。基于会话的水印软件用于主动识别针对被流式传送或下载到物</p>
    <p>理结构40内的内容文件进行的剽窃、掠夺和盗版行为。软件在用户 下载的内容中放置分立且唯一的水印有效栽荷。水印的有效栽荷是客 户专用的标识符（或者事务ID等等），该标识符可用于识别用于访 问和播放内容的客户播放设备（STB、 PC、 PDA、手机等等）。水印 有效载荷可被来自唯一数字证书的用户私钥加密签名，从而在内容被 发送时提供进一步的验证。这使得如果用户尝试将内容未授权地分配 给其它用户，该用户将会被识别出来。</p>
    <p>在可选实施例中，基于会话的水印软件可被放置在位于主机或电 话公司数据中心或服务器10的内容服务器内。由于每个流或下载是 针对分立的物理结构和分立设备45、 50或55而专用的，插入主数据 中心10的唯一的水印有效载荷将足以制止物理结构40内的数字盗 版。这个可选实施例要求下载通过主数据中心被指引到建筑，而不是 被在另 一个连接内直接指引到建筑。可以实现使用客户的私钥的水印 有效载荷内的密码签名，以进一步证明用户或客户请求内容发送并且 全权负责内容的保护。这可有效地防止内容被上传到公众共享站点 上。</p>
    <p>建议所有水印基于会话进行。这意味着每个单独的内容流或下载</p>
    <p>被唯一地做标记。在上述第一可选水印方法中，客户或用户设备本身 可在到达该设备的每个流或下载内插入唯一的水印。在第二可选择实 施例中，内容服务器系统可在目标是特定设备（而不是其它）的每个 流或下载内插入唯一的水印。</p>
    <p>另夕卜，水印内的有效载荷使用系统可用的密钥被加密验证。在一 个实施例中，在水印有效载荷内添加数字签名，即水印有效载荷被客 户使用的私钥加密"签名"。还可使用其它方法例如"散列"和使用会话 密钥。这一验证水印有效栽荷的附加步骤还可证明负责从家庭或建筑 的内容泄漏的人员的确实性和过失。术语"数字签名"在用于本申请时 包含发送或接收方使用的或者可用于传输路径以创建可被接收方、认 证授权或另一方验证的唯一的密码签名或标识符的任何以及所有技</p>
    <p>40术。存在多种形式的可用数字签名，包括在消息散列或消息摘要上使</p>
    <p>用PKI加密，消息摘要例如Message Digest 5 (MD5)、美国安全散列 算法（SHA1)以及其它基于密码技术的数据签名技术。任何类型的 数字签名都可用于数字签名，并且，可利用任何形式的当前安全的数 字签名或未来的数字签名技术。</p>
    <p>即使对于最安全的环境，内容也总是可能从网络中泄漏并且在内 容所有者不同意的情况下变得公开可用。尽管这不太可能，但是预测</p>
    <p>可能在一些情况下发生的盗版和剽窃行为是很重要的。因此，有利的 是使用密写技术和过程例如基于会话的水印，以将不可见的标记放置 在内容文件内以便识别造成未授权的内容泄漏的人员。</p>
    <p>图9的系统的一种可能的应用是允许用户下载早发布或高清 (HD)电影等等。由于数字盗版的危险很大，所以多数电影工作室 不愿意他们的高价值的数字内容被互联网上的客户获得。消费电子产 品公司也不愿意&#37318;取使得偷窃有价值的内容更加困难的硬件和软件 技术，因为这会增加消费电子设备的成本。这意味着实际上没有个人 计算机对于HD内容是安全的。其主要原因是HD电影可被从个人计 算机容易地上传到互联网上，并且被提供给具有网络连接的实际上的 任何人。由于在互联网上具有高度的匿名性，所以数字盗版者可不受 惩罚地执行这些上传操作。添加了基于会话的水印软件的图9的验证 系统可以是一种克服这些问题、并允许在互联网上购买有价值的数字 内容以便在被验证的用户设备上查看而该内容被未授权地进一步分 配的危险很小或没有的方法。本发明的网络结构可在网络用户想要消 费有价值的产品时验证该网络用户。如果这个网络用户决定将内容文 件粘贴在公共可用的网络上（或者作出另一个类似的非法行为），则 他或她会有被抓获的危险，因为他们可能会基于内容文件内添加的水 印被识别。这对于有价值的数字内容例如HD电影的数字盗版或未授 权的发布的行为是很大的震慑，并且鼓励人们利用以及对这种内容的 合法付费。</p>
    <p>图10和11示出验证系统和方法的可选择实施例，其中电力公司</p>
    <p>41证系统的基础。传统的跟踪客户电力消耗的方式是在每个家庭或其它 建筑安装安全的电量表，并且定期读表以便计费。但是，世界范围的 电力公司计划使用网络技术以使得他们的员工不需要定期访问每个 建筑以便读表。相同的系统可用于使用计量系统的自来水或燃气公 司，该计算系统经由公司网络传输定期的计量表读数。</p>
    <p>图10的系统假设公用事业公司例如电力公司已经建立了主要打 算在给定时间段查询每个结构40的电表的状态的读取器/发送器设备 的网络。在此情况下，安全组件或家庭单元80具有包含本地验证控 制单元的组件或电路的仪表箱或外壳。家庭单元80被安全地连接在 该建筑或物理结构40内部或外部。控制单元在图9内被更详细地示 出，并且被配置成控制验证系统的本地操作以及公用事业公司的计量 操作。控制单元经由虚拟专用网络（VPN) 85与主机或公用网络服务 器84通信。邻近的其它验证控制单元也能够经由网络85与主网络服 务器通信。主服务器84继而与可信的认证实体或验证服务器20通信 以便执行验证，或者在可选实施例中，此功能可被主机服务器84执 行。</p>
    <p>如图11所示，箱80内的安全控制单元包含足以保持数字证书 70的长期存储器或数据存储模块86，用于保持密码例程等等的附加 的长期存储器或数据存储模块88,以及链接到该数据存储模块86和 88的中央处理器90。在可选实施例内，这两个数据存储功能可被包 含在单个模块内。计量表读数模块87也链接到中央处理器90。控制 单元还包括用于经由专用无线链路或固定的有线链路与网络85的接 入点通信的主通信模块92,和用于使用无线或固定有线链路与建筑内 的消费设备连接的连接或本地用户通信模块或路由器94。</p>
    <p>尽管在安装时家庭或建筑单元通过主网络服务器84与特定的、 唯一物理位置或地址相关联，但是可通过在控制单元内包含本地传感 器模块95例如全球定位系统（GPS)传感器模块或其它类型的位置 传感器来进一步提供安全性。位置传感器可用于检验箱80的地理位置。如果箱被从建筑中拆除或移走，则地理坐标将不再匹配于与数字 证书相关联的建筑位置，该系统将马上指示变动。这样可使用数据存</p>
    <p>储模块86内存储的所建立的数字证书70确保控制单元不会被从其固 定建筑位置移走并移动到另一个位置进行非法活动。在此情况下，位 置传感器95的输入被检查且与箱80打算连接的建筑的位置相比较， 以便每当客户或用户请求安全连接或活动时验证数字证书70。在图 10和11的实施例内，数字证书的对应密钥可被存储在数据存储模块 88内。</p>
    <p>在数据存储模块86、 88和/或处理器模块90内提供适合于操作 验证系统的用户或客户端的软件。家庭或建筑控制单元的物理结构或 封装被设计成不能被容易地移动，并且可具有表现出可识别的个人或 公司的所有权的识别码等等。还可采用其它安全措施，例如从而在检 测到一些人破坏或移动箱80时取消数字证书。</p>
    <p>如先前的实施例，主机或公用网络服务器84链接到可信的认证 实体或服务操作员数据库/验证服务器20，该服务器20收集订购验证</p>
    <p>而且还使得此信息可在互联网65 (或其它公用网）上被快速和有效地 查询。如图10所示，如可信认证授权或验证服务器20,网络结构40 内的用户设备通过有线或无线连接与互联网或其它公用网65连接。 如先前的实施例，可信认证授权服务器和数据库可被公用事业公司本 身提供作为其自身网络服务器和数据库84的一部分，或者可以是如 图5所示的完全分离的实体。</p>
    <p>图10内的家庭或建筑单元或安全组件80通过箱80内的控制单 元中内置的路由器等连接到建筑40内的各种用户设备。这种连接可 以是（但不局限于）以太网上的互联网协议（IP)。软件和通信模块 被设计成支持结构40和主机服务器84例如电力公司之间的、以及该 结构和结构内的客户或用户设备例如结构内的设备40、 50和55以及 其它电子设备之间的安全双向通信。在图10的实施例中，如图9的 实施例一样，可在家庭单元80和连接到家庭单元的用户设备内安装</p>
    <p>43额外的安全元件例如软件狗95。</p>
    <p>每个建筑控制单元可定期将计量数据与确认数字证书70的状态 的信息一起报告给主机服务器或操作中心84。数字证书状态信息经由 一个或多个中间数据收集点或网络中继站被传递给验证服务器20(如 果与主机服务器分离）。在接收到状态信息时，验证服务器可更新打 算检验证书是可信的并且未被篡改的数据库，从而其可用于检验在建 筑40内居住或工作的人的网络交易。定期的数字证书状态更新被从 边缘站点服务器发送给主机服务器，然后发送给验证服务器。</p>
    <p>由于电力公司部署的网络可定期向操作中心报告，重要的是，部 署可以使用通过验证数字证书获得的信息的大型的、安全的、大容量 的服务器，从而可基于这种证书作出验证安全网络活动的瞬时网络请 求。</p>
    <p>一旦验证网络已被设立，则其可用于验证使用付费电视服务的机 顶盒45，检验具有电子邮件功能的用户设备的非垃圾邮件，验证互联 网电子商务交易，减小身份盗用并且减小其他类型的基于网络的欺诈 行为。</p>
    <p>过去，在芯片级作出了许多重要努力以验证网络用户。这些努力 没有实现在很大程度上是由于关于个人隐私保护的声音保护。这是由 于验证设备违背客户的意志而被强加给用户，隐藏在客户设备内。相 反，本发明的验证系统和方法除非被客户或用户特别请求否则不会被 安装，或者可被客户随意容易地启动或关闭。当然，当系统未被激活 时，客户不能与对于互联网或其它公用网上的安全交易需要此验证级 的其它网络服务或用户联系。</p>
    <p>另外，客户仅需要能够将公钥发送给预期网络伙伴以便被验证， 该公钥可与在图5至11的实施例内的分配给客户的建筑的数字证书 或图1至4的实施例内的连接线标识符相关联。不需要个人信息例如 地址、电话号码或其它关于建筑的特定信息。如果存在足以导致信任 的基础，则预期网络伙伴对验证服务器的查询可返回YES，并且如果 不存在信任基础则返回NO。</p>
    <p>44如果使用验证系统的人参与非法活动，则适当的管理机构能够从 验证服务总部获得关于建筑的物理地址的信息以及建筑所有者/用户 的信息，并且可采取适当的行动。这与使用取证装置的当前状态以定 位和检验在网络上发生的非法行为没有区别。</p>
    <p>通过此系统，家庭或建筑仅需要通过远程验证服务或数据中心验 证自身。家庭内的用户设备可被验证给客户前端设备例如单个建筑网</p>
    <p>关、安全网关模块、路由器、调制解调器或交换机（图1至9)，或 如图10和11所示的组合的计量和安全控制单元80。正如公用事业公 司向居住环境内的各个承租人或办公或商业环境内的各个用户提供 服务一样，本发明的验证系统可提供相同的粒度等级。建筑的所有者 不必对整个结构负责，而是可要求每个承租人经由分配给每个承租人 的数字证书负责他们的区域。这可通过创建层级结构并且为每个用户 或承租人发布单独的数字证书和密钥容易地实现。</p>
    <p>图12是图9的验证系统的更详细视图，其示出链接到商业网络 物业公司或服务提供商的系统，而图13是示出当注册的用户在图12 内指示的路径上从零售商订购服务时的验证过程。尽管此实施例使用 实际数字证书70以识别到建筑40的唯一的有线或无线连接35，但是 也可以按照上文结合图l至4说明的方式建立安全证书，即通过识别 实现为计算机数据结构或数据库记录的物理连接ID，并且使用此物理 连接ID作为用于验证经由该连接ID通信的用户的"证书"。</p>
    <p>家庭或建筑的数字证书70在被使用时可以是单个数字证书，或 者可在物理结构40和电话公司或主边缘站点30之间分配，并且可以 是独立的或者如上文结合图6所述地与物理结构内的网络元件组合以 提供一个证书链。当数字证书在物理结构40和边缘站点30之间分配 时，可基于结构40和边缘站点30之间的物理连接，或者经由在边缘 站点30和物理结构40之间建立的密码安全连接发生结合。为了下文 的说明，应理解术语"数字证书，，可以是实际安装的数字证书，如X.509 证书，或者可以是如上文结合图1至4所述的在将家庭或建筑连接到 网络边缘站点的通信线路或用于接收经由这种线路的通信的端口之间实现的关联。</p>
    <p>如上文结合先前实施例说明的，边缘站点30和建筑网关、路由 器、调制解调器或交换机36之间的通信线路35可以是有线或无线的。 当使用无线通信时，可使用无线连接与 一些客户设备指定信息的组合 例如序列号、SIM卡、智能卡、客户设备内的安全存储器、网络MAC 地址或用于为服务提供商等建立无线服务（手机，无线调制解调器， 或其它无线设备）的任何其它标识符建立通信线路35。</p>
    <p>图12示出从与物理结构相关联的用户设备到商业或服务供应商 的通信路径。主数据或操作中心IO和边缘站点30连接到网络400, 网络400可以是任何类型的物理或无线网络，如因特网。类似于边缘 站点30的各种网络边缘站点410以通常的方式连接到网络400，包括 商户网络470的边缘站点450。商户网络470是针对商业或贸易位置 的计算机网络。示例包括可被描述为提供www.ebay.com的处理的计 算机服务的分布式集合的EBAY⑧计算机网络。另一个示例是用于电 子商务站点或教育站点的分布式计算机处理。商户电子商务网站物业 公司或数据中心483经由商业路由器或网络交换机480连接到商业网 络470。商户电子商务网络物业公司是为商业或服务过程执行处理的 计算机群集，例如电子商务网站。可连接到网络470的一种特定类型 的电子商务网站物业公司是视频点播服务器物业公司490，其是经由 家庭网关模块36向用户设备例如STB、智能卡、PC、基于载体的无 线设备等等提供视频交付业务的计算机群集。视频点播（VOD)服务 器物业公司490可发布其它形式的内容和媒体，并且不局限于视频内 容。视频点播服务器物业公司还代表任何形式的电子商务、教育、体 育、消费注册或其它互联网站点。</p>
    <p>在此实施例中，可使用嵌入到关键网络组件中的安全屏障在用户 或用户与服务提供商之间建立被验证或可信的通信路径。凭证可以是 物理上被包含在设备内的标识符或数字证书，或第三方例如Telco提 供的关联凭证。凭证可以是如图5至11的实施例内的X.509数字证 书，或可以是如上文结合图1至4说明的识别从Telco边缘站点30</p>
    <p>46到物理结构40的一个具体物理连接的安全凭证。关键网络组件的凭 证被用于验证特定的网络端点（客户机或服务器），或者两个端点之 间的消息都来自已知网络和已知网络位置，该已知网络和已知网络位 置使用上文结合图1至11说明的任何技术基于它们的物理网络连接 (通信线路305或35 )来验证。可信通信路径内的被检验的凭证可最 少使到物理结构40的单个通信线路35生效，或最多使例如从PC 50 到商户网络470的通信路径内的多个端点生效。可通过访问Telco或 其它主数据中心10以验证物理结构40的安全凭证来检验凭证，或者 检验可由独立的第三方电子商业网验证站点420或验证建筑的安全凭 证的可信认证授权或验证服务器20执行。</p>
    <p>可信路径的附加元件可被添加到验证过程中，包含物理连接网点 例如客户设备（STB 45)和商户网络470的路径内的任何网络边缘站 点（例如图12内的元件450和30)的认证。可信路径通信可包含通 信网络内的多个主要元素，包括互联网服务提供商（ISP)、网络接 入点、光纤骨干网、高速全球互联网通信电路、横贯大洋的通信、卫 星和微波通信电路或路径等等。</p>
    <p>在一个实施例中，可执行两个通信路径验证以在两个网络服务之 间建立可信路径。文中使用的术语"可信路径，，是指一项交易内包含的 一个或两个网络设备位于例如连接到物理铜线对的已知位置。在物理 结构40的情况下，已知位置是通信线路305或35。对于商户网络170， 已知位置是将网络边缘站点450连接到商业网络的物理线路455,其 可以是专用电话连接例如Tl线。到设备的物理连接的关联安全凭证 被用作用户检查的一部分，并且如果用户的相关联数字证书或物理连 接40的物理连接ID匹配于预期的关联性，则用户被认为是可信。当 用户注册服务时，或者当在注册或电子商务交易期间使用用户和/或地 址时，可建立物理结构40与该结构40的数字证书的预期关联性。针 对客户与Telco的已知on-ramp连接以及从网络边缘站点450到商户 网络470的off-ramp连接，边缘（周边）设备例如边缘站点30和450 可,皮验证。除了用户物理连接线路35的验证、与Telco边缘站点30的连接和商业连接（网络边缘站点450到商业网络470 )的验证之外， 客户可使用连接到PC 50的软件狗（100 )或连接到STB 45的智能卡 98或家庭网关36内的TPM 96、连接到家庭网关36的安全软件狗95 或其它额外的安全凭证被进一步验证。</p>
    <p>还可提供另外的对在边缘设备30、 450之外的网络设备的验证以 提高验证系统的验证强度。示例可包括Telco或主数据中心10的验证 (当主机或Telco边缘站点通过Telco数据中心通信时），和其它网 络传输及通信设备（示出为网络400)的验证。</p>
    <p>通过经由无线源290验证无线i殳备55内的SIM卡112，或者通 过验证到无线源2卯的通信路径，可验证该无线设备55以提供可信 的通信路径。为了在无线设备55和商业网络470之间建立可信的路 径通信，无线源2卯可在SIM存在的情况下使用SIM卡112验证无 线设备18，或者利用无线源或服务提供商290使用的其它验证方法进 行验证。当基于载体的无线设备55验证商业网络470时，无线设备 可使用商业网络470的数字证书，并且当客户验证商户网络470时， 可选地包含与商业网络470的网络边缘站点450连接的验证。</p>
    <p>图12示出用于无线载体或服务提供商的简化框图元件或模块 290，但是无线源290的内部细节可包含基于载体或不基于载体的通 信网络内常用的所有网络和通信设备。可信路径通信可包含无线源或 栽体网络290内的单个节点或多个节点执行的验证。另外，基于载体 的无线设备55可经由无线设备55、或经由无线源2卯、或经由无线 设备55和无线源290的组合、或者甚至通过这两者以及第三方验证 代理（单独代理、认证授权（CA)或其它）被单独验证。</p>
    <p>当无线设备55内不存在SIM卡时，还可通过无线设备55实现 可信路径通信。无线源290可执行通常由无线设备提供商用于验证无 线设备55的标准用户验证，并且无线源或服务提供商290可提供与 外部世界的接口，该接口可用于检查基于载体的无线设备55的状态 或身份。无线源2卯可添加指示无线设备55已被验证的消息，并且 可提供关于无线源290是否已被报告被盗或者被危及的信息。 一旦无线设备55被无线源290验证，则无线源290可将无线设备验证结果 提供给可信的认证授权、验证服务器20、商业电子商务网络物业483, 或其它执行客户验证或提供关于客户验证的细节的服务提供商或等 同物。</p>
    <p>对于不包含SIM卡或等效安全元件的无线设备55，无线源290 可向涉及无线设备55的验证的验证服务器、CA中心、或其它代理或 计算机指示缺少SIM卡。无线设备安全元件（SIM,其它安全元件或 没有）的指示可被用于指示可信CA、验证服务器或等价代理的客户 验证的强度，并且当商业网络470验证无线设备55时此信息被提供 给商业网络470。</p>
    <p>在一个实施例中，客户设备（STB、 PC或无线设备）被设立以 除了使用这种商业的典型电子商务凭证之外，通过以与线路35类似 的方式验证物理线路455来验证与商户网络470的连接。客户可从可 信CA、验证服务器或服务、代理或商业网络服务提供商（未示出） 荻得信息，这使得客户设备可检验该客户设备和商户网络之间的网络 路径在正确的物理线路（在此示例内，线路455)上建立。这种信任 由可信CA或验证服务器20、向商业网络470提供服务的主机网络 10，或验证物理线路455或提供可被客户设备检验的物理线路455的 凭证的第三方代理或验证服务420建立。</p>
    <p>在下文说明中，术语"基于家庭的被验证设备"是指经由从网络边 缘设备到家庭或房间或交易的物理连接相关联的住宅或建筑网络内 的基于计算机的设备例如个人计算机（例如，PC 50)、其它计算机、 个人数字助理或PDA (未示出）、机顶盒（例如STB 45)、数字录 像机（DVR)(未示出）以及其它消费型产品（电视、广播、放像机、 投影机），与物理连接的关联性被用于验证该设备。在此情况下，术 语"家庭，，是指人在其中居住或工作的任何物理结构或建筑。</p>
    <p>基于家庭的被验证设备还包括家庭网络基础结构项目例如家庭 网关模块36,以及具有安全软件狗95、 SIM卡110和/或TPM96的 家庭网关模块。本申请中使用的术语"家庭网关"或"家庭网关模块"还可应用于任何家庭联网设备例如网络路由器、网络交换机、DSL调制 解调器、线缆调制解调器、光纤到户（FTTH)网络设备、拨号调制 解调器、光纤到路边（FTTC) /FTTC设备、卫星接收机、其它调制 解调器或网络通信设备。物理关联可经由与设备的物理连接，或经由 无线服务提供商提供的无线验证的关联。</p>
    <p>为了提高高价值交易的安全性，需要用户经由在可信或被验证通 信路径上连接的客户设备的键区或键盘提供附加的信息，如密码、PIN 或安全码。</p>
    <p>在一个实施例中，验证系统被配置成使得网络设备可自动检测到 被验证的交易被请求，并且被验证的交易的传输路径也可被验证。这 可通过以下操作实现，即为现有协议增加适当扩展，开发并指定新协 议，执行单独的消息事务，在可被查询的任何网络点处提供安全接口 ， 添加具有被添加到从客户机流到服务器的消息中的安全信息的额外 消息封装，并且确定验证设备（商业网络470)之间的网络路径，该 验证设备检查从通信线路35到物理结构40内的客户设备例如STB 45 的物理连接。</p>
    <p>在 一 个实施例中，物理连接验证在两个端点之间的初始连接建立 期间执行。这两个端点例如可以是STB 45和商户电子商务网络物业 483，或者可以是任何用户设备和网络服务提供商。在物理连接的验 证之后，这两个端点然后可在端点之间使用对称加密。这意味着在这 两个端点之间生成会话密钥对之前检验安全的、被检验的通信路径。 即使当两个端点位于开放互联网内时，在这两个端点之间的会话密钥 交换之前仅在初始设立期间执行验证提供了可信的已知通信路径。本 发明的另 一 个实施例没有为两个端点之间的信息通信使用会话密钥， 相反，两个端点可使用基于PKI的非对称加密，该加密使用每个网络 端点的被验证的私钥/公钥对。</p>
    <p>另一个可选方法是添加触发器或标识符以指示可信的路径验证 会话被请求，并且被网络设备例如网络路由器、交换机、DSLAM、 宽带环路栽波BLC、无线单元站点、无线路由器、无线交换机、DOCSIS网络设备、网络接入设备以及其它边缘和网络基础结构设备自动处 理。触发器指示客户机或服务器或客户机和服务器或另外的网络设备 应该通过使用新协议或自动封装在这两个网络端点之间被发送的消 息，向交易增加新路径验证信息。对可信路径验证对话的请求的自动</p>
    <p>检测可基于对任何类型的网络设备例如STB 45、家庭网关36、 PC 50、 基于载体的无线设备55、 VOD服务器配套物业490、或位于客户站 点或商业站点的类似类型的计算机或设备的请求。自动检测可基于对 现有网络传输控制协议/互联网协议（TCP/IP )、异步传输模式（ATM )、 拨号调制解调器、DOCSIS、卫星通信协议的扩展，或通过限定新的 验证特定通信协议。验证协议的自动检测在基于现有协议例如TCP/IP 或安全套接字层（SSL)时可利用指示可信路径验证被请求的增强消 息。</p>
    <p>如上可见，用于验证的基于X.509的证书的使用是可选的。验证 的关键要素是物理连接线路305或35与物理结构40的关联，该物理 结构包含一个或多个计算机设备（STB40、 PC 50、家庭网关36等）， 提供物理端点验证信息，该信息然后被提供给可使用物理端点连接来 验证网络设备的远程服务器。通信线路35与物理结构40以及物理结 构40内的设备之间的关联性可使用或不使用X.509证书来建立，甚 至可不使用X.509标准（使用非基于X.509的证书，或仅使用简单的 关联数据结构）而建立。通信线路35或其它安全组件与物理结构40 内的计算机设备之间的关联性大大提高了其中没有智能卡、安全存储 器、密码协处理器等等的用户的验证。</p>
    <p>在一个实施例中，验证系统通过使客户与到家庭/用户的物理连 接相关联，而不需要任何安全元件与家庭或用户相关联，来提供可信 路径通信。这意味着物理连接信息可被用于省去客户设备安全元件， 或者在这些元件之外可被附带地用于加强客户设备安全性的验证。</p>
    <p>参照图12和13，并且使用STB45与家庭网关模块36、通信线 路35和Telco边缘站点30，验证或可信路径可被如下地建立而不依 赖于STB 45和家庭网关模块36内的任何安全元件。STB 45使用任何有线和无线通信技术连接到家庭网关模块36,并且开始与在被称为 连接到商业网络470的商业电子商务网络物业483的位置处的应用服 务器的连接。当STB45连接到家庭网关模块36时，家庭网关模块36 执行NAT (网络地址翻译）提供的IP地址翻译，从而STB 45的IP 地址与家庭网关模块36提供给Telco网络的IP地址不同。STB 45连 接到商业网络配套物业483，提供一个或多个不安全ID，如STB序 列号、或MAC地址、或者具有或不具有密码的用户ID。在接收到请 求验证的服务的连接消息时，商业网络配套物业483可识别将Telco 边缘站点30连接到物理结构40、家庭网关模块36和STB或用户设 备45的物理通信线路35。商业网络配套物业483可利用跟踪路由映 射或如下文更详细说明的其它连接识别方法（IP地址查找等）识别将 Telco边缘站点30连接到用户STB 45的家庭网关模块36的通信线路 35。</p>
    <p>Telco或主机边缘站点30可提供映射查找功能，该功能可将IP 地址或NAT翻译地址映射成通信线路35的永久标识符，而不会泄露 物理结构40的身份。这种识别可对于通信线路35使用后Telco数据 中心NAT地址翻译IP地址，该通信线路35保持对于物理结构40是 不变的，但是由于DHCP或等同物在Telco数据中心10或Telco边 缘站点30上运行而对于实际IP地址是临时的。此永久关联性使得当 用户向商业网络配套物业483注册商户提供的服务时，商业网络配套 物业483将物理线路35关联到用户。下表l内给出了一种可能的关 联模型：&lt;table&gt;table see original document page 53&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;上述实施例的验证系统和方法可被称为可信路径通信。在一个实 施例中，验证或可信路径通信方法和用于指示可信路径验证被请求的</p>
    <p>标准消息可被添加到开放式系统互联（OSI)七层网络的任一层，如</p>
    <p>物理层、数据链路层、网络层、传输层、会话层或表现层中。使用组</p>
    <p>件和软件增强以提供自动可信路径验证的网络设备可在OSI七层网</p>
    <p>络模型的合适层中自动检测验证请求。当使用其它网络层模型时，可 信路径验证可被添加到网络模型的任意层或多个层中。添加到现有协</p>
    <p>议例如SSL的自动验证指示器中的触发器可向网络设备指示需要通 过将未被验证的网络包封装在包含验证数据标题的新包标题内，或者 通过发送具有增强的验证数据（带外消息）的附加包（没有封装未被 验证的网络包），从而添加额外的验证数据。可信路径网络设备可检 测到可信路径通信会话被请求，并且自动应用如下文更详细说明的适 当的可信路径安全或验证方法。</p>
    <p>存在多种可能的用于建立被验证或可信路径通信会话的方法，但 是任何被应用的方法的关键是可信路径网络增强设备执行一些处理， 该处理导致通信网络设备被识别为被检验的可信网络路径。计算机网 络软件或硬件设计领域内的技术人员可在一个特定的网络层应用如 下文所述的技术，以建立验证方法和系统。下面的表2内列出了通常 可应用于OSI 7层网络模型的各个层的技术。建立可信路径通信或被 验证路径通信所需的硬件和软件可被全部添加到单个模型层内，或分</p>
    <p>布在多于一个的模型层中。当在下文的表内给出多于一个的模型示例 时，还可想到，本领域技术人员可仅在单个层实现特定功能，例如将 可信路径通信仅添加到浏览器层中，或者将可信路径通信仅添加到应 用层（层7)的超文本传输协议（HTTP)功能中。</p>
    <p>表2-可能的可应用于OSI 7层网络模型的不同层以建立可信路 径通信的验证技术&lt;table&gt;table see original document page 55&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;是增强远程服务器做出的客户验证，并且增加服务器的 额外处理以验证到连接到服务器的客户的物理连接。 另 一个如何添加SSL层验证的示例是通过可信认证授权 (CA)或验证代理执行验证。当在系统中使用X.509数 字证书时，可在网络内的任何位置增加单独的验证代理， 以经由通信线路35检验证书所有者（例如STB45,或 与STB45相关联的智能卡98)的X.509数字证书（或 等同物），用户从该通信线路通信。</p>
    <p>4传输层	传输控制协议 /用户定义协 议（TCP/UDP )	增强TCP连接以在TCP连接建立之前验证客户。在此 情况下，客户ID可在连接发生之前被建立，或者被建立 为该连接的一部分。 另一种方法是封装包含被封装的用户标识符的与特定网 点的TCP连接，该用户标识符可被用于提供验证。</p>
    <p>3网络层	IP，互联网控 制消息协议 (ICMP )，地 址解析协议 (ARP)， RARP (逆向 ARP)	利用协议增强例如互联网协议安全（IPsec)增强网络层 协议，从而该增强在协议封装或增强中提供验证信息。 当在IP层内添加验证时，提供协议扩展或添加的封装以 将在此层的验证提供的信息传递给协议内的更高层，或 者将验证信息提供给协议内的更高层或在客户机或服务 器或两者上运行的应用程序。</p>
    <p>2数据链 路层		对数椐链路层的增强并不是添加验证信息的优选层。但 是，可通过协议封装、协议增强或生成新协议在数据链 路层传递验证信息和状态（例如，用于连接到用户的物 理线路）。当在数据链路层添加验证信息时，可提供协 议扩展或添加的封装以将在此层的验证信息传递给协议 内的更高层，或在客户机或服务器或两者上运行的应用 程序。</p>
    <p>1物理层		在物理层添加验证并不是优选技术。但是，可通过物理 层扩展或在物理层生成传送验证信息的附加消息，在物 理层传送验证信息和状态（例如用于连接到用户的物理 线路）。当在物理层添加验证信息时，可提供物理层扩 展或添加的封装以将此层的验证信息传递给协议内的更 高层，或将验证信息提供给协议内的更高层或在客户机 或服务器或两者上运行的应用程序。</p>
    <p>系统和方法的方式。图13示出一种验证从用户设备到商户或服务提供商的路径以提供安全或可信通信路径的方法。在步骤500，订单被 从物理层中的用户设备例如图12内的PC 50经过一个或多个网络提 供给商户例如VOD服务器配套物业490或任何类型的网络服务提供 商。在一个可能的示例中，应用层通过接口连接到PC50内的网络软 件，并且请求可信路径验证（步骤502 )。应注意，在此示例中，该 应用知道订购视频需要用户的验证。如果应用软件没有自动执行此步 骤，则商户网络470可通过使用验证客户请求命令来验证客户。对可 信路径验证的请求不一定来自应用层。PC 50甚至不需要知道可信路 径验证被执行，并且服务器侧（商业网络470)可请求信息以检验可 信路径。网络软件接收到对命令路径的验证的请求，并且开始与预期 端点建立可信路径的过程。在此情况下，端点识别用户希望连接的远 程机器，例如VOD服务器配套物业490或商业电子商务网络物业483。 Telco或主机边缘站点30通过通信线路35经由家庭网关模块 36从PC 50接收"可信路径建立连接"消息。在一个实施例中，边缘 站点30可被配置成在可信路径建立连接消息中添加节点特定识别。 节点特定识别信息可识别到建筑40的物理线路35,以产生用于验证 用户的通信线路ID (而不是使用数字证书）。可选地，边缘站点30 可提供可用于检验物理连接的应用程序接口 （API)或网络服务。 Telco或主机边缘站点30还可经由消息从PC 50与其通信的服 务器/网络配套物业端点接收到对验证可信路径的请求。在这个可选实 施例中，商业网络470可向边缘站点30或等同物发送客户ID，从而 边缘站点可识别商业网络470希望验证的用户。商业网站还可从主才几 或Telco请求允许建立可信或被验证路径的验证信息。</p>
    <p>在一个实施例中，商业网络边缘站点450从Telco边缘站点30 接收可信路径建立通信或消息，其包含节点特定验证信息。网络边缘 站点450在该消息中添加网络边缘站点节点特定验证信息。多节点特 定验证可通过这种方式应用于可信路径建立连接消息。</p>
    <p>商业网络470然后接收具有边缘站点的节点特定信息的可信路 径建立连接消息，然后可以请求可信认证授权或验证服务器20或第</p>
    <p>57三方验证服务420确认可信通信路径（步骤504)。当用户设备例如 STB 45或PC 50连接到商业网络470时，商业网络或网站请求可信 CA验证Telco提供的可信路径信息。验证可信路径消息可被例如用 加密时间戳、消息序列号和任选的随机数数字签名，这使得商业网络 470可唯一识别来自Telco或可信CA的消息。</p>
    <p>认证实体（CA)或其它验证或安全设备接收到商业网络470的 "验证可信路径"请求（步骤505 )，并且确定路径是否可信（步骤506 )。 CA的消息被用CA的私钥与消息序列号和时间戳一起加密或签名以 消除回放攻击。尽管在此步骤内提到认证实体或单独或第三方验证服 务器，但是也可在Telco数据中心IO设置验证可信路径所需的软件和 硬件，并且在此情况下Telco数据中心可向商业网络470提供响应， 该响应指示路径是否可信。如果路径不可信，则商户可选择终止交易 (步骤507 )。</p>
    <p>如果商业网络从CA或类似认证服务器接收到对验证可信路径 请求的肯定响应，则使用CA的公钥确认该消息，并且商业网络还确 认当第一次对CA做出路径认证请求时由商业网络添加的时间戳、消 息序列号和随机数。商业网络470还使用PC 50的公钥加密用于与 PC 50通信的会话密钥（步骤508 )。商户将加密后的会话密钥发送 给PC50 (步骤510) 。 PC50的公钥、家庭网关软件狗95、 TPM 96 或STM IIO可用于当会话密钥被发送给PC 50时加密会话密钥。一 种可选方法是在用PC 50的软件狗密钥IOO加密之后加密会话密钥以 便输送给Telco边缘站点30，然后用Telco边缘站点30的公钥加密 该-故加密的会话密钥。Telco边缘站点30可随后解密包含该;故加密会 话密钥的加密有效载荷。图14示出此示例的加密会话密钥，并且在 下文jf皮更详细地说明。</p>
    <p>网络边缘站点450在路由到PC 50的同时从商业网络470接收到 加密的会话密钥，并且可选地作为可信路径连接序列的建立的一部 分，在加密的会话密钥响应中添加节点特定验证。具有所添加的特定 验证的加密会话密钥然后可经由网络400被发送给PC 50。可选的节点特定验证使得PC 50可检验商业网络470。网络边缘站点450不能 解密该加密会话密钥。</p>
    <p>来自商业网络470的加密会话密钥响应（步骤510 )在Telco DSL 边缘站点30处被接收，或者经由Telco数据中心10和边缘站点30 的组合被接收。可选地，Telco数据中心10或Telco边缘站点30可 验证商业响应。加密后的会话密钥然后经由通信线路35或家庭网关 模块36 (如果存在的话）被发送给PC50。 PC50接收加密后的会话 密钥，并且可选地验证来自商业网络配套物业或VOD服务器配套物 业4卯的通信路径。然后可以在商业网络470和PC 50之间开始进行 安全通信（步骤512)。</p>
    <p>如图14所示，上文所述的可信通信路径方法使得多个加密层可 应用于验证或传输数据流或者同时应用于这两者。例如，PC50可加 密商业网络470的消息，并且Telco边缘站点30可添加额外的针对网 络边缘站点450的加密层。通过使得网络边缘设备例如DSL/DSLAM 边缘设备30添加特定网络边缘站点450专用的加密可实现网络信任。 任何网络基础结构设备可添加这种网络路径加密。例如，假设Telco 边缘站点30连接到Telco数据中心10，并且Telco数据中心10是大 型电话公司或其它大型服务提供商。商业网络470可通过分层加密用 于使用PC50的用户的消息提高物理安全性。如图14所示，Telco数 据中心加密消息550可包含用于Telco边缘站点30的加密消息552， 并且消息552继而可包含针对用户PC 50的加密消息554。可选地， 通过将用户PC 50的加密消息放置在到Telco数据中心10的加密消 息内，可提供两层加密而不是三层加密。两层或三层加密可做出仅对 Telco的用户有用的响应。通过添加可信或已验证网络路径专用的加 密增强物理安全性可包含一个、两个或多个物理网络连接例如PC 50、 家庭网关36、 Telco边缘站点30和Telco数据中心10。每个添加的 加密专用可信网络路径可包含标识符，该标识符可被可信网络路径设 备用于自动除去添加的加密层。</p>
    <p>可信路径使能的通信设备可验证传输路径内的任何预期被验证</p>
    <p>59(数字签名或其它密码技术）的点。例如，商业网络470可验证到PC 50的物理连接，或者PC 50和软件狗100 (如果使用的话）到Telco 边缘站点30、 Telco数据中心10以及网络边缘站点450的物理连接。 可选地，最少可验证网络交易的一方，例如仅验证PC50。另一个示 例是商业网络470经由软件狗100验证PC 50，经由软件狗95或TPM 96验证家庭网关36，经由数字证书70验证Telco边缘站点30，经由 Telco数字证书71验证Telco数据中心10，或者经由网络边缘站点 450内的证书或安全凭证（未示出）验证网络边缘站点450。此验证 系统最少可验证PC 50端点，或者可验证PC 50端点和沿该路径的任 何其它预期元件。另外，由于引至物理结构40的物理通信线路35可 被验证，所以除了 PC50之外或代替PC50，可使用物理结构40的数 字证书70。这使得可使用一个或多个验证点验证物理结构40。</p>
    <p>参照图14，源自商业网络470的消息可仅作为用于PC 50的加 密消息554发出，其可仅被PC 50解密。网络点（例如，Telco数据 中心10)的加密消息550可包含消息解密终点指示符，该指示符指示 沿可信路径的哪个网络元件应解密该消息，例如Teclo数据中心10、 Telco边缘站点30、 PC50或家庭网关36。同样，增加的安全性可被_ 层叠在端点专用加密之上，这使得可信路径网络可识别消息，该消息 在移动通过网络时可被网络设备解密。</p>
    <p>在图14中，Telco数据中心10可识别出消息550可被Telco数 据中心10解密。在第一加密消息被解密之后，包含两个内部盒的剩 余消息552被转发给Telco边缘站点30。不但是在商业网络外部的网 络设备，而且商业网络470也可解密或去除添加的消息封装数据。添 加的加密层可被源点例如商业网络470执行，或者被网络边缘站点例 如如图12所示的网络边缘站点450添加。添加到基本的以端点为目 标的消息554中的消息加密层可以是基于封装包含信包会话密钥的消 息的信包，该会话密钥被网络元件（例如Telco数据中心10)的公钥 加密。需要解密消息的网络元件可使用网络元件的私钥解密信包会话 密钥以暴露会话密钥。会话密钥然后可用于解密会话密钥加密的信包数据，该数据是图14内的基本的以端点为目标的消息（PC50的加密 消息554 )的封装。如消息信包内的消息解密目终点指示符所识别的， 基本的以端点为目标的消息是被发送给端点的消息，而该消息的所有 其它的加密层被沿可信路径的网络设备去除。</p>
    <p>可信路径验证可作为完全安全的SSL (安全套接字层）传输路径 操作，其中验证和传输加密使用基于非对称密钥PKI的加密，该PKI 密钥基于连接端点（例如，STB 50和VOD服务器490 )。端点验证 (例如，STB 50和VOD服务器4卯）可使用非对称密钥PKI方法执 行，并且加密消息内的VOD流或其它传输有效载荷可利用对称密钥 加密，并且在端点（例如，STB 50和VOD服务器490 )之间建立会 话密钥。在验证传输路径之后可输送用于对称密钥加密的密钥。用于 对称密钥加密的密钥可使用用于每个端点的PKI密钥，或者使用在验 证之后在端点50和490之间建立的会话密钥，在端点（在此情况下， 为50和490)之间交换。可选地，对称加密密钥可通过使用其它端点 的公钥加密会话密钥使用默认的验证。端点的公钥可被可信CA或系 统内可包含的其它认证授权（未示出）获得。在上述示例中，STB50 和VOD服务器490被用作端点，但是任何两个网络元件都可用作端 点。可信路径验证的示例将使得Telco数据中心10验证Telco边缘站 点30、数字证书70、家庭网关36和PC50。</p>
    <p>基础结构元件中，包括调制解调器、FTTC、 FTTH或光纤到邻居 (FTTN)接口卡、线缆调制解调器、DSL调制解调器、路由器和网 络交换机。该方法和系统包含用于启动被验证的交易的自动装置，并 且还可包括网络边缘设备的交易路径签名，应用程序提供商的交易路 径签名，客户应用的交易路径检验，以及服务提供商的交易路径检验。 例如，在线商户可检验以下路径：</p>
    <p>1. 经由位于连接到用户的边缘站点上的物理线检验签名的用户 到提供互联网服务的用户的ISP。</p>
    <p>2. 用户的ISP到向在线商户提供服务的ISP。3. 经由在ISP的网络边缘站点的验证的在线商户ISP到在线商 户验证，该边缘站点包含使在线商户连接到在线商户ISP的线路或网 络边缘设备。</p>
    <p>4. 使位于在线商户的网站的计算机连接到在线商户ISP的在线 商户的交易门（或计算机）。</p>
    <p>5. 在线商户内的网络路径的可选的、附加的验证 此方法为传输路径提供了可信VPN以便验证和注册。注册可能</p>
    <p>需要通过家庭网关发生，这意味着家庭网关的证书涉及新用户或客户 设备例如TV、视频电话、计算机等等的注册。验证可从家庭网关开 始，该家庭网关当被设置在DSL或安全物理线路上时被用于注册/验 证层级。</p>
    <p>在请求客户（例如，图12内的STB45)没有通过在连接到远程 服务器或电子商务网站时请求验证开始会话，该远程服务器（商业网 络470)可通过发出客户验证请求命令开始客户验证。此命令可查询 客户（STB45和Telco边缘站点30或Telco数据中心IO或等同物） 之间的网络设备以获得客户的验证数据。</p>
    <p>在一个实施例中，无线设备例如图12的设备55可通过载体以及 该无线设备的栽体验证而被链接。这可为数字权限管理DRM交换提 供良好模型，从而无线设备被载体验证，并且家庭网关或视频发布设 备可证实无线设备是个人专用网的一部分。</p>
    <p>可为高带宽数字内容保护（HDCP)和在传统硬件上运行的其它 子网络提供子网络验证。与传统设备例如具有弱安全性的HDCP相 比，新硬件可受益于更好的安全性和注册。</p>
    <p>在系统内存在多个安全验证传输路径，并且在服务或购物的验证 链内可4吏用任何以及全部元件。例如：</p>
    <p>DSL边缘站点到DSL调制解调器或家庭网关；</p>
    <p>家庭网关到STB;</p>
    <p>家庭网关到PC;</p>
    <p>PC到监视器。</p>
    <p>62安全元件可用于直接连接到PDA或PC的键盘，并且可从远程 计算机将命令传递给需要响应的安全元件，该响应被安全元件加密并 且被发送给远程计算机。</p>
    <p>上文所述的验证方法和系统可避免或减少由于网络钓鱼请求带 来的问题。用户可通过使用如上所述的检验方法检验来自可信的被验 证源的电子邮件或数据。例如，当与银行家通信时，用户可检查到消 息的源是来自该银行家。系统可检验到远程源的凭证适用于被请求的 信息。</p>
    <p>如上所述，跟踪路由映射可用于确定网络拓朴，从而边缘站点或 路由器可被检测和检验。已知的跟踪路由映射不仅可用于路由器，而 且可用于在层1、 2、 3...的网络设备，以便确定包封装如何在较低的 网络层内发生。当跟踪路由映射在跟踪路由响应内没有给出接口类型 时，网络服务提供商可建立从安全头端到用户的跟踪路由之间的关联 性。示例如下：</p>
    <p>跟踪路由用户123456,其翻译成IP地址205.171.17.135。在识 别用户时的来自头端的跟踪路由可如下：</p>
    <p>1 pos2&#22283;0-155m.cr2.telco.net ( 205.117.17.130) 2ms</p>
    <p>2 205.171.17.135 lms</p>
    <p>在上述示例中，来自头端的跟踪路由将与用户123456的连接识 别为经由跳距l pos2-0-155cm.cr2.telco.net的连接，关联性可经由网 络管理控制台或等同接口被确定为此连接/IP地址与从本地局到位于 特定地址的家庭的特定物理铜线对相关联。</p>
    <p>类似的跟踪路由关联映射可将用户IP地址映射到线缆调制解调 器终端系统（CMTS) MAC地址和/或物理DOCSIS (或类似）线缆 调制解调器识别和用户。术语"跟踪路由"在文中是示例性的，但是实</p>
    <p>现物理层连接的用户与服务提供商边缘站点或网络接入点相关联的 任何命令或接口均可代替跟踪路由。可以想象，可开发新命令以使得 用户与OSI七层协议模型的物理层、数据链路层、网络层、传输层或 更高层适当地关联。尽管可以想象，网络发布服务内的多个网络设备可与物理连接等 相关联或被验证，但是可建立的最重要的关联是用户的物理网络接入</p>
    <p>设备（例如，数据调制解调器、线缆调制解调器、ATM调制解调器、 光纤调制解调器、DSL调制解调器或其它家庭内的调制解调设备）与 网络边缘站点之间的所谓的"最后一英里"关联，该网络边缘站点物理 上终止与家庭的连接。这种关联可包括OSI分层网络模型的以下七层 中的任何一个或一个以上，如上文的表2内指示的被称为物理层、数 据链路层、网络层、传输层、会话层、表现层或应用层。用户关联可 通常使用物理层连接的映射（DSL、 Sonet、 Fast Ethernet例如 100BaseT、综合业务数字网络（ISDN )、令牌环、光纤分布式数据 接口 （FDDI)、广域网（WAN) 、 ATM、混合光纤/同轴电缆网络 或其它物理层技术）在物理层建立。可为一个用户建立附加的物理层 关联，但是关键的一个物理层关联是为家庭或位置提供服务的最后一 英里关联。还可想象， 一个或多个层可组合起来，以使用户与物理连 接相关联，例如合并网络边缘设备上的数据链路层（层2)参数例如 介质访问控制（MAC)地址与用户和到用户前端的物理层连接。这种 关联可经由与网路边缘设备的通信一如果可用的话一建立，或者经由 服务提供商或等同物操作的数据库建立。用户关联的解析可精细至与 家庭的物理铜线对连接，或线缆调制解调器终端系统（CMTS)上的 DOCSIS地址，或家庭和网络之间的无线最后一英里连接的MAC或 逻辑链路控制层（LIC)或无线电链路地址，或将无线客户连接到无 线网络的基站。</p>
    <p>验证具有通信线路的用户或客户所需的验证或物理连接ID信息 可由使客户（STB 12、 PC 14、基于载体的无线设备18、 PDA或其它 客户）与通信线路相关联的Telco数据中心10 (或等同物）或Telco 边缘站点30 (或等同物）或可信CA20 (或等同物）提供。验证所需 的最少信息是客户ID和通信线路ID。客户ID是用于跟踪经由通信 线路连接到网络的特定客户设备的值。这个值可以是用于用户的具有 永久固定值的任意值，或者其可以是仅用于单个连接的临时值。这个</p>
    <p>64值可基于IP地址、IP地址和端口号、用户ID、得自用户ID的随机 数、Telco边缘站点提供的标识符例如NAT的地址，或用于识别或寸吏 客户设备与下文所述的通信线路信息字段相关联的其它类似数据值。 通信线路标识符或ID是将Telco边缘站点连接到物理结构40内的计 算机设备或调制解调器或网关的通信线路的永久标识符。这个值提供 了永久标识符，从而与物理结构40相连接的任何客户设备都可被检 验。</p>
    <p>在本发明的示例性实施例中，可获得额外的检验或验证信息以便 增加安全性。例如，签名、安全码或其它标识符可被用于检验客户ID 数据字段和通信线路ID没有被修改。此字段可如同客户ID和通信线 路ID字段的带符号散列一样简单。可选地，带符号的值可由两个不 同的散列生成，从而通过利用散列冲突消除了篡改散列的可能。有符 号的散列可使用Telco边缘站点30或Telco数据中心10或可信CA 20 或等同物的私钥被加密。当使用 一对有符号的散列利用散列&#27798;突消除 墓改时，这两个散列是具有不同的散列冲突的不同类型的散列。例如， 当使用 一对散列利用散列冲突消除签名篡改时， 一个散列可以是MD5 而另一个散列是具有不同冲突特性的不同散列例如SHA1。如果一个 散列被使用两次，则散列的计算可基于精确数据进行，而第二散列可 使用类似于SALT值的SALTed散列计算，当用户为系统选择相同密 码时，SALT值被添加以使密码随机化以消除数据库内存储的相同随 机化密码值（SALT是用于修改加密的随机数据串）。当使用两个相 同散列时， 一个散列可使用未修改的精确数据，而第二散列使用在计 算被加符号的第二数据散列时应用的随机数发生器或增白器。如果数 据被墓改以利用散列&#27798;突，则随机数发生器或增白器会导致散列冲突 利用失败，这是因为被利用的冲突仅在两个被计算的散列之一内。这 是由于每个散列计算使用不同的数据作为散列函数的输入，第一散列 是精确数据而第二散列具有被随机化或增白的第 一散列函数所使用 的数据。随机数发生器或增白器可以是简单函数例如异或（XOR)函 数，或者是更复杂的函数例如得自种子的随机数，该种子用于向第二散列计算提供不同的输入数据。</p>
    <p>如果安全或验证系统被黑客入侵或被危及安全，文中所述的实施 例可包含可更新特征。在一些情况下，可更新性可通过简单地改变密</p>
    <p>码技术实现。例如，如果先进加密标准（AES) 128加密方案被部署 并且被黑客入侵，则快速改变为另一个标准例如RSA Security of Bedford, Mass.开发的RC-4加密方案可用于将内容保护数天或数个 星期。在此情况下，系统设计者有时间更新原始加密方法以便稍晚时 重新部署该加密方法。</p>
    <p>网络的服务器侧、客户机侧以及对等用户可相互了解，但是所有 用户的一个主要关注点是抵抗各种危险保护自身的安全。网络使用中 的主要危险是：</p>
    <p>1. 客户从未知的实体接收到垃圾邮件和病毒（客户机侧危险的示</p>
    <p>例）；</p>
    <p>2. 基于网络的零售商从使用盗用的信用卡、盗用的身份等等的消 费者体验到高度欺诈，尤其是即时消费顾客服务例如长距离电话服务</p>
    <p>(服务器侧危险的示例）；</p>
    <p>3. 电子商务网络例如e-Bay上的客户，其担心进入与未知买家或 卖家的交易（对等危险的示例）</p>
    <p>本发明的验证系统如果被客户和零售商使用以便基于特定物理 结构实现安全识别，则可&#32233;解一些或全部上述问题。</p>
    <p>验证系统还可在公共网上用于向机顶盒发送安全的付费电视内 容，并且向用户设备例如计算机和手提式设备发送敏感信息和材料。 如果这些内容泄漏或者被进一步分配给未授权的用户，则比较容易识 别泄漏源。系统可用于医学、金融和其它敏感信息例如急救信息的验 证。使用这种双向验证（提供商和客户验证）可更容易地和安全地利 用各种高价值的网络服务，例如早释放窗口内容发布，高分辨率内容</p>
    <p>发布，安全e-Bay交易、安全金融交易、安全对等交易、安全电子邮 件通信等等。</p>
    <p>本领域技术人员应理解，文中结合公开的实施例说明的各种示例性逻辑程序块、模块、电路和算法步骤可经常实现为电子硬件、计算 机软件或它们的组合。为了清楚地示出硬件和软件的此可互换性，程 序块、模块、电路和步骤在上文已经大致说明了它们的功能。这种功 能被实现为硬件还是软件依赖于具体应用和在整个系统的设计约束。 技术人员可针对每个具体应用以多种方式实现所述功能，但是这种实 现决定不应被理解为背离本发明的范围。另外，模块、程序块或步骤 内的功能分组是为了易于说明。特定功能或步骤可被从一个模块或程 序块中去除而不会背离本发明。</p>
    <p>结合文中公开的实施例说明的各种示例性逻辑程序块和模块可</p>
    <p>用设计成执行文中所述功能的通用处理器、数字信号处理器（DSP)、 专用集成电路（ASIC)、现场可编程门阵列（FPGA)或其它可编程 逻辑设备、离散门或晶体管逻辑、分离硬件&#32068;件或它们的任何组合实 现或执行。通用处理器可以是微处理器，但是在可选实施例中，处理 器可以是任何处理器、控制器、微控制器或状态机。处理器还可被实 现为计算设备的组合，例如DSP和微处理器的组合、多个微处理器、 联合DSP核的一个或多个微处理器或任何其它的这种配置。</p>
    <p>结合文中公开的实施例说明的方法或算法的步骤可直接用硬件， 处理器可执行的&#36575;件模块或二者的组合体现。软件模块可位于RAM 存储器、闪速存储器、ROM存储器、EPROM存储器、EEPROM存 储器、寄存器、硬盘、可换式磁盘、CD-ROM或任何其它形式的存 储介质。示例性存储介质可耦合到处理器，从而处理器可从该存储介 质读信息并且向其写信息。在可选情况下，存储介质可集成在处理器 内。处理器和存储介质可位于ASIC内。</p>
    <p>各种实施例还可使用例如组件、如专用集成电路（ASIC)或现 场可编程门阵列（FPGA)主要用硬件实现。能够执行文中所述功能 的硬件状态机的实现对于本领域技术人员来说也是显而易见的。各种 实施例还可使用硬件和软件的组合实现。</p>
    <p>公开实施例的上述说明使得任何本领域技术人员可实现或使用 本发明。对这些实施例的各种修改对于本领域技术人员是显而易见的，并且文中所述的基本原理可应用其它实施例而不会背离本发明的 精神或范围。因此，应理解，文中的说明和附图代表本发明的优选实 施例，因此代表本发明概述的主旨。还应理解，本发明的范围完全包 含对于本领域技术人员明显的其它实施例，并且本发明的范围因此仅 被所附权利要求限定。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101958889A?cl=zh">CN101958889A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年6月28日</td><td class="patent-data-table-td patent-date-value">2011年1月26日</td><td class="patent-data-table-td ">株式会社日立制作所</td><td class="patent-data-table-td ">信息处理方法以及信息处理系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101958889B?cl=zh">CN101958889B</a></td><td class="patent-data-table-td patent-date-value">2010年6月28日</td><td class="patent-data-table-td patent-date-value">2013年11月20日</td><td class="patent-data-table-td ">株式会社日立制作所</td><td class="patent-data-table-td ">信息处理方法以及信息处理系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102025503A?cl=zh">CN102025503A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年11月4日</td><td class="patent-data-table-td patent-date-value">2011年4月20日</td><td class="patent-data-table-td ">北京曙光天演信息技术有限公司</td><td class="patent-data-table-td ">一种集群环境下数据安全实现方法和一种高安全性的集群</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102025503B?cl=zh">CN102025503B</a></td><td class="patent-data-table-td patent-date-value">2010年11月4日</td><td class="patent-data-table-td patent-date-value">2014年4月16日</td><td class="patent-data-table-td ">曙光云计算技术有限公司</td><td class="patent-data-table-td ">一种集群环境下数据安全实现方法和一种高安全性的集群</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102316078A?cl=zh">CN102316078A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年6月30日</td><td class="patent-data-table-td patent-date-value">2012年1月11日</td><td class="patent-data-table-td ">中华电信股份有限公司</td><td class="patent-data-table-td ">验证登录方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102648618A?cl=zh">CN102648618A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年10月26日</td><td class="patent-data-table-td patent-date-value">2012年8月22日</td><td class="patent-data-table-td ">阿尔卡特朗讯</td><td class="patent-data-table-td ">用于电信网络、中心局以及网络终止单元的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102656576A?cl=zh">CN102656576A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年12月3日</td><td class="patent-data-table-td patent-date-value">2012年9月5日</td><td class="patent-data-table-td ">阿尔特拉公司</td><td class="patent-data-table-td ">防止出现故障时可编程芯片上部件之间的信息泄漏</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102656576B?cl=zh">CN102656576B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年12月3日</td><td class="patent-data-table-td patent-date-value">2015年11月25日</td><td class="patent-data-table-td ">阿尔特拉公司</td><td class="patent-data-table-td ">防止出现故障时可编程芯片上部件之间的信息泄漏</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102932171A?cl=zh">CN102932171A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年10月22日</td><td class="patent-data-table-td patent-date-value">2013年2月13日</td><td class="patent-data-table-td ">烽火通信科技股份有限公司</td><td class="patent-data-table-td ">基于License资源控制ONU认证授权管理的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102932171B?cl=zh">CN102932171B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年10月22日</td><td class="patent-data-table-td patent-date-value">2015年7月1日</td><td class="patent-data-table-td ">烽火通信科技股份有限公司</td><td class="patent-data-table-td ">基于License资源控制ONU认证授权管理的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102932492A?cl=zh">CN102932492A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年9月12日</td><td class="patent-data-table-td patent-date-value">2013年2月13日</td><td class="patent-data-table-td ">微软公司</td><td class="patent-data-table-td ">用户与ip地址租用事件的关联</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103039039B?cl=zh">CN103039039B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年7月8日</td><td class="patent-data-table-td patent-date-value">2016年1月20日</td><td class="patent-data-table-td ">西门子公司</td><td class="patent-data-table-td ">用于将设备集成在网络中的方法和装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103430183A?cl=zh">CN103430183A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年10月11日</td><td class="patent-data-table-td patent-date-value">2013年12月4日</td><td class="patent-data-table-td ">思飞信智能电网公司</td><td class="patent-data-table-td ">用于公用事业应用的物理安全授权</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103430183B?cl=zh">CN103430183B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年10月11日</td><td class="patent-data-table-td patent-date-value">2016年4月20日</td><td class="patent-data-table-td ">思飞信智能电网公司</td><td class="patent-data-table-td ">用于公用事业应用的物理安全授权</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=wNlqBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=G06F0011000000">G06F11/00</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2009年6月24日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2009年8月19日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2011年8月10日</td><td class="patent-data-table-td ">C02</td><td class="patent-data-table-td ">Deemed withdrawal of patent application after publication (patent law 2001)</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/17d817b3d7d07a0127ac/CN101467131A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E7%BD%91%E7%BB%9C%E7%94%A8%E6%88%B7%E9%AA%8C%E8%AF%81%E7%B3%BB%E7%BB%9F%E5%92%8C%E6%96%B9%E6%B3%95.pdf?id=wNlqBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U0LVuwE6EwJvQ4NJ5OTb9EYiiy-xA"},"sample_url":"https://www.google.com/patents/reader?id=wNlqBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>