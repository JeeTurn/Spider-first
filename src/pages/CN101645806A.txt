<!DOCTYPE html><html><head><title>专利 CN101645806A - Dpi和dfi相结合的网络流量分类系统及分类方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_50a6672b5f82ffbd39b7a9e87fd4594c/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_50a6672b5f82ffbd39b7a9e87fd4594c__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="Dpi和dfi相结合的网络流量分类系统及分类方法"><meta name="DC.contributor" content="梁 王" scheme="inventor"><meta name="DC.contributor" content="裴文江" scheme="inventor"><meta name="DC.contributor" content="东南大学" scheme="assignee"><meta name="DC.date" content="2009-9-4" scheme="dateSubmitted"><meta name="DC.description" content="本发明公开了一种DPI和DFI相结合的网络流量分类系统及分类方法，包括DPI业务识别系统和DFI流量识别系统两个模块结合而成；其中DPI模块又包括流表检测模块和流量识别模块；DFI模块包括样本获取模块，分类器训练模块和分类器分类预测模块。样本获取模块将DPI中的流量识别模块能够准确识别的数据流划分成几个大类，并且将其作为样本对分类器训练模块进行训练，获得能对网络流量进行大类区分的分类模型，然后DPI的流量识别模块无法识别的流量再通过DFI的分类器分类预测模块就能达到对DPI无法识别的流量进行大类区分的目的。本发明比单纯地使用DPI或者DFI更全面，能够对应用层没有加密的业务进行精确地识别，也能够对应用层加密的业务进行大类的区分。"><meta name="DC.date" content="2010-2-10"><meta name="citation_patent_publication_number" content="CN:101645806:A"><meta name="citation_patent_application_number" content="CN:200910034643"><link rel="canonical" href="https://www.google.com/patents/CN101645806A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101645806A?cl=zh"/><meta name="title" content="专利 CN101645806A - Dpi和dfi相结合的网络流量分类系统及分类方法"/><meta name="description" content="本发明公开了一种DPI和DFI相结合的网络流量分类系统及分类方法，包括DPI业务识别系统和DFI流量识别系统两个模块结合而成；其中DPI模块又包括流表检测模块和流量识别模块；DFI模块包括样本获取模块，分类器训练模块和分类器分类预测模块。样本获取模块将DPI中的流量识别模块能够准确识别的数据流划分成几个大类，并且将其作为样本对分类器训练模块进行训练，获得能对网络流量进行大类区分的分类模型，然后DPI的流量识别模块无法识别的流量再通过DFI的分类器分类预测模块就能达到对DPI无法识别的流量进行大类区分的目的。本发明比单纯地使用DPI或者DFI更全面，能够对应用层没有加密的业务进行精确地识别，也能够对应用层加密的业务进行大类的区分。"/><meta property="og:title" content="专利 CN101645806A - Dpi和dfi相结合的网络流量分类系统及分类方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101645806A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101645806A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=0Bt3BwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101645806A&amp;usg=AFQjCNGek9rdxUt-7CKUY08iEXsbg2CoLw" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/fb44e8eb905970661829/CN101645806A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/fb44e8eb905970661829/CN101645806A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101645806A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101645806A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN101645806A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN101645806B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101645806A?cl=zh" style="display:none"><span itemprop="description">本发明公开了一种DPI和DFI相结合的网络流量分类系统及分类方法，包括DPI业务识别系统和DFI流量识别系统两个模块结合而成；其中DPI模块又包括流表检测模块和流量识别模块；DFI模块包括样本获取模块，分类器训练模块和分类器...</span><span itemprop="url">https://www.google.com/patents/CN101645806A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101645806A - Dpi和dfi相结合的网络流量分类系统及分类方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101645806A - Dpi和dfi相结合的网络流量分类系统及分类方法" title="专利 CN101645806A - Dpi和dfi相结合的网络流量分类系统及分类方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101645806 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200910034643</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2010年2月10日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2009年9月4日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2009年9月4日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101645806B?hl=zh-CN&amp;cl=zh">CN101645806B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200910034643.7, </span><span class="patent-bibdata-value">CN 101645806 A, </span><span class="patent-bibdata-value">CN 101645806A, </span><span class="patent-bibdata-value">CN 200910034643, </span><span class="patent-bibdata-value">CN-A-101645806, </span><span class="patent-bibdata-value">CN101645806 A, </span><span class="patent-bibdata-value">CN101645806A, </span><span class="patent-bibdata-value">CN200910034643, </span><span class="patent-bibdata-value">CN200910034643.7</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%A2%81+%E7%8E%8B%22">梁 王</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E8%A3%B4%E6%96%87%E6%B1%9F%22">裴文江</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%22">东南大学</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101645806A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101645806A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101645806A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (12),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (1),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (4)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=0Bt3BwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200910034643&amp;usg=AFQjCNFRwJF8dGViudDtj3dug9nGGAaizA"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=0Bt3BwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101645806A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNGOOCYXjx72DX4MCGu0z4WUjXMOYw"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT92705820" lang="ZH" load-source="patent-office">Dpi和dfi相结合的网络流量分类系统及分类方法</invention-title>
    </span><br><span class="patent-number">CN 101645806 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA73829259" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明公开了一种DPI和DFI相结合的网络流量分类系统及分类方法，包括DPI业务识别系统和DFI流量识别系统两个模块结合而成；其中DPI模块又包括流表检测模块和流量识别模块；DFI模块包括样本获取模块，分类器训练模块和分类器分类预测模块。样本获取模块将DPI中的流量识别模块能够准确识别的数据流划分成几个大类，并且将其作为样本对分类器训练模块进行训练，获得能对网络流量进行大类区分的分类模型，然后DPI的流量识别模块无法识别的流量再通过DFI的分类器分类预测模块就能达到对DPI无法识别的流量进行大类区分的目的。本发明比单纯地使用DPI或者DFI更全面，能够对应用层没有加密的业务进行精确地识别，也能够对应用层加密的业务进行大类的区分。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(2)</span></span></div><div class="patent-text"><div mxw-id="PCLM29195137" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1、DPI和DFI相结合的网络流量分类系统，其特征在于：包括DPI业务识别系统和DFI流量识别系统两个模块结合而成；    所述的DPI业务识别系统中，包括：    A.流表检测模块，判断当前的数据流是否为已经标记类型的数据流；    B.数据流特征库，存储数据流的特征；    C.流量识别模块，根据数据流特征库中的特征识别网络流量代表的不同业务；    D.协议处理模块，用于对具体业务的处理，以及对网络大类的处理；    所述的DFI流量识别系统中，包括：    E.样本获取模块，用于将DPI能够精确识别的业务的流特征提取出来，分成不同的类别，作为分类器训练模块的训练样本；    F.分类器训练模块，对样本获取模块提供的样本进行训练获得一个训练模型；    G.分类器分类预测模块，根据分类器训练模块获得的模型对其他数据进行分类。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2、 一种基于权利要求1所述的DPI和DFI相结合的网络流量分类系统的网络流量分类方法，包括以下步骤：(a) 数据流先经过DPI业务识别系统中的流表检测模块，流表检测模块检测当前 数据流是否在流表检测模块维护的状态表中，当该数据流在状态表中，则流表检测模块 直接将当前数据流标记以后，发送至协议处理模块；当该数据流不在状态表中，则流标 检测模块将该数据流发送至流量识别模块，进入（b)步骤；(b) 流量识别模块检查该数据流是否含有DPI业务识别系统中的数据流特征库中 的任意一条特征；当流量识别模块在数据流特征库中识别到与该数据流有匹配的流量特 征，则标记当前报文对应的该数据流为特定的数据流，更新流表检测模块中维护的状态 表，同时将当前数据流标记以后发送至协议处理模块；当流量识别模块在数据流特征库 中没有识别到与该数据流匹配的流量特征，则将该数据流发送至DFI流量识别系统，进 入（c)步骤；(c) 流量识别模块将能够识别的数据流发送至DFI流量识别系统中的样本获取模 块，样本获取模块在线获得该数据流的样本文件以后，将该样本文件发送至分类器训练模块进行离线训练，获得分类模型，分类器训练模块将此分类模型发送至分类器分类预 测模块；分类器分类预测模块根据训练得到的分类模型对（b)步骤中流量识别模块无 法识别的数据流进行分类；(d)分类器分类预测模块将分好类的数据流做好相应标记发送至协议处理模块，协 议处理模块根据以上步骤中对数据流的不同标记，分别进行具体业务或者针对不同大类 的处理。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES35660977" lang="ZH" load-source="patent-office" class="description">
    <p>DPI和DFI相结合的网络流量分类系统及分类方法</p>
    <p>技术领域</p>
    <p>本发明涉及DPI和DFI相结合的网络流量分类系统及分类方法，属于网络数据传 输领域。</p>
    <p>背景技术</p>
    <p>随着网络应用层出不穷，P2P、网络游戏、IPTV、 WEBTV等新兴业务，占用了互联网 大部分带宽，以BT和Edonkey为代表的P2P应用己经占据了整个互联网流量的2/3以 上，运营商的基础网络建设陷入了 "拥塞-扩容-再拥塞"的非正常局面，盈利能力相应 降低。无法实现业务识别增加了运营商的运营成本，降低了客户的满意度。于是，如何 深度感知网络应用，提供网络业务控制和管理手段，构建可以运营、可以管理的和谐网 络，对P2P有效限制，合理引导，化不利为我所用，己经成为电信运营商目前亟需研究 的一个热门课题。</p>
    <p>基于以上原因，必须通过技术手段识别出不同的网络数据流量，从而可以对其进行 控制和管理。</p>
    <p>目前识别网络数据流业务的方法主要有以下几种：</p>
    <p>(1) 基于端口的网络数据流业务识别技术：这种识别技术是通过各种不同的应用在 IANA(Internet Assigned Numbers Authority)中注册的不同端口号来进行识别的。例 如检测到端口号为80时，则认为该应用代表着普通上网应用。而当前网络上的一些非 法应用会采用隐藏或假冒端口号的方式躲避检测和监管，造成仿冒合法报文的数据流侵 蚀着网络。比如新型的P2P协议所使用的端口是变化的，因此端口号识别的准确率已经 越来越低，该方法已经越来越不适合对现有网络数据流业务的识别。</p>
    <p>(2) DPI (De印Packet Inspection)深度包检测网络数据流业务识别技术：当碰到 某些使用动态端口的新型的协议时，采用基于端口的识别技术就会无能为力。DPI技术 除了对4层以下的基础信息进行分析外，还增加了应用层分析，识别各种应用及其内容。 就是通过对一系列数据包的应用层负载特征进行分析，找出其应用层的特征字，从而对各种业务进行识别。这种方法在遇到应用层数据加密的时候处理起来就会非常困难。</p>
    <p>(3)DFI (De印Flow Inspection)深度流检测网络数据流业务识别技术：当DPI 识别技术遇到应用层数据加密的时候，就很难通过分析应用层数据的特征来对其进行识 别。DFI技术是根据流的特征来对业务进行识别的技术，即不同的应用类型体现在会话 连接或数据流上的状态各有不同。DFI的特点是对整个数据流的特征进行分析，例如每 个流的平均包长，每个包到达的时间间隔等。无须对应用层数据进行检测，因而应用层 数据加密与否对这种识别技术来讲没有区别。属于同种类型业务的数据流的特征一般都 是非常接近的，例如QQ和MSN这两种IM软件的流量特征可能就非常接近，因此这种方 法的缺点是只能对网络流量的几个大类进行区分。例如IM， P2P，WEB等。</p>
    <p>发明内容</p>
    <p>发明目的：</p>
    <p>本发明要解决的技术问题在于，针对基于端口识别技术的准确率低，DPI和DFI技 术分别存在对应用层数据加密的业务的识别非常困难，以及只能对网络流量进行大类区 分的缺陷，提出了将DPI和DFI相结合的网络流量分类系统及分类方法。</p>
    <p>技术方案-</p>
    <p>本发明解决其技术问题所采用的技术方案是：先对网络流量进行大类的区分，然后 构造DPI网络数据流业务识别系统，对应用层没有加密的业务进行应用层特征提取，将</p>
    <p>提取到的特征放入特征库中，然后以DPI能够识别的协议的数据流作为DFI业务识别模 块的样本，对DFI进行训练，训练完成以后将DFI模块加在DPI业务识别系统后面，让 DPI无法识别的数据流再经过DFI模块的识别，从而对DPI无法识别的数据流进行大类 的区分。具体技术方案如下：</p>
    <p>本发明的DPI和DFI相结合的网络流量分类系统，包括DPI业务识别系统和DFI流 量识别系统两个模块结合而成；</p>
    <p>所述的DPI业务识别系统中，包括：</p>
    <p>A. 流表检测模块，判断当前的数据流是否为已经标记类型的数据流；</p>
    <p>B. 数据流特征库，存储数据流的特征；</p>
    <p>C. 流量识别模块，根据数据流特征库中的特征识别网络流量代表的不同业务；D. 协议处理模块，用于对具体业务的处理，以及对网络大类的处理； 所述的DFI流量识别系统中，包括：</p>
    <p>E. 样本获取模块，用于将DPI能够精确识别的业务的流特征提取出来，分成不同的 类别，作为分类器训练模块的训练样本；</p>
    <p>F. 分类器训练模块，对样本获取模块提供的样本进行训练获得一个训练模型；</p>
    <p>G. 分类器分类预测模块，根据分类器训练模块获得的模型对其他数据进行分类； 本发明还提供一种基于本发明的网络流量分类方法，包括以下步骤：</p>
    <p>(a) 数据流先经过DPI业务识别系统中的流表检测模块，流表检测模块检测当前 数据流是否在流表检测模块维护的状态表中，当该数据流在状态表中，则流表检测模块 直接将当前数据流标记以后，发送至协议处理模块；当该数据流不在状态表中，则流标 检测模块将该数据流发送至流量识别模块，进入（b)步骤；</p>
    <p>(b) 流量识别模块检&#26619;该数据流是否含有DPI业务识别系统中的数据流特征库中 的任意一条特征；当流量识别模块在数据流特征库中识别到与该数据流有匹配的流量特 征，则标记当前报文对应的该数据流为特定的数据流，更新流表检测模块中维护的状态 表，同时将当前数据流标记以后发送至协议处理模块；当流量识别模块在数据流特征库 中没有识别到与该数据流匹配的流量特征，则将该数据流发送至DFI流量识别系统，进 入（c)步骤；</p>
    <p>(c) 流量识别模块将能够识别的数据流发送至DFI流量识别系统中的样本获取模 块，样本获取模块在线获得该数据流的样本文件以后，将该样本文件发送至分类器训练 模块进行离线训练，获得分类模型，分类器训练模块将此分类模型发送至分类器分类预 测模块；分类器分类预测模块根据训练得到的分类模型对（b)步骤中流量识别模块无 法识别的数据流进行分类；</p>
    <p>(d) 分类器分类预测模块将分好类的数据流做好相应标记发送至协议处理模块，协 议处理模块根据以上步骤中对数据流的不同标记，分别进行具体业务或者针对不同大类 的处理。</p>
    <p>在本发明所述的DPI业务识别系统中，所述数据流特征库，包括网络流量各个大类 中的部分业务的应用层特征。例如：属于即时消息这一大类的业务有QQ和百度HI等，QQ的应用层特征为数据包以0x02开始，以0x03结束，百度HI的应用层特征为前八个 字节为0x0000010031564d49。属于P2P这一大类的业务有TTlive和Sopcast等，TTlive 的应用层特征为每个流的第一个包的净载荷长度为52字节，前三个字节为OxffffOl, 最后两个字节为0x0002， Sopcast的应用层特征为第一个有净载荷的数据包的特征字用 正则表达式表示为：'DESCRIBE. *User-Agent:WMPlayer。</p>
    <p>有益效果</p>
    <p>本发明的DPI和DFI相结合的网络流量分类系统及方法，先对网络数据进行DPI 识别，DPI无法识别的数据流再进过DFI进行分类，增加了对网络流量进行分类的准确 性。</p>
    <p>附图说明</p>
    <p>图1是DPI识别模块的结构框图； 图2是DFI识别模块的结构框图；</p>
    <p>图3是本发明DPI和DFI相结合的网络流量分类方法的框图； 图4是本发明DPI和DFI相结合的网络流量分类方法的流程图。</p>
    <p>具体实施方式</p>
    <p>下面结合附图对本发明进行进一步详细的说明。 .</p>
    <p>如图1所示，在本发明的DPI和DFI相结合的网络流量分类系统的第一实施步骤中， 网络流量识别系统连接到基于TCP/IP协议的网络中，其中有一个流表检测模块， 一个 协议处理模块， 一个流量识别模块以及一个数据流特征库。</p>
    <p>数据流特征库中包含有分别属于几个网络流量大类的各种不同的业务。举例如下：</p>
    <p>(1) 属于IM (即时通讯）这一大类的有QQ和百度HI等，QQ的应用层特征为数据 包以0x02开始，以0x03结束，百度HI的应用层特征为前八个字节为 0x0000010031564d49。</p>
    <p>(2) 属于P2P这一大类的业务有TTlive和Sopcast等，TTlive的应用层特征为 每个流的第一个包的净载荷长度为52字节，前三个字节为0xffff01，最后两个字节为0x0002， Sopcast的应用层特征为第一个有净载荷的数据包的特征字用正则表达式表示 为：'DESCRIBE. *User-Agent:WMPlayer。</p>
    <p>数据流特征库中存储有上述各类业务的特征。</p>
    <p>流表检测模块维护一张状态表，表中信息包括数据流的五元组（源ip地址，目的 ip地址，源端口，目的端口，协议号）以及所属协议类型的ID，网络数据流进入以后 首先将自己的五元组与状态表中的信息比对，&#26619;看是否在该状态表中，若在该状态表中 则将其用所属协议类型的ID标注后送入协议处理模块。</p>
    <p>例如状态表中维护的一条信息格式如下表第二行</p>
    <p>源ip地址	目的ip地址	源端口	目的端口	协议类型	协议ID</p>
    <p>119.147.18.47	10.8.7,43	8000	4000	0x11	5</p>
    <p>其中119. 147. 18. 47是源ip地址，10. 8. 7. 43是目的ip地址，8000是源端口 ， 4000 是目的端口， 0x11是协议号（UDP协议），5是可以自己定义的协议ID，比如我们把QQ 的协议ID定为5，那么5就代表QQ的数据流。 一旦有新数据流进入流表检测模块，首 先将自己的五元组与表中的信息的前五项（五元组）进行比对，如果发现状态表中存在 有自己的五元组，则将该数据流用协议ID进行标注后送入协议处理模块，若在状态表 中没有发现与自己五元组匹配的记录则进入流量识别模块。</p>
    <p>流量识别模块先对网络数据流应用层数据进行分析，并将其应用层特征与数据流特 征库中的特征进行比对，若应用层数据的特征字符串符合数据流特征库中的一个或者多 个特征，则流量识别模块将其标记为对应的协议ID，并且将该流量更新到流表检测模 块，若在数据流特征库中不存在与其特征字符串匹配的特征，则数据流量识别模块不对 其进行标记，而是将其送入DFI识别模块，由DFI识别模块对其进行进一步识别。</p>
    <p>数据流特征库中存放有事先已经识别的业务的应用层特征字，比如bitspirit的应 用层前20个字节恒为0xl3426974546f7272656e742070726f746f636f6c ， PP点点通下 载文件时应用层前5个字节恒为0x3c00000001。流量识别模块就是通过与库中特征比 对来判断数据流是否能够识别以及属于何种协议。</p>
    <p>如图2所示，是DPI和DFI相结合的网络流量分类系统中的DFI部分的结构框图， 其中主要有样本获取模块，分类器训练模块，和分类器分类预测模块，样本获取模块将 图1中的流量识别模块能够准确识别的数据流作为样本，将其归入之前分好的几个网络流量的大类中，并从中提取出所需要的流特征，比如QQ是流量识别模块能够准确识别</p>
    <p>的，并且QQ属于IM (即时通讯）这一大类，那么每个QQ网络数据流都可以作为一个 IM这一大类的样本。同样我们也能对百度HI进行准确识别，并且百度HI也属于IM这 一大类，那么每个百度HI网络数据流也可以作为一个IM这一大类的样本。获得样本后 我们计算出每个样本的流特征，比如该流的平均包长，包的平均时间间隔等，并对这个 样本进行标记以确定其所属的大类。采用同样的方法我们可以通过对TTlive和Sopcast 网络数据流提取出P2P这一个大类的样本，以及其他几个大类的样本，将所有这些样本 集中在一起我们就可以获得一个样本文件。其文件格式如下表：</p>
    <p>所属大类ID 特征索引	特征值            特征索引 特征值 ...........	1 1	:         &#35698; 2	0.005 ..........</p>
    <p>2 1	:         450 2	0.03 ..........</p>
    <p>1 1	:         950 2	0.006 ..........</p>
    <p>3 1	:         100 2	0.07 ..........</p>
    <p>该文件中每一行都代表一个样本，每列的第一个字符表示该行样本所属的大类，例</p>
    <p>如我们把P2P这一大类用1这个ID表示，把IM (即时通讯）这一大类用2表示，把WEB 应用这一大类用3表示，那么这个文件的第一行和第三行表示是P2P的样本数据，第二 行表示是IM (即时通讯）的样本数据，第四行表示是WEB应用的样本数据。文件每一 行的大类ID后面是特征索引和该特征的值，例如我们把流的平均包长这一流特征用1 索引，把包到达的平均时间间隔用2索引，那么代表第一行就表明这一样本数据的平均 包长为1000，包到达的平均时间间隔为0.005。每个流的特征肯定不止两项，其他特征 这里不再列出。样本获取模块的作用就是从流量识别模块能够准确识别的数据流中提取 其流特征，将该特征以样本文件的形式保存。</p>
    <p>分类器训练模块通过对样本获取模块获取的样本的训练获得一个预测模型。 分类器分类预测模块通过预测模型对流量识别模块无法识别的流量进行分类。 图3是DPI识别模块和DFI识别模块的结合，可以将其分成在线和离线两个大类， 流表检测模块，协议处理模块，流量识别模块，数据流特征库，样本获取模块，分类器 分类预测模块是在线的，分类器训练模块是离线的。在进行在线的分类之前，需要先进 行样本获取和分类器训练生成一个分类模型的过程，这时候流量识别模块将能够准确识别的数据流直接送入样本获取模块。</p>
    <p>样本获取模块在线获得样本文件以后可以对分类器进行离线训练，获得分类模型，</p>
    <p>当DPI系统中的流量识别模块无法识别时，再经过DFI系统的分类器分类预测模块，分</p>
    <p>类器分类预测模块根据训练得到的分类模型对流量识别模块无法识别数据流进行分类。 图4是本发明DPI和DFI相结合的网络流量分类方法的流程图。 该流程图是在线分类时网络数据的处理过程，其前提是分类器已经训练完成并且获</p>
    <p>得了分类模型。</p>
    <p>首先，在网络流量到达时，首先到达流表检测模块，根据报文中的报头检测当前 报文是否已经标记。若当前报文对应数据流的类型已经标记，则使用与类型对应的方式 处理当前数据流。若当前报文对应数据流的类型没有标记，则进入流量识别模块进行识 别判断，流量识别模块识别的依据就是图1中的数据流特征库，若流量识别模块能够识 别则更新流表检测模块，以便使属于同一流量的报文在流表检测时就能检测出来。若流 量识别模块无法识别，则进入分类器分类预测模块，分类器分类预测模块根据DFI离线 训练得到的分类模型对无法识别的流量进行分类。由于所有网络数据流量必然属于几个 大类中的一类，所以在这里所有DPI的流量识别模块无法识别的流量都被按大类进行了 分类。分类完成以后送入协议处理模块，协议处理模块根据类别的不同分别进行处理。 这里的协议处理模块包含两大处理对象， 一个是对具体业务的处理，另外一个是对网络 大类的处理。</p>
    <p>通过上述方式处理网络流量，比单纯地使用DPI或者DFI来得全面，它能够对应用 层没有加密的业务进行精确地识别，也能够对应用层加密的业务进行大类的区分。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101814977A?cl=zh">CN101814977A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年4月22日</td><td class="patent-data-table-td patent-date-value">2010年8月25日</td><td class="patent-data-table-td ">北京邮电大学</td><td class="patent-data-table-td ">利用数据流头部特征的tcp流量在线识别方法及装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101814977B?cl=zh">CN101814977B</a></td><td class="patent-data-table-td patent-date-value">2010年4月22日</td><td class="patent-data-table-td patent-date-value">2012年11月21日</td><td class="patent-data-table-td ">北京邮电大学</td><td class="patent-data-table-td ">利用数据流头部特征的tcp流量在线识别方法及装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102025623A?cl=zh">CN102025623A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年12月7日</td><td class="patent-data-table-td patent-date-value">2011年4月20日</td><td class="patent-data-table-td ">苏州迈科网络安全技术股份有限公司</td><td class="patent-data-table-td ">智能化网络流控方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102025623B?cl=zh">CN102025623B</a></td><td class="patent-data-table-td patent-date-value">2010年12月7日</td><td class="patent-data-table-td patent-date-value">2013年3月20日</td><td class="patent-data-table-td ">苏州迈科网络安全技术股份有限公司</td><td class="patent-data-table-td ">智能化网络流控方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102201982A?cl=zh">CN102201982A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年4月29日</td><td class="patent-data-table-td patent-date-value">2011年9月28日</td><td class="patent-data-table-td ">北京网康科技有限公司</td><td class="patent-data-table-td ">一种应用识别方法及其设备</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102420830A?cl=zh">CN102420830A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年12月15日</td><td class="patent-data-table-td patent-date-value">2012年4月18日</td><td class="patent-data-table-td ">北京大学</td><td class="patent-data-table-td ">一种p2p协议类型识别方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102724317A?cl=zh">CN102724317A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年6月21日</td><td class="patent-data-table-td patent-date-value">2012年10月10日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">一种网络数据流量分类方法和装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102868638A?cl=zh">CN102868638A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年8月16日</td><td class="patent-data-table-td patent-date-value">2013年1月9日</td><td class="patent-data-table-td ">苏州迈科网络安全技术股份有限公司</td><td class="patent-data-table-td ">动态调整带宽方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103582512A?cl=zh">CN103582512A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年2月4日</td><td class="patent-data-table-td patent-date-value">2014年2月12日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">特征提取装置、网络流量识别方法、装置和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8797901">US8797901</a></td><td class="patent-data-table-td patent-date-value">2010年7月14日</td><td class="patent-data-table-td patent-date-value">2014年8月5日</td><td class="patent-data-table-td ">Beijing University of Posts and Telecommunicaions</td><td class="patent-data-table-td ">Method and its devices of network TCP traffic online identification using features in the head of the data flow</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2011130957A1?cl=zh">WO2011130957A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年7月14日</td><td class="patent-data-table-td patent-date-value">2011年10月27日</td><td class="patent-data-table-td ">Beijing University Of Posts And Telecommunications</td><td class="patent-data-table-td ">利用数据流头部特征的tcp流量在线识别方法及装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2014117406A1?cl=zh">WO2014117406A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年2月4日</td><td class="patent-data-table-td patent-date-value">2014年8月7日</td><td class="patent-data-table-td ">Huawei Technologies Co., Ltd.</td><td class="patent-data-table-td ">特征提取装置、网络流量识别方法、装置和系统</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=0Bt3BwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0012260000">H04L12/26</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2010年2月10日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2010年4月14日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2011年9月7日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Grant of patent or utility model</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2015年10月28日</td><td class="patent-data-table-td ">EXPY</td><td class="patent-data-table-td ">Termination of patent right or utility model</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/fb44e8eb905970661829/CN101645806A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_50a6672b5f82ffbd39b7a9e87fd4594c.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/Dpi%E5%92%8Cdfi%E7%9B%B8%E7%BB%93%E5%90%88%E7%9A%84%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F%E5%88%86%E7%B1%BB.pdf?id=0Bt3BwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U2ujkdEhle1X5FUJpQDTjA3AxVOiQ"},"sample_url":"https://www.google.com/patents/reader?id=0Bt3BwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>