<!DOCTYPE html><html><head><title>专利 CN101031113A - 移动终端、数据通信方法以及计算机程序 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="移动终端、数据通信方法以及计算机程序"><meta name="DC.contributor" content="栗田太郎" scheme="inventor"><meta name="DC.contributor" content="竹村俊治" scheme="inventor"><meta name="DC.contributor" content="飞力凯网路股份有限公司" scheme="assignee"><meta name="DC.date" content="2006-11-20" scheme="dateSubmitted"><meta name="DC.description" content="一种移动终端包括：近场通信设备，能够与外部设备进行近场无线通信；和控制器，配置为指示外部设备或近场通信设备执行命令。该近场通信设备具有存储单元；第一相互验证单元，用于验证控制器，并用于请求控制器验证近场通信设备；第一通信密钥设置单元，用于设置第一通信密钥；第二相互验证单元，用于验证外部设备，并用于请求外部设备验证近场通信设备；和第二通信密钥设置单元，用于设置第二通信密钥。该控制器和该近场通信设备使用第一通信密钥执行安全通信，而该近场通信设备和外部设备使用第二通信密钥执行安全通信。"><meta name="DC.date" content="2007-9-5"><meta name="citation_patent_publication_number" content="CN:101031113:A"><meta name="citation_patent_application_number" content="CN:200610064720"><link rel="canonical" href="https://www.google.com/patents/CN101031113A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101031113A?cl=zh"/><meta name="title" content="专利 CN101031113A - 移动终端、数据通信方法以及计算机程序"/><meta name="description" content="一种移动终端包括：近场通信设备，能够与外部设备进行近场无线通信；和控制器，配置为指示外部设备或近场通信设备执行命令。该近场通信设备具有存储单元；第一相互验证单元，用于验证控制器，并用于请求控制器验证近场通信设备；第一通信密钥设置单元，用于设置第一通信密钥；第二相互验证单元，用于验证外部设备，并用于请求外部设备验证近场通信设备；和第二通信密钥设置单元，用于设置第二通信密钥。该控制器和该近场通信设备使用第一通信密钥执行安全通信，而该近场通信设备和外部设备使用第二通信密钥执行安全通信。"/><meta property="og:title" content="专利 CN101031113A - 移动终端、数据通信方法以及计算机程序"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101031113A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101031113A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101031113A&amp;usg=AFQjCNFeiNsuT8d3guEQIsEN60Nn3f8Mzg" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/42de416a42756b0b71ea/CN101031113A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/42de416a42756b0b71ea/CN101031113A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101031113A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101031113A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN101031113A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN101031113B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101031113A?cl=zh" style="display:none"><span itemprop="description">一种移动终端包括：近场通信设备，能够与外部设备进行近场无线通信；和控制器，配置为指示外部设备或近场通信设备执行命令。该近场通信设备具有存储单元；第一相互验证单元，用于验证控制器，并用于请求控制器验证近...</span><span itemprop="url">https://www.google.com/patents/CN101031113A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101031113A - 移动终端、数据通信方法以及计算机程序</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101031113A - 移动终端、数据通信方法以及计算机程序" title="专利 CN101031113A - 移动终端、数据通信方法以及计算机程序"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101031113 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200610064720</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2007年9月5日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2006年11月20日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2005年11月18日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101031113B?hl=zh-CN&amp;cl=zh">CN101031113B</a>, </span><span class="patent-bibdata-value"><a href="/patents/US7797537?hl=zh-CN&amp;cl=zh">US7797537</a>, </span><span class="patent-bibdata-value"><a href="/patents/US8832441?hl=zh-CN&amp;cl=zh">US8832441</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20070116292?hl=zh-CN&amp;cl=zh">US20070116292</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20100325713?hl=zh-CN&amp;cl=zh">US20100325713</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200610064720.X, </span><span class="patent-bibdata-value">CN 101031113 A, </span><span class="patent-bibdata-value">CN 101031113A, </span><span class="patent-bibdata-value">CN 200610064720, </span><span class="patent-bibdata-value">CN-A-101031113, </span><span class="patent-bibdata-value">CN101031113 A, </span><span class="patent-bibdata-value">CN101031113A, </span><span class="patent-bibdata-value">CN200610064720, </span><span class="patent-bibdata-value">CN200610064720.X</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%A0%97%E7%94%B0%E5%A4%AA%E9%83%8E%22">栗田太郎</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%AB%B9%E6%9D%91%E4%BF%8A%E6%B2%BB%22">竹村俊治</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E9%A3%9E%E5%8A%9B%E5%87%AF%E7%BD%91%E8%B7%AF%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">飞力凯网路股份有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101031113A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101031113A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101031113A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (8),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (17),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200610064720&amp;usg=AFQjCNEzf11i9bI9c2EOCa0IeDg9M9O-qw"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101031113A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNH9MByWEm7mQ5V0VsWqsakXiVQu-Q"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT121947232" lang="ZH" load-source="patent-office">移动终端、数据通信方法以及计算机程序</invention-title>
      </span><br><span class="patent-number">CN 101031113 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA108180883" lang="ZH" load-source="patent-office">
    <div class="abstract">一种移动终端包括：近场通信设备，能够与外部设备进行近场无线通信；和控制器，配置为指示外部设备或近场通信设备执行命令。该近场通信设备具有存储单元；第一相互验证单元，用于验证控制器，并用于请求控制器验证近场通信设备；第一通信密钥设置单元，用于设置第一通信密钥；第二相互验证单元，用于验证外部设备，并用于请求外部设备验证近场通信设备；和第二通信密钥设置单元，用于设置第二通信密钥。该控制器和该近场通信设备使用第一通信密钥执行安全通信，而该近场通信设备和外部设备使用第二通信密钥执行安全通信。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(7)</span></span></div><div class="patent-text"><div mxw-id="PCLM50768422" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.一种移动终端，包括：近场通信设备，能够执行与外部设备的近场无线通信；以及控制器，配置用于指示外部设备或近场通信设备执行命令，其中，近场通信设备具有：存储单元，其中分配有控制器验证密钥存储区域和外部设备访问密钥存储区域，其中，该控制器验证密钥存储区域用于存储与控制器相互验证所使用的控制器验证密钥，该外部设备访问密钥存储区域用于存储访问外部设备所使用的外部设备访问密钥，第一相互验证单元，用于响应于控制器给出的验证请求而基于控制器验证密钥来验证控制器是有效的，并且用于请求控制器验证近场通信设备是有效的，第一通信密钥设置单元，用于基于第一相互验证单元执行的验证操作结果来设置在控制器和近场通信设备之间使用的第一通信密钥，第二相互验证单元，用于响应于控制器给出的用于在近场通信设备和外部设备之间应用的相互验证请求，基于外部设备访问密钥来验证该外部设备是有效的，并且用于请求外部设备来验证该近场通信设备是有效的，和第二通信密钥设置单元，用于基于第二相互验证单元执行的验证结果来设置在近场通信设备和外部设备之间使用第二通信密钥，以及其中，已经相互验证的控制器和近场通信设备使用第一通信密钥执行安全通信，而已经相互验证的近场通信设备和外部设备使用第二通信密钥执行安全通信。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.根据权利要求1的移动终端，其中在近场通信设备内包括的存储单元中进一步分配用于存储价值信息的价值信息存储区域，并且该存储在价值信息存储区域中的价值信息可以利用第一通信密钥来访问。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.根据权利要求1的移动终端，其中，代替通过所述第一和第二相互验证单元执行相互验证，该相互验证是在控制器和外部设备之间执行的，而所述安全通信是在控制器和外部设备之间执行的。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.根据权利要求1的移动终端，其中，所述近场通信设备在从控制器接收到预定的数据时用第一通信密钥解密该数据，处理该已解密的数据，用第二通信密钥加密已处理的数据，并传送已加密数据到外部设备。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.根据权利要求1的移动终端，其中，安全通信是是否可在控制器和外部设备之间、在控制器和近场通信设备之间、或者在近场通信设备和外部设备之间执行是基于在近场通信设备上执行的相互验证完成的状态来确定的。</div>
    </div>
    </div> <div class="claim"> <div num="6" class="claim">
      <div class="claim-text">6.一种用于移动终端的数据通信的方法，其中，该移动终端具有能够与外部设备执行近场无线通信的近场通信设备和配置为指示外部设备或近场通信设备执行命令的控制器，该方法包括：在近场通信设备内包括的存储单元中分配控制器验证密钥存储区域和外部设备访问密钥存储区域的步骤，其中该控制器验证密钥存储区域用于存储与控制器相互验证所使用的控制器验证密钥，该外部设备访问密钥存储区域用于存储访问外部设备所使用的外部设备访问密钥；第一相互验证步骤，响应于控制器给出的相互验证请求而基于控制器验证密钥来验证控制器是有效的，并请求控制器验证近场通信设备是有效的；第一通信密钥设置步骤，基于在第一相互验证步骤执行的验证操作的结果来设置在控制器和近场通信设备之间使用的第一通信密钥；第二相互验证步骤，响应于控制器给出的应用于近场通信设备和外部设备之间的相互验证请求而基于外部设备访问密钥来验证外部设备是有效的，并请求外部设备来验证近场通信设备是有效的；和第二通信密钥设置步骤，基于在第二相互验证步骤执行的验证操作的结果来设置在近场通信设备和外部设备之间使用的第二通信密钥，以及其中已经相互验证的控制器和近场通信设备使用第一通信密钥来执行安全通信，而已经相互验证的近场通信设备和外部设备使用第二通信密钥执行安全通信。</div>
    </div>
    </div> <div class="claim"> <div num="7" class="claim">
      <div class="claim-text">7.一种促使移动终端执行数据通信处理的计算机程序，该移动终端包括能够与外部设备进行近场无线通信的近场通信设备和配置为指示外部设备或近场通信设备执行命令的控制器，该处理包括：在近场通信设备中包括的存储单元中分配控制器验证密钥存储区域和外部设备访问密钥存储区域的步骤，其中该控制器验证密钥存储区域用于存储与控制器相互验证所使用的控制器验证密钥，该外部设备访问密钥存储区域用于存储访问外部设备所使用的外部设备访问密钥；第一相互验证步骤，响应于控制器给出的相互验证请求而基于控制器验证密钥来验证控制器是有效的，并请求控制器验证近场通信设备是有效的；第一通信密钥设置步骤，基于在第一相互验证步骤执行的验证操作的结果来设置在控制器和近场通信设备之间使用的第一通信密钥；第二相互验证步骤，响应于控制器给出的应用于近场通信设备和外部设备之间的相互验证请求而基于外部设备访问密钥验证外部设备是有效的，并请求外部设备验证近场通信设备是有效的；和第二通信密钥设置步骤，基于在第二相互验证步骤执行的验证操作的结果来设置在近场通信设备和外部设备之间使用的第二通信密钥，以及其中，已经相互验证的控制器和近场通信设备使用第一通信密钥执行安全通信，已经相互验证的近场通信设备和外部设备使用第二通信密钥执行安全通信。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES57827761" lang="ZH" load-source="patent-office" class="description">
    <invention-title lang="ZH">移动终端、数据通信方法以及计算机程序</invention-title>
    <p>相关申请的交叉引用本申请包括于2005年11月18日在日本专利局提交的日本专利申请JP2005-334052所涉及的主题，该申请的全部内容通过参考结合于此。</p>
    <technical-field>
      <p>技术领域</p>
      <p>本发明涉及一种移动终端，特别涉及在移动终端和外部设备之间执行的数据通信。</p>
    </technical-field>
    <background-art>
      <p>背景技术</p>
      <p>非接触式IC(集成电路)卡能够执行近场或近程无线通信。随着信息技术的发展，目前用户可使用非接触式IC卡等而促使安装在站台票证出入口的自动检票机来开启/关闭出入口以通过该出入口。</p>
      <p>在上述提到的自动检票机系统等中，在读出器/写入器(R/W)和非接触式IC卡之间执行相互验证。自动检票机基于存储在非接触式IC卡的安全存储区内的票证信息(例如，计算机通行信息)，来开启/关闭出入口(例如，参见公开号为10-20780的日本未审查专利申请)。</p>
      <p>非接触式IC卡技术已经迅速地发展。非接触式IC卡能够在很短的时间内执行数据处理，从安全角度来讲这是有利的。目前非接触式IC卡广泛地应用于诸如公共运输进入系统和办公室考勤管理系统之类的系统中。</p>
      <p>另外，移动电话包括非接触式IC芯片(或近场通信设备)，其中该非接触式IC芯片即是上述的非接触式IC卡模块。现在用户可以用该移动电话购买产品。</p>
    </background-art>
    <disclosure>
      <p>发明内容</p>
      <p>然而，上述大部分系统仅仅与从读出器/写入器或外部设备向非接触式IC芯片启动的通信兼容。即，上述大部分系统不能够与从一个非接触式IC芯片向存在于该非接触式IC芯片外部的移动终端(即，外部设备)中包含的另一非接触式IC芯片启动的通信兼容，其中，移动终端例如是移动电话和PDA(个人数字助理)。</p>
      <p>鉴于上述缺陷做出本发明的实施例。本发明的实施例提供新的或改进的移动终端，其允许在其内包括的近场通信设备执行更全面的通信。</p>
      <p>为此目的，根据本发明的一个方面，提供一种移动终端，该移动终端包括能够与外部设备进行近场无线通信的近场通信设备、和配置为指示外部设备或近场通信设备执行命令的控制器。包括在移动终端内的近场通信设备具有存储单元，在其中分配有控制器验证密钥存储区域和外部设备访问密钥存储区域，该控制器验证密钥存储区域用来存储与控制器相互验证的控制器验证密钥，外部设备访问密钥存储区域用来存储用于访问外部设备的外部设备访问密钥；第一相互验证单元，用于响应于控制器给出的相互验证请求而基于控制器验证密钥来验证控制器是有效的，并用于请求控制器验证该近场通信设备是有效的；第一通信密钥设置单元，用于基于第一相互验证单元执行的验证操作结果来设置在控制器和近场通信设备之间使用的第一通信密钥；第二相互验证单元，用于响应于控制器给出的在近场通信设备和外部设备之间应用的相互验证请求而基于外部设备访问密钥来验证外部设备是有效的，并用于请求外部设备验证近场通信设备是有效的；以及第二通信密钥设置单元，用于基于第二相互验证单元执行的验证结果设置在近场通信设备和外部设备之间使用的第二通信密钥。已经相互验证的控制器和近场通信设备使用第一通信密钥执行安全通信。已经相互验证的近场通信设备和外部设备使用第二通信密钥执行安全通信。</p>
      <p>根据本发明的一实施例，在控制器和近场通信设备之间、在近场通信设备和外部设备之间、以及在控制器和外部设备之间中的至少一个中执行相互验证和安全通信。这种配置允许近场通信设备不仅读取/写入存储在其中的数据，还响应于控制器给出的指令来读取/写入存储在外部设备中的数据，从而提高了近场通信设备执行通信的通用性和移动终端的便利性。另外，控制器可访问和读取/写入外部设备和近场通信设备中的数据。</p>
      <p>控制器和近场通信设备可被配置为使用第一通信密钥在它们之间执行安全通信。例如，这种配置允许近场通信设备将存储在其内的数据安全发送到控制器。另外，举例来说，控制器然后在其显示单元上显示该数据。因此，在没有通过通信网络(例如，因特网)从设备(例如，服务器)中获得在它们之间相互验证所用的验证密钥的情况下，近场通信设备和控制器也能够有效地执行相互验证，并且控制器可访问该近场通信设备并读取/写入数据。</p>
      <p>可以在近场通信设备中包括的存储单元内进一步分配用于存储价值信息的价值信息存储区域，并且，可使用第一通信密钥来访问存储在该价值信息存储区域内的价值信息。这里，尽管控制器或外部设备访问该价值信息，然而访问该价值信息的对象并不局限于该特定示例。上述的配置允许控制器例如在屏幕上显示价值信息，还能够允许用户很容易地了解余额信息。</p>
      <p>在存储单元的控制器相互验证密钥存储区域内存储的相互验证密钥可被配置为通过通信网络从服务器发送。</p>
      <p>可以在控制器和外部设备之间执行相互验证来代替第一和第二相互验证单元执行的相互验证，并且可以在控制器和外部设备之间执行安全通信。根据这种配置，不是和近场通信设备执行相互验证，而是在控制器和外部设备之间执行相互验证，并且在控制器和外部设备之间执行安全通信。这减少了相互验证的数量。控制器和外部设备可以在不降低安全等级的情况下执行数据通信。</p>
      <p>一从控制器接收到预定数据，近场通信设备就可以用第一通信密钥解密数据，处理该已解密的数据，用第二通信密钥加密经已理的数据，并传送该加密数据到外部设备。根据这种配置，近场通信设备在处理了从控制器接收的数据之后传送数据到外部设备。因此，近场通信设备可执行数据处理，例如附加额外的信息到该数据中。</p>
      <p>可以基于在近场通信设备上执行的相互验证的完成状态来确定是否可以在控制器和外部设备之间、在控制器和近场通信设备之间、或近场通信设备和外部设备之间执行安全通信。根据这种配置，参考状态使得可以很容易地确定是否可执行安全通信，从而避免了执行错误的安全通信。</p>
      <p>为了克服上述缺陷，根据本发明的另一方面，提供一种用于移动终端的数据通信方法，其中，该移动终端具有：近场通信设备，能够与外部设备进行近场无线通信；和控制器，被配置为指示外部设备或近场通信设备执行命令。该数据通信方法包括：在近场通信设备中的存储单元内分配控制器验证密钥存储区域和外部设备访问密钥存储区域的步骤，其中该控制器验证密钥存储区域用于存储用于与控制器相互验证的控制器验证密钥，该外部设备访问密钥存储区域用于存储用于访问外部设备的外部设备访问密钥；第一相互验证步骤，响应于控制器给出的相互验证请求而基于控制器验证密钥来验证控制器是有效的，并请求控制器验证近场通信设备是有效的；第一通信密钥设置步骤，基于在第一相互验证步骤中执行的验证操作的结果，设置在控制器与近场通信设备之间使用的第一通信密钥；第二相互验证步骤，响应于控制器给出的应用于近场通信设备与外部设备之间的相互验证请求而基于外部设备访问密钥来验证外部设备是有效的，并请求该外部设备验证近场通信设备是有效的；和第二通信密钥设置步骤，基于在第二相互验证步骤中执行的验证操作的结果，设置在近场通信设备和外部设备之间使用的第二通信密钥。已经相互验证的控制器和近场通信设备使用第一通信密钥执行安全通信。已经相互验证的近距离通信设备近场通信设备和外部设备使用第二通信密钥执行安全通信。</p>
      <p>为了克服上述缺陷，根据本发明的又一方面，提供一种促使移动终端执行数据通信处理的计算机程序。该移动终端具有：近场通信设备，能够与外部设备进行近场无线通信；和控制器，配置用于指示外部设备或近场通信设备执行命令。该数据通信处理包括以下步骤：在近场通信设备中包括的存储单元内分配控制器验证密钥存储区域和外部设备访问密钥存储区域的步骤，其中该控制器验证密钥存储区域用于存储与控制器相互验证所使用的控制器验证密钥，该外部设备访问密钥存储区域用于存储用于访问外部设备的外部设备访问密钥；第一相互验证步骤，响应于控制器给出的相互验证请求而基于控制器验证来密钥验证控制器是有效的，并请求控制器验证近场通信设备是有效的；第一通信密钥设置步骤，基于在第一相互验证步骤中执行的验证操作的结果来设置在控制器和近场通信设备之间使用的第一通信密钥；第二相互验证步骤，响应于控制器给出的应用于近场通信设备和外部设备之间的相互验证请求而基于外部设备访问密钥来验证外部设备是有效的，并请求外部设备验证近场通信设备是有效的；和第二通信密钥设置步骤，基于在第二相互验证步骤中执行的验证操作的结果来设置在近场通信设备和外部设备之间使用的第二通信密钥。已经相互验证的控制器和近场通信设备使用第一通信密钥执行安全通信。已经相互验证的近场通信设备和外部设备使用第二通信密钥执行安全通信。</p>
      <p>如上所述，根据本方明的实施例，包括在移动终端内的近场通信设备不仅仅保存有用于访问存储区域的访问密钥还保存有其他访问密钥，例如，用于访问外部设备的访问密钥。这使得近场通信设备能够执行与读出器/写入器或外部设备(例如，移动电话)之间的更全面通信。</p>
    </disclosure>
    <description-of-drawings>
      <p>附图说明</p>
      <p>图1是示出根据本发明的实施例的数据通信系统的概观示例的示意图；图2是示出根据本发明的实施例的移动终端的示意配置示例的框图；图3是示意性地示出根据本发明的实施例在移动终端内包括的近场通信设备的功能示例的框图；图4是示意性地示出根据本发明的实施例在移动终端内包括的存储区域示例的说明图；图5是示意性地示出根据本发明的实施例的两路安全通信示例的次序图；图6是示意性地示出根据本发明的实施例的两路安全通信示例的次序图；图7是示意性地示出根据本发明的实施例的示范性三路安全通信示例的次序图；图8是示意性地示出根据本发明的实施例的三路安全通信示例的次序图；图9是示意性地示出根据本发明的实施例的三路安全通信示例的次序图；以及图10是示意性地示出根据本发明的实施例在数据通信中的状态和状态转换的说明图。</p>
    </description-of-drawings>
    <mode-for-invention>
      <p>具体实施方式</p>
      <p>下面将参考附图详细描述本发明的实施例。在下面给出的描述以及附图中，为了避免重复描述，具有实质相同功能和配置的部件用相同的符号来表示。</p>
      <p>(数据通信系统)现在，参考图1，将描述根据本发明的实施例的数据通信系统100。图1是示出根据该实施例的数据通信系统100的概观示例的示意图。</p>
      <p>如图1所示，数据通信系统100包括移动终端101、读出器/写入器(R/W)103、外部移动终端104、信息处理装置105、基站113、分组通信网络115、网关117和服务器119。图1中所示的移动终端101利用其执行近场无线通信的读出器/写入器103和/或外部移动终端104可以被统称为“外部设备”。</p>
      <p>另外，如图1所示，下面给出例如对以下情况的描述，其中根据该实施例的数据通信系统100仅包括一个移动终端101、一个外部移动终端104、和一个读出器/写入器103。然而，数据通信系统100并不限制于该特定示例。例如，数据通信系统100可以包括多个移动终端101(即101a、101b、......101n)，多个读出器/写入器103(即103a、103b、......103n)，和多个外部移动终端104(即104a、104b、......104n)。</p>
      <p>数据通信系统100是执行以下处理的系统。例如，数据通信系统100响应于移动终端101的控制器133发出的请求而与外部设备通信。另外，数据通信系统100在近场通信设备(或非接触式IC(集成电路)卡模块)135中存储数据。</p>
      <p>近场通信设备135中存储的数据类型包括例如点信息、电子货币信息和息票(coupon)信息。这种数据被称为“电子价值信息”或简单地称作“价值信息”。也就是，电子价值信息在网络上流通并且具有预定的价值，例如货币值。此外，动词“冲值”可能指的是通过存钱来增加电子货币余额。</p>
      <p>移动终端101是便携式的并且能够执行通信。更特别地，移动终端101能够执行通过基站113实现的语音通信功能，并能够通过基站113、分组通信网络115、和网关117访问服务器119。</p>
      <p>这里，访问服务器表示以无线方式或通过网络(例如通信网络)对信息执行的各种类型的信息处理，例如，系统的利用、连接到服务器或其他设备、参考数据、存储数据、删除数据和修改数据。</p>
      <p>服务器119包括密钥存储单元137。密钥存储单元137是具有抗干扰能力的存储单元。密钥存储单元137为每个移动终端101存储验证密钥。验证密钥用于例如在控制器133访问在近场通信设备135中包括的存储区域时执行的相互验证。</p>
      <p>包括在移动终端101内的控制器133在例如从用户接收到执行处理的指令时，能够从移动终端电路131读出和执行客户应用程序，并在近场通信设备135或外部移动终端104中写入数据。客户应用程序具有诸如浏览功能之类的功能。</p>
      <p>另外，当用户把移动终端101放在读出器/写入器103上面时，包括在移动终端101内的控制器133变得能够经由近场通信设备135和读出器/写入器103而与信息处理装置105无线地交换数据。</p>
      <p>例如，假设数据是存储于包括在信息处理装置105内的诸如硬盘驱动之类的存储设备中。当包括在移动终端101内的控制器133读取该数据时，在控制器133和信息处理装置105使用验证密钥执行相互验证之后，控制器133变得能够通过近场通信设备135和读出器/写入器103读取数据。验证密钥可以存储在信息处理装置105和移动终端101中，或者可以动态地生成。</p>
      <p>信息处理装置105包括，例如控制单元、输入单元(例如鼠标和键盘)、存储器(例如RAM(随机存取存储器)和ROM(只读存储器))、诸如硬盘驱动器的存储设备、诸如显示器的输出单元。更特别地，信息处理装置105可以例如是个人计算机(PC)。</p>
      <p>另外，近场通信设备135保存在外部移动终端104等中读取和写入数据时执行的用于与外部移动终端104的相互验证的验证密钥(即，外部设备访问密钥)。因为外部设备访问密钥是高度机密信息，这些密钥存储在具有抗干扰的存储设备等中，但不局限于此，下面将会详细描述。</p>
      <p>外部设备访问密钥是任何类型的密钥，诸如不对称密钥和对称密钥。不对称密钥可以是，例如RSA(Rivest&#160;Shamir&#160;Adleman)密钥。对称密钥可以是，例如DES(数据加密标准)密钥和AES(高级加密标准)密钥。对称密钥必须分配给保持其机密性的通信伙伴。因此，对称密钥并不是直接，而是通过其他方法例如邮件，从通信网络分配给通信伙伴。</p>
      <p>(移动终端101)参考图2，下面将会描述根据本发明实施例的移动终端101。图2是示出根据该实施例的移动终端101的示意配置的框图。</p>
      <p>移动终端电路131具有通过基站113执行的语音通信功能和数据通信功能。更具体地，移动终端电路131包括诸如输入按钮的输入单元、用于显示信息(例如价值信息)的显示单元、和用于语音通信和数据通信的天线102。另外，该移动终端电路131包括存储单元(未示出)，诸如RAM和ROM。</p>
      <p>如图2所示，存储单元能够存储各种数据，例如用于实现网络浏览功能以及用于读取和写入存储在近场通信设备135中的价值信息的应用程序。</p>
      <p>根据一操作系统，控制器133激活在移动终端电路131中存储的应用程序。控制器133还命令在移动终端101中包括的每个单元(例如，移动终端电路131和近场通信设备135)执行处理。另外，控制器133控制每个单元执行的处理。</p>
      <p>控制器133可包括存储单元(未示出)。存储单元可包括寄存器、诸如SRAM(静态随机存取存储器)的易失性存储器、和诸如ROM和EEPROM(电可擦除可编程只读存储器)的非易失性存储器。操作系统(下文中称作OS)可以安装在该存储单元中。</p>
      <p>以下给出对下面情况的描述，即，例如根据该实施例的OS(或固件)安装于包括在控制器133中的高速缓冲存储器或寄存器中。然而，存储OS的单元并不局限于该特定示例。例如，OS可以安装于在移动终端电路131中包括的存储单元中。控制器133调用在OS程序之中必需的程序，并且执行为OS。</p>
      <p>另外，移动终端101包括供电单元(未示出)，用于提供在移动终端101中包括的每个单元(例如，移动终端电路131、控制器133和近场通信设备135)进行操作所必需的电功率。</p>
      <p>电功率可以不从供电单元提供给近场通信设备135。在这种情况下，近场通信设备135在其中包括自己的供电单元，并且该供电单元可以向在近场通信设备135中包括的每个单元(例如，调谐器单元303、调制器/解调器(调制解调器)305、IC控制单元307和存储单元313)提供电功率。</p>
      <p>只要在图2所示的近场通信设备135和在外部移动终端104中包括的近场通信设备141放置在很近的范围(即通信范围)之内时，例如0到10厘米，近场通信设备135能够与近场通信设备141无线地通信。</p>
      <p>如图2所示，近场通信设备135包括允许近场或近程无线通信的天线301、调谐器单元303、调制解调器305、IC控制单元307和存储单元313。</p>
      <p>天线301例如由闭环线圈等组成，并在流经线圈的电流改变时输出电磁波。另外，当经过线圈天线301的磁流量改变时，有电流流经天线301。</p>
      <p>给出对例如根据该实施例的天线301是集成天线的情况的描述。更特别地，天线301例如具有，用于响应于外部的读出器/写入器103等设备的访问而读取/写入存储在其中的数据的天线，和用于在访问外部设备(例如外部移动终端104)之后从外部移动终端104等设备的存储区域读取数据并向该存储区域写入数据。然而，天线301的配置并不局限于该特定示例，天线301可以由那样的两个天线组成。</p>
      <p>例如，调谐器单元303接收流经天线301的电流，并在执行调谐或检测之后提供信号给调制解调器305。</p>
      <p>调谐器单元303执行调谐或滤波的频带可以是可能利用其访问包括在存储单元313中的价值信息和诸如近场通信设备135可以识别的ID等之类的数据的任何频率。例如该频带可以是13.56MHz。</p>
      <p>调制解调器305解调从调谐器单元303提供的信号，并把解调的信号提供给IC控制单元307。调制解调器305还调制从IC控制单元307提供的信号，以便通过天线301传送已调制信号。</p>
      <p>调制解调器305基于作为无线电信号从天线301传送的载波对从IC控制单元307提供的数据执行调制。另外，在解调过程中，调制解调器305解调通过从调谐器303提供的无线电信号中消除载波而获得的数据。</p>
      <p>IC控制单元307解码从调制解调器305提供的信号(例如曼彻斯特码等)，并分析从无线电信号中解码的代码信息，以便识别在接收信号中包含的命令等。</p>
      <p>各种命令包括，例如轮询命令、指示读取在存储单元313中存储的数据(例如ID)的读命令、指示在存储单元313的存储区域中写入数据的写命令。ID是近在工厂等地制造近场通信设备135时分配的识别编号等。</p>
      <p>另一方面，IC控制单元307把要发送给包括在外部移动终端104内的近场通信设备141的数据作为无线电信号编码成例如曼彻斯特码，并把已编码信号提供给调制解调器305。</p>
      <p>这里，ASK(幅移键控)调制技术可以用作调制解调器305使用的调制技术。然而，调制解调器305使用的调制技术并不局限于ASK，也可以使用其他调制技术，例如PSK(相移键控)和QAM(正交幅度调制)。另外，振幅调制系数并不局限于诸如8％-30％、50％和100％这些值，也可以选择合适的调制系数。</p>
      <p>IC控制单元307包括多个用于控制近场通信设备135的电路。虽然没有在图2中示出，IC控制单元307包括IC控制器、RAM(随机存取存储器)和ROM(只读存储器)。</p>
      <p>如上所述，IC控制器是对调制解调器305解调的无线电信号执行编码/解码的部件。</p>
      <p>另外，IC控制器控制在近场通信设备135中包括的每个单元(例如，调谐器单元303、调制解调器305、IC控制单元307、和存储单元313)所执行的处理。</p>
      <p>无线电信号中包含的各种命令包括轮询命令和当写入安全信息时所使用的命令。然而，这些命令并不局限于该特定示例，而是还可以包括例如在写入非安全信息时所使用的命令、当读取安全信息时所使用的命令、和当读取非安全信息时所使用的命令。</p>
      <p>已经对例如使用曼彻斯特码执行编码/解码操作的情况描述了根据该实施例的IC控制器。然而，该编码/解码技术并不局限于该特定示例。例如，可使用从诸如修正镜像和NRZ(不归零)之类的多种编码代码中选择的一种编码代码，来执行编码/解码操作。</p>
      <p>根据该实施例的近场通信设备135所采用的各种通信协议包括，例如NFC(近场通信)、ISO/IEC14443、指定RF(射频)标签通信的ISO/IEC1569、蓝牙、UWB(超宽带)和IEEE802.11b。</p>
      <p>尽管在下面给出详细的描述，存储单元313具有多个存储区域。例如价值信息和历史信息等的信息被存储在该存储区域中。存储单元313可以是例如能够电存储/擦除数据的EEPROM。然而，存储单元313并不局限于该特定示例，如果需要的话，可以是任何能够存储数据和擦除数据的存储单元。</p>
      <p>另外，在图1所示的外部移动终端104中包括的每个单元(例如移动终端电路136、控制器139和近场通信设备141)具有与在移动终端101中包括的相应单元基本相同的配置。</p>
      <p>现在，将参考图3描述根据本发明的实施例的近场通信设备135的主要功能块。图3是示意性地示出根据该实施例的近场通信设备135的功能块(或模块)的框图。</p>
      <p>如图3所示，近场通信设备135包括通信单元512、合成密钥生成单元514、相互验证单元516、随机数生成单元518、分组加密/解密单元520、密钥设置单元522、命令执行单元523、和存储区域111。合成密钥生成单元514生成合成密钥。相互验证单元516使用随机数和合成密钥执行近场通信设备135和外部通信设备之间的相互验证。分组加密/解密单元520使用经相互验证单元516验证的交易(transaction)密钥加来密和解密通信分组。存储区域111存储关于多个服务的信息。</p>
      <p>合成密钥生成单元514能够执行合成密钥生成算法(即，合成密钥生成算法1)。例如，使用单个DES(数据加密标准)的算法可以用作合成密钥生成算法1。</p>
      <p>分组加密/解密单元520能够执行分组加密/解密算法(即，分组加密/解密算法1)。例如，采用单个DES的算法可以用作分组加密/解密算法1。另外，在存储区域(或存储器区域)111中存储的各种服务中每一种服务的信息都可以包括访问(例如，读取/写入)服务时所使用的服务密钥(即，服务密钥1)。</p>
      <p>从图3所示的存储区域111指向合成密钥生成单元514的箭头表示合成密钥生成单元514根据例如区域密钥和服务密钥来生成合成密钥A和B。区域密钥包括区域0密钥和区域1密钥。服务密钥包括余额服务密钥和外部设备访问服务密钥。</p>
      <p>例如，合成密钥生成单元514以下列方式生成合成密钥A和B。合成密钥生成单元514首先通过顺序地用“区域0密钥1”、“区域1密钥1”和“区域2密钥1”来加密“系统密钥1”而生成合成密钥A。然后合成密钥生成单元514通过顺序地用“服务1密钥1”、“服务2密钥1”和“服务3密钥1”加密合成密钥A来生成合成密钥B。以上述方式生成合成密钥仅仅是示例，可以根据任何方法生成合成密钥A和B。下面给出系统密钥、区域密钥和服务密钥的详细描述。</p>
      <p>相互验证单元516(即，第一相互验证单元或第二相互验证单元)执行第一和第二验证操作。在第一验证操作中，验证控制器133。在第二验证操作中，验证外部设备，例如外部移动终端104。</p>
      <p>该实施例的相互验证单元516中，执行第一验证操作的单元和执行第二操作的单元可以分离也可以集成。</p>
      <p>密钥设置单元522基于在相互验证单元516中使用的随机数A和B来设置分组加密/解密单元520加密/解密数据所使用的交易密钥1和2。</p>
      <p>根据该实施例的密钥设置单元522可以改变交易密钥，并为每个交易操作设置新的交易密钥，或者可以为多个交易操作设置交易密钥。</p>
      <p>上述密钥设置单元(即，第一通信密钥设置单元或第二通信密钥设置单元)522基于在相互验证单元516执行的控制器133的验证操作中生成的随机数来设置第一交易密钥(即，第一通信密钥)。该密钥设置单元522还基于在外部移动终端104的验证操作中生成的随机数来设置第二交易密钥(即，第二通信密钥)。</p>
      <p>另外，根据该实施例的密钥设置单元522的设置第一交易密钥的单元和设置第二交易密钥的单元可以分离也可以集成。</p>
      <p>命令执行单元523根据接收到的命令执行各种处理操作。例如，命令执行单元523把分组加密/解密单元520解密的数据存储在预定的存储区域或者从预定存储区域读取该数据。</p>
      <p>另外，由于外部移动终端104与移动终端101具有基本上相同的详细配置，因此在这里省略对其的描述。包括在外部移动终端104中的近场通信设备141包括：通信单元；合成密钥生成单元，用于生成合成密钥；相互验证单元，用于使用随机数和合成密钥来执行外部信息处理装置的相互验证；随机数字生成单元；分组加密/解密单元，用于使用相互验证单元验证的交易密钥来加密和解密通信分组；密钥设置单元；和命令执行单元。</p>
      <p>上面描述了近场通信设备135的各种功能块。这些功能块中的每一个(即，通信单元512、合成密钥生成单元514、相互验证单元516、随机数生成单元518、分组加密/解密单元520、密钥设置单元522、命令执行单元523和存储区域111中的至少一个)可包括在作为具有上述功能的硬件的近场通信设备135中。可选地，每个功能块可以通过在存储单元313等中存储的可执行程序实现，该执行程序促使计算机实现上述功能。</p>
      <p>(存储区域的结构)如图4所示，在存储单元313内分配的存储区域中形成的文件系统具有由的“区域”和“服务”组成的分层结构。该区域对应于文件夹，而且可以在一个区域的下面分层地创建另一区域。</p>
      <p>该服务定义数据访问类型和权限。为区域和服务设置的“访问密钥(例如区域密钥或服务密钥)”防止未被授权的人访问该服务，并实现应用防火墙。</p>
      <p>使用通过组织多个访问密钥而创建的“合成密钥”允许用户打开用一个相互验证操作访问的多个文件。</p>
      <p>在该实施例中，在区域中执行读取/写入操作所使用的访问密钥被称作“区域密钥”。执行服务的读取/写入操作所使用的访问密钥被称作“服务密钥”。</p>
      <p>另外，如图4所示，尽管给出了关于例如一个区域/服务持有一个区域密钥/服务密钥的情况的描述，但是本发明并不局限于该特定示例。例如，一个区域/服务可以持有两个区域密钥/服务密钥。</p>
      <p>图4是示出在移动终端101中包括的存储区域111的示意图。存储区域111具有下述分层结构。尽管是关于在存储单元313中分配存储区域111的情况下描述的根据该实施例的存储区域111，但是存储区域111的分配并不局限于该特定示例，只要存储区域111能够安全地存储数据即可。</p>
      <p>区域名(1)310和区域名(3)330被分配在区域名(0)300下面。在区域名(1)310下面，创建了余额服务315、控制器验证服务316、和外部设备访问服务317。相应地，可以在一个区域下面分层地创建另一区域。在区域名(3)330下面，创建有点服务(point&#160;service)345。</p>
      <p>例如，余额服务315存储指示价值信息(例如，电子货币)余额的信息即余额信息。用户可通过访问余额信息来了解价值信息的余额。</p>
      <p>控制器验证服务316存储控制器验证服务密钥。控制器验证服务密钥用于在移动终端101中包括的近场通信设备135和控制器133之间的相互验证操作。</p>
      <p>外部设备访问服务317存储外部设备访问服务密钥。外部设备访问服务密钥用于在近场通信设备135和例如外部移动终端104的外部设备之间的相互验证操作。</p>
      <p>图4中示出的每一个区域/服务持有一个区域密钥/服务密钥。用[系统密钥1]表示在存储单元313中分配的存储区域111的系统密钥。区域密钥被定义为“区域名[区域密钥1]”。另外，服务密钥被定义为“服务名[服务密钥1]”。</p>
      <p>(两路安全通信方法)现在将参考图5和6来描述根据本发明实施例的数据通信方法。图5和6是示出根据该实施例的数据通信方法概要的顺序图。</p>
      <p>如图5所示，为了促使近场通信设备135开始输出无线电信号，控制器133向包括在移动终端101内的近场通信设备135发送RF(射频)输出开始命令(步骤S501)。</p>
      <p>然后，为了获得位于外面的外部设备(例如，外部移动终端104)的ID，控制器133发送ID请求命令到近场通信设备135(步骤S503)。</p>
      <p>当从控制器133接收到ID请求命令时，近场通信设备135在调制该命令之后通过天线301无线地发送ID请求命令到外部移动终端104(步骤S505)。例如，ID请求命令可以是轮询命令等。</p>
      <p>当接收到ID请求命令时，包括在外部移动终端104内的近场通信设备141执行该命令并获得存储在其内的近场通信设备141的ID，并且通过天线无线地传送该ID(步骤S507)。</p>
      <p>当无线地接收到近场通信设备141的ID时，近场通信设备135在解调该ID之后直接传送该近场通信设备141的ID到控制器133(步骤509)。控制器133能够通过获得这样的ID来识别通信伙伴并发送/接收数据。</p>
      <p>包括在控制器133中的合成密钥生成单元(未示出)514生成合成密钥A1和B1(步骤511)，以便执行与近场通信设备141的相互验证并执行数据通信。例如，合成密钥生成单元在访问存储在近场通信设备141中的余额服务时，根据余额服务密钥和其他服务密钥生成合成密钥A1。合成密钥生成单元根据位于余额服务上层的一个或多个区域密钥来生成合成密钥B1。</p>
      <p>在合成密钥生成单元已经生成合成密钥A1和B1(步骤S511)之后，控制器133生成随机数A1。控制器133用合成密钥B1加密随机数A1。然后控制器133把已加密的随机数连同相互验证请求命令一起发送到外部移动终端104的近场通信设备141(步骤S513)。</p>
      <p>当接收到从控制器133到近场通信设备141的相互验证请求命令时，近场通信设备135在调制该数据之后，通过天线301向外部通信设备104无线地传送相互验证请求命令和已加密的随机数[随机数A1]B1(步骤S515)。尽管要传送的例如相互验证请求命令等命令包含通信伙伴的ID，但是并不局限于此。另外，表达式[随机数A1]B1表示用合成密钥B1加密的随机数A1。</p>
      <p>当从近场通信设备135接收到相互验证请求命令和加密的随机数[随机数A1]B1时，近场通信设备141执行相互验证请求命令，并生成合成密钥A1和B1(步骤S517)。近场通信设备141以与控制器133执行的生成合成密钥(即，步骤S511)步骤中描述的基本相同的方式来生成合成密钥A1和B1。因此，在这里省略对它的详细描述。</p>
      <p>然后，近场通信设备141的分组加密/解密单元使用在步骤S517生成的合成密钥B1对与相互验证请求命令一起接收到的已加密随机数[随机数A1]B1进行解密(步骤S519)。当成功执行了对已加密随机数[随机数A1]B1的解密时，近场通信设备141可获得随机数A1。</p>
      <p>近场通信设备141的随机数生成单元生成随机数B1(步骤S521)。分组加密/解密单元使用先前生成的合成密钥A1来加密随机数B1，并且还使用合成密钥A1加密在步骤S519获得的随机数A1(步骤S523)。</p>
      <p>近场通信设备141的通信单元向控制器133无线地传送在步骤S523加密的已加密随机数[随机数A1]A1和[随机数B1]A1(步骤S525)。如图5和6所示，近场通信设备135用作在控制器133和近场通信设备141之间通信中的中继设备，并直接转送数据。</p>
      <p>在经由天线301以无线方式接收到从近场通信设备141传送到控制器133的已加密随机数[随机数A1]A1和[随机数B1]A1时，近场通信设备135使用调制解调器305解调该无线电信号。然后，近场通信设备135转送已加密的随机数[随机数A1]A1和[随机数B1]A1到控制器133(步骤S527)。</p>
      <p>控制器133用在步骤S511中生成的合成密钥A1解密从近场通信设备135接收的已加密随机数[随机数A1]A1(步骤S529)，并获得随机数A1。</p>
      <p>然后，控制器133将在步骤S513传送相互验证请求命令时生成的随机数A1与在步骤S529中获得的随机数A1相比较，并确认一致，这样控制器133就验证了近场通信设备141(步骤S531)。因此，完成了从控制器133到近场通信设备141的单路验证操作。</p>
      <p>控制器133的分组加密/解密单元520用合成密钥A1解密在步骤S527从近场通信设备135接收的其他已加密随机数[随机数B1]A1，并获得随机数B1(步骤S533)。</p>
      <p>控制器133用合成密钥B1加密在步骤S533执行的解密中获得的随机数B1(步骤S535)。</p>
      <p>为了促使近场通信设备141执行验证，控制器133向到近场通信设备141传送相互验证响应命令和在步骤S535加密的已加密随机数[随机数B1]B1(步骤S537)。</p>
      <p>当从控制器133接收到相互验证响应命令和命令数据(即，[随机数B1]B1)时，近场通信设备135在通过调制解调器305调制该数据之后，通过天线301无线地向外部移动终端104传送相互验证响应命令和已加密随机数[随机数B1]B1(步骤S539)。</p>
      <p>参考图6，下面将描述图5所示步骤后面的处理。当接收到在步骤S539传送的相互验证响应命令时，近场通信设备141的分组加密/解密单元用合成密钥B1解密命令数据[随机数B1]B1(步骤S541)。</p>
      <p>然后，近场通信设备141的相互验证单元比较随机数生成单元在步骤S521生成的随机数B1和在步骤S541获得的随机数B1，并确认一致，这样相互验证单元就验证了控制器133的有效性(步骤S543)。因此，完成了控制器133和近场通信设备141之间的相互验证操作。</p>
      <p>在完成了相互验证(步骤S543)之后，近场通信设备141的密钥设置单元将随机数生成单元生成的随机数A1和B1设置为交易密钥1和2(步骤S545)。然后，密钥设置单元把设置的交易密钥通知给分组加密/解密单元。</p>
      <p>然后，近场通信设备141的相互验证单元通过天线无线地传送命令或消息到控制器133(步骤S547)，通知控制器133相互验证的完成。</p>
      <p>在接收到通过天线301通知控制器133相互验证完成的命令或消息时，近场通信设备135在利用调制解调器305解调信号之后直接向控制器133转送通知相互验证完成的命令或消息(步骤S549)。</p>
      <p>在接收到通知控制器133相互验证完成的命令或消息时，控制器133以与上述近场通信设备141的密钥设置单元执行的设置操作相同的过程来设置交易密钥1和2(步骤S551)。</p>
      <p>上述步骤是用于控制器133和外部移动终端104之间的数据通信的预先处理步骤。在步骤S551后面的步骤是当在控制器133和外部移动终端104之间执行数据通信时执行的处理步骤。</p>
      <p>从控制器133到外部移动终端104的数据传输操作从如图6所示的数字加密(步骤S553)开始。控制器133的分组加密/解密单元(未示出)使用交易密钥1和2至少之一作为加密/解密密钥来加密数据和解密已加密的数据。更特别地，交易密钥1用作加密/解密密钥，而交易密钥2被当作伪密钥(dummykey)。可选地，交易密钥1和2都被用作双重加密/解密密钥。更特别地，首先使用交易密钥1加密数据，并进一步使用交易密钥2进行加密，以便创建已加密数据[数据]。然而，加密/解密密钥并不局限于该特定示例。</p>
      <p>为了在已经相互验证的控制器133和近场通信设备141之间执行两路安全通信，控制器133传送两路安全通信命令和在步骤S553加密的数据(即，[数据])到近场通信设备141(步骤S555)。表达式[数据]表示用交易密钥1和2中的至少一个加密的数据。</p>
      <p>在两路安全通信命令中，关于在双方之间执行的命令的数据(即，命令数据)被加密。两路安全通信命令的种类包括，但不局限于，指示在通信伙伴的存储区域内写入数据的写命令和指示读取在通信伙伴的存储区域中存储的数据的读命令。</p>
      <p>在接收到从控制器133向近场通信设备141传送的两路安全通信命令时，近场通信设备135用调制解调器305调制包括两路安全通信命令和已加密数据[数据]的数据。然后，近场通信设备135通过天线301向近场通信设备141无线地传送已调制数据(步骤S557)。</p>
      <p>在从近场通信设备135接收到两路安全通信命令和加密数据[数据]时，两路近场通信设备141的IC控制单元(未示出)指示对已加密数据[数据]进行解密，以便执行两路安全通信命令。</p>
      <p>响应于IC控制单元给出的解密命令，分组加密/解密单元用预设的交易密钥1和2中的至少一个对已加密数据[数据]进行解密(步骤S559)。</p>
      <p>然后，命令执行单元根据接收到的命令执行处理(步骤S561)。例如，如果已解密的数据包含该数据的读取地址，并且接收到的命令是指示根据读取地址读取数据的读命令，则该命令执行单元根据数据中指定的地址从存储单元的存储区域读出数据。然而，该命令并不局限于该特定示例。</p>
      <p>然后，为了向控制器133通知命令执行单元的执行结果，通过天线301无线地传送指示执行结果的数据(步骤S563)。执行结果的种类可包括在预定读取地址存储的数据内容和指示写操作结果(例如成功/错误)的信息，但不局限于此。另外，如果需要，可以用交易密钥1和2至少之一加密该执行结果。</p>
      <p>在无线地通过天线301接收从近场通信设备141向控制器133发送的执行结果时，近场通信设备135通过调制解调器305解调该执行结果。然后，近场通信设备135将执行结果转送给控制器133(步骤S565)。</p>
      <p>这是对涉及根据该实施例的两路安全通信方法中的系列步骤描述的结束。例如，上述的两路安全通信方法允许控制器133获得外部移动终端104的近场通信设备141等中保存的价值信息的余额信息，并在用户要求控制器133显示外部移动终端104的余额信息的时候，在移动终端101的显示单元的屏幕上显示该信息。</p>
      <p>(三路安全通信方法)现在，将参考图7-9来描述根据本发明一个实施例的数据通信方法。图7-9是示出根据该实施例的三路数据通信方法概要的顺序图。</p>
      <p>如图7所示，为了获得近场通信设备135的ID，控制器133发送ID请求命令到近场通信设备135(步骤S703)。</p>
      <p>在从控制器133接收到向其发送的ID请求命令时，近场通信设备135执行该命令，并且获得其中存储的近场通信设备135的ID。然后，近场通信设备135发送该ID到控制器133(步骤S707)。</p>
      <p>然后，包括在控制器133中的合成密钥生成单元(未示出)生成合成密钥A2和B2，以便执行与近场通信设备135的相互验证和数据通信(步骤711)。合成密钥生成单元例如根据用于验证近场通信设备135的控制器验证服务密钥和其他服务密钥，生成合成密钥A2。合成密钥生成单元根据位于控制器验证服务的上层中的一个或多个区域来密钥生成合成密钥B2。</p>
      <p>在生成合成密钥A2和B2(步骤S711)之后，控制器133生成随机数A2，并用合成密钥B2对随机数A2进行加密。然后，控制器133把已加密的随机数[随机数A2]B2连同相互验证请求命令一起发送到近场通信设备135(步骤S713)。诸如相互验证请求命令之类的将要发送的命令包括但不局限于通信伙伴的ID。</p>
      <p>在接收到相互验证请求命令和已加密的随机数[随机数A2]B2时，近场通信设备135执行该相互验证请求命令。首先，合成密钥生成单元514生成合成密钥A2和B2(步骤S717)。近场通信设备135以和上述控制器133或近场通信设备141基本相同的方式生成合成密钥A2和B2。因此，在这里省略其中的详细描述。</p>
      <p>然后，包括在近场通信设备135中的分组加密/解密单元520使用在步骤S717生成的合成密钥B2来解密与相互验证请求命令一起接收的已加密随机数[随机数A2]B2(步骤S719)。当已加密的随机数[随机数A2]B2的解密成功执行时，相互验证单元516可获得随机数A2。</p>
      <p>包括在近场通信设备135中的随机数生成单元518生成随机数B2(步骤S721)。分组加密/解密单元520使用先前生成的合成密钥A2来加密随机数B2，并使用合成密钥A2来加密在步骤S719加密的随机数A2(步骤S723)。</p>
      <p>近场通信设备135的通信单元512将在步骤S723加密的已加密随机数[随机数A2]A2和[随机数B2]A2发送给控制器133(步骤S725)。与图5和6所示的数据通信不同，近场通信设备135对控制器133和近场通信设备141二者都进行验证，以便能够以各种方式在控制器133和近场通信设备135之间、近场通信设备135和141之间、以及在控制器133和近场通信设备141之间实现安全数据通信。</p>
      <p>然后，控制器133用在步骤S711生成的合成密钥A2来解密从近场通信设备135接收的已加密的随机数[随机数A2]A2(步骤S729)，以获得随机数A2。</p>
      <p>然后，控制器133比较在步骤S713发送相互验证请求命令时生成的随机数A2和在通过在步骤S729执行解密而获得的随机数A2，并确认一致，这样控制器133就验证了近场通信设备135的有效性(步骤S731)。因此，完成了从控制器133到近场通信设备135的单路验证操作。</p>
      <p>然后，控制器133的分组加密/解密单元用合成密钥A2来解密在步骤S725从近场通信设备135接收的其他已加密随机数[随机数B2]A2，并获得随机数B2(步骤S733)。</p>
      <p>然后，控制器133的分组加密/解密单元用合成密钥B2来加密通过在步骤S733执行解密操作而获得的随机数B2(步骤S735)。</p>
      <p>为了促使近场通信设备135验证控制器133，控制器133发送在步骤S735加密的已加密随机数[随机数B2]B2和相互验证响应命令到近场通信设备135(步骤S737)。</p>
      <p>在近场通信设备135接收到从控制器133发送的相互验证响应命令和命令数据(即，已加密的随机数[随机数B2]B2)之后，近场通信设备135的分组加密/解密单元520用合成密钥B2对命令数据[随机数B2]B2进行解密(步骤S741)。</p>
      <p>然后，近场通信设备135的相互验证单元516比较随机数生成单元518在步骤S721生成的随机数B2和在步骤S741获得的随机数B2，并确认一致，这样相互验证单元516就验证了控制器133的有效性(步骤S743)。因此，完成了控制器133和近场通信设备135之间的相互验证操作。</p>
      <p>在完成了相互验证(步骤S743)之后，近场通信设备135的密钥设置单元518将随机数生成单元518生成的随机数A2和B2设置为第一交易密钥(即，交易密钥1-1和2-1)(步骤S745)。然后，密钥设置单元518把设置的交易密钥1-1和2-1通知给分组加密/解密单元520。</p>
      <p>然后，近场通信设备135的相互验证单元516发送命令或消息到控制器133(步骤S747)，来向控制器133通知相互验证的完成。</p>
      <p>在接收到通知控制器133相互验证完成的命令或消息时，控制器133设置第一交易密钥(步骤S751)。设置第一交易密钥的过程与近场通信设备135的密钥设置单元518执行的上述过程相同。</p>
      <p>上述步骤是用于控制器133和近场通信设备135之间的数据通信的预先处理步骤。在步骤S751后面的步骤是用于近场通信设备135和141之间的数据通信的预先处理步骤。</p>
      <p>如图8所示，为了使近场通信设备135开始输出无线电信号，控制器133发送RF(射频)输出开始命令到近场通信设备135(步骤S801)。</p>
      <p>然后，为了获得外部设备(例如，外部移动终端104)的ID，控制器133发送ID请求命令到近场通信设备135(步骤S803)。</p>
      <p>在从控制器133接收到ID请求命令时，近场通信设备135在对命令进行调制之后，通过天线301无线地传送ID请求命令到外部移动终端104(步骤S805)。</p>
      <p>在接收到ID请求命令时，包括在外部移动终端104中的近场通信设备141获得其中存储的近场通信设备141的ID，并通过天线无线地传送该ID(步骤S807)。</p>
      <p>在无线地接收到近场通信设备141的ID时，近场通信设备135在解调该ID之后，将该近场通信设备141的ID直接转送给控制器133(步骤809)。</p>
      <p>然后，为了使近场通信设备135和141执行相互验证和数据通信，控制器133发送外部设备相互验证执行命令到近场通信设备135(步骤S811)。</p>
      <p>当近场通信设备135的IC控制单元307接收到外部设备相互验证执行命令时，合成密钥生成单元514生成合成密钥A3和B3(步骤S812)。例如，当访问近场通信设备141即外部设备的存储区域时，合成密钥生成单元514根据在存储区域111中存储的外部设备访问服务密钥和其他服务密钥，生成合成密钥A3。合成密钥生成单元514根据位于外部设备访问服务上层的一个或多个区域密钥生成合成密钥B3。合成密钥生成方法并不局限于该特定示例。</p>
      <p>在合成密钥生成单元514已经生成合成密钥A3和B3(步骤S812)之后，随机数生成单元518生成随机数A3。分组加密/解密单元520用合成密钥B3加密随机数A3。</p>
      <p>近场通信设备135的通信单元512通过天线301把已加密的随机数[随机数A3]B3连同相互验证请求命令一起发送到外部移动终端104的近场通信设备141(步骤S813)。在步骤S813传送的无线电信号包括近场通信设备141的ID。</p>
      <p>在接收到从近场通信设备135到近场通信设备141相互验证请求命令和已加密随机数[随机数A3]B3时，近场通信设备141执行该相互验证请求命令。合成密钥A3和B3的生成方式和步骤S812相同(步骤S817)。</p>
      <p>然后，近场通信设备141的分组加密/解密单元使用在步骤S817生成的合成密钥B3来解密和相互验证请求命令一起接收的已加密随机数[随机数A3]B3(步骤S819)。当已加密随机数[随机数A3]B3的解密成功执行时，近场通信设备141可获得随机数A3。</p>
      <p>近场通信设备141的随机数生成单元生成随机数B3(步骤S821)。近场通信设备141的分组加密/解密单元使用先前生成的合成密钥A3加密随机数B3，并且还使用合成密钥A3加密在步骤S819获得的随机数A3(步骤S823)。</p>
      <p>近场通信设备141的通信单元无线地发送在步骤S823加密的已加密随机数[随机数A3]A3和[随机数B3]A3到近场通信设备135(步骤S825)。</p>
      <p>在通过天线301无线地接收到从近场通信设备141向其发送的已加密的随机数[随机数A3]A3和[随机数B3]A3时，近场通信设备135的分组加密/解密单元520在通过调制解调器305解调该随机数后，对已加密的随机数[随机数A3]A3进行解密(步骤S829)。</p>
      <p>然后，相互验证单元516比较在步骤S813传送相互验证请求命令时生成的随机数A3和在步骤S829获得随机数A3，并确认一致，这样近场通信设备135就验证了近场通信设备141的有效性(步骤S831)。因此，完成了从近场通信设备135到近场通信设备141的单路验证操作。</p>
      <p>近场通信设备135的分组加密/解密单元520用合成密钥A3解密在步骤S825接收的其他已加密随机数[随机数B3]A3，并获得随机数B3(步骤S833)。</p>
      <p>近场通信设备135的分组加密/解密单元520利用合成密钥B3加密在步骤S833执行的解密而获得的随机数B3，以获得已加密随机数[随机数B3]B3(步骤S835)。</p>
      <p>为了促使近场通信设备141验证近场通信设备135，近场通信设备135通过天线301无线地传送相互验证响应命令和在步骤S835加密的已加密随机数[随机数B3]B3到近场通信设备141(步骤S837)。</p>
      <p>在接收到在步骤S837传送的相互验证响应命令时，近场通信设备141的分组加密/解密单元然后用合成密钥B3对已加密随机数[随机数B3]B3进行解密(步骤S841)。</p>
      <p>然后，近场通信设备141的相互验证单元比较随机数生成单元在步骤S821生成的随机数B3和在步骤S841获得的随机数B3，并确认一致，这样相互验证单元就验证了近场通信设备135的有效性(步骤S843)。因此，完成了近场通信设备135和141之间的相互验证操作。</p>
      <p>在完成了相互验证(步骤S843)之后，如图9所示，近场通信设备141的密钥设置单元将近场通信设备141的随机数生成单元生成的随机数A3和B3设置为第二交易密钥(即，交易密钥1-2和2-2)(步骤S845)。然后，密钥设置单元把设置的交易密钥1-2和2-2通知给近场通信设备141的分组加密/解密单元。</p>
      <p>然后，近场通信设备141的相互验证单元通过天线无线地传送命令或消息到控制器133(步骤S847)，以向控制器133通知相互验证的完成。</p>
      <p>在近场通信设备135通过天线301接收到通知控制器133相互验证完成的命令或消息之后，调制解调器305解调该消息或命令。</p>
      <p>同近场通信设备141一样，近场通信设备135的密钥设置单元522将随机数生成单元518生成的随机数A3和B3设置为第二交易密钥(即，交易密钥1-2和2-2)(步骤S848)。然后，密钥设置单元将设置的交易密钥1-2和2-2通知给近场通信设备135的分组加密/解密单元。</p>
      <p>由调制解调器305解调的通知控制器133相互验证完成的命令或消息被传送到控制器133(步骤S849)。</p>
      <p>在上述步骤中，执行了控制器133与近场通信设备135和141之间的相互验证，并完成了数据通信的预先处理。在步骤S849后面的步骤是当在控制器133、近场通信设备135和外部移动终端104之间执行安全数据通信时所执行的处理步骤。</p>
      <p>如图9所示，从控制器133到外部移动终端104的数据传输操作从用第一交易密钥加密数据开始(步骤S853)。控制器133的分组加密/解密单元(未示出)使用交易密钥1-1和2-1至少之一作为加密/解密密钥来加密数据和解密该已加密数据。在这里省略更详细的描述，因为该过程与在上述两路安全通信方法中描述的基本相同。</p>
      <p>为了在已经相互验证的控制器133和近场通信设备135之间和/或近场通信设备135和141之间执行安全通信，控制器133发送三路安全通信命令和在步骤S853加密的数据(即，[数据])到近场通信设备135(步骤S855)。</p>
      <p>在三路安全通信的命令中，与在三方之间执行的命令有关的数据(即，命令数据)是被加密的。三路安全通信命令的种类包括指示在通信伙伴(例如，近场通信设备135或141)的存储区域内写入数据的写命令和指示读取在通信伙伴的存储区域中存储的数据的读命令，但不局限于此。</p>
      <p>当接收到从控制器133发送到近场通信设备141的三路安全通信命令时，近场通信设备135的分组加密/解密单元520用第一交易密钥解密该已加密数据[数据](步骤S856)。然后，分组加密/解密单元用在和近场通信设备141通信中有效的第二交易密钥对该已解密数据进行加密(步骤S857)。与第一交易密钥的情况一样，交易密钥1-2和2-2至少之一作为第二交易密钥用于加密/解密。</p>
      <p>近场通信设备135的通信单元512通过天线301无线地传送已加密数据[数据]和三路安全通信命令到近场通信设备141(步骤S858)，其中该数据[数据]已经被调制解调器305调制并使用第二交易密钥加密。</p>
      <p>在从近场通信设备135接收到三路安全通信命令和已加密数据[数据]时，近场通信设备141的IC控制单元(未示出)指示对已加密数据[数据]进行解密，以执行三路安全通信命令。</p>
      <p>响应于IC控制单元的解密命令，分组加密/解密单元用预设的第二交易密钥1-1和2-1至少之一对已加密数据[数据]进行解密(步骤S859)。</p>
      <p>然后，包括在近场通信设备141中的命令执行单元根据接收的命令执行处理(步骤S861)。例如，如果该已解密数据包含数据的读取地址，并且接收到的命令是指示根据读取地址读取数据的读命令，则该命令执行单元根据在已接收数据中指定的地址从存储单元的存储区域读出数据。然而，该命令并不局限于该特定示例。</p>
      <p>然后，为了向控制器133通知命令执行单元的执行结果，通过天线301无线地传送指示执行结果的数据(步骤S863)。执行结果的种类可包括存储在预定读取地址中的数据内容和指示写入操作结果(例如成功/错误)的信息，但不局限于此。另外如果需要，可用第二交易密钥加密该执行结果。</p>
      <p>在通过天线301无线地接收到从近场通信设备141传送到控制器133的执行结果时，近场通信设备135使用调制解调器305解调该执行结果。然后，近场通信设备135传送执行结果到控制器133(步骤S865)。</p>
      <p>另一方面，当控制器133在近场通信设备135中写入/读取数据时，控制器133的分组加密/解密单元首先使用第一交易密钥的交易密钥1-1和2-1至少之一作为加密/解密密钥来加密该数据(步骤S867)。已加密数据可包含从其读出数据的通信伙伴内存储区域中的地址、和将要写入通信伙伴的存储区域中预定地址内的数据，但是不局限于此。</p>
      <p>为了在已经相互验证的控制器133和近场通信设备135之间执行安全通信，然后，控制器133发送三路安全通信命令和在步骤S867加密的已加密数据(即，[数据])到近场通信设备135(步骤S869)。</p>
      <p>当接收到从控制器133到近场通信设备135的三路安全通信命令时，近场通信设备135的分组加密/解密单元520用第一交易密钥解密已加密的数据[数据](步骤S871)。</p>
      <p>然后，包括在近场通信设备135中的命令执行单元523根据从控制器133接收的命令来执行处理(步骤S873)。例如，如果已解密的数据包含数据的读取地址，并且接收到的命令是指示根据读取地址读取数据的读命令，则该命令执行单元523根据在该接收数据中指定的地址从存储单元的存储区域读出数据。然而，该命令并不局限于该特定示例。</p>
      <p>然后，为了向控制器133通知命令执行单元523的执行结果，发送指示执行结果的数据到控制器133(步骤S875)。例如，在接收到该执行结果时，控制器133在移动终端101的显示器上显示存储在近场通信设备135的存储区域111中的价值信息的余额。</p>
      <p>这是对涉及根据该实施例的三路安全通信方法中的系列步骤描述的结束。例如，上述的三路安全通信方法允许控制器133获得在近场通信设备135或141中保存的价值信息的余额信息，并在用户要求控制器133显示存储在移动终端101和外部移动终端104至少之一中的余额信息时而在移动终端101显示单元上显示该信息。如果当控制器133获得该余额信息等时相互验证已经完成，则该三路安全通信方法允许控制器133从近场通信设备135和141集中获得信息，因此能够显著地提高处理效率。</p>
      <p>另外，在三路安全通信中将近场通信设备135放置在控制器133和外部设备(例如，外部移动终端104)之间，允许近场通信设备135处理从控制器133发送的数据并将已处理的数据发送到近场通信设备141。例如，当在控制器133和包括在外部终端104中的近场通信设备141之间执行数据通信时，近场通信设备135可以在从控制器133发送的数据中附加保存在近场通信设备135内的其它价值信息，例如息票信息。这样的配置允许各种通信伙伴。另外，上述配置简化了需要多个交易的通信处理，从而提供更有效的通信处理。</p>
      <p>(状态转换)现在，将参考图10来描述根据本发明实施例的数据通信中的状态以及状态转换。图10是示出根据该实施例的数据通信中状态和状态转换的概要的说明图。</p>
      <p>如图10所示，根据该实施例的数据通信中有三种状态(即，状态0-2)。可执行命令根据每种状态而不同。</p>
      <p>在每种状态上的可执行命令和当前状态在执行该命令之后转换到的状态用图10中示出的状态转换模式(1)-(8)表示。例如，状态转换模式“(1)0→0”表示当前的状态为状态0，并在执行模式(1)中列出的命令之后的转换后状态仍然是状态0。如图10所示，属于模式(1)的命令包括例如两路安全通信命令、RF输出开始命令、RF输出终止命令、当前状态请求命令和复位命令。</p>
      <p>另外，如图10所示，属于模式(2)的命令包括例如两路安全通信命令、相互验证请求命令、RF输出开始命令、RF输出终止命令和当前状态请求命令。</p>
      <p>如图10所示，属于模式(3)的命令包括例如两路安全通信命令、相互验证请求命令、三路安全通信命令、RF输出开始命令、RF输出终止命令、当前状态请求命令、和外部设备相互验证执行命令。</p>
      <p>如图10所示，属于模式(4)的命令包括例如相互验证请求命令。如图10所示，属于模式(5)的命令包括例如相互验证响应命令。另外，如图10所示，属于模式(6)的命令包括例如相互验证请求命令。</p>
      <p>此外，属于模式(7)和(8)的命令包括例如复位命令。</p>
      <p>当从控制器133等设备上接收到要执行的命令时，IC控制单元307确定该命令在当前状态下是否可执行。当IC控制单元307确定该命令不可执行时，IC控制单元307改变当前状态以便使该命令可执行。</p>
      <p>例如，当状态1下从控制器133接收到相互验证请求命令时，IC控制单元307确定接收的命令在当前状态(即，状态1)是可执行的。</p>
      <p>另外，例如当在状态1下从控制器133接收到三路安全通信命令时，IC控制单元307确定该命令不可执行。IC控制单元307将当前状态从状态1改变到状态2以便使该命令可执行。当正在将状态改变到状态(2)时，除非相互验证单元516完成了相互验证，IC控制单元307不会将状态从状态1改变到状态2。</p>
      <p>当前状态存储在例如IC控制单元307中包括的RAM和存储单元313中。状态转换模式(转换模块)和在每个状态中可执行命令的列表存储在例如在IC控制单元307中包括的ROM和存储单元313中。</p>
      <p>例如，图10所示的那些命令中的当前状态请求命令的执行允许控制器133等设备获得(识别出)近场通信设备135的当前状态。另外，复位命令的执行使当前状态进入状态0。</p>
      <p>根据近场通信设备135的相互验证的完成和未完成来分类图10所示的状态。在状态0中不执行相互验证。在状态1中正在执行相互验证。在状态2中已经完成了相互验证。</p>
      <p>因此，具体地，因为三路安全通信要求对近场通信设备135的相互验证，所以三路安全通信命令在状态0和1中不可执行而仅仅在状态2中可执行。</p>
      <p>在上面给出的描述中，结合相互验证将根据该实施例的状态分类为三种状态。然而，状态的分类不局限于该特定示例。例如，结合处理负荷或处理负荷和相互验证的组合而将状态分类为一种或多种状态。例如，当使用处理负荷时，状态0表示应用高处理负荷的状态，并且可执行命令在状态0高度受限。状态1表示应用中等处理负荷的状态，并且除了那些应用高处理负荷之外的命令在状态1是可执行的。另外，状态2表示应用低处理负荷的状态，并且所有的命令在状态2都是可执行的。</p>
      <p>例如，近场通信设备135可能不确认，分组加密/解密单元520是否持有交易密钥以确定三路安全通信命令是否可执行。IC控制单元307通过参考IC控制单元307管理的当前状态可容易地确定三路通信命令是否可执行。</p>
      <p>上面描述的系列处理步骤可以通过专门的硬件或软件来执行。当这些系列处理步骤由软件执行时，构成该软件的程序被安装在信息处理装置(例如，通用计算机和微计算机)中，并促使该信息处理装置起起移动终端101的作用。</p>
      <p>这些程序可以预先存储在作为包括在计算机中存储介质的硬盘驱动(HDD)和ROM中。</p>
      <p>另外，这些程序还可以暂时地或永久地存储(记录)在可移动记录介质中，例如HDD、软盘、CD-ROM(只读存储光盘)、MO(磁光)盘、DVD(数字通用盘)、磁盘、半导体存储器。这样的可移动记录介质可以作为所谓的“软件包”而提供。</p>
      <p>另外，这些程序可以从上述的可移动记录介质安装到计算机中。这些程序还可以从网站下载到计算机中，通过用于数字卫星广播的人造卫星转送到计算机、通过诸如带有电缆的LAN(局域网)和互联网之类的网络转送到计算机。计算机可以接收以这种方式转送给它的程序，并将程序安装在硬盘驱动器内。</p>
      <p>在本说明书中，在促使计算机执行各种处理的程序中描述的步骤包括按照作为流程描述的次序顺序地执行的处理，还包括不需要顺序执行而是并行或单独执行的处理(例如，并行处理或根据对象执行的处理)。</p>
      <p>另外，单独的计算机可以处理该程序，或可通过使用多个计算机而在程序上执行分布处理。</p>
      <p>虽然已经参考附图描述了本发明的实施例，但是应该指出本发明并不局限于这些特定实施例。对本领域的技术人员来说，在不脱离所附权利要求限定的本发明的技术精神和范围的情况下做出各种修改和应用是显而易见的。应当理解那些修改和应用也属于本发明技术精神和范围。</p>
      <p>在上述实施例中，例如已经给出了对如下情况的描述，当在近场通信设备135和141之间执行相互验证时，合成密钥A和B是根据外部设备访问服务密钥和其他密钥而生成的。然而，本发明并不局限于该特定示例。例如，合成密钥A和B可以仅仅根据外部设备访问服务密钥来生成。可选地，外部设备访问服务密钥可以设置为合成密钥A和B。可以用这种方式执行近场通信设备135和141之间的相互验证。</p>
      <p>另外，在上述实施例中，例如已经给出了对如下情况的描述，在包括在移动终端101中的控制器133或近场通信设备135与包括在外部移动终端104中的近场通信设备141之间执行数据通信。然而本发明并不局限于该特定示例。例如，可以以与外部移动终端104执行的数据通信一样的方式，通过读出器/写入器103在控制器133或近场通信设备135与信息处理设备105之间，以及在控制器133或近场通信设备135与读出器/写入器103之间执行数据通信。读出器/写入器103可包括具有存储区域的存储单元，其中可存储一个或多个服务密钥和区域密钥。</p>
      <p>此外，在上述实施例中，密钥A和B可以被预先生成并存储在存储区域111中，还可以在执行相互验证的任意时间生成，或可以以其他方式处理。</p>
      <p>上面已经描述了在近场通信设备135中包括的每以个功能模块。可在近场通信设备135中构成每个功能模块(通信单元512、合成密钥生成单元514、相互验证单元516、随机数生成单元518、分组加密/解密单元520、密钥设置单元522、命令执行单元523、和存储区域111中至少之一)，作为具有相应功能的硬件。可选地，每个功能模块可以由存储在存储单元313等单元中的程序构成，以可执行方式促使计算机实现每个功能。</p>
    </mode-for-invention>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101419657B?cl=zh">CN101419657B</a></td><td class="patent-data-table-td patent-date-value">2008年10月17日</td><td class="patent-data-table-td patent-date-value">2013年3月20日</td><td class="patent-data-table-td ">英赛康特雷斯公司</td><td class="patent-data-table-td ">安全个人化近场通信芯片组的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101442739B?cl=zh">CN101442739B</a></td><td class="patent-data-table-td patent-date-value">2007年11月20日</td><td class="patent-data-table-td patent-date-value">2011年1月19日</td><td class="patent-data-table-td ">展讯通信（上海）有限公司</td><td class="patent-data-table-td ">一种保护at指令的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101464932B?cl=zh">CN101464932B</a></td><td class="patent-data-table-td patent-date-value">2007年12月19日</td><td class="patent-data-table-td patent-date-value">2012年8月22日</td><td class="patent-data-table-td ">联想(北京)有限公司</td><td class="patent-data-table-td ">硬件安全单元间协作方法、系统及其应用设备</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103051361A?cl=zh">CN103051361A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年1月5日</td><td class="patent-data-table-td patent-date-value">2013年4月17日</td><td class="patent-data-table-td ">深圳市中兴移动通信有限公司</td><td class="patent-data-table-td ">近距离通信系统及其移动终端、连接方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103051361B?cl=zh">CN103051361B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年1月5日</td><td class="patent-data-table-td patent-date-value">2015年11月25日</td><td class="patent-data-table-td ">努比亚技术有限公司</td><td class="patent-data-table-td ">近距离通信系统及其移动终端、连接方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103139373B?cl=zh">CN103139373B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年11月23日</td><td class="patent-data-table-td patent-date-value">2015年8月19日</td><td class="patent-data-table-td ">黑莓有限公司</td><td class="patent-data-table-td ">提供安全单元数据管理特征的移动通信设备及相关方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103390140A?cl=zh">CN103390140A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年6月20日</td><td class="patent-data-table-td patent-date-value">2013年11月13日</td><td class="patent-data-table-td ">上海鼎为通讯电子有限公司</td><td class="patent-data-table-td ">一种移动终端以及其信息安全控制方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US9197293">US9197293</a></td><td class="patent-data-table-td patent-date-value">2012年9月12日</td><td class="patent-data-table-td patent-date-value">2015年11月24日</td><td class="patent-data-table-td ">Blackberry Limited</td><td class="patent-data-table-td ">Mobile communications device providing secure element data management features and related methods</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04B0005000000">H04B5/00</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04Q0007320000">H04Q7/32</a></span></td></tr><tr><td class="patent-data-table-td "> 合作分类</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G06Q20/3229">G06Q20/3229</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G06Q20/34">G06Q20/34</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L63/04">H04L63/04</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L2209/805">H04L2209/805</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G06F21/34">G06F21/34</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L9/0844">H04L9/0844</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L63/0428">H04L63/0428</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G06Q20/4093">G06Q20/4093</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L9/0894">H04L9/0894</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G06F2211/003">G06F2211/003</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L9/3273">H04L9/3273</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G06F21/45">G06F21/45</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=M8OGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G06F21/35">G06F21/35</a></span></td></tr><tr><td class="patent-data-table-td "> 欧洲专利分类号</td><td class="patent-data-table-td "><span class="nested-value">H04L9/32</span>, <span class="nested-value">H04L9/08</span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2007年9月5日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2007年10月31日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2010年11月10日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Granted</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/42de416a42756b0b71ea/CN101031113A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E7%A7%BB%E5%8A%A8%E7%BB%88%E7%AB%AF_%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E6%96%B9%E6%B3%95%E4%BB%A5%E5%8F%8A%E8%AE%A1.pdf?id=M8OGAAABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U2Z7sXa1wRPV1-XK2BP2pgKBQhIFQ"},"sample_url":"https://www.google.com/patents/reader?id=M8OGAAABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>