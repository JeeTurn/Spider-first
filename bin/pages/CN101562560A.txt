<!DOCTYPE html><html><head><title>专利 CN101562560A - 一种通用流量控制方法及系统 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_50a6672b5f82ffbd39b7a9e87fd4594c/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_50a6672b5f82ffbd39b7a9e87fd4594c__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种通用流量控制方法及系统"><meta name="DC.contributor" content="孙海波" scheme="inventor"><meta name="DC.contributor" content="博 李" scheme="inventor"><meta name="DC.contributor" content="杨海青" scheme="inventor"><meta name="DC.contributor" content="斌 胡" scheme="inventor"><meta name="DC.contributor" content="骆拥政" scheme="inventor"><meta name="DC.contributor" content="北京启明星辰信息技术股份有限公司" scheme="assignee"><meta name="DC.date" content="2008-4-18" scheme="dateSubmitted"><meta name="DC.description" content="本发明涉及一种通用的对网络应用流量进行自动控制的方法及系统。本发明包括网络应用特征库、网络应用识别器、策略规则库、信息提取器及流量控制策略实施装置。运行包括以下步骤：网络应用识别步骤、相关信息提取步骤及流量控制策略实施步骤。本发明解决了传统产品中对于网络应用流量控制缺乏灵活性的问题，实现了在实际网络环境中实时的根据不同的规则进行相应流量控制的策略，可以按照实际用户网络状况需要制定适当的流量管理策略并加以实施，同时具有速度快和准确率高等优点。"><meta name="DC.date" content="2009-10-21"><meta name="citation_patent_publication_number" content="CN:101562560:A"><meta name="citation_patent_application_number" content="CN:200810104371"><link rel="canonical" href="https://www.google.com/patents/CN101562560A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101562560A?cl=zh"/><meta name="title" content="专利 CN101562560A - 一种通用流量控制方法及系统"/><meta name="description" content="本发明涉及一种通用的对网络应用流量进行自动控制的方法及系统。本发明包括网络应用特征库、网络应用识别器、策略规则库、信息提取器及流量控制策略实施装置。运行包括以下步骤：网络应用识别步骤、相关信息提取步骤及流量控制策略实施步骤。本发明解决了传统产品中对于网络应用流量控制缺乏灵活性的问题，实现了在实际网络环境中实时的根据不同的规则进行相应流量控制的策略，可以按照实际用户网络状况需要制定适当的流量管理策略并加以实施，同时具有速度快和准确率高等优点。"/><meta property="og:title" content="专利 CN101562560A - 一种通用流量控制方法及系统"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101562560A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101562560A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=TEJ0BwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101562560A&amp;usg=AFQjCNHRuf6ZYvPoXT2u_4_cQ2_j4Y8EtA" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/2806d8c4c167ad7fa9cb/CN101562560A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/2806d8c4c167ad7fa9cb/CN101562560A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101562560A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101562560A?cl=en&amp;hl=zh-CN"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101562560A?cl=zh" style="display:none"><span itemprop="description">本发明涉及一种通用的对网络应用流量进行自动控制的方法及系统。本发明包括网络应用特征库、网络应用识别器、策略规则库、信息提取器及流量控制策略实施装置。运行包括以下步骤：网络应用识别步骤、相关信息提取步骤...</span><span itemprop="url">https://www.google.com/patents/CN101562560A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101562560A - 一种通用流量控制方法及系统</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101562560A - 一种通用流量控制方法及系统" title="专利 CN101562560A - 一种通用流量控制方法及系统"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101562560 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200810104371</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2009年10月21日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2008年4月18日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2008年4月18日</td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200810104371.9, </span><span class="patent-bibdata-value">CN 101562560 A, </span><span class="patent-bibdata-value">CN 101562560A, </span><span class="patent-bibdata-value">CN 200810104371, </span><span class="patent-bibdata-value">CN-A-101562560, </span><span class="patent-bibdata-value">CN101562560 A, </span><span class="patent-bibdata-value">CN101562560A, </span><span class="patent-bibdata-value">CN200810104371, </span><span class="patent-bibdata-value">CN200810104371.9</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%AD%99%E6%B5%B7%E6%B3%A2%22">孙海波</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%8D%9A+%E6%9D%8E%22">博 李</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%9D%A8%E6%B5%B7%E9%9D%92%22">杨海青</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%96%8C+%E8%83%A1%22">斌 胡</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%AA%86%E6%8B%A5%E6%94%BF%22">骆拥政</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E5%8C%97%E4%BA%AC%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">北京启明星辰信息技术股份有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101562560A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101562560A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101562560A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (8),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (2),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=TEJ0BwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200810104371&amp;usg=AFQjCNFRQ68aYaM7nNeUFd8KPKzxrASctA"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=TEJ0BwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101562560A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNHh_HfBGrJfKx65RMHBmd7Z9GLelw"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT86538112" lang="ZH" load-source="patent-office">一种通用流量控制方法及系统</invention-title>
      </span><br><span class="patent-number">CN 101562560 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA62828194" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明涉及一种通用的对网络应用流量进行自动控制的方法及系统。本发明包括网络应用特征库、网络应用识别器、策略规则库、信息提取器及流量控制策略实施装置。运行包括以下步骤：网络应用识别步骤、相关信息提取步骤及流量控制策略实施步骤。本发明解决了传统产品中对于网络应用流量控制缺乏灵活性的问题，实现了在实际网络环境中实时的根据不同的规则进行相应流量控制的策略，可以按照实际用户网络状况需要制定适当的流量管理策略并加以实施，同时具有速度快和准确率高等优点。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(8)</span></span></div><div class="patent-text"><div mxw-id="PCLM23405207" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.一种通用流量控制方法，其特征在于包含以下步骤：    网络应用识别步骤；    相关信息提取步骤；    流量控制策略实施步骤。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2. 根据权利要求1所述的一种通用流量控制方法，其特征在于所述的网络 应用识别步骤具有如下特征：以层次化的数据包协议分析方法依据实际捕获的数据报文及预先设定的各 种网络应用具有的不同特征对当前才艮文进行网络应用的识&#21029;。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3. 根据权利要求2所述的一种通用流量控制方法，其特征在于所述的网络 应用识别步骤具有如下特征：以实际捕获的网络报文为样本、根据各种网络应用过程中使用的协议格式 对数据报文进行解析并且依赖该网络应用通信过程当中传输的数据"R文当中具 有才艮文特征或行为特征进行网络应用类型的识别。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4. 根据权利要求1所述的一种通用流量控制方法，其特征在于所述的相关 信息提取步骤具有如下特征：依据策略规则库中预先设定网络应用控制规则对网络应用识别步骤提供的 识别结果进行检查，并在依据控制规则过滤出的数据报文当中提取相关信息以 供策略实施使用。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5. 根据权利要求4所述的一种通用流量控制方法，其特征在于所述的相关 信息提取步骤具有如下特征：以网络应用识别步骤提供的已识别的网络应用报文为样本，以策略规则库当中存储的实际检测为模式，首先进行匹配以确定当前网络环境中的应用是否 为策略允许范围内的应用，对于策略不允许或必须进行限制的应用可视作非正 常网络应用。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6. 根据权利要求1所述的一种通用流量控制方法，其特征在于所述的流量控制策略实施步骤，具有如下特征：依据相关信息提取步骤提供的信息依据相应的网络流量控制策略进行网络 应用流量控制。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7. 根据权利要求6所述的一种通用流量控制方法，其特征在于所述的流量 控制策略实施步骤，具有如下特征：在接收到信息提取阶段提供的当前网络中的非正常应用信息的时候，依据 预先设定的流量控制策略进行策略的实施。</div>
    </div>
    </div> <div class="claim"> <div num="8" class="claim">
      <div class="claim-text">8. &#8212;种通用流量控制系统，其特征在于包括：网络应用特征库、网络应用 识别器、策略规则库、信息提取器及流量控制策略实施装置；存储用于识别不同网络应用的特征的网络应用特征库、负责依据数据报文 进行网络应用识别的网络应用识别器、存储当前网络应用黑名单或白名单用以 区分网络应用是否允许规则的策略规则库、依据策略规则库中设定的规则及当 前网络应用报文进行比对并提取相关信息的信息提取器以及实时的根据信息提 取器4是供的信息进行网络流量策略实施的策略实施装置；所述的网络应用特征库与网络应用识别器连4妄；所述的网络应用识别器和 策略规则库与信息提取器连接；所述的信息提取器与策略实施装置连接。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES28359576" lang="ZH" load-source="patent-office" class="description">
    <p>一种通用流量控制方法及系统</p>
    <p>技术领域</p>
    <p>本发明涉及一种用于在网络应用过程中进行流量控制的方法及系统，是一 种可用于网络管理产品及审计产品中的方法及系统，属于网络技术领域。 背景技术</p>
    <p>网络管理系统是目前应用日益广泛的作为网络安全防护的重要手段，它通 常配置在网关通过对网络内部整体架构及应用的配置以达到最优的网络使用效 率。它实现了当前网络运行状态的监控及策略调整，使网络业务得以顺利正常 的运行，避免网络资源的滥用及浪费，保障网络系统的正常运营，是企业实现</p>
    <p>IT管理和控制的有效方法。随着网络的发展目前的网络环境当中出现了越来越 多的新型应用，而这些应用往往会占用大量的网络带宽或其他资源使得某些正 常的网络业务不可用。例如目前大量涌现的各类P2P类下载、网络电视流媒体 播放等等，这些应用在使用过程中会占用大量的带宽，造成普通的http、 ftp 等服务不可用。从网络资源的共享角度来看这些应用的网络结构是非常先进的 必将有着很好的发展前景，它能够提高网络资源的利用率，提高资源共享率， 是未来网络发展的一大趋势。但是由于缺乏统一的标准和使用规范，这些新的 应用的出现也带来很多的弊端。这主要体现在对于网络资源的滥用严重影响其 他正常网络业务的使用，同时随着网络技术的发展，这些应用越来越多的使用 了加密技术，如BT、 emule等，这使得完全的阻断其使用变得非常困难，因此 需要用合理的网络应用控制策略来规范各种网络应用的合理使用。</p>
    <p>随着P2P下载、网络电视流媒体播放等新型应用带来的弊端日益严重，很多的网络安全产品使用了不同的措施希望对于各种网络应用加以规范化的限 制。其中流量控制是应用较为普遍的方法。但是目前的网络管理产品对于网络 应用流量的控制采用的策略非常单一，例如采用单一的连接数限制、为各个用 户分配固定的带宽或者采用了协议解析加特征匹配的方式在网络环境中对特定 应用采取硬性阻断等等。这种单一的管理策略虽然实施简单，但是也面临很多 的问题。首先单一的阻断并不利于网络的发展并且随着加密等技术的发展单一 的阻断技术变得越来越不可行。此外，单一的采用连接数或带宽的限制有时又 会给网络的正常使用带来影响造成网络资源利用的不合理。这些缺点的产生主 要是由于控制策略过于单一，无法区分正常使用及异常使用流量造成。因此有 必要发展一种能够实现对网络应用流量进行合理化控制的方法以提高网络系统 对于资源的合理分配，尽量保证网络正常业务的使用及网络资源的最大利用。 发明内容</p>
    <p>本发明提出 一种通用流量控制方法及系统，所述的通用流量控制技术可以</p>
    <p>满足：在实际网络应用过程当中实时对网络环境中的各种网络应用报文进行识 别并根据预先设置的控制策略检查当前网络应用中是否包含非正常的应用，在 发现有非正常使用的情况下根据预先设定的流量控制策略对这些非正常的应用 实施流量控制。既可以保证其他正常网络业务的使用，也可以在流量情况允许 的情况下对一些非正常的网络应用流量加以控制以避免网络资源的浪费，提高 了网络管理系统对于网络应用流量管理的灵活性。</p>
    <p>本发明的目的是这样实现的， 一种通用流量控制系统，包括：网络应用特</p>
    <p>征库、网络应用识别器、策略规则库、信息提取器及流量控制策略实施装置。 其中：</p>
    <p>存^f渚用于识别不同网络应用的特征的网络应用特征库；负责依据数据报文进行网络应用识别的网络应用识别器；</p>
    <p>存储当前网络应用黑名单或白名单用以区分网络应用是否允许及相应提取</p>
    <p>规则的策略规则库；</p>
    <p>依据策略规则库中设定的规则及当前网络应用报文进行比对并提取相关信 息的信息提取器；</p>
    <p>实时的根据信息提取器提供的信息进行网络流量策略实施的策略实施装置。</p>
    <p>一种通用流量控制方法及系统，包含以下步骤：</p>
    <p>网络应用识别步骤； 相关信息提取步骤； 流量控制策略实施步骤。</p>
    <p>本发明的产生的有益效果是：针对网络发展出现的大量新型应用，设计了灵 活的网络应用流量控制策略，同时解决了传统网络流量管理中对于网络流量管 理缺乏灵活性，单纯的进行阻断或实施单一策略带来的各种不足。从整个当前 网络环境的流量状况出发，以网络应用识别为基础，针对不同的实际环境需要 动态的制定流量控制策略，并且在策略实施过程中根据不同的非正常应用情况 也提供了不同的策略实施方式。尽可能的保证不同网络环境当中正常网络业务 的进行，避免网络资源的浪费。同时网络管理系统或网络管理人员可以依据实 际网络状况灵活的设置当前环境的网络流量控制策略，具有很好的实施灵活性 和适用性，可广泛应用网络产品中。 附图说明</p>
    <p>图1是通用流量控制系统架构图；</p>
    <p>图2是通用流量控制系统的工作流程图。</p>
    <p>下面结合附图和实施例对本发明作进一步说明。具体实施方式</p>
    <p>实施例一：</p>
    <p>本实施例为 一种通用的网络应用过程中进行动态流量控制的方法及系统的 基本^f莫式，其基本架构如图1所示。包括网络应用特征库、网络应用识别器、 策略一见则库、信息提^l器及流量控制策略实施装置，系统工作流程如图2所示： 一种通用流量控制方法，包含以下步骤： 网络应用识别步骤； 相关信息提取步骤； 流量控制策略实施步骤。 其中：</p>
    <p>① 网络应用识别步骤。网络应用识别根据实际捕获的数据报文采用协议解 析技术进行层次化解析，并根据预先设定的各种网络应用的报文特征来识别当 前数据报文属于何种网络应用，识别结果作为相关信息提取步骤的对象。</p>
    <p>② 相关信息提取步骤。本步骤以网络应用识别步骤提供的已识别的数据报 文为样本，以策略规则库当中存储的实际规则为模式进行匹配。当发现当前不 被允许或受限制的网络应用时，由该网络应用的数据报文中提取相关信息提供 给策略实施装置进行具体控制或限制策略的实施。</p>
    <p>③ 流量控制策略实施步骤。流量控制策略实施步骤以相关信息提取步骤提 供的数据信息为依据，依靠预先设定的控制策略对当前网络当中的相关应用进 行流量控制。</p>
    <p>实施例二：</p>
    <p>本实施例为实施例 一 中的网络应用识别步骤的优选方案：以层次化的数据包协议分析方法依据实际捕获的数据报文及预先设定的各 种网络应用具有的不同特征对当前报文进行网络应用的识别。</p>
    <p>1) 本实施例的基本思路是：以实际捕获的网络报文为样本、根据各种网络应 用过程中使用的协议格式对数据报文进行解析并且依赖该网络应用通信过程当</p>
    <p>如："％13BitTorrent%20Protocol"可以标识BT协议或某种4吏用BT协i义的客户 端软件正在使用，可以用它来作为BT协议静态识别特征。又如网络电视流媒体 播放软件QQ直播在登录过程中具有这样的特征：使用TCP连接，TCP载荷部 分长度为24,载荷部分数据报文以"0200000018000000"开头。当匹配到这样 的报文特征，可以认为是QQ直播软件在进行登录行为。</p>
    <p>此外对于某些难以用单一报文静态特征进行网络应用识别的协议可以依据 其行为特征进行识别，以Oracle TNS协议为例可以i殳定如下：</p>
    <p>1) 客户端向服务器端发送01请求报文</p>
    <p>才艮据01请求报文的回复报文（02响应报文）可以判断客户端驱动类型</p>
    <p>2) 才艮据此后通信过程中如出现的不同命令号（如0376/0373或0351/0352) 对，可以判定该类型客户端下大致的驱动版本。</p>
    <p>3) 根据判断的驱动版本及实际控制数组的取值可验证后续报文的解析格式。 这样依据各种不同的网络应用具有的报文特征或行为特征就可以唯一的识</p>
    <p>别当前网络环境中正在进行的各种具体应用。 实施例三：</p>
    <p>本实施例为实施例一中的相关信息提取步骤的优选方案：</p>
    <p>依据策略规则库中预先设定网络应用控制规则对网络应用识别步骤提供的</p>
    <p>8识别结果进行检查，并在依据控制规则过滤出的数据报文当中提取相关信息以 供策略实施使用。</p>
    <p>本实施例的基本思路是：以网络应用识别步骤提供的已识别的网络应用报</p>
    <p>文为样本，以策略规则库当中存储的实际检测为模式首先进行匹配以确定当前 网络环境中的应用是否为策略允许范围内的应用，对于策略不允许或必须进行 限制的应用可视作非正常网络应用。这里的策略规则设置可以依据不同的网络</p>
    <p>环境或实际客户需求进行灵活的设置，例如对于正常的网络应用如http应用、 FTP应用可以视为合理的，无需进行任何控制和管理，对于P2P下载或流媒体播 放等占用带宽严重的应用可设置为必须进行限制的应用。由此产生白名单或黑 名单。其中对于每一种非正常的网络应用可以进一步设置具体的信息提取策略。 对于各种流々某体播放应用其为了保证播放的速度和画面的流畅通常采用UDP负 载，那么在其网络数据传输过程中都具有明显的标识。例如实施2中提到的QQ 直播在实际数据传输过程中使用的UDP报文具有明显特征：源端口和目的端口 大于1024,且载荷部分以FE开头并包含"0000或0101或0404"。对于这种业 务过程可明确识别的应用可i殳定^L则为提取四元组（源IP、目的IP、源端口、 目的端口）。此外对于某些应用过程无法准确识别的应用如迅雷，其数据传输过 程不包含明显特征，在使用过程中包括登录、检索、下载等多个行为过程，而 每一个行为其连接的目的IP及目的端口均不同，因此我们可以设定规则为在发 现任何应用数据报文当中包含迅雷特征时仅提取其源IP。类似的对于每一种网 络应用我们都可以根据预先设定的策略规则确定其在当前网络环境当中是否为 正常网络应用，对于非正常的网络应用也可以根据实际需要制定相应的信息提 取策略。最后这些提取出的信息将提供给策略实施装置进行具体策略的实施使用。</p>
    <p>实施例四：</p>
    <p>本实施例为实施例一中的流量控制策略实施步骤的优选方案： 依据相关信息提取步骤提供的信息依据相应的网络流量控制策略进行网络 应用流量控制。</p>
    <p>本实施例的基本思路是：在接收到信息提取阶段提供的当前网络中的非正常 应用信息的时候，依据预先设定的流量控制策略进行策略的实施。例如当前网 络环境中发现网络电视流媒体播放应用，既占用带宽有可能占用大量的工作时 间则可以设定为对于UDP的数据报文根据四元组采用包丢弃的方式进行阻断。 又如在当前网络环境中设定对于P2P下载行为必须进行流量限制的情况下发现 了 P2P下载使用，则可以在能够确定其业务行为的连接中（如BT、 emule等） 实施连接数的限制或连接传输速度的限制。而在对于某些不能够准确识别其业 务行为的P2P应用如迅雷时，可以根据信息提取阶段提供的源IP信息，对该IP 地址的全部连接数及各连接的传输速度进行限制。</p>
    <p>实施例五：</p>
    <p>本实施例是实现实施例一、二、三、四所述的方法的虚拟装置或者说系统， 系统如图1所示，本实施例包括：存储用于识别不同网络应用的特征的网络应 用特征库；负责依据数据报文进行网络应用识别的网络应用识别器；存储当前</p>
    <p>则库；依据策略规则库中设定的规则及当前网络应用报文进行比对并提取相关 信息的信息提取器；实时的根据信息提取器提供的信息进行网络流量策略实施 的策略实施装置。其中，网络应用识别器实现了如实施例二中所述的依据数据报文进行实际</p>
    <p>网络应用识别的功能；信息提取器实现了如实施例三中所述的依据策略规则库 中设定的规则及当前网络应用报文进行比对并提取相关信息的功能；策略规则 库存储了当前网络应用黑名单或白名单用以区分网络应用是否允许及相应提取 规则；策略实施装置实现了如实施例四所述的实时的根据信息提取器提供的信 息进行网络流量策略实施的功能。</p>
    <p>一种通用流量控制系统，包括：网络应用特征库、网络应用识别器、策略 规则库、信息提取器及流量控制策略实施装置。所述的网络应用特征库与网络 应用识别器连接；所述的网络应用识别器和策略规则库与信息提取器连接；所 述的信息提取器与策略实施装置连接。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101888337A?cl=zh">CN101888337A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年6月29日</td><td class="patent-data-table-td patent-date-value">2010年11月17日</td><td class="patent-data-table-td ">武汉绿色网络信息服务有限责任公司</td><td class="patent-data-table-td ">一种基于控制矩阵的网络实时流量控制方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101888337B?cl=zh">CN101888337B</a></td><td class="patent-data-table-td patent-date-value">2010年6月29日</td><td class="patent-data-table-td patent-date-value">2012年5月30日</td><td class="patent-data-table-td ">武汉绿色网络信息服务有限责任公司</td><td class="patent-data-table-td ">一种基于控制矩阵的网络实时流量控制方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102185841A?cl=zh">CN102185841A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年4月25日</td><td class="patent-data-table-td patent-date-value">2011年9月14日</td><td class="patent-data-table-td ">上海爱数软件有限公司</td><td class="patent-data-table-td ">一种分类数据传输方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102594675A?cl=zh">CN102594675A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年2月10日</td><td class="patent-data-table-td patent-date-value">2012年7月18日</td><td class="patent-data-table-td ">北京星网锐捷网络技术有限公司</td><td class="patent-data-table-td ">流量控制系统及方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102594675B?cl=zh">CN102594675B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年2月10日</td><td class="patent-data-table-td patent-date-value">2014年11月26日</td><td class="patent-data-table-td ">北京星网锐捷网络技术有限公司</td><td class="patent-data-table-td ">流量控制系统及方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103107948A?cl=zh">CN103107948A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年11月15日</td><td class="patent-data-table-td patent-date-value">2013年5月15日</td><td class="patent-data-table-td ">阿里巴巴集团控股有限公司</td><td class="patent-data-table-td ">一种流量控制方法和装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103107948B?cl=zh">CN103107948B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年11月15日</td><td class="patent-data-table-td patent-date-value">2016年2月3日</td><td class="patent-data-table-td ">阿里巴巴集团控股有限公司</td><td class="patent-data-table-td ">一种流量控制方法和装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103441947A?cl=zh">CN103441947A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年8月23日</td><td class="patent-data-table-td patent-date-value">2013年12月11日</td><td class="patent-data-table-td ">深信服网络科技（深圳）有限公司</td><td class="patent-data-table-td ">基于桌面虚拟化的流量控制方法及装置</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=TEJ0BwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0012813000">H04L12/813</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=TEJ0BwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029060000">H04L29/06</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2009年10月21日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2009年12月16日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年6月20日</td><td class="patent-data-table-td ">C02</td><td class="patent-data-table-td ">Deemed withdrawal of patent application after publication (patent law 2001)</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/2806d8c4c167ad7fa9cb/CN101562560A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_50a6672b5f82ffbd39b7a9e87fd4594c.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E9%80%9A%E7%94%A8%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E6%96%B9%E6%B3%95%E5%8F%8A%E7%B3%BB%E7%BB%9F.pdf?id=TEJ0BwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U2-a29a2y3ZTKv5yEd89EVbCoINmg"},"sample_url":"https://www.google.com/patents/reader?id=TEJ0BwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>