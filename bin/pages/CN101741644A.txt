<!DOCTYPE html><html><head><title>专利 CN101741644A - 流量检测方法及装置 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_50a6672b5f82ffbd39b7a9e87fd4594c/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_50a6672b5f82ffbd39b7a9e87fd4594c__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="流量检测方法及装置"><meta name="DC.contributor" content="米淑云" scheme="inventor"><meta name="DC.contributor" content="翟祥志" scheme="inventor"><meta name="DC.contributor" content="成都市华为赛门铁克科技有限公司" scheme="assignee"><meta name="DC.date" content="2009-12-16" scheme="dateSubmitted"><meta name="DC.description" content="本发明实施例涉及一种流量检测方法及装置，其中方法包括：对数据流进行特征检测，识别所述数据流的承载协议是否为指定协议；当识别结果为所述数据流的承载协议是指定协议时，查找所述数据流中的应用层信息；当查找得到的应用层信息与预先设置的应用类型匹配时，确定所述数据流为所述匹配得到的应用类型的流量。本发明实施例采用特征识别完成第一次匹配过程，通过查找数据流中的应用层信息，获取与应用层信息匹配的预先设置的应用类型，识别出数据流为匹配得到的应用类型的流量，完成第二次匹配过程。本实施例不依赖于端口来检测流量，提高了检测流量中的应用类型时的识别正确率，从而提高了网络流量精细化管理中对不同应用类型进行管理的准确性。"><meta name="DC.date" content="2010-6-16"><meta name="citation_patent_publication_number" content="CN:101741644:A"><meta name="citation_patent_application_number" content="CN:200910258047"><link rel="canonical" href="https://www.google.com/patents/CN101741644A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101741644A?cl=zh"/><meta name="title" content="专利 CN101741644A - 流量检测方法及装置"/><meta name="description" content="本发明实施例涉及一种流量检测方法及装置，其中方法包括：对数据流进行特征检测，识别所述数据流的承载协议是否为指定协议；当识别结果为所述数据流的承载协议是指定协议时，查找所述数据流中的应用层信息；当查找得到的应用层信息与预先设置的应用类型匹配时，确定所述数据流为所述匹配得到的应用类型的流量。本发明实施例采用特征识别完成第一次匹配过程，通过查找数据流中的应用层信息，获取与应用层信息匹配的预先设置的应用类型，识别出数据流为匹配得到的应用类型的流量，完成第二次匹配过程。本实施例不依赖于端口来检测流量，提高了检测流量中的应用类型时的识别正确率，从而提高了网络流量精细化管理中对不同应用类型进行管理的准确性。"/><meta property="og:title" content="专利 CN101741644A - 流量检测方法及装置"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101741644A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101741644A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=Dol-BwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101741644A&amp;usg=AFQjCNFGQt3OBpHJryHo8cpiedW2tyhMOA" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/94f01cbd1b79f6858ad2/CN101741644A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/94f01cbd1b79f6858ad2/CN101741644A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101741644A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101741644A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN101741644A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN101741644B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101741644A?cl=zh" style="display:none"><span itemprop="description">本发明实施例涉及一种流量检测方法及装置，其中方法包括：对数据流进行特征检测，识别所述数据流的承载协议是否为指定协议；当识别结果为所述数据流的承载协议是指定协议时，查找所述数据流中的应用层信息；当查找得...</span><span itemprop="url">https://www.google.com/patents/CN101741644A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101741644A - 流量检测方法及装置</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101741644A - 流量检测方法及装置" title="专利 CN101741644A - 流量检测方法及装置"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101741644 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200910258047</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2010年6月16日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2009年12月16日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2009年12月16日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101741644B?hl=zh-CN&amp;cl=zh">CN101741644B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200910258047.7, </span><span class="patent-bibdata-value">CN 101741644 A, </span><span class="patent-bibdata-value">CN 101741644A, </span><span class="patent-bibdata-value">CN 200910258047, </span><span class="patent-bibdata-value">CN-A-101741644, </span><span class="patent-bibdata-value">CN101741644 A, </span><span class="patent-bibdata-value">CN101741644A, </span><span class="patent-bibdata-value">CN200910258047, </span><span class="patent-bibdata-value">CN200910258047.7</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%B1%B3%E6%B7%91%E4%BA%91%22">米淑云</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%BF%9F%E7%A5%A5%E5%BF%97%22">翟祥志</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E6%88%90%E9%83%BD%E5%B8%82%E5%8D%8E%E4%B8%BA%E8%B5%9B%E9%97%A8%E9%93%81%E5%85%8B%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">成都市华为赛门铁克科技有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101741644A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101741644A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101741644A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (8),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (3),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (4)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=Dol-BwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200910258047&amp;usg=AFQjCNEj9KsENqz9JAS-nRBr0jfgncBOtQ"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=Dol-BwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101741644A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNFqZkjNpukuLWKtGRKRJBMt-E-7RQ"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT95935527" lang="ZH" load-source="patent-office">流量检测方法及装置</invention-title>
    </span><br><span class="patent-number">CN 101741644 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA78463111" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明实施例涉及一种流量检测方法及装置，其中方法包括：对数据流进行特征检测，识别所述数据流的承载协议是否为指定协议；当识别结果为所述数据流的承载协议是指定协议时，查找所述数据流中的应用层信息；当查找得到的应用层信息与预先设置的应用类型匹配时，确定所述数据流为所述匹配得到的应用类型的流量。本发明实施例采用特征识别完成第一次匹配过程，通过查找数据流中的应用层信息，获取与应用层信息匹配的预先设置的应用类型，识别出数据流为匹配得到的应用类型的流量，完成第二次匹配过程。本实施例不依赖于端口来检测流量，提高了检测流量中的应用类型时的识别正确率，从而提高了网络流量精细化管理中对不同应用类型进行管理的准确性。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(10)</span></span></div><div class="patent-text"><ol mxw-id="PCLM32050872" lang="ZH" load-source="patent-office" class="claims">
    <li class="claim"> <div num="1" class="claim">
      <div class="claim-text">一种流量检测方法，其特征在于包括：对数据流进行特征检测，识别所述数据流的承载协议是否为指定协议；当识别结果为所述数据流的承载协议是指定协议时，查找所述数据流中的应用层信息；当查找得到的应用层信息与预先设置的应用类型匹配时，确定所述数据流为匹配得到的应用类型的流量。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2. 根据权利要求1所述的流量检测方法，其特征在于，所述对数据流进行特征检测包括：对数据流中设定个数的报文进行特征检测； 或，对数据流中报文的头部或尾部进行特征检测； 或，对数据流中设定个数的报文的头部或尾部进行特征检测。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3. 根据权利要求2所述的流量检测方法，其特征在于，还包括：当对数据流中设定个数的报文进行特征检测或对数据流中设定个数的报文的头部或 尾部进行特征检测，没有检测出所述数据流的承载协议为指定协议时，确定所述数据流为 非指定协议的流量。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4. 根据权利要求1所述的流量检测方法，其特征在于，所述查找数据流中的应用层信 息包括：对所述数据流中设定个数的报文进行检测，查找所述报文的应用层信息； 或，对所述数据流的报文进行全包检测，查找所述报文中的应用层信息； 或，对所述数据流中设定个数的报文进行全包检测，查找所述报文中的应用层信息。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5. 根据权利要求4所述的流量检测方法，其特征在于，还包括：当查找得到的应用层信息与预先设置的应用类型不匹配时，确定所述数据流不是所述 预先设置的应用类型的流量。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6. 根据权利要求1所述的流量检测方法，其特征在于，所述当识别结果为所述数据流 的承载协议是指定协议时，查找所述数据流中的应用层信息，包括：当识别结果为所述数据流的承载协议是安全套接层协议时，查找所述数据流中的证书 授权信息中包含的服务器身份信息。</div>
    </div>
    </li> <li class="claim"> <div num="7" class="claim">
      <div class="claim-text">7. &#8212;种流量检测装置，其特征在于包括：特征检测模块，用于对数据流进行特征检测，识别所述数据流的承载协议是否为指定 协议；二次匹配模块，用于当识别出所述数据流的承载协议为指定协议时，查找所述数据流 中的应用层信息；当查找得到的应用层信息与预先设置的应用类型匹配时，确定所述数据 流为匹配得到的应用类型的流量。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8. 根据权利要求7所述的流量检测装置，其特征在于，所述特征检测模块具体用于： 对数据流中设定个数的报文进行特征检测，识别所述数据流的承载协议是否为指定协议；或，对数据流中报文的头部或尾部进行特征检测，识别所述数据流的承载协议是否为 指定协议；或，对数据流中设定个数的报文的头部或尾部进行特征检测，识别所述数据流的承载协议是否为指定协议。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9. 根据权利要求7所述的流量检测装置，其特征在于，所述二次匹配模块具体用于： 当识别出所述数据流的承载协议为指定协议时，对所述数据流中设定个数的报文进行检测，查找所述报文的应用层信息；当查找得到的应用层信息与预先设置的应用类型匹配 时，确定所述数据流为匹配得到的应用类型的流量；或，当识别出所述数据流的承载协议为指定协议时，对所述数据流的报文进行全包检 测，查找所述报文中的应用层信息；当查找得到的应用层信息与预先设置的应用类型匹配 时，确定所述数据流为匹配得到的应用类型的流量；或，当识别出所述数据流的承载协议为指定协议时，对所述数据流中设定个数的报文 进行全包检测，查找所述报文中的应用层信息；当查找得到的应用层信息与预先设置的应 用类型匹配时，确定所述数据流为匹配得到的应用类型的流量。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10. 根据权利要求7所述的流量检测装置，其特征在于，所述二次匹配模块具体用于： 当识别结果为所述数据流的承载协议是安全套接层协议时，查找所述数据流中的证书授权信息中包含的服务器身份信息；当查找得到的应用层信息与预先设置的应用类型匹配 时，确定所述数据流为匹配得到的应用类型的流量。</div>
    </div>
  </li> </ol>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES37417821" lang="ZH" load-source="patent-office" class="description">
    <p>流量检测方法及装置</p>
    <p>技术领域</p>
    <p>[0001 ]     本发明实施例涉及网络领域，尤其涉及一种流量检测方法及装置。</p>
    <p>背景技术</p>
    <p>[0002] 随着以传输控制协议（Transmission Control Protocol,简称：TCP) /因特网协议 (Internet Protocol,简称：IP)技术为基础的互联网的快速发展，各种网络新应用层出不 穷，其中以端到端（Peer to Peer，简称：P2P)禾P IP电话（Voice over IP，简称：VoIP)应用 最为突出。对于这两种业务，需要一种有效的方法对网络流量进行精细化管理，而流量管理 的前提是精准的流量检测。流量检测技术的目的是准确的识别网络中各种应用协议及软件 的流量，将网络流量的分类精确到协议级别。</p>
    <p>[0003] 现有技术提供了一种对采用安全套接层（Secure Socket Layer,简称：SSL)协议 的应用进行流量检测的方法，该方法也称为基于端口的检测方法，对数据流进行特征字识 别；若识别出该数据流采用了 SSL协议后，记录该数据流的源端口和目的端口等传输层数 据；如该数据流的源端口和目的端口与协议库中保存的某种应用协议或软件的端口匹配， 则确定数据流为该应用协议或软件的流量。</p>
    <p>[0004] 但发明人发现，该方法通过匹配传输层数据来识别数据流的应用软件或协议，依 赖于端口来检测流量，当应用协议或软件的端口不固定、或不同应用协议或软件使用的端 口相同时，采用该方法对P2P和VOIP等业务的网络流量进行检测，识别结果错误的概率较 高。</p>
    <p>发明内容</p>
    <p>[0005] 本发明实施例提供了一种流量检测方法及装置，用以在检测流量中的应用类型时 提高识别正确率，从而提高了网络流量精细化管理中对不同应用类型进行管理的准确性。 [0006]     本发明实施例提供的流量检测方法，包括：</p>
    <p>[0007]     对数据流进行特征检测，识别所述数据流的承载协议是否为指定协议；</p>
    <p>[0008] 当识别结果为所述数据流的承载协议是指定协议时，查找所述数据流中的应用层</p>
    <p>信息；</p>
    <p>[0009] 当查找得到的应用层信息与预先设置的应用类型匹配时，确定所述数据流为匹配 得到的应用类型的流量。</p>
    <p>[0010]     本发明实施例提供的流量检测装置，包括：</p>
    <p>[0011] 特征检测模块，用于对数据流进行特征检测，识别所述数据流的承载协议是否为 指定协议；</p>
    <p>[0012] 二次匹配模块，用于当识别出所述数据流的承载协议为指定协议时，查找所述数 据流中的应用层信息；当查找得到的应用层信息与预先设置的应用类型匹配时，确定所述 数据流为匹配得到的应用类型的流量。</p>
    <p>[0013] 本发明实施例采用特征识别完成第一次匹配过程，通过查找数据流中的应用层信</p>
    <p>4息，获取与应用层信息匹配的预先设置的应用类型，识别出数据流为匹配得到的应用类型 的流量，完成第二次匹配过程。本发明实施例通过应用层的类型信息检测流量中的具体应 用，提高了检测流量中的应用类型时的识别正确率，从而提高了网络流量精细化管理中对 不同应用类型进行管理的准确性。</p>
    <p>附图说明</p>
    <p>[0014] 为了更清楚地说明本发明实施例中的技术方案，下面将对实施例中所需要使用的 附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领 域普通技术人员来讲，在不付出创造性劳动的前提下，还可以根据这些附图获得其他的附 图。</p>
    <p>[0015] 图1为本发明实施例一流量检邻</p>
    <p>[0016] 图2为本发明实施例二流量检邻</p>
    <p>[0017] 图3为本发明实施例三流量检邻</p>
    <p>[0018] 图4为本发明实施例五流量检邻</p>
    <p>[0019] 图5为本发明实施例六流量检邻</p>
    <p>J方法的流程图 J方法的流程图 J方法的流程图 J装置的结构示意图 J装置的结构示意图,</p>
    <p>具体实施方式</p>
    <p>[0020] 下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完 整地描述，显然，所描述的实施例仅仅是本发明一部分实施例，而不是全部的实施例。基于 本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他 实施例，都属于本发明保护的范围。</p>
    <p>[0021] 图1为本发明实施例一流量检测方法的流程图。如图1所示，本实施例包括如下 步骤：</p>
    <p>[0022]     步骤101、对数据流进行特征检测，识别数据流的承载协议是否为指定协议； [0023] 步骤102、当识别结果为数据流的承载协议是指定协议时，查找数据流中的应用层 信息；</p>
    <p>[0024] 步骤103、当查找得到的应用层信息与预先设置的应用类型匹配时，确定数据流为 匹配得到的应用类型的流量。</p>
    <p>[0025] 本实施例的执行主体是深度包检测（De印Packet Inspection,简称：DPI)设备， 或者是具有DPI功能的网络设备。对于从网络上获取的数据流，首先采用特征识别进行第 一次匹配过程，该第一匹配过程得到的识别结果是数据流的承载协议是否为指定协议，比 如是TCP协议，或者是UDP协议，再或者是SSL协议。该识别结果作为中间状态，是第二次 匹配过程的触发条件。</p>
    <p>[0026] 第二次匹配过程只对承载协议为指定协议的数据流起作用，比如只对TCP协议承 载的数据进行。在这些指定承载协议的数据流中，如果查找到与预先设置的应用类型相匹 配的应用层信息时，比如P2P应用层信息或者VOIP应用层信息等等，则可以确定这一数据 流为匹配得到的应用类型的流量。</p>
    <p>[0027] 本实施例通过应用层的类型信息检测流量中的应用类型，提高了检测流量中的应 用类型时的识别正确率，从而提高了网络流量精细化管理中对不同应用类型进行管理的准确性。</p>
    <p>[0028] 在以下各个实施例中，以检测承载在SSL协议之上的应用软件流量为例进行说 明，即指定协议为SSL协议。在详细介绍以下各个实施例之前，首先说明SSL协议连接建 立过程。SSL协议建立连接时，首先客户端向服务器端发送"ClientHello"消息，服务器 端响应的第一条消息是"Serverifello"消息，这一组交互消息数据用于确认通信双方的加 密算法，此时加密密钥还未确立，这组交互消息数据为明文。然后，服务器端向客户端发 送"Certificate"消息，用于传递服务器端的证书授权（Certificate Authority，简称： CA)信息，该CA信息中包含服务器身份信息。后续过程中，客户端和服务器端还交互了 "ServerHelloDone"消息、"ClientKeyExchange"消息和"Finished"消息，从而完成SSL协 议连接建立过程。</p>
    <p>[0029] 图2为本发明实施例二流量检测方法的流程图。在执行本实施例的步骤之前，首 先给要检测的数据流分配一个节点，该节点用于保存数据流的五元组信息、识别结果、报文 个数、流量大小和二次匹配标记等节点信息。</p>
    <p>[0030]     如图2所示，以数据流的指定协议为SSL为例，本实施例包括如下步骤：</p>
    <p>[0031] 步骤201、传送数据流的报文，对数据流进行特征检测，识别该数据流的承载协议</p>
    <p>是否为SSL协议。本步骤为第一次匹配过程。</p>
    <p>[0032] 本步骤所检测的报文可以为"ClientHello"消息，即通过在"ClientHello"消息 中提取能标识SSL协议的特征字来识别数据流的承载协议是否为SSL协议。 [0033] 根据SSL报文的格式规定，"ClientHello"消息中能够提取特征字的字段为：握手 (handshake)消息类型、SSL协议版本号、消息长度、"ClientHello"消息类型。以VoIP软 件Teltel的报文为例，设其"ClientHello"消息中的一段应用层特征字数据为"16 03 01 00 53 01 00"，则其中"16"表示握手消息类型，"03 01"表示SSL协议版本号，"00 53"表 示消息长度，"Ol 00"表示ClientHello"消息类型。如果检测到上述特征字数据，则可以 识别数据流的承载协议为SSL协议。</p>
    <p>[0034] 进一步的，由于在数据流的报文中，特征字的字段一般分布在报文的头部或尾部， 所以在本步骤中，根据实际情况，可以只对数据流中的报文的头部或尾部进行特征检测；举 例来说，可以只检测报文的头部64字节或尾部64字节，即可完成识别。这样，在网络流量 较大的时候，大大的提高检测匹配的效率，提升检测设备的性能。</p>
    <p>[0035] 步骤202、当识别结果为数据流的承载协议为SSL协议时，将识别结果保存在该数 据流的节点信息中，并将节点信息中的二次匹配标记设置为需要进行二次匹配的标识。 [0036] 步骤203、传送二次匹配标记为需要进行二次匹配的标识的数据流的报文，查找该 数据流报文中的应用层信息。该报文可以为第一次匹配过程检测的报文的后续报文。 [0037] 本步骤所查找的后续报文可以为"Certificate"消息，查找数据流中的应用层信 息可以为：查找数据流中的CA信息中包含的服务器身份信息，也就是说，本步骤查找的应 用层信息可以为CA信息中包含的服务器身份信息。</p>
    <p>[0038] 由于包含服务器身份信息的CA信息可能在数据报文负载数据的中间部分出现， 所以本步骤中，可以对数据流的报文进行全包检测，查找报文中的应用层信息，而不仅限于 头部64字节或尾部64字节。这样有针对性的拓宽了匹配覆盖的范围，提高了识别率。 [0039] 步骤204、当查找得到的应用层信息与预先设置的应用类型匹配时，确定该数据流</p>
    <p>6为匹配得到的应用类型的流量。</p>
    <p>[0040] 查找得到的应用层信息与预先设置的应用类型匹配是指：查找出与应用层信息匹 配的预先设置的应用类型，进一步的，可以查找出与服务器身份信息匹配的预先设置的应 用类型。</p>
    <p>[0041] 上述步骤203和204为第二次匹配过程。</p>
    <p>[0042] 如果经过步骤201识别出数据流的承载协议不是SSL协议时，本实施例得出的识 别结果为该数据流为其他协议流量。</p>
    <p>[0043]     如果在步骤204中查找得到的应用层信息与预先设置的应用类型不匹配，即没有</p>
    <p>查找出与应用层信息匹配的预先设置的应用类型，本实施例确定该数据流不是预先设置的</p>
    <p>应用类型的流量，进一步的，得出的识别结果可以为该数据流为SSL协议流量。</p>
    <p>[0044] 本实施例提供了一种承载在SSL协议之上的应用软件流量的检测方法，其中采</p>
    <p>用特征识别对"ClientHello"消息进行检测完成第一次匹配过程，通过查找数据流中</p>
    <p>"Certificate"消息中的服务器身份信息，获取与服务器身份信息匹配的预先设置的应用</p>
    <p>类型，识别出数据流为匹配得到的应用类型的流量，完成第二次匹配过程。本实施例根据CA</p>
    <p>信息包含的服务器身份信息来匹配SSL协议的应用类型，不依赖于端口来检测流量，提高</p>
    <p>了检测流量中的应用类型时的识别正确率，从而提高了网络流量精细化管理中对不同应用</p>
    <p>类型进行管理的准确性。</p>
    <p>[0045] 图3为本发明实施例三流量检测方法的流程图。本实施例在上述实施例二的基础 上，可以预先设定检测的报文的个数，在第一次匹配过程中，对数据流中设定个数的报文进 行特征检测，本实施例中该设定个数为第一报文限制个数；在第二次匹配过程中，对数据流 中设定个数的报文进行检测，查找报文的应用层信息，本实施例中该设定个数为第二报文 限制个数。</p>
    <p>[0046]     如图3所示，本实施例包括如下步骤：</p>
    <p>[0047] 步骤301、从网络中获取数据流之后，依次将该数据流的报文进行传送，并进行特 征检测，判断是否得到与数据流的报文匹配的结果，若是，则执行步骤304 ;否则执行步骤 302。</p>
    <p>[0048] 本步骤中，可以首先查询节点信息中的二次匹配标记，如果二次匹配标记为"空"， 则将报文继续传送并进行特征检测。</p>
    <p>[0049] 步骤302、判断进行特征检测的该数据流的报文个数是否大于第一报文限制个数， 若是，则执行步骤303 ;否则执行步骤301。</p>
    <p>[0050]     上述步骤301中将数据流的一个报文进行特征检测，步骤302中判断出进行特征</p>
    <p>检测的报文总数没有超出第一报文限制个数，则跳转步骤301，然后将下一个报文进行特征</p>
    <p>检测。举例来说，设第一报文限制个数为16。由于本实施例中数据流的报文是依次进行处</p>
    <p>理的，通过本步骤使得本实施例特征检测只处理该数据流的前16个报文。</p>
    <p>[0051]     步骤303、识别出该数据流的承载协议不是SSL协议，即得到的识别结果为该数据</p>
    <p>流为非SSL协议流量。</p>
    <p>[0052]     本步骤中，对数据流中设定个数（可以为第一报文限制个数）的报文进行特征检</p>
    <p>测，没有检测出数据流的承载协议为SSL协议，则确定数据流为非指定协议的流量。</p>
    <p>[0053]     步骤304、进一步识别该数据流的承载协议是否为SSL协议，若是，则执行步骤305 ;否则执行步骤303。</p>
    <p>[0054]     本步骤的实现方式可以与步骤201相同。</p>
    <p>[0055] 步骤305、将识别结果保存在该数据流的节点信息中，并将节点信息中的二次匹配 标记设置为"真"，"真"是需要进行二次匹配的标识。</p>
    <p>[0056] 步骤306、依次传送二次匹配标记为"真"的数据流的报文，该报文为第一次匹配过</p>
    <p>程检测的报文的后续报文，查找后续报文中的服务器身份信息，并判断是否存在与该服务</p>
    <p>器身份信息匹配的预先设置的应用类型，若是，执行步骤309 ;否则执行步骤307。</p>
    <p>[0057] 本步骤中，查询节点信息中的二次匹配标记，二次匹配标记为"真"，所以将后续报</p>
    <p>文进行传送和处理。</p>
    <p>[0058] 步骤307、判断第二次匹配过程检测的该数据流的后续报文个数是否大于第二报 文限制个数，若是，则执行步骤308 ;否则执行步骤306。</p>
    <p>[0059] 上述步骤306中将一个报文进行二次匹配，步骤307中若判断出二次匹配的报文 总数没有超出第二报文限制个数，则跳转步骤306，将下一个报文进行二次匹配。举例来说， 设第二报文限制个数为3。对于某一个承载在SSL协议上的应用协议或软件，该应用协议或 软件的数据流经二次匹配处理的后续报文个数最多为3个，如果这3个报文均没有匹配成 功，则二次匹配处理过程完成，跳转步骤308。</p>
    <p>[0060] 对于不同的应用协议或软件，该预先配置的第二报文限制个数可以不同。</p>
    <p>[0061]     步骤308、识别出该数据流的承载协议是SSL协议，即得到的识别结果为该数据流</p>
    <p>为SSL协议流量。</p>
    <p>[0062] 本步骤中，通过对第二报文限制个数的报文进行检测，仍没查找到与该数据流服 务器身份信息匹配的预先设置的应用类型，即查找得到的应用层信息与预先设置的应用类 型不匹配，则确定该数据流不是预先设置的应用类型的流量，进一步的，得出的识别结果为 该数据流为SSL协议流量。</p>
    <p>[0063] 本步骤还可以包括：将该数据流的节点信息中的二次匹配标记修改为"假"，该数 据流的后续报文不再进行二次匹配过程。</p>
    <p>[0064] 步骤309、识别出该数据流的预先设置的应用类型，确定该数据流为匹配得到的应 用类型的流量。</p>
    <p>[0065] 进一步的，由于在数据流的报文中，特征字的字段一般分布在报文的头部或尾部， 所以在上述步骤301中，根据实际情况，可以只对数据流中设定个数的报文的头部或尾部 进行特征检测；举例来说，可以只检测设定个数的报文的头部64字节或尾部64字节，即可 完成识别。也可以对数据流中设定个数（可以为第一报文限制个数）的报文头部或尾部进 行特征检测，没有检测出数据流的承载协议为SSL协议，则确定数据流为非指定协议的流 量。这样在网络流量较大的时候，可以大大的提高检测匹配的效率，提升检测设备的性能。 [0066] 由于包含服务器身份信息的CA信息可能在数据报文负载数据的中间部分出现， 所以在上述步骤306中，二次匹配处理可以对数据流的设定个数的报文进行全包检测，查 找报文中的应用层信息，而不仅限于头部64字节或尾部64字节。这样有针对性的拓宽了 匹配覆盖的范围，提高了识别率。</p>
    <p>[0067] 本实施例提供了一种承载在SSL协议之上的应用软件流量的检测方法，其中采 用特征识别对"ClientHello"消息进行检测完成第一次匹配过程，通过查找数据流中</p>
    <p>8"Certificate"消息中的服务器身份信息，获取与服务器身份信息匹配的预先设置的应用类型，识别出数据流为匹配得到的应用类型的流量，完成第二次匹配过程。本实施例根据CA信息包含的服务器身份信息来匹配SSL协议的预先设置的应用类型，不依赖于端口来检测流量，提高了检测流量中的应用类型时的识别正确率，从而提高了网络流量精细化管理中对不同应用类型进行管理的准确性。进一步的，本实施例可以根据实际情况合理设定第一次匹配过程和第二次匹配过程中检测报文的个数，提高了处理的灵活性，在第一次匹配过程和第二次匹配过程中不会无限制的对数据流的每个报文都进行处理，提高了检测效率。[0068] 在上述实施例二和实施例三中，可以检测客户端发送的"ClientHello"消息完成第一次匹配过程，可以检测服务器端发送的"Certificate"消息完成第二次匹配过程。这两次匹配过程的报文分别来自于数据流的上行和下行，所以上述流量检测为双向数据流检</p>
    <p>[0069] 本发明实施例四还可以提供一种流量检测方法，适用于单向（下行）数据流检测。本实施例中，第一次匹配过程中所检测的报文为"ServerHe 11 o "消息。"ServerHe 11 o "消息中能够提取特征字的字段为：握手（handshake)消息类型、SSL协议版本号、消息长度、"ClientHello"消息类型。通过检测上述特征字的字段，可以识别数据流的承载协议是否为SSL协议。</p>
    <p>[0070] 由于待查找的CA信息可能和"ServerHello"消息在同一个数据报文中，所以在第二次匹配过程中，需要首先查找第一次匹配过程中检测的报文，然后再查找后续报文，也就是说，本实施例中查找的报文包括第一次匹配过程中检测的报文及其后续报文。本实施例的其他流程与上述实施例基本相同，在此不再赘述。</p>
    <p>[0071] 本实施例中，第一次匹配过程和第二次匹配过程中检测的报文均为下行报文，实现了下行单向数据流检测。</p>
    <p>[0072]     本发明实施例不仅限于基于SSL协议的流量检测，同样适用于其他与SSL协议类</p>
    <p>似的流量检测，例如：对于承载在超文本传输协议（Hyper TextTransfer Protocol，简称：</p>
    <p>HTTP)之上的应用软件的流量，在第一次匹配过程中，通过匹配HTTP的特征字，识别出数据</p>
    <p>流的承载协议为HTTP，在第二次匹配过程中，查找数据流中的应用层信息，获取与应用层信</p>
    <p>息匹配的预先设置的应用类型，识别出数据流为匹配得到的应用类型的流量。</p>
    <p>[0073] 本发明实施例提供的流量检测方法与其他的流量检测方法并不冲突，在某些环境</p>
    <p>下，可以结合其他的流量检测方法一起使用。</p>
    <p>[0074] 图4为本发明实施例五流量检测装置的结构示意图。如图4所示，本实施例包括：特征检测模块11和二次匹配模块12。其中：</p>
    <p>[0075] 特征检测模块ll，用于对数据流进行特征检测，识别数据流的承载协议是否为指定协议；</p>
    <p>[0076] 二次匹配模块12，用于当识别出数据流的承载协议为指定协议时，查找数据流中的应用层信息；当查找得到的应用层信息与预先设置的应用类型匹配时，确定数据流为匹配得到的应用类型的流量。</p>
    <p>[0077] 对于从网络上获取的数据流，首先特征检测模块11采用特征识别进行第一次匹配过程，该第一匹配过程得到的识别结果是数据流的承载协议是否为指定协议。该识别结果作为中间状态，是第二次匹配过程的触发条件；然后二次匹配模块12对承载协议为指定协议的数据流起作用，查找数据流的报文中的应用层信息；当获取与应用层信息匹配的预先设置的应用类型时，识别出数据流为匹配得到的应用类型的流量。</p>
    <p>[0078] 本实施例采用特征识别完成第一次匹配过程，通过查找数据流中的应用层信息，获取与应用层信息匹配的预先设置的应用类型，识别出数据流为匹配得到的应用类型的流量，完成第二次匹配过程。本实施例不依赖于端口来检测流量，提高了检测流量中的应用类型时的识别正确率，从而提高了网络流量精细化管理中对不同应用类型进行管理的准确性。</p>
    <p>[0079] 图5为本发明实施例六流量检测装置的结构示意图。如图5所示，本实施例在实施例五的基础上，进一步的，特征检测模块11可以用于对数据流的报文的头部或尾部进行特征检测，识别数据流的承载协议是否为指定协议。</p>
    <p>[0080] 二次匹配模块12可以用于当识别出数据流的承载协议为指定协议时，对数据流的报文进行全包检测，查找报文中的应用层信息；当查找得到的应用层信息与预先设置的应用类型匹配时，确定数据流为匹配得到的应用类型的流量。</p>
    <p>[0081]     特征检测模块11检测的报文的个数可以有所限制，特征检测模块11可以用于对</p>
    <p>数据流中设定个数的报文进行特征检测，识别数据流的承载协议是否为指定协议；进一步</p>
    <p>的，特征检测模块11也可以用于对数据流中设定个数的报文的头部或尾部进行特征检测，</p>
    <p>识别数据流的承载协议是否为指定协议。当特征检测模块11通过对设定个数的报文进行</p>
    <p>检测，没有检测出数据流的承载协议为指定协议时，识别出数据流为非指定协议的流量。</p>
    <p>[0082] 二次匹配模块12检测的报文的个数可以有所限制，二次匹配模块12可以用于当</p>
    <p>识别出数据流的承载协议为指定协议时，对数据流中设定个数的报文进行检测，查找报文</p>
    <p>的应用层信息；当查找得到的应用层信息与预先设置的应用类型匹配时，确定数据流为匹</p>
    <p>配得到的应用类型的流量；进一步的，二次匹配模块12也可以用于当识别出数据流的承载</p>
    <p>协议为指定协议时，对数据流中设定个数的报文进行全包检测，查找报文中的应用层信息；</p>
    <p>当查找得到的应用层信息与预先设置的应用类型匹配时，确定数据流为所述匹配得到的应</p>
    <p>用类型的流量。当二次匹配模块12通过对设定个数的报文进行检测，没有获取与应用层信</p>
    <p>息匹配的预先设置的应用类型时，识别出数据流不是预先设置的应用类型的流量。</p>
    <p>[0083] 再进一步，二次匹配模块可以用于当识别结果为数据流的承载协议是SSL协议</p>
    <p>时，查找数据流中的CA信息中包含的服务器身份信息；当查找得到的应用层信息与预先设</p>
    <p>置的应用类型匹配时，确定数据流为所述匹配得到的应用类型的流量。</p>
    <p>[0084]     特征检测模块11和二次匹配模块12的功能可以参见实施例二、三或四。</p>
    <p>[0085] 见图5，本实施例提供的流量检测装置还可以包括实现附加功能的模块，说明如</p>
    <p>下：</p>
    <p>[0086]     数据流维护模块13，用于在特征检测模块11识别出数据流的承载协议为指定协</p>
    <p>议时，将数据流的节点信息中的二次匹配标记设置为需要进行二次匹配的标识。</p>
    <p>[0087] 数据获取模块14，用于实时捕获网络上的数据流，并将数据流传送给预处理模块</p>
    <p>15进行处理；</p>
    <p>[0088] 预处理模块15，用于对数据流中的报文进行分层解析，取出报文的五元组信息和应用层信息，发送给数据流维护模块13进行处理；同时，还可以用于处理分片报文和一些异常报文。数据流维护模块13接收到数据流的报文后，分配一节点给该数据流，该节点用</p>
    <p>10于保存数据流的五元组信息、特征检测模块11和二次匹配模块12返回的识别结果、报文个数、流量大小和二次匹配标记等节点信息；并将报文发送给特征检测模块11或二次匹配模块12。</p>
    <p>[0089]     规则库加载模块16，用于加载特征识别规则库和二次匹配规则库，以供特征检测</p>
    <p>模块11和二次匹配模块12检测时使用。其中特征识别规则库主要包括第一次匹配过程</p>
    <p>中的策略信息，如用于第一次匹配的协议规则信息和第一报文限制个数等；二次匹配规则</p>
    <p>库主要包括第二次匹配过程中的策略信息，如所需查找的应用层信息和第二报文限制个数等。</p>
    <p>[0090] 流信息上报模块17，用于负责整理数据流维护模块13传递的识别结果，并上报识别结果到数据库模块19。</p>
    <p>[0091] 策略接受模块18，用于实时扫描并读取数据库模块19中的策略信息，下发给规则库加载模块16。</p>
    <p>[0092] 数据库模块19，用于存储数据流的识别结果和网页服务器模块20下发的策略信息，并为网页服务器模块20提供数据查询功能。</p>
    <p>[0093] 网页（如WEB)服务器模块20，为管理员使用流量检测装置提供图形界面接口，管理员可以在其提供的WEB页面上配置检测的策略信息，同时WEB页面也可以提供各种丰富的报表，管理员可以随时了解网络流量的检测信息。</p>
    <p>[0094] 本实施例采用特征识别完成第一次匹配过程，通过查找数据流中的应用层信息，获取与应用层信息匹配的预先设置的应用类型，识别出数据流为匹配得到的应用类型的流量，完成第二次匹配过程。本实施例不依赖于端口来检测流量，提高了检测流量中的应用类型时的识别正确率，从而提高了网络流量精细化管理中对不同应用类型进行管理的准确性。</p>
    <p>[0095] 本领域普通技术人员可以理解：实现上述方法实施例的全部或部分步骤可以通过程序指令相关的硬件来完成，前述的程序可以存储于一计算机可读取存储介质中，该程序在执行时，执行包括上述方法实施例的步骤，而前述的存储介质包括：ROM、 RAM、磁碟或者光盘等各种可以存储程序代码的介质。</p>
    <p>[0096] 最后应说明的是：以上实施例仅用以说明本发明实施例的技术方案，而非对其限制；尽管参照前述实施例对本发明实施例进行了详细的说明，本领域的普通技术人员应当理解：其依然可以对前述各实施例所记载的技术方案进行修改，或者对其中部分技术特征进行等同替换；而这些修改或者替换，并不使相应技术方案的本质脱离本发明实施例各实施例技术方案的精神和范围。</p>
    <p>11</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102546548A?cl=zh">CN102546548A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年12月22日</td><td class="patent-data-table-td patent-date-value">2012年7月4日</td><td class="patent-data-table-td ">中兴通讯股份有限公司</td><td class="patent-data-table-td ">一种分层协议的识别方法和装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102546548B?cl=zh">CN102546548B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年12月22日</td><td class="patent-data-table-td patent-date-value">2015年4月1日</td><td class="patent-data-table-td ">中兴通讯股份有限公司</td><td class="patent-data-table-td ">一种分层协议的识别方法和装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102752218A?cl=zh">CN102752218A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年7月16日</td><td class="patent-data-table-td patent-date-value">2012年10月24日</td><td class="patent-data-table-td ">北京国创富盛通信股份有限公司</td><td class="patent-data-table-td ">网络优化系统和网络优化方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102780588A?cl=zh">CN102780588A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年5月22日</td><td class="patent-data-table-td patent-date-value">2012年11月14日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">深度报文检测方法、装置、网络设备及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102780588B?cl=zh">CN102780588B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年5月22日</td><td class="patent-data-table-td patent-date-value">2014年12月3日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">深度报文检测方法、装置、网络设备及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103152340A?cl=zh">CN103152340A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年2月28日</td><td class="patent-data-table-td patent-date-value">2013年6月12日</td><td class="patent-data-table-td ">汉柏科技有限公司</td><td class="patent-data-table-td ">一种跨资源访问的协议识别方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103152340B?cl=zh">CN103152340B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年2月28日</td><td class="patent-data-table-td patent-date-value">2015年12月2日</td><td class="patent-data-table-td ">汉柏科技有限公司</td><td class="patent-data-table-td ">一种跨资源访问的协议识别方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103166963A?cl=zh">CN103166963A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年3月5日</td><td class="patent-data-table-td patent-date-value">2013年6月19日</td><td class="patent-data-table-td ">汉柏科技有限公司</td><td class="patent-data-table-td ">一种解除封装的协议识别方法及系统</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=Dol-BwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0001000000">H04L1/00</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=Dol-BwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0012260000">H04L12/26</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=Dol-BwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029080000">H04L29/08</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2010年6月16日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2010年9月1日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年5月30日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Granted</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2015年2月25日</td><td class="patent-data-table-td ">C56</td><td class="patent-data-table-td ">Change in the name or address of the patentee</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Owner name: </span><span class="nested-value">HUAWEI DIGITAL TECHNOLOGY (CHENGDU) CO., LTD.</span></div><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">FORMER NAME: CHENGDU HUAWEI SYMANTEC TECHNOLOGIES CO., LTD.</span></div></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/94f01cbd1b79f6858ad2/CN101741644A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_50a6672b5f82ffbd39b7a9e87fd4594c.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E6%B5%81%E9%87%8F%E6%A3%80%E6%B5%8B%E6%96%B9%E6%B3%95%E5%8F%8A%E8%A3%85%E7%BD%AE.pdf?id=Dol-BwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U2XXmc3dgN7uOgkTaVG8MdbsvMu6A"},"sample_url":"https://www.google.com/patents/reader?id=Dol-BwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>