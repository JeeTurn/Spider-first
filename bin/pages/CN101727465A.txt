<!DOCTYPE html><html><head><title>专利 CN101727465A - 分布式列存储数据库索引建立、查询方法及装置与系统 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="分布式列存储数据库索引建立、查询方法及装置与系统"><meta name="DC.contributor" content="徐萌" scheme="inventor"><meta name="DC.contributor" content="罗治国" scheme="inventor"><meta name="DC.contributor" content="赵鹏" scheme="inventor"><meta name="DC.contributor" content="郭磊涛" scheme="inventor"><meta name="DC.contributor" content="钱岭" scheme="inventor"><meta name="DC.contributor" content="中国移动通信集团公司" scheme="assignee"><meta name="DC.date" content="2008-11-3" scheme="dateSubmitted"><meta name="DC.description" content="本发明公开了一种分布式列存储数据库索引建立方法、查询方法及装置与系统。该分布式列存储数据库索引建立方法包括：获取分布式列存储数据库中的列字段，生成以所述列字段作为关键字的列索引文件，所述列索引文件中包含所述列字段在所述分布式列存储数据库中的值与对应的Row字段值的映射关系；存储所述列索引文件到所述分布式列存储数据库中与所述列字段对应的索引目录下。客户端发起以列字段作为查询条件和查询结果的查询请求时，通过匹配出相应的列索引文件，得到对应的Row字段值，从而实现索引查询。采用本发明能在现有分布式列存储数据库中，实现除Row字段外的其它列字段快速查询。"><meta name="DC.date" content="2010-6-9"><meta name="citation_patent_publication_number" content="CN:101727465:A"><meta name="citation_patent_application_number" content="CN:200810225486"><link rel="canonical" href="https://www.google.com/patents/CN101727465A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101727465A?cl=zh"/><meta name="title" content="专利 CN101727465A - 分布式列存储数据库索引建立、查询方法及装置与系统"/><meta name="description" content="本发明公开了一种分布式列存储数据库索引建立方法、查询方法及装置与系统。该分布式列存储数据库索引建立方法包括：获取分布式列存储数据库中的列字段，生成以所述列字段作为关键字的列索引文件，所述列索引文件中包含所述列字段在所述分布式列存储数据库中的值与对应的Row字段值的映射关系；存储所述列索引文件到所述分布式列存储数据库中与所述列字段对应的索引目录下。客户端发起以列字段作为查询条件和查询结果的查询请求时，通过匹配出相应的列索引文件，得到对应的Row字段值，从而实现索引查询。采用本发明能在现有分布式列存储数据库中，实现除Row字段外的其它列字段快速查询。"/><meta property="og:title" content="专利 CN101727465A - 分布式列存储数据库索引建立、查询方法及装置与系统"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101727465A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101727465A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=1ht-BwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101727465A&amp;usg=AFQjCNHApMTHhwWSQXIlzfkr-XSoHyL2TQ" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/9def98b0b76a518e88e0/CN101727465A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/9def98b0b76a518e88e0/CN101727465A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101727465A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101727465A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN101727465A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN101727465B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101727465A?cl=zh" style="display:none"><span itemprop="description">本发明公开了一种分布式列存储数据库索引建立方法、查询方法及装置与系统。该分布式列存储数据库索引建立方法包括：获取分布式列存储数据库中的列字段，生成以所述列字段作为关键字的列索引文件，所述列索引文件中包...</span><span itemprop="url">https://www.google.com/patents/CN101727465A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101727465A - 分布式列存储数据库索引建立、查询方法及装置与系统</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101727465A - 分布式列存储数据库索引建立、查询方法及装置与系统" title="专利 CN101727465A - 分布式列存储数据库索引建立、查询方法及装置与系统"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101727465 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200810225486</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2010年6月9日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2008年11月3日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2008年11月3日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101727465B?hl=zh-CN&amp;cl=zh">CN101727465B</a>, </span><span class="patent-bibdata-value"><a href="/patents/US20110314027?hl=zh-CN&amp;cl=zh">US20110314027</a>, </span><span class="patent-bibdata-value"><a href="/patents/WO2010048789A1?hl=zh-CN&amp;cl=zh">WO2010048789A1</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200810225486.3, </span><span class="patent-bibdata-value">CN 101727465 A, </span><span class="patent-bibdata-value">CN 101727465A, </span><span class="patent-bibdata-value">CN 200810225486, </span><span class="patent-bibdata-value">CN-A-101727465, </span><span class="patent-bibdata-value">CN101727465 A, </span><span class="patent-bibdata-value">CN101727465A, </span><span class="patent-bibdata-value">CN200810225486, </span><span class="patent-bibdata-value">CN200810225486.3</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%BE%90%E8%90%8C%22">徐萌</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%BD%97%E6%B2%BB%E5%9B%BD%22">罗治国</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E8%B5%B5%E9%B9%8F%22">赵鹏</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%83%AD%E7%A3%8A%E6%B6%9B%22">郭磊涛</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%92%B1%E5%B2%AD%22">钱岭</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8%E9%80%9A%E4%BF%A1%E9%9B%86%E5%9B%A2%E5%85%AC%E5%8F%B8%22">中国移动通信集团公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101727465A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101727465A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101727465A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (12),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (5),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=1ht-BwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200810225486&amp;usg=AFQjCNEjAb5J0pomw_JJYLOXjs3hmHJrHw"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=1ht-BwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101727465A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNEnW0HZZfOWtAWouFgVN4mCTNvPMw"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT95806493" lang="ZH" load-source="patent-office">分布式列存储数据库索引建立、查询方法及装置与系统</invention-title>
      </span><br><span class="patent-number">CN 101727465 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA78270400" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明公开了一种分布式列存储数据库索引建立方法、查询方法及装置与系统。该分布式列存储数据库索引建立方法包括：获取分布式列存储数据库中的列字段，生成以所述列字段作为关键字的列索引文件，所述列索引文件中包含所述列字段在所述分布式列存储数据库中的值与对应的Row字段值的映射关系；存储所述列索引文件到所述分布式列存储数据库中与所述列字段对应的索引目录下。客户端发起以列字段作为查询条件和查询结果的查询请求时，通过匹配出相应的列索引文件，得到对应的Row字段值，从而实现索引查询。采用本发明能在现有分布式列存储数据库中，实现除Row字段外的其它列字段快速查询。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(14)</span></span></div><div class="patent-text"><ol mxw-id="PCLM32007796" lang="ZH" load-source="patent-office" class="claims">
    <li class="claim"> <div num="1" class="claim">
      <div class="claim-text">一种分布式列存储数据库索引建立方法，其特征在于，包括：获取分布式列存储数据库中的列字段；生成以所述列字段作为关键字的列索引文件，所述列索引文件中包含所述列字段在所述分布式列存储数据库中的值与对应的Row字段值的映射关系；存储所述列索引文件到所述分布式列存储数据库中与所述列字段对应的索引目录下。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2. 如权利要求1所述的方法，其特征在于，在所述分布式列存储数据库的主服务器中， 存储Row字段值与所述分布式列存储数据库的分片服务器的映射关系；在所述分片服务器中，存储分配的分片数据中所述列字段对应的数据文件、以Row字 段为关键字的索引文件和生成的对应列索引文件。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3. 如权利要求2所述的方法，其特征在于，所述分布式列存储数据库采用三级索引目 录结构，具体包括：在所述主服务器中存储第一级索引目录，在所述第一级索引目录中包含所述Row字段 值与所述分片服务器的映射关系；在所述分片服务器中存储第二级索引目录和第三级索引目录，在所述第二级索引目录 中包含所述列字段与列存储文件的映射关系；在所述第三级索引目录中包含所述列存储文 件对应列字段的所述数据文件、索引文件和列索引文件。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4. 如权利要求3所述的方法，其特征在于，当一个所述分片服务器中存储一片或以上 的分片数据时，对每片分片数据分别建立所述第二级索引目录和第三级索引目录。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5. 如权利要求1-4任一所述的方法，其特征在于，当所述分布式列存储数据库中增加 数据、删除数据或修改数据后，重新生成所述列索引文件或修改所述列索引文件中的对应 数据。</div>
    </div>
    </li> <li class="claim"> <div num="6" class="claim">
      <div class="claim-text">6. &#8212;种分布式列存储数据库查询方法，其特征在于，包括： 客户端向分布式列存储数据库的主服务器发起查询请求；所述主服务器根据本地存储的Row字段值与所述分布式列存储数据库的分片服务器 的映射关系，向所述客户端返回分片服务器信息；所述客户端向所述分片服务器发起查询请求，在该查询请求中携带查询结果的列字 段、查询条件的列字段及字段值信息；所述分片服务器根据本地存储的列字段的索引目录，匹配出与所述查询条件的列字段 对应的列索引文件，所述列索引文件中包含所述列字段在所述分布式列存储数据库中的值 与对应的Row字段值的映射关系；所述分片服务器根据匹配出的所述列索引文件及所述字段值信息获取对应Row字段 值，并根据获取的Row字段值查询与所述查询结果的列字段对应的索引文件和数据文件， 得到满足查询条件结果值，返回给所述客户端。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7. 如权利要求6所述的方法，其特征在于，当所述主服务器返回的分片服务器信息中 包含多个分片服务器时，所述客户端并行地分别向每个分片服务器发起所述查询请求。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8. 如权利要求6或7所述的方法，其特征在于，当发送给所述分片服务器的所述查询请 求中包含一个以上的查询条件时，所述分片服务器分别获取每个查询条件对应的Row字段 值，再根据各查询条件之间的逻辑关系，确定出满足全部查询条件的最终Row字段值，并根 据所述最终Row字段值查询所述查询结果的列字段对应的数据文件，得到满足查询条件结果值，返回给所述客户端。</div>
    </div>
    </li> <li class="claim"> <div num="9" class="claim">
      <div class="claim-text">9. 一种分布式列存储数据库索引建立装置，其特征在于，包括： 获取单元，用于获取分布式列存储数据库中的列字段；生成单元，用于生成以所述获取单元获取的所述列字段作为关键字的列索引文件，所 述列索引文件中包含所述列字段在所述分布式列存储数据库中的值与对应的Row字段值 的映射关系；存储单元，用于存储所述列索引文件到所述分布式列存储数据库中与所述列字段对应 的索引目录下。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10. 如权利要求9所述的装置，其特征在于，所述生成单元包括： 获取子单元，用于获取所述列字段在所述分布式列存储数据库中的值； 匹配子单元，用于在所述分布式列存储数据库中匹配出与所述列字段的值对应的Row字段值；生成子单元，用于建立起所述列字段的值与对应的Row字段的值之间的映射关系，生 成所述列索引文件。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="11" class="claim">
      <div class="claim-text">11. 如权利要求9或IO所述的装置，其特征在于，所述装置为软件模块，嵌入到存储所 述分布式列存储数据库的分片数据的分片服务器中。</div>
    </div>
    </li> <li class="claim"> <div num="12" class="claim">
      <div class="claim-text">12. &#8212;种分布式列存储数据库系统，包括主服务器和分片服务器，其特征在于： 所述主服务器包括：第一存储单元，用于存储分布式列存储数据库的Row字段值与分片服务器的映射关 系；以及查询受理单元，用于接收客户端的查询请求，根据所述第一存储单元存储的所述映射 关系向客户端返回分片服务器信息； 所述分片服务器包括：列索引文件生成单元，用于获取分布式列存储数据库中的列字段，生成以所述列字段 作为关键字的列索引文件，所述列索引文件中包含所述列字段在所述分布式列存储数据库 中的值与对应的Row字段值的映射关系，并存储所述列索引文件到所述分布式列存储数据 库中与所述列字段对应的索引目录下；第二存储单元，用于存储分配的分片数据中的列字段对应的数据文件、以Row字段为 关键字的索引文件和所述列字段的列索引文件；分析单元，用于接收客户端发送的查询请求，分析所述查询请求中携带的查询结果的 列字段、查询条件的列字段及字段值信息；匹配单元，用于根据所述查询条件的列字段在所述第二存储单元中匹配出对应的列索 引文件，并根据匹配出的所述列索引文件及所述字段值信息，获取对应Row字段值；结果查询单元，用于用获取的Row字段值查询所述查询结果的列字段对应的索引文件 和数据文件，得到满足查询条件的查询结果值；结果返回单元，用于向发起查询请求的所述客户端返回所述查询结果值。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13. 如权利要求12所述的系统，其特征在于，在所述主服务器的第一存储单元中存储 有第一级索引目录，在所述第一级索引目录中包含所述Row字段值与分片服务器的映射关 系；在所述分片服务器的第二存储单元中存储有第二级索引目录和第三级索引目录，在所 述第二级索引目录中包含所述列字段与列存储文件的映射关系；在所述第三级索引目录中 包含所述列存储文件对应列字段的所述数据文件、索引文件和列索引文件。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="14" class="claim">
      <div class="claim-text">14.如权利要求12或13所述的系统，其特征在于，所述分片服务器为多个。</div>
    </div>
  </li> </ol>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES37377035" lang="ZH" load-source="patent-office" class="description">
    <p>分布式列存储数据库索引建立、查询方法及装置与系统</p>
    <p>技术领域</p>
    <p>[0001] 本发明涉及分布式列存储数据库，尤其涉及一种分布式列存储数据库的索引建立</p>
    <p>方法，数据查询方法及相应的装置与系统。 背景技术</p>
    <p>[0002] 分布式列存储数据库是一种适合快速查询的、分布式的优良解决方案，它在提供 海量数据存储的同时，还可以有效的提高对数据的查询速度。</p>
    <p>[0003]     分布式列存储数据库的特点是：数据表中必须有Row字段，且Row字段为关键字，</p>
    <p>即不可重复，并排序。如果原表为N个列字段，则整个表在分布式列存储数据库中以（N-l)</p>
    <p>个表来进行存储；即除Row字段外，对其余的列字段分别存储一个对应表。</p>
    <p>[0004]      举例说明如下：</p>
    <p>[0005]     表一 ：GNTABLE</p>
    <p>[0006]&lt;table&gt;table see original document page 5&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;[0007] 上表一为分布式列存储数据库的一个原数据表GNTABLE，其包含Row字段并排序， 其余列字段包括：时间（Time)、用户标识（UserlD)、源IP地址（SourceIP)、目标IP地址 (ObjectIP)和信号类型（SingalType)。</p>
    <p>[0008]     在列存储数据库中，需要针对各列字段（Time、 UserID、 SourceIP、 ObjectIP和 SingalType)分别存储一个对应表。以Time和UserlD列字段为例，其存储的对应表分别如 下表二和表三所示： [0009] 表二 [0010]</p>
    <p>&lt;table&gt;table see original document page 5&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;&lt;table&gt;table see original document page 6&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;</p>
    <p>[0011] 表三 [0012]</p>
    <p>&lt;table&gt;table see original document page 6&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;</p>
    <p>[0013] 在分布式列存储数据库中，包含有主服务器（Master)和分片服务器 (TabletServer)。其中，在主服务器中保存Row字段值与各分片服务器之间的映射关系，在 各分片服务器中分别保存分布式列存储数据库的分片数据。所谓分片数据，是指将一个原 数据表按照行分为几个分片（一个分片包含若干行），每个分片包括各行的全部数据。每个 分片数据可以存储于一个分片服务器中（当然，一个分片服务器可以存储多个分片数据）， 各分片数据中按Row排序。每个分片数据中第一行的Row值为开始（begin)值，最后一行 的Row值为结束（end)值，根据分片规则，则下一个分片数据的begin值&gt;上一个分片数据 的end值。其存储架构示意图如图l所示，包括：</p>
    <p>[0014] 在主服务器（Master)中包含有元数据（Metadata)模块，存储Row字段值与各分 片服务器（TabletServer)的映射关系。在各分片服务器中包含数据片模块（HRegion)，在 该模块中存储列字段（或列家族，在分布式列存储数据库中，将经常被同时访问的几个列 定义为列家族，同一个列家族存储于一个列文件中）与对应列存储文件（HStoreFile)之间 的映射关系，一个或多个HStoreFile存储在一个列模块（HStore)下。每个HStoreFile保 存了两个文件，即数据（Data)文件和索引（Index)文件，并建立两者之间的映射。Data文 件保存数据，其格式为〈Key， value〉， Index文件保存Key的索引，通过Key的索引，可以直 接定位到Data文件中的某行数据。</p>
    <p>[0015]     仍以上表一中的UserID列字段为例，在对应的HStoreFile中，其对应的Data文 件和Index文件分别如下表四、表五所示。 [0016]     表四：[0017]</p>
    <p>&lt;table&gt;table see original document page 7&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;</p>
    <p>[0018] 表五： [0019]</p>
    <p>&lt;table&gt;table see original document page 7&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;[0020] 根据上述现有技术的存储架构，对于分布式列存储数所库，整体的索引机制形成 树的形式，可以通过三层快速对Row进行定位。</p>
    <p>[0021] 但由于现有技术中数据是根据主关键字Row排序并存储的，对于Time、 UserID等 非主关键字的列则不是排序的，因此以这些列为条件的访问就必须根据Row遍历整个数据 表才能实现。在没有索引情况下的遍历数据，即便是分布式数据库，可以并发处理遍历请 求，但其面对海量数据时，性能也无法忍受。而对于传统的数据库应用来说，使用非主关键 字查询的场合非常多，因此需要有一种针对非主关键字的列的索引机制以满足使用需求。</p>
    <p>发明内容</p>
    <p>[0022] 本发明提供一种分布式列存储数据库索引建立方法、查询方法及装置与系统，用 以解决现有分布式列存储数据库中不能够按照除Row字段外的其它列字段进行快速高效 查询的问题。</p>
    <p>[0023]      本发明提供的分布式列存储数据库索引建立方法，包括： [0024]      获取分布式列存储数据库中的列字段；</p>
    <p>[0025] 生成以所述列字段作为关键字的列索引文件，所述列索引文件中包含所述列字段</p>
    <p>在所述分布式列存储数据库中的值与相对应的Row字段值的映射关系；</p>
    <p>[0026] 存储所述列索引文件到所述分布式列存储数据库中与所述列字段对应的索引目录下。</p>
    <p>[0027]     本发明还提供一种分布式列存储数据库查询方法，包括： [0028]     客户端向分布式列存储数据库的主服务器发起查询请求；</p>
    <p>[0029] 所述主服务器根据本地存储的Row字段值与所述分布式列存储数据库的分片服 务器的映射关系，向所述客户端返回分片服务器信息；[0030] 所述客户端向所述分片服务器发起查询请求，在该查询请求中携带查询结果的列 字段、查询条件的列字段及字段值信息；</p>
    <p>[0031] 所述分片服务器根据本地存储的列字段的索引目录，匹配出与所述查询条件的列 字段对应的列索引文件，所述列索引文件中包含所述列字段在所述分布式列存储数据库中 的值与相对应的Row字段值的映射关系；</p>
    <p>[0032] 所述分片服务器根据匹配出的所述列索引文件及所述字段值信息获取对应Row 字段值，并根据获取的Row字段值查询与所述查询结果的列字段对应的索引文件和数据文 件，得到满足查询条件结果值，返回给所述客户端。</p>
    <p>[0033]     本发明再提供一种分布式列存储数据库索引建立装置，包括： [0034]     获取单元，用于获取分布式列存储数据库中的列字段；</p>
    <p>[0035] 生成单元，用于生成以所述获取单元获取的所述列字段作为关键字的列索引文 件，所述列索引文件中包含所述列字段在所述分布式列存储数据库中的值与相对应的Row 字段值的映射关系；</p>
    <p>[0036] 存储单元，用于存储所述列索引文件到所述分布式列存储数据库中与所述列字段 对应的索引目录下。</p>
    <p>[0037] 本发明再提供一种分布式列存储数据库系统，包括主服务器和分片服务器，所述 主服务器包括：</p>
    <p>[0038] 第一存储单元，用于存储分布式列存储数据库的Row字段值与分片服务器的映射 关系；以及</p>
    <p>[0039] 查询受理单元，用于接收客户端的查询请求，根据所述第一存储单元存储的所述 映射关系向客户端返回分片服务器信息； [0040]     所述分片服务器包括：</p>
    <p>[0041] 列索引文件生成单元，用于获取分布式列存储数据库中的列字段，生成以所述列 字段作为关键字的列索引文件，所述列索引文件中包含所述列字段在所述分布式列存储数 据库中的值与对应的Row字段值的映射关系，并存储所述列索引文件到所述分布式列存储 数据库中与所述列字段对应的索引目录下；</p>
    <p>[0042] 第二存储单元，用于存储分配的分片数据中的列字段对应的数据文件、以Row字 段为关键字的索引文件和所述列字段的列索引文件；</p>
    <p>[0043] 分析单元，用于接收客户端发送的查询请求，分析所述查询请求中携带的查询结 果的列字段、查询条件的列字段及字段值信息；</p>
    <p>[0044] 匹配单元，用于根据所述查询条件的列字段在所述第二存储单元中匹配出对应的 列索引文件，并根据匹配出的所述列索引文件及所述字段值信息，获取对应Row字段值； [0045]     结果查询单元，用于用获取的Row字段值查询所述查询结果的列字段对应的索引 文件和数据文件，得到满足查询条件的查询结果值；</p>
    <p>[0046] 结果返回单元，用于向发起查询请求的所述客户端返回所述查询结果值。 [0047] 本发明通过获取分布式列存储数据库中除Row字段外的列字段，生成以列字段作 为关键字的列索引文件，在该列索引文件中包含列字段在分布式列存储数据库中的值与相 对应的Row字段值的映射关系；并将生成的列索引文件存储到与列字段对应的索引目录 下。使得客户端可以向分布式列存储数据库的主服务器发起携带查询结果的列字段、查询条件的列字段及字段值信息的查询请求，通过主服务器、分片服务器根据存储的列字段的 索引目录，匹配出与查询条件的列字段对应的列索引文件，根据列索引文件获取对应Row 字段值，并根据获取的Row字段值查询所述查询结果的列字段对应的数据文件，得到满足</p>
    <p>查询条件结果值，返回给客户端。从而实现客户端可以方便地针对分布式列存储数据库采</p>
    <p>用非Row字段的其余列字段进行快速高效的索引查询。</p>
    <p>附图说明</p>
    <p>[0048]     图1为现有技术中分布式列存储数据库存储架构示意图；</p>
    <p>[0049]      图2为本发明实施例提供的分布式列存储数据库索引建立方法流程图；</p>
    <p>[0050]     图3为本发明实施例提供的HStoreFile下的文件结构示意图；</p>
    <p>[0051]     图4为本发明实施例提供的分布式列存储数据库查询方法流程图；</p>
    <p>[0052]      图5为本发明实施例提供的分布式列存储数据库索引建立装置结构示意图；</p>
    <p>[0053]     图6为本发明实施例提供的分布式列存储数据库索引建立装置中生成单元的内</p>
    <p>部结构示意图；</p>
    <p>[0054]     图7为本发明实施例提供的分布式列存储数据库系统结构示意图。 具体实施方式</p>
    <p>[0055] 本发明实施例提供一种分布式列存储数据库索引建立方法，其实现流程如图2所 示，包括：</p>
    <p>[0056]     步骤S201、获取分布式列存储数据库中的列字段。</p>
    <p>[0057] 步骤S202、生成以获取的列字段作为关键字的列索引文件，在列索引文件中包含</p>
    <p>该列字段在分布式列存储数据库中的值与相对应的Row字段值的映射关系。</p>
    <p>[0058]     在该步骤S202中，可以针对获取的每一个列字段（或列家族），分别生成一个对应</p>
    <p>的列索引文件。</p>
    <p>[0059] 实际应用中，为方便用户查询，理论上可以对分布式列存储数据库中除Row字段 外的每一个列字段，都生成一个对应的列索引文件。当然，如果某些列字段基本没有查询的 价值，实际中几乎不会采用该字段进行查询，则不必生成对应的列索引文件，以节省数据库 占用的存储资源。</p>
    <p>[0060] 步骤S203、存储生成的列索引文件到分布式列存储数据库中与该列字段对应的索 引目录下。</p>
    <p>[0061] 根据上述流程描述可知，本发明在现有技术的基础上，为分布式列存储数据库中 除Row字段外的其余列字段分别生成了一个对应的列索引文件，并存储到与列字段对应的 索引目录下。</p>
    <p>[0062]     仍沿用上述表一为例，针对列字段UserID生成的列索引文件如下表六所示： [0063]      表六：&lt;table&gt;table see original document page 10&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;[0065] 表六中，左边一栏为UserID在原分布式列存储数据库中的值，根据表三可知， 其字段值只有两个，其一为13910001000和13810001000 ;右边一栏为Row字段值，即与 UserID的每个值分别对应的Row字段值，由表三可知，与13910001000对应的Row字段值分 别为1、3、4，与13810001000对应的Row字段值为2。 [0066]     下面结合分布式列存储数据库的存储架构，进行具体说明：</p>
    <p>[0067] 在分布式列存储数据库的主服务器中存储第一级索引目录，在第一级索引目录中 包含Row字段值与各分片服务器的映射关系；例如，在主服务器的元数据模块中存储第一 级索引目录。根据第一级索引目录，主服务器可以查找到全部的分片服务器。 [0068] 在每个分片服务器中存储第二级索引目录和第三级索引目录，在第二级索引目录 中包含列字段与列存储文件的映射关系；例如，在分片服务器的数据片模块中存储第二级 索引目录。在第三级索引目录下，存储列存储文件对应列字段的数据文件、索引文件和本 发明生成的列索引文件。第三级索引目录相当于现有现有技术中的HStoreFile，所不同的 是，本发明在现有技术的HStoreFile下增加了一个与该列字段对应的列索引文件，其层级 关系示意图如图3所示：</p>
    <p>[0069]     在列存储文件（HStoreFile)下，存储有三个文件，分别为：</p>
    <p>[0070] 在对应的分片服务器分配的分片数据中，该列字段对应的数据（Data)文件（为描 述方便，后续统一称为Data文件）、以Row字段为关键字的索引（Index)文件（为描述方 便，后续统一称为Index文件）和本发明生成的对应列索引（Collndex)文件（为描述方便， 后续统一称为Collndex文件）。</p>
    <p>[0071] 在分片服务器中，对列字段建立对应的列索引文件，可由用户指定。即在分片服务 器向用户提供创建索引、删除索引的接口，用户可以根据自己的使用需要，建立全部或部分 列字段对应的列索引文件。</p>
    <p>[0072] 根据本发明上述实施例提供的方法，当一个分片服务器中存储一片及一片以上的 分片数据时，在该分片服务器中针对每片分片数据分别建立第二级索引目录和第三级索引 目录。</p>
    <p>[0073] 当分布式列存储数据库中增加数据、删除数据或修改数据后，需要重新生成列索 引文件，或者修改已生成的列索引文件中的对应数据，以保证列索引文件中的数据与当前 数据库中的相关数据相一致，以避免后续查询时出现错误的查询结果。</p>
    <p>[0074] 基于同一发明构思，根据本发明提供的上述分布式列存储数据库索引建立方法，本发明还提供一种分布式列存储数据库查询方法，其具体实现流程如图4所示，包括： [0075]     步骤S401、客户端向分布式列存储数据库的主服务器发起查询请求； [0076]     步骤S402、主服务器根据本地存储的Row字段值与分片服务器的映射关系，向客 户端返回分片服务器信息；</p>
    <p>[0077] 步骤S403、客户端向分片服务器发起查询请求，在该查询请求中携带查询结果的 列字段、查询条件的列字段及字段值信息；</p>
    <p>[0078] 步骤S404、分片服务器根据本地存储的列字段的索引目录，匹配出与查询条件的 列字段对应的Co 1 Index文件；</p>
    <p>[0079] 步骤S405、分片服务器根据匹配出的Collndex文件及查询条件中携带的列字段 的字段值信息，获取对应Row字段值；</p>
    <p>[0080] 步骤S406、分片服务器根据获取的Row字段值，以及查询结果的列字段对应的 Index文件和Data文件，得到满足查询条件结果值；</p>
    <p>[0081] 步骤S407、分片服务器返回符合查询条件的结果值给发起查询请求的客户端。 [0082]     仍以上表一为例，假设查询请求为"Select SignalType from GNTABLEwhere UserID =， 13910001000'"，即从GNTABLE数据表中选择列字段UserID为"13910001000" 的用户对应使用的信号类型。该查询请求中，携带的查询条件的列字段为"UserID"字段， 字段值为"13910001000"，查询结果列字段为"SignalType"字段。</p>
    <p>[0083] 根据本发明提供的上述流程，客户端先向主服务器发起查询请求，主服务器将各 分片服务器信息返回给客户端；客户端再分别向各分片服务器发起查询，当有多个分片服 务器时，客户端并行地分别向每个分片服务器发起查询请求，实现分布式查询；每个分片服 务器根据本地存储的分片数据，查询出满足查询条件的结果值后返回给客户端，客户端接 收各分片服务器返回的查询结果，即得到最终的查询数据。</p>
    <p>[0084] 具体地，分片服务器接收到上述查询请求后，在本地存储的列字段的索引目录中 匹配出与查询条件的列字段"UserID"字段对应的列索引文件，S卩如表六所示，分片服务器 根据匹配出的列索引文件，获取UserID字段值为"13910001000"对应Row字段值为"1、3、 4";得到Row字段值后，再采用现有技术中分布式列存储数据库的查询方式，得到查询结果； 即：再根据本次查询结果对应的列字段（"SignalType"字段）的Index文件和Data文件， 即可获得满足查询要求的对应SignalType字段值。</p>
    <p>[0085] 当查询请求中携带有多个查询条件时，分片服务器分别获取每个查询条件对应的 Row字段值，再根据各查询条件之间的逻辑关系（逻辑"或"，逻辑"与"或其组合），确定出 满足全部查询条件的最终Row字段值，再根据确定出的最终Row字段值，查询得到满足查询 条件的结果值返回给客户端。</p>
    <p>[0086] 采用本发明提供的分布式列存储数据库查询方法，客户端可以并行地同时向各分</p>
    <p>片服务器发起查询请求，使得对数据的多条件查询处理在各分片服务器同时进行，从而实</p>
    <p>现了快速高效的查询。而如果不采用分布式查询方式，由主服务器进行集中式的多条件查</p>
    <p>询处理，当进行海量数据查询时，会出现海量数据单节点无法处理的情况。</p>
    <p>[0087] 其次，采用本发明提供的分布式列存储数据库查询方法，分片服务器直接在本地</p>
    <p>进行数据查询处理，即各分片服务器只需处理本地存储的数据就能获得查询结果，没有网</p>
    <p>络交互，减少了网络的开销，进一步提高了查询速度及效率。[0088] 基于同一发明构思，根据本发明上述实施例提供的分布式列存储数据库索引建立 方法，本发明还提供一种分布式列存储数据库索引建立装置，其结构示意图如图5所示，包 括：</p>
    <p>[0089]     获取单元71，用于获取分布式列存储数据库中的列字段；</p>
    <p>[0090] 生成单元72，用于生成以获取单元71获取的列字段作为关键字的列索引文件，在 该列索引文件中包含列字段在分布式列存储数据库中的值与相对应的Row字段值的映射 关系；</p>
    <p>[0091] 存储单元73，用于存储生成单元72生成的列索引文件到分布式列存储数据库中 与该列字段对应的索引目录下。</p>
    <p>[0092]     其中，生成单元72的内部结构如图6所示，可以进一步包括：</p>
    <p>[0093]     获取子单元721，用于获取列字段在所述分布式列存储数据库中的值；</p>
    <p>[0094] 匹配子单元722，用于在分布式列存储数据库中匹配出与列字段的值相对应的</p>
    <p>Row字段值；</p>
    <p>[0095] 生成子单元723，用于建立起列字段的值与相对应的Row字段的值之间的映射关 系，生成列索引文件。</p>
    <p>[0096] 在实际应用中，本发明提供的分布式列存储数据库索引建立装置可以是软件模 块，嵌入到存储分布式列存储数据库的分片数据的分片服务器中。</p>
    <p>[0097] 基于同一发明构思，本发明再提供一种分布式列存储数据库系统，其结构示意图 如图7所示，包括主服务器和分片服务器，其中： [0098]      所述主服务器包括：</p>
    <p>[0099] 第一存储单元81，用于存储分布式列存储数据库的Row字段值与分片服务器的映 射关系；以及</p>
    <p>[0100] 查询受理单元82，用于接收客户端的查询请求，根据第一存储单元81存储的所述 映射关系向客户端返回分片服务器信息； [0101] 所述分片服务器包括：</p>
    <p>[0102] 列索引文件生成单元91，用于获取分布式列存储数据库中的列字段，生成以列字 段作为关键字的列索引文件，在该列索引文件中包含列字段在分布式列存储数据库中的值 与相对应的Row字段值的映射关系，并存储生成的列索引文件到分布式列存储数据库中与 该列字段对应的索引目录下；</p>
    <p>[0103] 第二存储单元92，用于存储分配的分片数据中的列字段对应的数据文件、以Row 字段为关键字的索引文件和列字段的列索引文件；</p>
    <p>[0104] 分析单元93，用于接收客户端发送的查询请求，分析所述查询请求中携带的查询 结果的列字段、查询条件的列字段及字段值信息；</p>
    <p>[0105] 匹配单元94，用于根据查询请求中携带的查询条件的列字段在第二存储单元92 中匹配出对应的列索引文件，并根据匹配出的列索引文件以及字段值信息，获取与查询条 件列字段的字段值对应Row字段值；</p>
    <p>[0106] 结果查询单元95，用于用获取的Row字段值查询所述查询结果的列字段对应的索 引文件和数据文件，得到满足查询条件的查询结果值；</p>
    <p>[0107] 结果返回单元96，用于向发起查询请求的所述客户端返回查询结果值。[0108] 主服务器用于存储分布式列存储数据库的Row字段值与分片服务器的映射关系； 在分片服务器中，除了存储分配的分片数据中的列字段对应的Data文件、以Row字段为关 键字的Index文件外，还存储该列字段的Col Index文件；该Col Index文件和Data文件以 及Index文件一起保存在列字段对应的索引目录下。所述列索引文件，采用本发明上述实 施例提供的方法建立，在其中包含列字段在分布式列存储数据库中的值与相对应的Row字 段值的映射关系。</p>
    <p>[0109] 如前所述，在主服务器中可以存储有第一级索引目录，在第一级索引目录中包含 Row字段值与分片服务器的映射关系；在分片服务器中可以存储有第二级索引目录和第三 级索引目录，在第二级索引目录中包含列字段与列索引文件的映射关系；在第三级索引目 录下，存储列索引文件对应列字段的Data文件、Index文件和本发明建立的Col Index文件。 [0110] 本发明提供的分布式列存储数据库系统中，分片服务器可以是一个或多个。 [0111] 综上所述，本发明通过获取分布式列存储数据库中除Row字段外的列字段，生成 以列字段作为关键字的列索引文件，在该列索引文件中包含该列字段在分布式列存储数据 库中的值与相对应的Row字段值的映射关系；并将生成的列索引文件存储到与列字段对应 的索引目录下。从而使得客户端可以向分布式列存储数据库的主服务器发起携带查询结果 的列字段、查询条件的列字段及字段值信息的查询请求，通过匹配出与查询条件的列字段 对应的列索引文件，获取对应Row字段值，再利用现有技术的查询方式根据Row字段值获得 查询结果，实现了在分布式列存储数据库中采用非Row字段的其余列字段进行索引查询， 极大地满足用户的使用需求。</p>
    <p>[0112] 采用本发明提供的分布式列存储数据库查询方法，由客户端并行地同时向各分片 服务器发起查询请求，使得对数据的多条件查询处理在各分片服务器同时进行，从而实现 了快速高效的查询。而如果不采用本发明提供的分布式列存储数据库查询方式，而采用现 有数据库常用的索引方法，即在主服务器中建立一个索引表，进行集中式的多条件查询处 理，在索引表中存储列字段中列数据到其存储位置的映射，这种常规索引方法在处理所有 的条件数据判断时，主服务器极有可能内存溢出，导致无法处理；且在获取数据的存储位置 时，需要经过三次索引定位，增加网络开销。</p>
    <p>[0113] 其次，采用本发明提供的分布式列存储数据库查询方法，分片服务器直接在本地 进行数据查询处理，即各分片服务器只需处理本地存储的数据就能获得查询结果，没有网 络交互，减少了网络的开销，进一步提高了查询速度及效率。</p>
    <p>[0114] 再次，采用本发明提供的分布式列存储数据库查询方法，每次查询是针对列索引 文件进行的，相对于采用遍历方式查询所需要的时间复杂度N而言，其时间复杂度仅为 log2N。</p>
    <p>[0115] 本领域普通技术人员可以理解实现上述实施例方法中的全部或部分步骤是可以 通过程序来指令相关的硬件来完成，该程序可以存储于一计算机可读取存储介质中，如： R0M/RAM、磁碟、光盘等。</p>
    <p>[0116] 显然，本领域的技术人员可以对本发明进行各种改动和变型而不脱离本发明的精 神和范围。这样，倘若本发明的这些修改和变型属于本发明权利要求及其等同技术的范围 之内，则本发明也意图包含这些改动和变型在内。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101916280A?cl=zh">CN101916280A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年8月17日</td><td class="patent-data-table-td patent-date-value">2010年12月15日</td><td class="patent-data-table-td ">上海云数信息科技有限公司</td><td class="patent-data-table-td ">并行计算系统及按查询内容进行负载均衡的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102156714A?cl=zh">CN102156714A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年3月22日</td><td class="patent-data-table-td patent-date-value">2011年8月17日</td><td class="patent-data-table-td ">广东环天电子技术发展有限公司</td><td class="patent-data-table-td ">实现自适应垂直划分的关系型数据库的方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102375853A?cl=zh">CN102375853A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年8月24日</td><td class="patent-data-table-td patent-date-value">2012年3月14日</td><td class="patent-data-table-td ">中国移动通信集团公司</td><td class="patent-data-table-td ">分布式数据库系统、在其中建立索引的方法和查询方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102567329A?cl=zh">CN102567329A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年12月15日</td><td class="patent-data-table-td patent-date-value">2012年7月11日</td><td class="patent-data-table-td ">金蝶软件（中国）有限公司</td><td class="patent-data-table-td ">一种数据查询方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102567329B?cl=zh">CN102567329B</a></td><td class="patent-data-table-td patent-date-value">2010年12月15日</td><td class="patent-data-table-td patent-date-value">2013年10月23日</td><td class="patent-data-table-td ">金蝶软件（中国）有限公司</td><td class="patent-data-table-td ">一种数据查询方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102890721A?cl=zh">CN102890721A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年10月16日</td><td class="patent-data-table-td patent-date-value">2013年1月23日</td><td class="patent-data-table-td ">苏州迈科网络安全技术股份有限公司</td><td class="patent-data-table-td ">基于列存储技术的数据库建立方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102890721B?cl=zh">CN102890721B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年10月16日</td><td class="patent-data-table-td patent-date-value">2016年3月30日</td><td class="patent-data-table-td ">苏州迈科网络安全技术股份有限公司</td><td class="patent-data-table-td ">基于列存储技术的数据库建立方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8671111">US8671111</a></td><td class="patent-data-table-td patent-date-value">2012年5月7日</td><td class="patent-data-table-td patent-date-value">2014年3月11日</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">Determination of rules by providing data records in columnar data structures</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US9229950">US9229950</a></td><td class="patent-data-table-td patent-date-value">2012年11月14日</td><td class="patent-data-table-td patent-date-value">2016年1月5日</td><td class="patent-data-table-td ">Huawei Technologies Co., Ltd.</td><td class="patent-data-table-td ">Method and device for processing files of distributed file system</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2011140991A1?cl=zh">WO2011140991A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年5月12日</td><td class="patent-data-table-td patent-date-value">2011年11月17日</td><td class="patent-data-table-td ">Huawei Technologies Co., Ltd.</td><td class="patent-data-table-td ">分布式文件系统的文件处理方法及装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2012164469A1?cl=zh">WO2012164469A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年5月25日</td><td class="patent-data-table-td patent-date-value">2012年12月6日</td><td class="patent-data-table-td ">International Business Machines Corporation</td><td class="patent-data-table-td ">A method for determining rules by providing data records in columnar data structures</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2015081780A1?cl=zh">WO2015081780A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2014年11月5日</td><td class="patent-data-table-td patent-date-value">2015年6月11日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">列式数据库处理的方法和处理设备</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=1ht-BwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=G06F0017300000">G06F17/30</a></span></td></tr><tr><td class="patent-data-table-td "> 合作分类</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=1ht-BwABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G06F17/30321">G06F17/30321</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=1ht-BwABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=G06F17/30315">G06F17/30315</a></span></td></tr><tr><td class="patent-data-table-td "> 欧洲专利分类号</td><td class="patent-data-table-td "><span class="nested-value">G06F17/30S2P</span>, <span class="nested-value">G06F17/30S2C</span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2010年6月9日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2010年8月11日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2011年12月21日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Granted</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/9def98b0b76a518e88e0/CN101727465A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E5%88%86%E5%B8%83%E5%BC%8F%E5%88%97%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B4%A2%E5%BC%95%E5%BB%BA%E7%AB%8B.pdf?id=1ht-BwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U2qF7s49WEQ-_RHuUpfQyvaKpKDfA"},"sample_url":"https://www.google.com/patents/reader?id=1ht-BwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>