<!DOCTYPE html><html><head><title>专利 CN102571340A - 证书认证装置及该装置的访问和证书更新方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="证书认证装置及该装置的访问和证书更新方法"><meta name="DC.contributor" content="刘道斌" scheme="inventor"><meta name="DC.contributor" content="廖剑" scheme="inventor"><meta name="DC.contributor" content="王晨阳" scheme="inventor"><meta name="DC.contributor" content="陈庆方" scheme="inventor"><meta name="DC.contributor" content="普天信息技术研究院有限公司" scheme="assignee"><meta name="DC.date" content="2010-12-23" scheme="dateSubmitted"><meta name="DC.description" content="本发明公开了一种证书认证装置，该装置包括：普通存储模块、存储控制模块和接口模块；所述普通存储模块与存储控制模块相连，所述存储控制模块和接口模块相连；该装置还包括：安全存储模块，与运算处理模块以及安全控制模块分别相连，用于存储用于证书认证的私密信息；运算处理模块，用于对加密算法进行硬件加速；安全控制模块，与所述存储控制模块相连，用于调度所述运算处理模块进行运算，控制所述安全存储模块进行数据的存储和输出。该装置能够在保证安全性的情况下，拥有较高的证书认证速度。本发明还公开了一种基于该证书认证装置的访问方法和证书更新方法，实现对该证书认证装置的访问和证书的更新。"><meta name="DC.date" content="2012-7-11"><meta name="DC.relation" content="CN:101317362:A" scheme="references"><meta name="DC.relation" content="CN:101593380:A" scheme="references"><meta name="DC.relation" content="CN:101777978:A" scheme="references"><meta name="DC.relation" content="CN:201122439" scheme="references"><meta name="DC.relation" content="CN:201150068" scheme="references"><meta name="DC.relation" content="EP:2009839:A1" scheme="references"><meta name="DC.relation" content="JP:2010117885" scheme="references"><meta name="citation_patent_publication_number" content="CN:102571340:A"><meta name="citation_patent_application_number" content="CN:201010620431"><link rel="canonical" href="https://www.google.com/patents/CN102571340A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN102571340A?cl=zh"/><meta name="title" content="专利 CN102571340A - 证书认证装置及该装置的访问和证书更新方法"/><meta name="description" content="本发明公开了一种证书认证装置，该装置包括：普通存储模块、存储控制模块和接口模块；所述普通存储模块与存储控制模块相连，所述存储控制模块和接口模块相连；该装置还包括：安全存储模块，与运算处理模块以及安全控制模块分别相连，用于存储用于证书认证的私密信息；运算处理模块，用于对加密算法进行硬件加速；安全控制模块，与所述存储控制模块相连，用于调度所述运算处理模块进行运算，控制所述安全存储模块进行数据的存储和输出。该装置能够在保证安全性的情况下，拥有较高的证书认证速度。本发明还公开了一种基于该证书认证装置的访问方法和证书更新方法，实现对该证书认证装置的访问和证书的更新。"/><meta property="og:title" content="专利 CN102571340A - 证书认证装置及该装置的访问和证书更新方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN102571340A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN102571340A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=uqWDBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN102571340A&amp;usg=AFQjCNEdr0yiN2FL-LR9yQ2aIBhNc0l6_g" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/813e176e3b609607d54e/CN102571340A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/813e176e3b609607d54e/CN102571340A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN102571340A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN102571340A?cl=en&amp;hl=zh-CN"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN102571340A?cl=zh" style="display:none"><span itemprop="description">本发明公开了一种证书认证装置，该装置包括：普通存储模块、存储控制模块和接口模块；所述普通存储模块与存储控制模块相连，所述存储控制模块和接口模块相连；该装置还包括：安全存储模块，与运算处理模块以及安全控...</span><span itemprop="url">https://www.google.com/patents/CN102571340A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN102571340A - 证书认证装置及该装置的访问和证书更新方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN102571340A - 证书认证装置及该装置的访问和证书更新方法" title="专利 CN102571340A - 证书认证装置及该装置的访问和证书更新方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN102571340 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201010620431</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2012年7月11日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2010年12月23日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2010年12月23日</td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201010620431.X, </span><span class="patent-bibdata-value">CN 102571340 A, </span><span class="patent-bibdata-value">CN 102571340A, </span><span class="patent-bibdata-value">CN 201010620431, </span><span class="patent-bibdata-value">CN-A-102571340, </span><span class="patent-bibdata-value">CN102571340 A, </span><span class="patent-bibdata-value">CN102571340A, </span><span class="patent-bibdata-value">CN201010620431, </span><span class="patent-bibdata-value">CN201010620431.X</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%88%98%E9%81%93%E6%96%8C%22">刘道斌</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%BB%96%E5%89%91%22">廖剑</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%8E%8B%E6%99%A8%E9%98%B3%22">王晨阳</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%99%88%E5%BA%86%E6%96%B9%22">陈庆方</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E6%99%AE%E5%A4%A9%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF%E7%A0%94%E7%A9%B6%E9%99%A2%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">普天信息技术研究院有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102571340A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102571340A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102571340A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (7),</span> <span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (2),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (1),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (4)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=uqWDBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201010620431&amp;usg=AFQjCNGFvRznTWnMXRpuRQbjSHHbN1hpvA"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=uqWDBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D102571340A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNEf2PWpic-iyVFrk96AmsZyvMNhMg"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT114031869" lang="ZH" load-source="patent-office">证书认证装置及该装置的访问和证书更新方法</invention-title>
      </span><br><span class="patent-number">CN 102571340 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA98379970" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明公开了一种证书认证装置，该装置包括：普通存储模块、存储控制模块和接口模块；所述普通存储模块与存储控制模块相连，所述存储控制模块和接口模块相连；该装置还包括：安全存储模块，与运算处理模块以及安全控制模块分别相连，用于存储用于证书认证的私密信息；运算处理模块，用于对加密算法进行硬件加速；安全控制模块，与所述存储控制模块相连，用于调度所述运算处理模块进行运算，控制所述安全存储模块进行数据的存储和输出。该装置能够在保证安全性的情况下，拥有较高的证书认证速度。本发明还公开了一种基于该证书认证装置的访问方法和证书更新方法，实现对该证书认证装置的访问和证书的更新。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(18)</span></span></div><div class="patent-text"><div mxw-id="PCLM44203748" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.	一种证书认证装置，包括普通存储模块、存储控制模块和接口模块；所述普通存储模块与存储控制模块相连，所述存储控制模块和接口模块相连；其特征在于，该装置还包括：安全存储模块，与运算处理模块以及安全控制模块分别相连，用于存储用于证书认证的私密信息；运算处理模块，用于对加密算法进行硬件加速；安全控制模块，与所述存储控制模块相连，用于调度所述运算处理模块进行运算，控制所述安全存储模块进行数据的存储和输出。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.如权利要求1所述的证书认证装置，其特征在于，所述安全存储模块、运算处理模块和安全控制模块集成于一块独立芯片。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.如权利要求1所述的证书认证装置，其特征在于，所述安全存储模块、运算处理模块、安全控制模块和存储控制模块集成于一块独立芯片。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.如权利要求1所述的证书认证装置，其特征在于，所述安全存储模块与所述普通存储模块集成于一块独立芯片；所述运算处理模块、安全控制模块和存储控制模块集成于另一块独立芯片。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.所述如权利要求1&#12316;4中任一项权利要求所述的证书认证装置，其特征在于，所述安全控制模块与所述存储控制模块通过串口、国际标准化组织IS07816或串行外设接口 SPI 总线方式连接。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.	一种基于权利要求1所述的证书认证装置的访问方法，其特征在于，该方法包括： 存储控制模块通过接口模块接收到存储卡写指令时，若所述写指令指定的地址是预先定义的特殊地址，则将所述写指令携带的数据作为命令数据传送给安全控制模块；安全控制模块解析并响应所述命令数据，根据所述命令数据对应的操作指令进行处理；安全控制模块将处理完成后得到的响应数据输出给存储控制模块； 存储控制模块对所述响应数据进行重组。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.如权利要求6所述的访问方法，其特征在于，该方法进一步包括：当存储控制模块通过接口模块接收到外部应用程序发送的读指令时，若所述读指令指定的地址是预先定义的特殊地址，则将重组后的所述响应数据作为读指令的反馈数据反馈给外部应用程序。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.如权利要求6或7所述的访问方法，其特征在于，所述若写指令指定的地址是预先定义的特殊地址，该方法进一步包括：对所述写指令进行校验，若所述写指令校验通过，则继续执行所述将写指令携带的数据作为命令数据传送给安全控制模块的步骤及其后续步骤。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.如权利要求8所述的访问方法，其特征在于，该方法进一步包括：若所述写指令指定的地址不是预先定义的特殊地址，或者所述写指令携带的数据未通过校验，则存储控制模块将所述写指令携带的数据作为普通数据传送给普通存储模块进行存储。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.	一种基于权利要求1所述的证书认证装置的证书更新方法，其特征在于，该方法包括：当证书认证装置MobileKey中原有的数字证书失效后，MobileKey按照与认证中心CA预先协商好的协议产生新的公、私钥对，通过其连接的终端向CA发送经CA的公钥加密的更新请求；所述更新请求中携带所述新的公钥；CA使用CA的私钥对收到的加密的更新请求进行解密，利用所述更新请求中携带的新的公钥为MobileKey重新签发新的数字证书，返回更新响应，所述更新响应中包括加密后的新数字证书；MobileKey收到CA返回的更新响应后，用所述新的数字证书和所述新的私钥替换 Mobi 1 eKey中原有的已失效的数字证书和原有的私钥。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="11" class="claim">
      <div class="claim-text">11.如权利要求10所述的证书更新方法，其特征在于，所述更新请求中进一步携带用于唯一标识MobileKey身份的MobileKey标识、已经失效的数字证书及会话密钥；所述失效的数字证书中包含使用CA的私钥加密的MobileKey标识。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12.如权利要求11所述的证书更新方法，其特征在于，所述CA对更新请求进行解密后， 该方法进一步包括：根据所述MobileKey标识和失效的数字证书判断所述MobileKey是否是CA域内的合法用户，若是，则继续执行所述利用更新请求中携带的新的公钥为MobileKey重新签发新的数字证书的步骤及其后续步骤，否则结束证书更新流程。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13.如权利要求12所述的证书更新方法，其特征在于，所述根据所述MobileKey标识和失效的数字证书判断所述MobileKey是否是CA域内的合法用户，包括：用CA的公钥解密MobileKey数字证书中CA的签名，恢复出MobileKey标识的明文，并判断恢复出的MobileKey标识是否与MobileKey发送来的更新请求中携带的MobileKey标识相同，相同则为CA域内的合法用户，不同则不是合法用户。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="14" class="claim">
      <div class="claim-text">14.如权利要求12所述的证书更新方法，其特征在于，所述更新请求中进一步携带CA 数字签名；所述CA数字签名是指CA对保存在MobileKey中的已经失效的数字证书序列号加密后得到的数据，CA数字签名是CA上一次给MobileKey签发数字证书，即保存在证书认证装置中的已经失效的数字证书时，发送给MobileKey的。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="15" class="claim">
      <div class="claim-text">15.如权利要求14所述的证书更新方法，其特征在于，根据所述MobileKey标识和失效的数字证书判断所述MobileKey是CA域内的合法用户之后，该方法进一步包括：根据所述更新请求中携带的CA数字签名判断该更新请求是否是MobileKey发送来的， 如果是，则继续执行所述利用更新请求中携带的新的公钥为MobileKey重新签发新的数字证书的步骤及其后续步骤，否则结束证书更新流程。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="16" class="claim">
      <div class="claim-text">16.如权利要求15所述的证书更新方法，其特征在于，根据所述更新请求中携带的CA 数字签名判断该更新请求是否是MobileKey发送来的，包括：根据CA的公钥解密所述CA数字签名，恢复出已经失效的数字证书序列号的明文，并判断恢复出的已经失效的证书序列号是否与MobileKey发送来的更新请求中携带的已经失效的数字证书的序列号相同，如果相同，则判断出该更新请求是MobileKey发送来的，否则判断出该更新请求不是MobileKey发送来的。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="17" class="claim">
      <div class="claim-text">17.如权利要求15所述的证书更新方法，其特征在于，所述返回更新响应包括：CA用MobileKey发送来的所述会话密钥对所述重新签发的新的数字证书进行加密， 使用CA的私钥对新签发的数字证书的序列号进行加密得到新的CA数字签名，再使用MobileKey发送来的会话密钥对新的CA数字签名进行加密；所述更新响应中携带加密后的新的数字证书和加密后的新CA数字签名。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="18" class="claim">
      <div class="claim-text">18.如权利要求17所述的证书更新方法，其特征在于，MobileKey收到CA返回的更新响应后，该方法进一步包括：用所述会话密钥对所述更新响应中携带的加密后的新的数字证书及加密后的新CA数字签名进行解密，并继续执行用所述新的数字证书和所述新的私钥替换MobileKey中原有的已失效的数字证书和原有的私钥的步骤，并进一步执行用所述新CA数字签名替换原CA 数字签名的步骤。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES49825428" lang="ZH" load-source="patent-office" class="description">
    <p>证书认证装置及该装置的访问和证书更新方法</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及认证技术领域，特别涉及证书认证装置及该装置的访问和证书更新方法。</p>
    <p>背景技术</p>
    <p>[0002]	USBKey是一种通用串行总线（USB)接口的证书认证装置，它内置单片机或智能卡芯片，有一定的存储空间，可以存储用户的私钥以及数字证书，利用USBKey内置的公钥算法实现对用户身份的认证。</p>
    <p>[0003]	USBKey在现在的网上银行、政府的OA以及虚拟专用网（VPN)中都应用的比较广泛。USBKey提供了数字证书在终端安全存储的环境；通过硬件协处理器处理运算提高了认证的效率，是目前对证书认证比较好的解决方案。</p>
    <p>[0004]	随着移动支付、移动办公的兴起，对于移动终端的证书认证需求越来越多，由于很多移动终端并不支持USB接口，且USB接口功耗太大，大多数移动终端无法负担，因此，目前 USBKey的证书认证方式并不适用于移动终端。</p>
    <p>[0005]	为了解决移动终端的证书认证的问题，目前主要采取以下两种方案：</p>
    <p>[0006]	一、软证书认证方式</p>
    <p>[0007]	这个方式是把数字证书及私钥直接存放在移动终端设备上，私钥由用户的个人识别码（PIN)保护，证书认证中需要的非对称密钥的产生、加解密和签名验证等运算由移动终端上承载的软件实现。</p>
    <p>[0008]	二、用户识别卡（SIM)卡方式</p>
    <p>[0009]	这个方式是把SIM卡作为数字证书存放的硬件载体，证书认证中需要的非对称密钥的产生、加解密和签名验证等运算由SIM卡实现。</p>
    <p>[0010]	方案一的缺陷：</p>
    <p>[0011]	数字证书及私钥存放在移动终端设备上，使用过程中需要存放于终端的内存 (RAM)中，容易被攻击者获取，安全性不高，不符合国家信息安全相关标准。另外，证书认证中需要的非对称密钥的产生、加解密和签名验证等运算由软件实现，运算速度慢。以普通的智能机为例，主频在200M左右，生成一对IOM位RSA加密算法的密钥对平均需要时间大约几十秒，相比使用硬件产生同样长度的密钥对的平均时间4秒来说，差距很大，从而影响认证速度。</p>
    <p>[0012]	方案二的缺陷：</p>
    <p>[0013]	SIM卡存储空间很小，数字证书及私钥若保存在SIM卡上，将会影响其他数据的存储，比如占用通讯录等数据的存储空间。而且，SIM卡通信速率很低，大多数SIM卡采用的是国际标准化组织（ISO) 7816接口，相对于一般的存储卡接口的传输速率来说，速度差距较大，从而影响认证速度。另外，由于SIM卡不能直接在PC上使用，无法兼容当前PC上的证书认证方式，其适用范围受限。发明内容</p>
    <p>[0014]	本发明实施例提供一种证书认证装置，用于移动终端时，能够在保证安全性的情况下，拥有较高的证书认证速度。</p>
    <p>[0015]	本发明实施例提供一种证书认证装置的访问方法，能够实现对证书认证装置内用于认证的私密信息的访问。</p>
    <p>[0016]	本发明实施例提供一种证书认证装置的证书更新方法，能够简便地实现对证书认证装置中保存的证书的更新。</p>
    <p>[0017]	为达到上述目的，本发明的技术方案具体是这样实现的：</p>
    <p>[0018]	一种证书认证装置，包括普通存储模块、存储控制模块和接口模块；所述普通存储模块与存储控制模块相连，所述存储控制模块和接口模块相连；该装置还包括：</p>
    <p>[0019]	安全存储模块，与运算处理模块以及安全控制模块分别相连，用于存储用于证书认证的私密信息；</p>
    <p>[0020]	运算处理模块，用于对加密算法进行硬件加速；</p>
    <p>[0021]	安全控制模块，与所述存储控制模块相连，用于调度所述运算处理模块进行运算， 控制所述安全存储模块进行数据的存储和输出。</p>
    <p>[0022]	较佳地，所述安全存储模块、运算处理模块和安全控制模块集成于一块独立芯片。</p>
    <p>[0023]	较佳地，所述安全存储模块、运算处理模块、安全控制模块和存储控制模块集成于一块独立芯片。</p>
    <p>[0024]	较佳地，所述安全存储模块与所述普通存储模块集成于一块独立芯片；所述运算处理模块、安全控制模块和存储控制模块集成于另一块独立芯片。</p>
    <p>[0025]	较佳地，所述安全控制模块与所述存储控制模块通过串口、7816或SPI总线方式连接。</p>
    <p>[0026]	一种基于上述的证书认证装置的访问方法，该方法包括：</p>
    <p>[0027]	存储控制模块通过接口模块接收到存储卡写指令时，若所述写指令指定的地址是预先定义的特殊地址，则将所述写指令携带的数据作为命令数据传送给安全控制模块；</p>
    <p>[0028]	安全控制模块解析并响应所述命令数据，根据所述命令数据对应的操作指令进行处理；</p>
    <p>[0029]	安全控制模块将处理完成后得到的响应数据输出给存储控制模块；</p>
    <p>[0030]	存储控制模块对所述响应数据进行重组。</p>
    <p>[0031]	较佳地，该方法进一步包括：</p>
    <p>[0032]	当存储控制模块通过接口模块接收到外部应用程序发送的读指令时，若所述读指令指定的地址是预先定义的特殊地址，则将重组后的所述响应数据作为读指令的反馈数据反馈给外部应用程序。</p>
    <p>[0033]	较佳地，所述若写指令指定的地址是预先定义的特殊地址，该方法进一步包括：对所述写指令进行校验，若所述写指令校验通过，则继续执行所述将写指令携带的数据作为命令数据传送给安全控制模块的步骤及其后续步骤。</p>
    <p>[0034]	较佳地，该方法进一步包括：</p>
    <p>[0035]	若所述写指令指定的地址不是预先定义的特殊地址，或者所述写指令携带的数据未通过校验，则存储控制模块将所述写指令携带的数据作为普通数据传送给普通存储模块进行存储。</p>
    <p>[0036]	一种基于上述的证书认证装置的证书更新方法，该方法包括：</p>
    <p>[0037]	当证书认证装置MobileKey中原有的数字证书失效后，MobileKey按照与认证中心CA预先协商好的协议产生新的公、私钥对，通过其连接的终端向CA发送经CA的公钥加密的更新请求；所述更新请求中携带所述新的公钥；</p>
    <p>[0038]	CA使用CA的私钥对收到的加密的更新请求进行解密，利用所述更新请求中携带的新的公钥为MobileKey重新签发新的数字证书，返回更新响应，所述更新响应中包括加密后的新数字证书；</p>
    <p>[0039]	MobileKey收到CA返回的更新响应后，用所述新的数字证书和所述新的私钥替换 Mobi 1 eKey中原有的已失效的数字证书和原有的私钥。</p>
    <p>[0040]	较佳地，所述更新请求中进一步携带用于唯一标识MobileKey身份的MobileKey 标识、已经失效的数字证书及会话密钥；</p>
    <p>[0041]	所述失效的数字证书中包含使用CA的私钥加密的MobileKey标识。</p>
    <p>[0042]	较佳地，所述CA对更新请求进行解密后，该方法进一步包括：</p>
    <p>[0043]	根据所述MobileKey标识和失效的数字证书判断所述MobileKey是否是CA域内的合法用户，若是，则继续执行所述利用更新请求中携带的新的公钥为MobileKey重新签发新的数字证书的步骤及其后续步骤，否则结束证书更新流程。</p>
    <p>[0044]	较佳地，所述根据所述MobileKey标识和失效的数字证书判断所述MobileKey是否是CA域内的合法用户，包括：</p>
    <p>[0045]	用CA的公钥解密MobileKey数字证书中CA的签名，恢复出MobileKey标识的明文，并判断恢复出的MobileKey标识是否与MobileKey发送来的更新请求中携带的 MobileKey标识相同，相同则为CA域内的合法用户，不同则不是合法用户。</p>
    <p>[0046]	较佳地，所述更新请求中进一步携带CA数字签名；</p>
    <p>[0047]	所述CA数字签名是指CA对保存在MobileKey中的已经失效的数字证书序列号加密后得到的数据，CA数字签名是CA上一次给MobileKey签发数字证书，即保存在证书认证装置中的已经失效的数字证书时，发送给Mobi 1 eKey的。</p>
    <p>[0048]	较佳地，根据所述MobileKey标识和失效的数字证书判断所述MobileKey是CA域内的合法用户之后，该方法进一步包括：</p>
    <p>[0049]	根据所述更新请求中携带的CA数字签名判断该更新请求是否是MobileKey发送来的，如果是，则继续执行所述利用更新请求中携带的新的公钥为MobileKey重新签发新的数字证书的步骤及其后续步骤，否则结束证书更新流程。</p>
    <p>[0050]	较佳地，根据所述更新请求中携带的CA数字签名判断该更新请求是否是 MobileKey发送来的，包括：</p>
    <p>[0051]	根据CA的公钥解密所述CA数字签名，恢复出已经失效的数字证书序列号的明文， 并判断恢复出的已经失效的证书序列号是否与MobileKey发送来的更新请求中携带的已经失效的数字证书的序列号相同，如果相同，则判断出该更新请求是MobileKey发送来的， 否则判断出该更新请求不是MobileKey发送来的。</p>
    <p>[0052]	较佳地，所述返回更新响应包括：</p>
    <p>[0053]	CA用MobileKey发送来的所述会话密钥对所述重新签发的新的数字证书进行加密，使用CA的私钥对新签发的数字证书的序列号进行加密得到新的CA数字签名，再使用 MobileKey发送来的会话密钥对新的CA数字签名进行加密；所述更新响应中携带加密后的新的数字证书和加密后的新CA数字签名。</p>
    <p>[0054]	较佳地，MobileKey收到CA返回的更新响应后，该方法进一步包括：</p>
    <p>[0055]	用所述会话密钥对所述更新响应中携带的加密后的新的数字证书及加密后的新 CA数字签名进行解密，并继续执行用所述新的数字证书和所述新的私钥替换MobileKey中原有的已失效的数字证书和原有的私钥的步骤，并进一步执行用所述新CA数字签名替换原CA数字签名的步骤。</p>
    <p>[0056]	由上述的技术方案可见，本发明的这种证书认证装置，用于移动终端时，由于使用硬件作为私钥和证书等安全信息的载体，安全性远高于软证书方式；由于采用存储卡接口， 通信速度远高于SIM卡的IS07816接口；另外，由于基于标准的存储卡接口，适用范围广泛， 除移动终端外，还可以通过读卡器等设备与PC等终端相连作为PC平台的证书载体。</p>
    <p>[0057]	本发明的这种证书认证装置的访问方法，通过预先设定的特殊地址将对本发明的证书认证装置内保存的私密信息的访问，和对普通数据的访问区别开，从而实现对证书认证装置内的私密信息的访问。</p>
    <p>[0058]	本发明的这种证书认证装置的证书更新方法，可以通过证书认证装置连接的终端设备与认证中心通信，在保证安全性的同时，实现在线的证书更新，从而简化了证书更新过程。</p>
    <p>附图说明</p>
    <p>[0059]	图1为现有存储卡结构示意图；</p>
    <p>[0060]	图2为本发明实施例一的证书认证装置结构示意图；</p>
    <p>[0061]	图3为本发明实施例二的证书认证装置结构示意图；</p>
    <p>[0062]	图4为本发明实施例三的证书认证装置结构示意图；</p>
    <p>[0063]	图5为本发明实施例的证书认证装置访问方法流程图；</p>
    <p>[0064]	图6为本发明实施例的证书更新方法流程图。</p>
    <p>具体实施方式</p>
    <p>[0065]	为使本发明的目的、技术方案及优点更加清楚明白，以下参照附图并举实施例，对本发明进一步详细说明。</p>
    <p>[0066]	本发明主要是在标准接口的存储卡中内嵌用于证书认证的模块，通过硬件保存保密信息并完成证书认证过程，从而能够在保证安全性的情况下，提高证书认证的速度，并拥有较大的适用范围。本发明这种证书认证装置可称为MobileKey。</p>
    <p>[0067]	图1为现有的存储卡结构示意图，如图1所示，包括普通存储模块101、存储控制模块102和接口模块103 ；</p>
    <p>[0068]	其中普通存储模块101用于存储普通数据，一般由闪存（FLASH)芯片实现；存储控制模块102与普通存储模块101及接口模块103分别相连，用于对普通存储模块101进行数据的读写控制等，一般由一块独立芯片实现；接口模块103用于收发数据，可以采用安全数码卡（SD)/多媒体卡（MMC)/记忆棒（Memory Stick)等标准接口实现。[0069]	本发明具体实施例中，将在现有的存储卡结构中增加以下用于证书认证的模块：</p>
    <p>[0070]	安全存储模块，用于存储用于证书认证的私密信息，例如数字证书、数字证书对应的私钥信息，密钥种子等不可泄露的信息，不用于普通数据的存储。</p>
    <p>[0071]	运算处理模块，用于对加密算法进行硬件加速，例如可以是RSA(&#8212;种加密算法） 运算加速引擎、随机数发生器、AES ( &#8212;种加密算法）运算引擎等，根据使用的具体加密算法不同而异。</p>
    <p>[0072]	安全控制模块，用于调度运算处理模块进行运算、控制安全存储模块进行数据的存储和输出等。</p>
    <p>[0073]	上述三个模块在物理上，可以由一个独立的芯片实现，例如智能卡芯片、专用的协处理芯片等，并与存储控制模块通过串口、IS07816、串行外设接口（SPI)等总线方式连接， 也可以将上述三个模块集成在现有的其他模块所在的芯片中，例如将上述三个模块全部集成于存储控制模块所在芯片；或者将安全存储模块集成于普通存储模块所在的FLASH芯片，运算处理模块和安全控制模块集成于存储控制模块所在芯片。</p>
    <p>[0074]	图2为本发明实施例一的证书认证装置结构示意图，如图2所示，该装置包括：普通存储模块201、存储控制模块202，和接口模块203，安全存储模块204，运算处理模块205， 以及安全控制模块206。</p>
    <p>[0075]	其中，普通存储模块201、存储控制模块202和接口模块203的功能及连接关系与现有存储卡相同，不再赘述。安全存储模块204与运算处理模块205以及安全控制模块206 分别相连，安全控制模块206还与存储控制模块202相连，安全存储模块204与运算处理模块205以及安全控制模块206集成于一个独立的安全处理芯片中，而普通存储模块201由 FLASH芯片实现，存储控制模块202由控制器芯片实现。</p>
    <p>[0076]	图3为本发明实施例二的证书认证装置结构示意图，如图3所示，该装置包括：普通存储模块301、存储控制模块302，和接口模块303，安全存储模块304，运算处理模块305， 以及安全控制模块306。</p>
    <p>[0077]	其中，各模块的功能和连接关系相同，不再赘述。其与实施例一的区别在于安全存储模块304、运算处理模块305以及安全控制模块306与存储控制模块302集成于控制器芯片中。</p>
    <p>[0078]	图4为本发明实施例三的证书认证装置结构示意图，如图4所示，该装置包括：普通存储模块401、存储控制模块402，和接口模块403，安全存储模块404，运算处理模块405， 以及安全控制模块406。</p>
    <p>[0079]	其中，各模块的功能和连接关系相同，不再赘述。其与实施例一、二的区别在于安全存储模块404与普通存储模块401集成于FLASH芯片中，而运算处理模块405以及安全控制模块406与存储控制模块402集成于控制器芯片中。</p>
    <p>[0080]	当然，对于本发明的证书认证装置来说，由于普通存储模块的功能与证书认证无关，所以并不是必须的。另外，不限于上述三个实施例，本发明中安全存储模块、运算处理模块以及安全控制模块在物理上也可以分别通过独立的芯片实现，或者集成于现有存储卡内的任意芯片中。</p>
    <p>[0081]	对于上述证书认证装置来说，由于是在标准存储卡的接口上扩展证书认证的应用，而标准的存储卡协议并不支持对卡内用于证书认证的模块的访问，如果不能实现对用于证书认证的模块的访问，则证书认证的认证过程和证书更新过程等将无法实现。对此， 我们设计了通过共享地址的方式访问卡内用于证书认证的模块的方法，具体步骤如图5所示，包括：</p>
    <p>[0082]	步骤501，预先定义特殊地址。</p>
    <p>[0083]	这个特殊地址可以是某一个地址或某一段地址范围，具体可根据需要而定。由于存储卡属于外部存储设备，只能通过写或读指令进行操作，而写或读指令中指定了具体写或读的地址，因此可以通过定义特殊地址，在接收到写或读指令时，通过判断指令中指定的地址，区分出外部应用程序是对证书认证装置中现有的普通存储模块进行读写操作，还是对本发明中用于证书认证的模块进行的操作。</p>
    <p>[0084]	步骤502，根据特殊地址确定命令数据。</p>
    <p>[0085]	当外部应用程序需要访问卡内数据时，例如控制器芯片中的存储控制模块通过接口模块接收到外部应用程序发送的写指令时，判断写指令中指定的地址是否是预先定义的特殊地址。如果是特殊地址，则进一步校验写指令携带的数据的有效性，有效性校验实际上是为了安全性考虑，防止指令被中途篡改，一般来说可以采用校验和方式进行校验，或者采用加密算法等，具体校验方法可以使用现有的任意校验方法，这里不再赘述，当然，如果对于安全性要求不高，这里也可以不进行校验；如果校验不通过，则将写指令携带的数据作为普通数据存储到普通存储模块。如果校验通过，则作为命令数据传送给安全控制模块；另外，如果不是特殊地址，则直接将写指令携带的数据作为普通数据存储到普通存储模块。</p>
    <p>[0086]	步骤503，根据所述命令数据进行相应处理。</p>
    <p>[0087]	安全控制模块接收到命令数据时，解析并响应该命令数据进行相应的处理，命令数据内包含的是外部应用程序对本发明中各个用于证书认证的模块的操作指令，例如可以是调用运算处理模块对安全存储模块内保存的私密信息进行加密、生成密钥等操作，或者对安全存储模块进行私密信息数据的存储等。安全控制模块响应命令数据进行处理完成之后，将响应命令数据进行处理后得到的响应数据输出给存储控制模块。</p>
    <p>[0088]	步骤504，将处理后的数据进行反馈。</p>
    <p>[0089]	存储控制模块得到安全控制模块反馈的响应数据后，重新组织具体应用的响应数据，并存放在存储控制模块内部的缓存区中。由于在存储卡中进行处理得到数据的格式与外部应用程序所需要的数据格式不同，因此这里存储控制模块需要将响应数据重新大包封装成外部程序所需要的数据格式，以便外部应用程序的读取。另外，由于存储卡是被动设备，外部应用程序只能通过读指令获取数据。因此当存储控制模块通过接口模块接收到外部应用发送的存储卡读指令时，需要判断读指令指定的地址是否是预先定义的特殊地址， 如果是特殊地址，且存储控制模块已经完成了响应数据的重组，则将重组好的响应数据作为存储卡读指令的反馈数据，通过接口模块反馈给外部应用。</p>
    <p>[0090]	在上述过程中，外部应用程序对特殊地址发出读写指令，可以采用两种方式实现， 一种是直接利用系统的应用程序接口（API)进行物理地址的数据读写；另一种是读写覆盖了这个扇区的文件，通过对文件某个数据块的读写，实现通过文件系统进行物理地址的数据读写。另外，外部应用程序对于认证的模块的具体应用功能指令可以作为读写指令指定的数据携带在读写指令中。</p>
    <p>[0091]	通过上述方法，外部应用程序即可实现对存储卡内的用于证书认证的模块的访问，本领域具体技术人员根据该访问方法，即可实现具体的证书认证的过程，由于本发明并未对证书认证过程进行改进，因此通过本发明的证书认证装置具体实现证书认证的过程这里就不再赘述了。</p>
    <p>[0092]	为了提高MobileKey在使用过程中的安全性，认证中心（CA)在给MobileKey 分配数字证书时会对该数字证书设置有效期，一旦过了有效期，该数字证书将变得无效， MobileKey在与移动终端设备进行身份认证时将无法通过。因此，为了保证MobileKey的正常使用，CA需要对MobileKey的数字证书进行更新。</p>
    <p>[0093]	由于MobileKey无法直接与CA建立通信，而且MobileKey大都处于离线状态， 从而使得数字证书更新比较困难。一种可能的方法是，由用户定期到CA指定的地点对 MobileKey数字证书进行更新，但这种数字证书更新过程较为繁琐，并且会给用户带来诸多不便。</p>
    <p>[0094]	有鉴于此，本发明提供了一种Mobi 1 eKey数字证书更新方法，简化了 Mobi 1 eKey的数字证书更新过程。</p>
    <p>[0095]	本发明中的MobileKey可以通过终端以在线方式进行数字证书更新，即让 MobileKey在与终端连接时，利用终端和CA之间的数据连接通道，如WLAN、GPRS等，完成 MobileKey数字证书的更新。MobileKey先按照预先与CA协商好的协议产生公、私钥对， 向CA发起数字证书更新请求，CA收到更新请求后，重新为MobileKey签发数字证书，之后， MobileKey用重新签发的数字证书和私钥替换失效的数字证书和私钥，完成整个更新过程。</p>
    <p>[0096]	下面以MobileKey与移动终端连接时进行证书更新过程的典型应用为例进行详细说明，当然，在MobileKey与个人电脑（PC)等其他终端连接时，证书更新的过程也是相同的。</p>
    <p>[0097]	首先，MobileKey内需要存储有能够唯一标识MobileKey身份的MobileKey标识、 MobileKey数字证书和CA数字证书等私密信息，其中，CA数字证书中包含有CA的公钥，对应的，CA中保存有CA数字证书对应的CA的私钥。</p>
    <p>[0098]	如图6所示，数字证书更新过程包括以下步骤：</p>
    <p>[0099]	步骤601 ：当MobileKey数字证书失效时，MobileKey启动证书更新过程，先按照预先与CA协商好的协议产生新的公、私钥对以及会话密钥，通过其连接的移动终端向CA发送更新请求。</p>
    <p>[0100]	更新请求中携带以下请求信息=MobileKey标识、失效的MobileKey数字证书、按照预先与CA协商好的协议产生的新的公钥、CA数字签名及会话密钥，为信息的安全传输起见，请求信息必须用CA的公钥进行加密。</p>
    <p>[0101]	其中，失效的MobileKey数字证书中包含使用CA的私钥加密的MobileKey标识。 MobileKey标识和失效的MobileKey数字证书是用于让CA判断MobileKey是否是CA域内的合法用户，如果对于安全性要求不高，可以省略判断MobileKey是否是CA域内的合法用户的步骤，这时更新请求中也可以不携带MobileKey标识和失效的MobileKey数字证书。</p>
    <p>[0102]	CA数字签名是指用CA的私钥对某些信息进行加密而得到的数据，例如本实施例中是CA对保存在证书认证装置中的已经失效的MobileKey数字证书序列号加密后得到的数据，当然，任何其它具有唯一性的信息都可以进行加密操作得到CA数字签名。CA数字签名是CA在为Mob i 1 eKey签发数字证书时发送给Mob i 1 eKey的，即CA上一次给Mob i 1 eKey签发MobileKey数字证书（保存在证书认证装置中的已经失效的MobileKey数字证书）时， 发送给MobileKey的。</p>
    <p>[0103]	另外，CA数字签名不能放在MobileKey数字证书中发送，也就是说，CA数字签名不能公开。CA数字签名是为防止移动终端欺骗CA而设置的，保存在MobileKey内，移动终端无法得到，并且，由于移动终端没有CA的私钥，无法伪造CA数字签名，因此移动终端也就无法伪造MobileKey向CA发送的更新请求来欺骗CA。</p>
    <p>[0104]	而会话密钥是为防止移动终端欺骗MobileKey而设置，由于会话密钥只在 MobileKey和CA之间传递，移动终端不知道CA和MobileKey的会话密钥，因此，移动终端无法解密响应信息，也无法通过伪造响应信息来欺骗MobileKey。</p>
    <p>[0105]	在数字证书更新过程中，CA数字签名和会话密钥可以同时使用，也就是说，在更新请求中同时携带CA数字签名和会话密钥；也可以仅使用CA数字签名或者仅使用会话密钥， 当不使用CA数字签名时，CA不需要在为MobileKey签发新的数字证书时发送CA数字签名的操作；当然，如果对可能出现的中间人攻击的安全性要求不高，也可以都不使用，通过CA 数字证书对MobileKey与CA之间通信进行加密也可以保证较高的安全性。下面针对同时使用CA数字签名和会话密钥、以及用CA的公钥加密请求信息的情况进行详细阐述。</p>
    <p>[0106]	步骤602 =CA收到MobileKey发送来的更新请求后，判断MobileKey是否是CA域内的合法用户，即CA首先用CA的私钥对收到的请求信息进行解密，恢复出请求信息明文， 然后，用CA的公钥解密MobileKey数字证书中CA的签名，恢复出MobileKey标识的明文， 并判断恢复出的MobileKey标识是否与MobileKey发送来的更新请求中携带的MobileKey 标识相同，如果相同，则说明该MobileKey是CA域内的合法用户，继续执行步骤603 ；如果不同，则说明该MobileKey不是CA域内的合法用户，CA终止与该MobileKey的通信，即结束本流程的处理。</p>
    <p>[0107]	步骤603 :CA根据更新请求中携带的CA数字签名判断该更新请求是否是 MobileKey发送来的，如果是，则执行步骤604 ；否则，CA终止会话，即结束本流程的处理。</p>
    <p>[0108]	具体地，CA用自身的公钥解密CA数字签名，恢复出MobileKey证书序列号的明文，并判断恢复出的MobileKey证书序列号是否与MobileKey发送来的更新请求中携带的 MobileKey数字证书中的序列号相同，如果相同，则说明该更新请求是MobileKey发送来的，因为只有MobileKey才拥有CA对MobileKey证书序列号的签名即CA数字签名，然后执行步骤604;如果不同，则说明该更新请求不是MobileKey发送来的，CA终止会话，结束本流程。</p>
    <p>[0109]	如果更新请求中没有携带CA数字签名，那么，在步骤602中判断出该MobileKey 是CA域内的合法用户后，可以直接执行步骤604，无需执行步骤603。</p>
    <p>[0110]	步骤604 :CA利用更新请求中携带的MobileKey按照预先与CA协商好的协议产生的新的公钥为MobileKey重新签发新的数字证书，并用MobileKey发送来的会话密钥对重新签发的数字证书进行加密，使用CA的私钥对新签发的数字证书的序列号进行加密得到新的CA数字签名，再使用MobileKey发送来的会话密钥对新的CA数字签名进行加密&#8226;’然后，通过移动终端向MobileKey返回更新响应，该更新响应中携带的响应信息包括加密后的新数字证书以及加密后的新CA数字签名；如果不使用会话密钥，则无需对新签发的新数字证书和新CA数字签名进行加密，更新响应中携带新签发的新数字证书和CA数字签名的明文。</p>
    <p>[0111]	步骤605 =MobileKey收到CA返回的更新响应后，用会话密钥解密响应信息，恢复 MobileKey的新数字证书，并用新数字证书和按照预先与CA协商好的协议产生的私钥替换 MobileKey中原有的已失效的数字证书和私钥；用新的CA数字签名替换原CA数字签名。</p>
    <p>[0112]	至此，整个数字证书更新过程结束。该证书更新方法可以通过移动终端以在线的方式进行数字证书更新，在保证更新过程的安全性的同时，能够使MobileKey的数字证书更新过程得以简化，用户无需定期到CA指定的地点对MobileKey数字证书进行更新，很大程度上方便了用户。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101317362A?cl=zh">CN101317362A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年3月6日</td><td class="patent-data-table-td patent-date-value">2008年12月3日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">一种信息安全认证方法和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101593380A?cl=zh">CN101593380A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2008年5月28日</td><td class="patent-data-table-td patent-date-value">2009年12月2日</td><td class="patent-data-table-td ">北京飞天诚信科技有限公司</td><td class="patent-data-table-td ">一种基于动态密码生成和验证的门禁系统及认证方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101777978A?cl=zh">CN101777978A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2008年11月24日</td><td class="patent-data-table-td patent-date-value">2010年7月14日</td><td class="patent-data-table-td ">华为终端有限公司</td><td class="patent-data-table-td ">一种基于无线终端的数字证书申请方法、系统及无线终端</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN201122439Y?cl=zh">CN201122439Y</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年8月22日</td><td class="patent-data-table-td patent-date-value">2008年9月24日</td><td class="patent-data-table-td ">北京华大恒泰科技有限责任公司</td><td class="patent-data-table-td ">加密闪存盘</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN201150068Y?cl=zh">CN201150068Y</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年8月23日</td><td class="patent-data-table-td patent-date-value">2008年11月12日</td><td class="patent-data-table-td ">北京飞天诚信科技有限公司</td><td class="patent-data-table-td ">多功能信息安全设备</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/EP2009839A1?cl=zh">EP2009839A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年3月6日</td><td class="patent-data-table-td patent-date-value">2008年12月31日</td><td class="patent-data-table-td ">Huawei Technologies Co Ltd</td><td class="patent-data-table-td ">A method and system for information security authentication</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="https://www.google.com/url?id=uqWDBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DJP%26NR%3D2010117885A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNFJhICCJ9cfO08t1TBvFuZNXx85ZA">JP2010117885A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td patent-date-value"></td><td class="patent-data-table-td "> </td><td class="patent-data-table-td citation-no-title">没有名称</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102868526A?cl=zh">CN102868526A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年8月17日</td><td class="patent-data-table-td patent-date-value">2013年1月9日</td><td class="patent-data-table-td ">上海华申智能卡应用系统有限公司</td><td class="patent-data-table-td ">智能卡或usb key保护方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102868526B?cl=zh">CN102868526B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年8月17日</td><td class="patent-data-table-td patent-date-value">2015年6月10日</td><td class="patent-data-table-td ">上海华申智能卡应用系统有限公司</td><td class="patent-data-table-td ">智能卡或usb key保护方法及系统</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=uqWDBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0009320000">H04L9/32</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2012年7月11日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年9月12日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年3月27日</td><td class="patent-data-table-td ">ASS</td><td class="patent-data-table-td ">Succession or assignment of patent right</td><td class="patent-data-table-td "><div class="nested-key-value"><span class="nested-key">Owner name: </span><span class="nested-value">PUTIAN IT TECH INST CO., LTD.</span></div><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">FORMER OWNER: CHINA POTEVIO CO., LTD.</span></div><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20130306</span></div><div class="nested-key-value"><span class="nested-key">Owner name: </span><span class="nested-value">CHINA POTEVIO CO., LTD.</span></div><div class="nested-key-value"><span class="nested-key">Free format text: </span><span class="nested-value">FORMER OWNER: PUTIAN IT TECH INST CO., LTD.</span></div><div class="nested-key-value"><span class="nested-key">Effective date: </span><span class="nested-value">20130304</span></div></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年3月27日</td><td class="patent-data-table-td ">C41</td><td class="patent-data-table-td ">Transfer of patent application or patent right or utility model</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/813e176e3b609607d54e/CN102571340A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E8%AF%81%E4%B9%A6%E8%AE%A4%E8%AF%81%E8%A3%85%E7%BD%AE%E5%8F%8A%E8%AF%A5%E8%A3%85%E7%BD%AE%E7%9A%84%E8%AE%BF%E9%97%AE.pdf?id=uqWDBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U0QGiw4N4k9MrLxt7YHiGiPsU5gKQ"},"sample_url":"https://www.google.com/patents/reader?id=uqWDBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>