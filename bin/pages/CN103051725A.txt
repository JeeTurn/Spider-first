<!DOCTYPE html><html><head><title>专利 CN103051725A - 应用识别方法、数据挖掘方法、装置及系统 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="应用识别方法、数据挖掘方法、装置及系统"><meta name="DC.contributor" content="周&#38881;" scheme="inventor"><meta name="DC.contributor" content="唐东" scheme="inventor"><meta name="DC.contributor" content="张洪丁" scheme="inventor"><meta name="DC.contributor" content="华为技术有限公司" scheme="assignee"><meta name="DC.date" content="2012-12-31" scheme="dateSubmitted"><meta name="DC.description" content="本发明实施例公开了一种数据挖掘方法、装置及系统，该UBA数据挖掘方法包括：获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息；向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息，从而提升DPI识别性能和应用识别率。"><meta name="DC.date" content="2013-4-17"><meta name="DC.relation" content="CN:102075404:A" scheme="references"><meta name="DC.relation" content="CN:102523274:A" scheme="references"><meta name="DC.relation" content="CN:102726026:A" scheme="references"><meta name="DC.relation" content="WO:2006111970:A1" scheme="references"><meta name="citation_patent_publication_number" content="CN:103051725:A"><meta name="citation_patent_application_number" content="CN:201210592203"><link rel="canonical" href="https://www.google.com/patents/CN103051725A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN103051725A?cl=zh"/><meta name="title" content="专利 CN103051725A - 应用识别方法、数据挖掘方法、装置及系统"/><meta name="description" content="本发明实施例公开了一种数据挖掘方法、装置及系统，该UBA数据挖掘方法包括：获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息；向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息，从而提升DPI识别性能和应用识别率。"/><meta property="og:title" content="专利 CN103051725A - 应用识别方法、数据挖掘方法、装置及系统"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN103051725A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN103051725A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=w1PwBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN103051725A&amp;usg=AFQjCNFsTvb_bULjKJ0-vVLa7kf6LvlYrA" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/e3d7874e7aa59a2dd552/CN103051725A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/e3d7874e7aa59a2dd552/CN103051725A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN103051725A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN103051725A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN103051725A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN103051725B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN103051725A?cl=zh" style="display:none"><span itemprop="description">本发明实施例公开了一种数据挖掘方法、装置及系统，该UBA数据挖掘方法包括：获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；对所述待处理数据中远端三元组信...</span><span itemprop="url">https://www.google.com/patents/CN103051725A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN103051725A - 应用识别方法、数据挖掘方法、装置及系统</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN103051725A - 应用识别方法、数据挖掘方法、装置及系统" title="专利 CN103051725A - 应用识别方法、数据挖掘方法、装置及系统"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN103051725 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201210592203</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2013年4月17日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2012年12月31日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2012年12月31日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CA2836821A1?hl=zh-CN&amp;cl=zh">CA2836821A1</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103051725B?hl=zh-CN&amp;cl=zh">CN103051725B</a>, </span><span class="patent-bibdata-value"><a href="/patents/WO2014101402A1?hl=zh-CN&amp;cl=zh">WO2014101402A1</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201210592203.5, </span><span class="patent-bibdata-value">CN 103051725 A, </span><span class="patent-bibdata-value">CN 103051725A, </span><span class="patent-bibdata-value">CN 201210592203, </span><span class="patent-bibdata-value">CN-A-103051725, </span><span class="patent-bibdata-value">CN103051725 A, </span><span class="patent-bibdata-value">CN103051725A, </span><span class="patent-bibdata-value">CN201210592203, </span><span class="patent-bibdata-value">CN201210592203.5</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%91%A8%E9%9F%A1%22">周&#38881;</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%94%90%E4%B8%9C%22">唐东</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%BC%A0%E6%B4%AA%E4%B8%81%22">张洪丁</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E5%8D%8E%E4%B8%BA%E6%8A%80%E6%9C%AF%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">华为技术有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN103051725A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103051725A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN103051725A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (4),</span> <span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (2),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (4),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=w1PwBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201210592203&amp;usg=AFQjCNHkAyVyLpq3yrGECkOfgwZqSlagng"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=w1PwBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D103051725A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNEPGYznI_zAk66p-hnwgKWq33kBaA"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT123278428" lang="ZH" load-source="patent-office">应用识别方法、数据挖掘方法、装置及系统</invention-title>
      </span><br><span class="patent-number">CN 103051725 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA110161467" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明实施例公开了一种数据挖掘方法、装置及系统，该UBA数据挖掘方法包括：获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息；向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息，从而提升DPI识别性能和应用识别率。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(31)</span></span></div><div class="patent-text"><div mxw-id="PCLM52604546" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.	一种用户行为分析UBA数据挖掘方法，其特征在于，包括：  获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；其中，所述远端三元组信息包括传输协议、服务器端IP地址和服务器端端口；  对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果； 根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息；  向深度包检测DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.如权利要求1所述的方法，其特征在于，所述获得待处理数据包括：  针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；  获得所述DPI子系统输出的第一协议识别结果，所述第一协议识别结果包括远端三元组信息；  根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.如权利要求1所述的方法，其特征在于，所述获得待处理数据包括：  获得所述DPI子系统输出的第一协议识别结果和爬取子系统输出的爬取结果，所述第一协议识别结果包括远端三元组信息，所述爬取结果包含成对应关系的应用信息、域名信息和IP地址信息；  根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.如权利要求1或2或3所述的方法，其特征在于，  所述对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果，包括：  对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，累加所述待处理数据中的远端三元组信息及应用信息相同的记录的个数作为对应于所述远端三元组信息及应用信息的连接数，得到包含成对应关系的远端三元组信息、应用信息及连接数的聚类结果； 所述根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，包括：  根据所述连接数的大小与第一连接数阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数的大小大于或等于第一连接数阈值；  或，根据所述连接数占所有连接数的比重与第二连接数占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述远端三元组与应用信息的连接数占所有连接数的比重大于或等于第二连接数占有比例阈值。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.如权利要求1所述的方法，其特征在于，所述每条记录还包括：客户端IP地址和客户端端口，以及对应于应用信息和五元组信息的流量，其中客户端IP地址、客户端端口和远端三元组信息构成所述五元组信息，  所述获得待处理数据包括：  接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；  针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；  获得所述DPI子系统输出的针对所述第一网络数据的第一协议识别结果，所述第一协议识别结果包括五元组信息；  根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于所述五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.如权利要求1所述的方法，其特征在于，所述每条记录还包括：客户端IP地址和客户端端口，以及对应于应用信息和五元组信息的流量，其中客户端IP地址、客户端端口和远端三元组信息构成所述五元组信息，  所述获得待处理数据包括：  接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；  获得所述DPI子系统输出的针对所述第一网络数据的第一协议识别结果和爬取子系统输出的爬取结果，所述第一协议识别结果包括五元组信息，所述爬取结果包含成对应关系的应用信息、域名信息和IP地址信息；  根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.如权利要求5或6所述的方法，其特征在于，  所述对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果，包括：  对所述待处理数据中远端三元组信息及应用信息相同且客户端IP地址和客户端端口不同的记录进行聚类处理，并累加所述待处理数据中的远端三元组信息及应用信息相同的记录中的流量作为对应于所述远端三元组信息及应用信息的流量汇总值，得到包含成对应关系的远端三元组信息、应用信息及流量汇总值的聚类结果；  所述根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，包括：  根据所述流量汇总值的大小与第一流量阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值的大小大于或等于第一流量阈值；  或，根据所述流量汇总值占所有流量的比重与第二流量占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值占所有流量的比重大于或等于第二流量占有比例阈值。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.如权利要求1或2或3或5或6所述的方法，其特征在于，所述根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，包括：  根据所述服务负载量的大小与第一阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的服务负载量的大小大于或等于第一阈值；  或，根据所述服务负载量的比重与第二阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的服务负载量的比重大于或等于第二阈值。</div>
    </div>
    </div> <div class="claim"> <div num="9" class="claim">
      <div class="claim-text">9.	一种应用识别方法，其特征在于，包括：  接收第二网络数据和用户行为分析UBA子系统发送的成对应关系的应用信息和远端三元组信息，其中，所述远端三元组信息包括传输协议、服务器端IP地址和服务器端端口 ；  根据所述第二网络数据中包含的远端三元组信息，从深度包检测DPI子系统维护的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息以识别出所述第二网络数据的应用类型，其中，所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.如权利要求9所述的方法，其特征在于，进一步包括：  对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括远端三元组信息，或者，所述第一协议识别结果包括五元组信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="11" class="claim">
      <div class="claim-text">11.如权利要求9或10或所述的方法，其特征在于，当查找失败时，所述方法进一步包括：  对所述第二网络数据进行七层L7层特征的匹配，得到第二协议识别结果，并向所述UBA子系统输出所述第二协议识别结果，所述第二协议识别结果包括：成对应关系的远端三元组信息和应用信息，或成对应关系的五元组信息和应用信息；或者，所述第二协议识别结果包括：成对应关系的远端三元组信息和七层L7协议信息，或成对应关系的五元组信息和七层L7协议信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12.如权利要求9至11任一项所述的方法，其特征在于，所述方法进一步包括：  根据所述UBA子系统发送的成对应关系的远端三元组信息与应用信息建立或更新DPI子系统维护的应用信息和远端三元组信息的对应关系，并存储所述建立或更新的应用信息和远端三元组信息之间的对应关系；  或者，存储所述UBA子系统发送的成对应关系的远端三元组信息与应用信息。</div>
    </div>
    </div> <div class="claim"> <div num="13" class="claim">
      <div class="claim-text">13.	&#8212;种UBA数据挖掘装置，其特征在于，包括：  内容获取模块，用于获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；其中，所述远端三元组信息包括传输协议、服务器端IP地址和服务器端端口 ；  聚类模块，与所述内容获取模块相连，用于对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；  收敛模块，与所述聚类模块相连，用于根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息；  同步模块，与所述收敛模块相连，用于向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="14" class="claim">
      <div class="claim-text">14.如权利要求13所述的UBA数据挖掘装置，其特征在于，所述内容获取模块具体用于：针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；获得所述DPI子系统输出的第一协议识别结果，所述第一协议识别结果包括远端三元组信息；根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信息；  或者，所述内容获取模块具体用于：获得所述DPI子系统输出的第一协议识别结果和爬取子系统输出的爬取结果，所述第一协议识别结果包括远端三元组信息，所述爬取结果包含成对应关系的应用信息、域名信息和IP地址信息；根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="15" class="claim">
      <div class="claim-text">15.如权利要求13或14所述的UBA数据挖掘装置，其特征在于，  所述聚类模块具体用于对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，累加所述待处理数据中的远端三元组信息及应用信息相同的记录的个数作为对应于所述远端三元组信息及应用信息的连接数，得到包含成对应关系的远端三元组信息、应用信息及连接数的聚类结果；  所述收敛模块具体用于根据所述连接数的大小与第一连接数阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数的大小大于或等于第一连接数阈值；或，根据所述连接数占所有连接数的比重与第二连接数占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述远端三元组与应用信息的连接数占所有连接数的比重大于或等于第二连接数占有比例阈值。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="16" class="claim">
      <div class="claim-text">16.如权利要求13所述的UBA数据挖掘装置，其特征在于，所述每条记录还包括：客户端IP地址和客户端端口，以及对应于应用信息和五元组信息的流量，其中客户端IP地址、客户端端口和远端三元组信息构成所述五元组信息，  所述内容获取模块具体用于：接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；获得所述DPI子系统输出的针对所述第一网络数据的第一协议识别结果，所述第一协议识别结果包括五元组信息；根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于所述五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值；  或者，所述内容获取模块具体用于：接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；获得所述DPI子系统输出的针对所述第一网络数据的第一协议识别结果和爬取子系统输出的爬取结果，所述第一协议识别结果包括五元组信息，所述爬取结果包含成对应关系的应用信息、域名信息和IP地址信息；根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="17" class="claim">
      <div class="claim-text">17.如权利要求16所述的UBA数据挖掘装置，其特征在于， 所述聚类模块具体用于对所述待处理数据中远端三元组信息及应用信息相同且客户端IP地址和客户端端口不同的记录进行聚类处理，并累加所述待处理数据中的远端三元组信息及应用信息相同的记录中的流量作为对应于所述远端三元组信息及应用信息的流量汇总值，得到包含成对应关系的远端三元组信息、应用信息及流量汇总值的聚类结果；  所述收敛模块具体用于根据所述流量汇总值的大小与第一流量阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值的大小大于或等于第一流量阈值；或，根据所述流量汇总值占所有流量的比重与第二流量占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值占所有流量的比重大于或等于第二流量占有比例阈值。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="18" class="claim">
      <div class="claim-text">18.如权利要求13、14或16所述的UBA数据挖掘装置，其特征在于，  所述收敛模块具体用于根据所述服务负载量的大小与第一阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的服务负载量的大小大于或等于第一阈值；或者，根据所述服务负载量的比重与第二阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的服务负载量的比重大于或等于第二阈值。</div>
    </div>
    </div> <div class="claim"> <div num="19" class="claim">
      <div class="claim-text">19.	一种应用识别装置，其特征在于，包括：  通信接口模块，用于接收第二网络数据和用户行为分析UBA子系统发送的成对应关系的应用信息和远端三元组信息，其中，所述远端三元组信息包括传输协议、服务器端IP地址和服务器端端口；  快速识别模块，与所述通信接口模块连接，用于根据所述第二网络数据中包含的远端三元组信息，从所述应用识别装置维护的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息以识别出所述第二网络数据的应用类型，其中，所述深度包检测DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="20" class="claim">
      <div class="claim-text">20.如权利要求19所述的应用识别装置，其特征在于，所述通信接口模块还用于接收第一网络数据；  所述快速识别模块还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括远端三元组信息，或者，所述第一协议识别结果包括五元组信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="21" class="claim">
      <div class="claim-text">21.如权利要求19或20所述的应用识别装置，其特征在于，进一步包括：深度识别模块， 所述快速识别模块还用于当查找不到与所述第二网络数据中包含的远端三元组信息匹配的应用信息时，将所述第二网络数据传递给所述深度识别模块；  所述深度识别模块用于对所述第二网络数据进行七层L7层特征的匹配，得到第二协议识别结果，并向所述UBA子系统输出所述第二协议识别结果，所述第二协议识别结果包括：成对应关系的远端三元组信息和应用信息，或成对应关系的五元组信息和应用信息；或者，所述第二协议识别结果包括：成对应关系的远端三元组信息和七层L7协议信息，或成对应关系的五元组信息和七层L7协议信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="22" class="claim">
      <div class="claim-text">22.如权利要求19-21任一项所述的应用识别装置，其特征在于，进一步包括：  应用特征关系管理模块，用于根据所述UBA子系统发送的成对应关系的远端三元组信息与应用信息建立或更新应用信息和远端三元组信息的对应关系；  存储模块，用于存储所述建立或更新应用信息和远端三元组信息之间的对应关系；或者，用于存储所述UBA子系统发送的成对应关系的远端三元组信息与应用信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="23" class="claim">
      <div class="claim-text">23.	一种用户行为分析UBA服务器，其特征在于，所述UBA服务器包括：用于执行用户行为分析或用户兴趣分析的UBA内容解析引擎，以及，与所述UBA内容解析引擎耦合的UBA数据挖掘引擎，所述UBA数据挖掘引擎为如权利要求13至18任一项所述的UBA数据挖掘&gt;j-U ρ&#962;α装直。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="24" class="claim">
      <div class="claim-text">24.	一种深度包检测DPI服务器，其特征在于，所述DPI服务器包括：用于接收网络数据或网络数据的镜像的接收器，与所述接收器耦合的深度包检测DPI引擎，以及用于发送所述网络数据或所述DPI引擎输出的应用信息的发送器，所述DPI引擎为如权利要求19至22任一项所述的应用识别装置。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="25" class="claim">
      <div class="claim-text">25.	&#8212;种通信设备，包括收发信机和与所述收发信机耦合的用于进行网络通信的处理器，其特征在于，所述通信设备还包括：与所述收发信机耦合的深度包检测DPI引擎，所述DPI引擎为如权利要求19至22任一项所述的应用识别装置。</div>
    </div>
    </div> <div class="claim"> <div num="26" class="claim">
      <div class="claim-text">26.	&#8212;种通信系统，其特征在于，包括：深度包检测DPI子系统和用户行为分析UBA子系统，其中  所述UBA子系统用于获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的、成对应关系的远端三元组信息与应用信息，向所述DPI子系统发送所述可信度高的成对应关系的远端三元组信息与应用信息；所述远端三元组信息包括服务器端IP地址、服务器端端口和传输协议；  所述DPI子系统用于当收到第二网络数据时，根据所述第二网络数据中包含的远端三元组信息，从所述DPI子系统维护的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息以识别出所述第二网络数据的应用类型，其中所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的远端三元组与应用信息建立或更新的。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="27" class="claim">
      <div class="claim-text">27.如权利要求26所述的系统，其特征在于，所述DPI子系统还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括远端三元组信息；  所述UBA子系统具体用于：针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；获得所述DPI子系统输出的所述第一协议识别结果；根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并累加所述待处理数据中远端三元组信息及应用信息相同的记录的个数作为对应于所述远端三元组信息及应用信息的连接数，得到包含成对应关系的远端三元组信息、应用信息及连接数的聚类结果；根据所述连接数的大小与第一连接数阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数的大小大于或等于第一连接数阈值；或，根据所述连接数占所有连接数的比重与第二连接数占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数占所有连接数的比重大于或等于第二连接数占有比例阈值，并向所述DPI子系统发送所述选取的成对应关系的远端三元组与应用信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="28" class="claim">
      <div class="claim-text">28.如权利要求26所述的系统，其特征在于，进一步包括：爬取系统，用于针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；  所述DPI子系统还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括远端三元组信息；  所述UBA子系统具体用于：获得所述DPI子系统输出的所述第一协议识别结果；根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并累加所述待处理数据中远端三元组信息及应用信息相同的记录的个数作为对应于所述远端三元组信息及应用信息的连接数，得到包含成对应关系的远端三元组信息、应用信息及连接数的聚类结果；根据所述连接数的大小与第一连接数阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数的大小大于或等于第一连接数阈值；或，根据所述连接数占所有连接数的比重与第二连接数占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数占所有连接数的比重大于或等于第二连接数占有比例阈值，向所述DPI子系统发送所述选取的成对应关系的远端三元组与应用信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="29" class="claim">
      <div class="claim-text">29.如权利要求26所述的系统，其特征在于，所述每条记录还包括：客户端IP地址和客户端端口，以及对应于应用信息和五元组信息的流量，其中客户端IP地址、客户端端口和远端三元组信息构成所述五元组信息，  所述DPI子系统还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括五元组信息；  所述UBA子系统具体用于：接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；获得所述DPI子系统输出的所述第一协议识别结果；根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于所述五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值；对所述待处理数据中远端三元组信息及应用信息相同且客户端IP地址和客户端端口不同的记录进行聚类处理，并累加所述待处理数据中的远端三元组信息及应用信息相同的记录中的流量作为对应于所述远端三元组信息及应用信息的流量汇总值，得到包含成对应关系的远端三元组信息、应用信息及流量汇总值的聚类结果；根据所述流量汇总值的大小与第一流量阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值的大小大于或等于第一流量阈值；或，根据所述流量汇总值占所有流量的比重与第二流量占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值占所有流量的比重大于或等于第二流量占有比例阈值，并向所述DPI子系统发送所述选取的成对应关系的远端三元组与应用信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="30" class="claim">
      <div class="claim-text">30.如权利要求26所述的系统，其特征在于，所述每条记录还包括：客户端IP地址和客户端端口，以及对应于应用信息和五元组信息的流量，其中客户端IP地址、客户端端口和远端三元组信息构成所述五元组信息，  所述系统进一步包括：爬取系统，用于针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；  所述DPI子系统还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括五元组信息；  所述UBA子系统具体用于：接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；获得所述DPI子系统输出的所述第一协议识别结果和所述爬取子系统输出的爬取结果；根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于所述五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值；对所述待处理数据中远端三元组信息及应用信息相同且客户端IP地址和客户端端口不同的记录进行聚类处理，并累加所述待处理数据中的远端三元组信息及应用信息相同的记录中的流量作为对应于所述远端三元组信息及应用信息的流量汇总值，得到包含成对应关系的远端三元组信息、应用信息及流量汇总值的聚类结果；根据所述流量汇总值的大小与第一流量阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值的大小大于或等于第一流量阈值；或，根据所述流量汇总值占所有流量的比重与第二流量占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值占所有流量的比重大于或等于第二流量占有比例阈值，并向所述DPI子系统发送所述选取的成对应关系的远端三元组与应用信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="31" class="claim">
      <div class="claim-text">31.如权利要求26至30任一项所述的系统，其特征在于，所述系统还包括业务控制子系统，  所述DPI子系统还用于将所述应用信息提供给所述业务控制子系统；  所述业务控制子系统用于根据所述DPI子系统提供的应用信息，提供基于应用的业务，所述业务包括计费、阻断、限流、重定向或服务优化。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES59664286" lang="ZH" load-source="patent-office" class="description">
    <p>应用识别方法、数据挖掘方法、装置及系统技术领域[0001]	本发明涉及通信技术领域，具体涉及一种应用识别方法、数据挖掘方法、装置及系统。背景技术[0002]	随着宽带业务快速发展，给运营商带来机遇的同时也带来挑战，随着P2P、网络游戏、Web TV、VoIP、网上银行类、网络磁盘等应用的普及，带来了带宽管理、内容计费、信息安全处理等一系列问题。[0003]	深度包检测（Deep Packet Inspection, DPI)技术被认为是应对网络中多个业务运行所带来的管理问题的方法，即利用DPI技术能够对网络数据进行快速的解析，从而能使得运营商网络能支撑基于应用的业务，例如邮件类资费包、视频类资费包、游戏类资费包、特定下载软件的阻断等。[0004]	如图1A所示，为协议层次关系图，从传输层来看网络应用多承载于TCP和UDP之上，从七层承载来看，主要的承载协议包括HTTP/HTTPS、SSL、RTP、SIP、S0CKS5、S0CKS4等。 而应用承载方式一般包括：流承载（仅前几包出现承载协议，后续包为纯应用数据，如图1B 所示的）；包承载（每个包拥有承载协议和应用数据，如图1C所示）；[0005]	对于承载类协议的应用识别，目前DPI采用7层协议扫描的方式进行协议匹配，换句话即从下到上依次进行特征串匹配来识别，以HTTP协议为例，首先通过HTTP首行的HTTP 请求方法及URI格式识别出HTTP协议，然后通过头域（例如HOST、REFERER、USER-AGENT 等）内容的特征串匹配识别出应用，最后期待第二包进行内容校验（此步骤可选）。[0006]	此外，由于互联网应用更新速度远快于DPI的特征库的更新，且很多应用处于安全考虑越来越多的采用了 SSL、HTTPS等加密方式进行数据传输，从而导致DPI识别性能的低下，而对于加密协议的应用识别，也仅仅只能识别到L7协议信息，L7上的运行的应用仍然无法识别；例如HTTPS等加密数据无法识别到应用，从而导致DPI识别失效。发明内容[0007]	本发明实施例在于提供一种应用识别方法、数据挖掘方法、装置及系统，以提升的 DPI识别性能和应用识别率。[0008]	第一方面，本发明实施例提供一种UBA数据挖掘方法，包括：[0009]	获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；其中，所述远端三元组信息包括传输协议、服务器端IP地址和服务器端端口；[0010]	对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的 聚类结果；[0011]	根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息；[0012]	向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息。[0013]	结合第一方面，在第一种实现方式下，所述获得待处理数据包括：[0014]	针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP 地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；[0015]	获得所述DPI子系统输出的第一协议识别结果，所述第一协议识别结果包括远端三元组信息；[0016]	根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信息。[0017]	结合第一方面，在第二种实现方式下，所述获得待处理数据包括：[0018]	获得所述DPI子系统输出的第一协议识别结果和爬取子系统输出的爬取结果，所述第一协议识别结果包括远端三元组信息，所述爬取结果包含成对应关系的应用信息、域名信息和IP地址信息；[0019]	根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信息。[0020]	结合第一方面，在第三种实现方式下，所述每条记录还包括：客户端IP地址和客户端端口，以及对应于应用信息和五元组信息的流量，其中客户端IP地址、客户端端口和远端三元组信息构成所述五元组信息，[0021 ] 所述获得待处理数据包括：[0022]	接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；[0023]	针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP 地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；[0024]	获得所述DPI子系统输出的针对所述第一网络数据的第一协议识别结果，所述第一协议识别结果包括五元组信息；[0025]	根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于所述五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累 加值。[0026]	结合第一方面，在第四种实现方式下，所述每条记录还包括：客户端IP地址和客户端端口，以及对应于应用信息和五元组信息的流量，其中客户端IP地址、客户端端口和远端三元组信息构成所述五元组信息，[0027]	所述获得待处理数据包括：[0028]	接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；[0029]	获得所述DPI子系统输出的针对所述第一网络数据的第一协议识别结果和爬取子系统输出的爬取结果，所述第一协议识别结果包括五元组信息，所述爬取结果包含成对应关系的应用信息、域名信息和IP地址信息；[0030]	根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值。[0031]	结合第一方面或第一方面的第一种实现方式或第一方面的第二种实现方式，在第五种实现方式下，所述对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果，包括：[0032]	对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，累加所述待处理数据中的远端三元组信息及应用信息相同的记录的个数作为对应于所述远端三元组信息及应用信息的连接数，得到包含成对应关系的远端三元组信息、应用信息及连接数的聚类结果；[0033]	所述根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，包括：[0034]	根据所述连接数的大小与第一连接数阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数的大小大于或等于第一连接数阈值；[0035]	或，根据所述连接数占所有连接数的比重与第二连接数占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述远端三元组与应用信息的连接数占所有连接数的比重大于或等于第二连接数占有比例阈值。[0036]	结合第一方面的第三种实现方式或第一方面的第四种实现方式，在第六种实现方式下，所述对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果，包括：[0037]	对所述待处理数据中远端三元组信息及应用信息相同且客户端IP地址和客户端端口不同的记录进行聚类处理，并累加所述待处理数据中的远端三元组信息及应用信息相同的记录中的流量作为对应于所述远端三元组信息及应用信息的流量汇总值，得到包含成对应关系的远端三元组信息、应用信息及流量汇总值的聚类结果；[0038]	所述根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，包括：  [0039]	根据所述流量汇总值的大小与第一流量阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值的大小大于或等于第一流量阈值；[0040]	或，根据所述流量汇总值占所有流量的比重与第二流量占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值占所有流量的比重大于或等于第二流量占有比例阈值。[0041]	结合第一方面或第一方面的第一种、第二种、第三种、第四种实现方式，在第六种实现方式下，所述根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，包括：[0042]	根据所述服务负载量的大小与第一阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的服务负载量的大小大于或等于第一阈值；[0043]	或，根据所述服务负载量的比重与第二阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的服务负载量的比重大于或等于第二阈值。[0044]	第二方面，本发明实施例提供一种应用识别方法，包括：[0045]	接收第二网络数据和UBA子系统发送的成对应关系的应用信息和远端三元组信息，其中，所述远端三元组信息包括传输协议、服务器端IP地址和服务器端端口 ；[0046]	根据所述第二网络数据中包含的远端三元组信息，从DPI子系统维护的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息以识别出所述第二网络数据的应用类型，其中，所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的。[0047]	结合第二方面，在第一种实现方式下，所述的方法，进一步包括：[0048]	对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括远端三元组信息，或者，所述第一协议识别结果包括五元组信息。[0049]	结合第二方面或第二方面的第一种实现方式，在第二种实现方式下，当查找失败时，所述方法进一步包括：[0050]	对所述第二网络数据进行七层L7层特征的匹配，得到第二协议识别结果，并向所述UBA子系统输出所述第二协议识别结果，所述第二协议识别结果包括：成对应关系的远端三元组信息和应用信息，或成对应关系的五元组信息和应用信息；或者，所述第二协议识别结果包括：成对应关系的远端三元组信息和七层L7协议信息，或成对应关系的五元组信息和七层L7协议彳η息。[0051]	结合第二方面或第二方面的第一种实现方式或第二方面的第二种实现方式，在第三种实现方式下，所述方法进一步包括：[0052]	根据所述UBA子系统发送的成对应关系的远端三元组信息与应用信息建立或更新DPI子系统维护的应用信息和远端三元组信息的对应关系，并存储所述建立或 更新的应用信息和远端三元组信息之间的对应关系；[0053]	或者，存储所述UBA子系统发送的成对应关系的远端三元组信息与应用信息。[0054]	第三方面，本发明实施例提供一种UBA数据挖掘装置，包括：[0055]	内容获取模块，用于获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；其中，所述远端三元组信息包括传输协议、服务器端IP地址和服务器端端口 ；[0056]	聚类模块，与所述内容获取模块相连，用于对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；[0057]	收敛模块，与所述聚类模块相连，用于根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息；[0058]	同步模块，与所述收敛模块相连，用于向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息。[0059]	结合第三方面，在第一种实现方式下，所述内容获取模块具体用于：针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；获得所述DPI子系统输出的第一协议识别结果，所述第一协议识别结果包括远端三元组信息；根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信息；[0060]	或者，所述内容获取模块具体用于：获得所述DPI子系统输出的第一协议识别结果和爬取子系统输出的爬取结果，所述第一协议识别结果包括远端三元组信息，所述爬取结果包含成对应关系的应用信息、域名信息和IP地址信息；根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用/[目息和远端二兀组彳目息。[0061]	结合第三方面或第三方面的第一种实现方式，在第二种实现方式下，所述聚类模块具体用于对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，累加所述待处理数据中的远端三元组信息及应用信息相同的记录的个数作为对应于所述远端三元组信息及应用信息的连接数，得到包含成对应关系的远端三元组信息、应用信息及连接数的聚类结果；[0062]	所述收敛模块具体用于根据所述连接数的大小与第一连接数阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数的大小大于或等于第一连接数阈值；或，根据所述连接数占所有连接数的比重与第二连接数占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述远端三元组与应用信息的连接数占所有连接数的比重大于或等于第二连接数占有比例阈值。[0063]	结合第三方面，在第三种实现方式下，所述每条记录还包括：客户端IP地址和客户端端口，以及对应于应用信息和五元组信息的流量，其中客户端IP地址、客户端端口和远端三元组信息构成所述五元组信息，[0064]	所述内容获取模块具`体用于：接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；获得所述DPI子系统输出的针对所述第一网络数据的第一协议识别结果，所述第一协议识别结果包括五元组信息；根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于所述五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值；[0065]	或者，所述内容获取模块具体用于：接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；获得所述DPI子系统输出的针对所述第一网络数据的第一协议识别结果和爬取子系统输出的爬取结果，所述第一协议识别结果包括五元组信息，所述爬取结果包含成对应关系的应用信息、域名信息和IP地址信息；根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值。[0066]	结合第三方面的第三种实现方式，在第四种实现方式下，所述聚类模块具体用于对所述待处理数据中远端三元组信息及应用信息相同且客户端IP地址和客户端端口不同的记录进行聚类处理，并累加所述待处理数据中的远端三元组信息及应用信息相同的记录中的流量作为对应于所述远端三元组信息及应用信息的流量汇总值，得到包含成对应关系的远端三元组信息、应用信息及流量汇总值的聚类结果；[0067]	所述收敛模块具体用于根据所述流量汇总值的大小与第一流量阈值的比较结果， 从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值的大小大于或等于第一流量阈值；或，根据所述流量汇总值占所有流量的比重与第二流量占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值占所有流量的比重大于或等于第二流量占有比例阈值。[0068]	结合第三方面或第三方面的第一种实现方式或第三方面的第三种实现方式，在第五种实现方式下，所述收敛模块具体用于根据所述服务负载量的大小与第一阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的服务负载量的大小大于或等于第一阈值；或，根据所述服务负载量的比重与第二阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的服务负载量的比重大于或等于第二阈值。[0069]	第四方面，本发明实施例提供一种应用识别装置，包括：[0070]	通信接口模 块，用于接收第二网络数据和UBA子系统发送的成对应关系的应用信息和远端三元组信息，其中，所述远端三元组信息包括传输协议、服务器端IP地址和服务器端端口 ；[0071]	快速识别模块，与所述通信接口模块连接，用于根据所述第二网络数据中包含的远端三元组信息，从应用识别装置维护的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息以识别出所述第二网络数据的应用类型，其中，所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的。[0072]	结合第四方面，在第一种实现方式下，所述通信接口模块还用于接收第一网络数据；[0073]	所述快速识别模块还用于对接收的第一网络数据进行协议识别处理，向所述UBA 子系统输出相应的第一协议识别结果，所述第一协议识别结果包括远端三元组信息，或者， 所述第一协议识别结果包括五元组信息。[0074]	结合第四方面或第四方面的第一种实现方式，在第二种实现方式下，所述的应用识别装置，进一步包括：深度识别模块，[0075]	所述快速识别模块还用于当查找不到与所述第二网络数据中包含的远端三元组信息匹配的应用信息时，将所述第二网络数据传递给所述深度识别模块；[0076]	所述深度识别模块用于对所述第二网络数据进行七层L7层特征的匹配，得到第二协议识别结果，并向所述UBA子系统输出所述第二协议识别结果，所述第二协议识别结果包括：成对应关系的远端三元组信息和应用信息，或成对应关系的五元组信息和应用信息；或者，所述第二协议识别结果包括：成对应关系的远端三元组信息和七层L7协议信息， 或成对应关系的五元组信息和七层L7协议信息。[0077]	结合第四方面或第四方面的第一种实现方式或第四方面的第二种实现方式，在第三种实现方式下，所述的应用识别装置进一步包括：[0078]	应用特征关系管理模块，用于根据所述UBA子系统发送的成对应关系的远端三元组信息与应用信息建立或更新应用信息和远端三元组信息的对应关系；[0079]	存储模块，用于存储所述建立或更新应用信息和远端三元组信息之间的对应关系；或者，用于存储所述UBA子系统发送的成对应关系的远端三元组信息与应用信息。[0080]	第五方面，本发明实施例提供一种UBA服务器，所述UBA服务器包括：用于执行用户行为分析或用户兴趣分析的UBA内容解析引擎，以及，与所述UBA内容解析引擎耦合的 UBA数据挖掘引擎，所述UBA数据挖掘引擎为结合第三方面或者结合第三方面与基于第三方面所形成的第I至第五个可能的实施方式中的任意一种或者多种实施方式，在第六种可能的实施方式中的UBA数据挖掘装置。[0081]	第六方面，本发明实施例提供一种DPI服务器，所述DPI服务器包括：用于接收网络数据或网络数据的镜像的接收器，与所述接收器耦合的深度包检测DPI引擎，以及用于发送所述网络数据或所述DPI引擎输出的应用信息的发送器，所述DPI引擎为结合第四方面或者结合第四方面与基于第四方面所形成的第一至第三个可能的实施方式中的任意一种或者多种实施方式，在第四种可能的实施 方式中的应用识别装置。[0082]	第七方面，本发明实施例提供一种通信设备，包括收发信机和与所述收发信机耦合的用于进行网络通信的处理器，所述通信设备还包括：与所述收发信机耦合的深度包检测DPI引擎，所述DPI引擎为结合第四方面或者结合第四方面与基于第四方面所形成的第一至第三个可能的实施方式中的任意一种或者多种实施方式，在第四种可能的实施方式中的应用识别装置。[0083]	第八方面，本发明实施例提供一种通信系统，包括：DPI子系统和UBA子系统，其中：所述UBA子系统用于获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的、成对应关系的远端三元组信息与应用信息，向所述DPI子系统发送所述可信度高的成对应关系的远端三元组信息与应用信息；所述远端三元组信息包括服务器端IP地址、服务器端端口和传输协议；[0084]	所述DPI子系统用于当收到第二网络数据时，根据所述第二网络数据中包含的远端三元组信息，从所述DPI子系统维护的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息以识别出所述第二网络数据的应用类型，其中所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的远端三元组与应用信息建立或更新的。[0085]	结合第八方面，在第一种实现方式下，所述DPI子系统还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括远端三元组信息；[0086]	所述UBA子系统具体用于：针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；获得所述DPI子系统输出的所述第一协议识别结果；根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并累加所述待处理数据中远端三元组信息及应用信息相同的记录的个数作为对应于所述远端三元组信息及应用信息的连接数，得到包含成对应关系的远端三元组信息、应用信息及连接数的聚类结果；根据所述连接数&#183;的大小与第一连接数阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数的大小大于或等于第一连接数阈值；或，根据所述连接数占所有连接数的比重与第二连接数占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数占所有连接数的比重大于或等于第二连接数占有比例阈值，并向所述DPI子系统发送所述选取的成对应关系的远端三元组与应用信息。[0087]	结合第八方面，在第二种实现方式下，所述的系统进一步包括：爬取系统，用于针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；[0088]	所述DPI子系统还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括远端三元组信息；[0089]	所述UBA子系统具体用于：获得所述DPI子系统输出的所述第一协议识别结果；根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并累加所述待处理数据中远端三元组信息及应用信息相同的记录的个数作为对应于所述远端三元组信息及应用信息的连接数，得到包含成对应关系的远端三元组信息、应用信息及连接数的聚类结果；根据所述连接数的大小与第一连接数阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数的大小大于或等于第一连接数阈值；或，根据所述连接数占所有连接数的比重与第二连接数占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数占所有连接数的比重大于或等于第二连接数占有比例阈值，向所述DPI子系统发送所述选取的成对应关系的远端三元组与应用信息。[0090]	结合第八方面，在第三种实现方式下，所述的系统中，所述每条记录还包括：客户端IP地址和客户端端口，以及对应于应用信息和五元组信息的流量，其中客户端IP地址、 客户端端口和远端三元组信息构成所述五元组信息，[0091]	所述DPI子系统还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括五元组信息；[0092]	所述UBA子系统具体用于：接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；获得所述DPI子系统输出的所述第一协议识别结果；根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待 处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于所述五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值；对所述待处理数据中远端三元组信息及应用信息相同且客户端IP 地址和客户端端口不同的记录进行聚类处理，并累加所述待处理数据中的远端三元组信息及应用信息相同的记录中的流量作为对应于所述远端三元组信息及应用信息的流量汇总值，得到包含成对应关系的远端三元组信息、应用信息及流量汇总值的聚类结果；根据所述流量汇总值的大小与第一流量阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值的大小大于或等于第一流量阈值；或，根据所述流量汇总值占所有流量的比重与第二流量占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值占所有流量的比重大于或等于第二流量占有比例阈值，并向所述DPI子系统发送所述选取的成对应关系的远端三元组与应用信肩、O[0093]	结合第八方面，在第四种实现方式下，所述的系统中，所述每条记录还包括：客户端IP地址和客户端端口，以及对应于应用信息和五元组信息的流量，其中客户端IP地址、 客户端端口和远端三元组信息构成所述五元组信息，[0094]	所述系统进一步包括：爬取系统，用于针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；[0095]	所述DPI子系统还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括五元组信息；[0096]	所述UBA子系统具体用于：接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；获得所述DPI子系统输出的所述第一协议识别结果和所述爬取子系统输出的爬取结果；根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括： 成对应关系的应用信息、五元组信息和流量，其中所述对应于所述五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值；对所述待处理数据中远端三元组信息及应用信息相同且客户端IP地址和客户端端口不同的记录进行聚类处理，并累加所述待处理数据中的远端三元组信息及应用信息相同的记录中的流量作为对应于所述远端三元组信息及应用信息的流量汇总值，得到包含成对应关系的远端三元组信息、应用信息及流量汇总值的聚类结果；根据所述流量汇总值的大小与第一流量阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值的大小大于或等于第一流量阈值；或，根据所述流量汇总值占所有流量的比重与第二流量占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值占所有流量的比重大于或等于第二流量占有比例阈值，并向所述DPI子系统发送所述选取的成对应关系的远端三元组与应用信息。[0097]	结合第八方面或第八方面的第一种、第二种、第三种或第四种实现方式，在第五种实现方式下，所述系统还包括业务控制子系统，[0098]	所述DPI子系统还用于将所述应用信息提供给所述业务控制子系统；[0099]	所述业务控制子系统用于根据所述DPI子系统提供的应用信息，提供基于应用的业务，所述业务包括计费、阻断、限流、重定向或服务优化。[0100]	可见，本发明实施例中，UBA子系统获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；并根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息；从而实现了 UBA子系统的数据挖掘分析结果同步作用于DPI子系统，换言之，实现了 UBA子系统反哺DPI子系统，即所述DPI子系统维护的应用信息和远 端三元组信息的对应关系是基于所述UBA子系统发送的应用信息和远端三元组信息所建立或更新的；从而在接收到第二网络数据后，DPI子系统能快速的根据所述第二网络数据中包含的远端三元组信息，从前述的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息，从而较大程度的提升了 DPI识别性能和应用识别率，尤其是大幅提升加密协议的应用识别率，大幅提升承载类协议的应用识别率。附图说明[0101]	为了更清楚地说明本发明实施例或现有技术中的技术方案，下面将对实施例或现有技术描述中所需要使用的附图作简单地介绍，显而易见地，下面描述中的附图仅仅是本发明的一些实施例，对于本领域普通技术人员来讲，在不付出创造性劳动性的前提下，还可以根据这些附图获得其它的附图。[0102]	图1A为传统的协议层次关系图的结构示意图；[0103]	图1B为传统的流承载的原理不意图；[0104]	图1C为传统的包承载的原理示意图；[0105]	图2为本发明实施例的一种通信系统的逻辑结构示意图；[0106]	图3为本发明实施例的另一种通信系统的逻辑结构示意图；[0107]	图4为本发明实施例的另一种通信系统的逻辑结构示意图；[0108]	图5为本发明实施例的一种通信系统的物理部署示意图；[0109]	图6A为本发明实施例提供一种UBA数据挖掘方法的流程示意图；[0110]	图6B为本发明实施例提供另一种UBA数据挖掘方法的流程示意图[0111]	图6C为本发明实施例提供另一种UBA数据挖掘方法的流程示意图[0112]	图6D为本发明实施例提供再一种UBA数据挖掘方法的流程示意图[0113]	图6E为本发明实施例提供又一种UBA数据挖掘方法的流程示意图[0114]	图7为本发明实施例提供一种应用识别方法的流程示意图；[0115]	图8为本发明实施例提供另一种应用识别方法的流程示意图；[0116]	图9为本发明实施例的另一种UBA数据挖掘方法的流程示意图[0117]	图10为本发明实施例提供的一种UBA数据挖掘装置1000的结构示意图[0118]	图11为本发明实施例提供的一种UBA服务器1100的结构示意图；[0119]	图12A为本发明实施例提供的一种应用识别装1200的结构示意图；[0120]	图12B为本发明实施例提供的另一种应用识别装1200的结构示意图；[0121]	图13为本发明实施例提供的一种通信设备1300的结构示意图；[0122]	图14为本发明实施例提供的一种DPI服务器1400的结构示意图[0123]	图15为本发明实 施例提供的另一种通信设备1500的结构示意图[0124]	图16为本发明实施例提供的一种计算机系统1600的结构示意图[0125]图17为本发明实施例提供的一种计算机系统1700的结构示意图。具体实施方式[0126]	为使本发明实施例的目的、技术方案和优点更加清楚，下面将结合本发明实施例中的附图，对本发明实施例中的技术方案进行清楚、完整地描述，显然，所描述的实施例是本发明一部分实施例，而不是全部的实施例。基于本发明中的实施例，本领域普通技术人员在没有作出创造性劳动前提下所获得的所有其他实施例，都属于本发明保护的范围。[0127]	为了方便理解本发明实施例，首先在此介绍本发明实施例描述中会引入的几个要素。[0128]	五元组信息：源IP地址、源端口、目的IP地址、目的端口和传输协议；需要说明的是，本发明实施例应用于客户端/服务器C/S的组网模式下，因此在本发明实施例中，源IP 地址和源端口应分别理解为客户端IP地址和客户端端口；目的IP地址和目的端口应分别理解为服务器端IP地址和服务器端端口 ；为了方便后文描述，在此先统一概念，本端为客户端，远端为服务器端，远端三元组信息被用于表示服务器端IP地址、服务器端端口和传输协议；[0129]	远端三元组信息：服务器端IP地址、服务器端端口和传输协议；需要说明的是，如果网络数据是从客户端发送给服务器端，则远端三元组信息亦可用于表示目的IP、目的端口和传输协议，本发明实施例主要以这种场景下举例来进行本发明方案的介绍。[0130]	应用信息：即用于表示应用的信息，比如应用名称或应用标识或应用类型。例如， SNS (social network service)、E_mail、GMAIL_SSL、Skype、KuGoo、PPLive 参见图 la 所不。[0131]	请参阅图2，为本发明实施例的一种通信系统的逻辑结构示意图，如图2所示，本发明实施例的通信系统，包括：深度包检测（De印Packet Inspection，DPI)子系统10和用户行为分析(User Behavior Analysis, UBA)子系统20,其中：[0132]	UBA子系统20用于获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的、成对应关系的远端三元组信息与应用信息，向所述DPI子系统发送所述可信度高的成对应关系的远端三元组信息与应用信息；所述远端三元组信息包括服务器端IP地址、服务器端端口和传输协议；[0133]	DPI子系统10用于当收到第二网络数据时，根据所述第二网络数据中包含的远端三元组信息，从所述DPI子系统维护的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息以识别出所述第二网络数据的应用类型，其中所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的远端三元组与应用信息建立或更新的。应当理解的是， 在确定了应用信息后，可以支持基于应用的业务，例如邮件类资费包、视频类资费包、游戏类资费包、特定下载软件的阻断等。[0134]	本发明实施例中提到的服务负载量包括但不限于流量汇总值或者连接数等；[0135]	针对服务负载量为流量汇总值的情况，在一种实现方式下，本发明实施例的通信系统中，DPI子系统10还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统 20输出相应的第一协议识别结果，所述第一协议识别结果包括远端三元组信息。较优的，所述第一协议识别结果包括五元组信息、七层（L7)协议信息；[0136]	相应的，UBA子系统2`0具体用于：针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP 地址信息的爬取结果；获得所述DPI子系统10输出的所述第一协议识别结果；根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并累加所述待处理数据中远端三元组信息及应用信息相同的记录的个数作为对应于所述远端三元组信息及应用信息的连接数，得到包含成对应关系的远端三元组信息、应用信息及连接数的聚类结果；根据所述连接数的大小与第一连接数阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数的大小大于或等于第一连接数阈值；或，根据所述连接数占所有连接数的比重与第二连接数占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数占所有连接数的比重大于或等于第二连接数占有比例阈值，并向所述DPI子系统10发送所述选取的成对应关系的远端三元组与应用信息。[0137]	需要说明的是，这里的DPI子系统10向UBA子系统20输出相应的第一协议识别结果可以是=DPI子系统10向UBA子系统20直接输出相应的第一协议识别结果，也可以是 DPI子系统10向UBA子系统20间接输出相应的第一协议识别结果，例如，DPI子系统10将第一协议识别结果发送给数据库存储起来，以便于UBA子系统20实时或定时的从数据库中获取第一协议识别结果。[0138]	在另一种实现方式下，如图3所示，本发明实施例的系统进一步包括：爬取系统 30，用于针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；这里的爬取结果可以是直接或间接的传递给UBA子系统20 ;对于后者的情况，例如爬取系统30将爬取结果存储入数据库中，该数据库与UBA子系统20和爬取系统30均具有通信连接。[0139]	DPI子系统10还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括远端三元组信息；较优的，所述第一协议识别结果包括五元组信息、七层L7协议信息；[0140]	相应的，UBA子系统20具体用于：获得所述DPI子系统输出的所述第一协议识别结果；根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并累加所述待处理数据中远端三元组信息及应用信息相同的记录的个数作为对应于所述远端三元组信息及应用信息的连接数，得到包含成对应关系的远端三元组信息、应用信息及连接数的聚类结果；根据所述连接数的大小与第一连接数阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数的大小大于或等于第一连接数阈值；或，根据所述连接数占所有连接数的比重与第二连接数占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数占所有连接数的比重大于或等于第二连接数占有比例阈值，向所述DPI子系统发送所述选取的成对应关系的远端三元组与应用信息。[0141]	针对服务负载量为连接数的情况，在一种实现方式下，本发明实施例的通信系统中，所述待处理数据中的每条记录还包括：客户端IP地址和 客户端端口，以及对应于应用信息和五元组信息的流量，其中客户端IP地址、客户端端口和远端三元组信息构成所述五元组信息，[0142]	DPI子系统10还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统20输出相应的第一协议识别结果，所述第一协议识别结果包括五元组信息。较优的，所述第一协议识别结果包括五元组信息、七层（L7)协议信息；[0143]	相应的，UBA子系统20具体用于：接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、 域名信息和IP地址信息的爬取结果；获得所述DPI子系统10输出的所述第一协议识别结果；根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于所述五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值；对所述待处理数据中远端三元组信息及应用信息相同且客户端IP地址和客户端端口不同的记录进行聚类处理，并累加所述待处理数据中的远端三元组信息及应用信息相同的记录中的流量作为对应于所述远端三元组信息及应用信息的流量汇总值，得到包含成对应关系的远端三元组信息、应用信息及流量汇总值的聚类结果；根据所述流量汇总值的大小与第一流量阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值的大小大于或等于第一流量阈值；或，根据所述流量汇总值占所有流量的比重与第二流量占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值占所有流量的比重大于或等于第二流量占有比例阈值，并向所述DPI子系统10发送所述选取的成对应关系的远端三元组与应用信息。[0144]	在另一种实现方式下，如图3所示，本发明实施例的系统进一步包括：爬取系统 30，用于针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；这里的爬取结果可以是直接或间接的传递给UBA子系统20 ;对于后者的情况，例如爬取系统30将爬取结果存储入数据库中，该数据库与UBA子系统20和&#183;爬取系统30均具有通信连接。[0145]	DPI子系统10还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括五元组信息；较优的，所述第一协议识别结果包括五元组信息、七层L7协议信息；[0146]	相应的，UBA子系统20具体用于：接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；获得所述DPI子系统输出的所述第一协议识别结果和所述爬取子系统输出的爬取结果；根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于所述五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值；对所述待处理数据中远端三元组信息及应用信息相同且客户端IP地址和客户端端口不同的记录进行聚类处理，并累加所述待处理数据中的远端三元组信息及应用信息相同的记录中的流量作为对应于所述远端三元组信息及应用信息的流量汇总值，得到包含成对应关系的远端三元组信息、应用信息及流量汇总值的聚类结果；根据所述流量汇总值的大小与第一流量阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值的大小大于或等于第一流量阈值；或，根据所述流量汇总值占所有流量的比重与第二流量占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值占所有流量的比重大于或等于第二流量占有比例阈值，并向所述DPI子系统发送所述选取的成对应关系的远端三元组与应用信息。[0147]	需要说明的是，UBA子系统20关联生成所述待处理数据的条件或数据源，可以是从具有通信连接的数据库中获得的所述第一网络数据、所述第一协议识别结果以及所述爬取结果，也可以是接收的网元设备（例如路由器）发来的第一网络数据，DPI子系统10发来的第一协议识别结果和爬取子系统30发来的爬取结果。[0148]	需要说明的是，本发明实施例的通信系统中的UBA子系统20可以是以离线状态， 当工作触发条件满足时，转换为在线状态，进行数据挖掘，并将数据挖掘分析结果（即成对应关系的应用信息、远端三元组信息）反哺给DPI子系统10。[0149]	在实际应用中，本发明实施例的通信系统中的UBA子系统20可以是UBA服务器。[0150]	在实际应用中，在一种实现方式下，本发明实施例的通信系统中的DPI子系统10 可以为独立的DPI服务器，例如，DPI服务器为外挂的部署方式，或者，DPI服务器串联在网络架构中，在移动网络中，例如DPI服务器串联在RNC和GGSN之间，或者，DPI服务器串联在GGSN和业务控制网关之间；在固网中，例如DPI服务器串联在宽带接入服务器和业务控制网关之间；在另一种实现方式下，DPI子系统10也可以是具有DPI功能的网元设备，其产品形态可以是路由器，网关设备，RNC、GGSN、SCG或I3DSN等等；应当理解的是，DPI子系统支持独立外置，DPI子系统能与现有设备进行对接，也可以内置于现网的网元设备上，例如通过插卡或软件集成方式。[0151]	在实际应用中，本发明实施例的通信系统中的爬取子系统30可以是一个或多个爬取服务器（即爬取服务器组），例如，DNS服务器、网页服务器、邮件服务器和/或游戏服务器等。[0152]	应当理解的是，本发明实施例提到的DPI子系统和UBA子系统均部署在单个物理节点上的。[0153]	本发明实施例的技术方案可以应用于各种通信系统，例如：全球移动通讯 (Global System of Mobile communication,简称为 “GSM”）系统、码分多址(Code Division Multiple Access,简称为 “CDMA”）系统、宽带码分多址（Wideband Code Division Multiple Access,简称为 “WCDMA”)系统、通用分组无线业务（General Packet Radio Service,简称为 “GPRS”）、长期演进(Long Term Evolution,简称为 “LTE”）系统、LTE 频分双工（FrequencyDivisio n Duplex,简称为 “FDD”）系统、LTE 时分双工（Time Division Duplex，简称为“TDD”）、通用移动通信系统（Universal Mobile TeIecommunicationSystem,简称为 “UMTS”）、全球互联微波接入(WorldwideInteroperabilityfor Microwave Access,简称为 “WiMAX”）通信系统等。[0154]	可见，本发明实施例中，UBA子系统获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；并根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息；从而实现了 UBA子系统的数据挖掘分析结果同步作用于DPI子系统，换言之，实现了 UBA子系统反哺DPI子系统，即所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的应用信息和远端三元组信息所建立或更新的；从而在接收到第二网络数据后，DPI子系统能快速的根据所述第二网络数据中包含的远端三元组信息，从前述的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息，从而较大程度的提升了 DPI识别性能和应用识别率，尤其是大幅提升加密协议的应用识别率，大幅提升承载类协议的应用识别率；[0155]	进一步的，DPI子系统对接收的前续第一网络数据进行协议识别处理，向UBA子系统直接或间接的输出相应的第一协议识别结果;UBA子系统获得待处理数据，所述待处理数据包括多条记录，其中每条记录至少包括：成对应关系的应用信息、远端三元组信息，其中所述待处理数据是根据至少包括所述第一协议识别结果的数据源生成的；从而实现DPI 子系统的输入或输出与UBA子系统的输入或输出在一定程度上是可以互相转化的；[0156]	以及，通过本发明实施例提供的通信系统由于实现了 UBA子系统反哺DPI子系统， 即所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的，从而解决了现有技术中固定配置带来维护成本与不适应变化的问题，从而实现了自适应更新或维护应用信息和远端三元组信息的对应关系，进而减轻维护工作。[0157]	请参阅图4，为本发明实施例的另一种通信系统的逻辑结构示意图，如图4所示， 本发明实施例的通信系统，包括：DPI子系统10、UBA子系统20和业务控制子系统40，其中： DPI子系统10，UBA子系统20的功能参考前述通信系统的实施例描述。[0158]	DPI子系统10还用于将所述应用信息提供给业务控制子系统40 ；[0159]	业务控制子系统40用于根据DPI子系统10提供的应用信息，提供基于应用的业务，所述业务包括计费、阻断、限流、重定向或服务优化。 [0160]	本发明实施例的基于应用的业务提供网络，能提供基于应用的业务，这里的服务包括但不限于：计费、阻断、限流、重定向或服务优化等。换言之，即识别并分析网络的各种应用层协议，对其实施各种策略，例如计费、阻断、限流、重定向或服务优化等等。例如邮件类资费包、视频类资费包、游戏类资费包、特定下载软件的阻断等。[0161]	可见，本发明实施例中，UBA子系统获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；并根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息；从而实现了 UBA子系统的数据挖掘分析结果同步作用于DPI子系统，换言之，实现了 UBA子系统反哺DPI子系统，即所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的应用信息和远端三元组信息所建立或更新的；从而在接收到第二网络数据后，DPI子系统能快速的根据所述第二网络数据中包含的远端三元组信息，从前述的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息，从而较大程度的提升了 DPI识别性能和应用识别率，尤其是大幅提升加密协议的应用识别率，大幅提升承载类协议的应用识别率，进而实现了支撑基于应用的业务；[0162]	进一步的，DPI子系统对接收的前续第一网络数据进行协议识别处理，向UBA子系统直接或间接的输出相应的第一协议识别结果;UBA子系统获得待处理数据，所述待处理数据包括多条记录，其中每条记录至少包括：成对应关系的应用信息、远端三元组信息，其中所述待处理数据是根据至少包括所述第一协议识别结果的数据源生成的；从而实现DPI 子系统的输入或输出与UBA子系统的输入或输出在一定程度上是可以互相转化的；[0163]	以及，通过本发明实施例提供的通信系统由于实现了 UBA子系统反哺DPI子系统， 即所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的，从而解决了现有技术中固定配置带来维护成本与不适应变化的问题，从而实现了自适应更新或维护应用信息和远端三元组信息的对应关系，进而减轻维护工作。[0164]	本发明实施例主要应用于客户端/服务器C/S的组网模式下，请参阅图5，为本发明实施例的一种通信系统的物理部署示意图，以向运营商网络提供计费服务。如图5所示， 包括：用户终端50a_50b、基站51、无线网络控制器52 (Radio Network Controller, RNC)、 通用分组无线业务网关支持节点53 (Gateway GPRS Support Node, GGSN)、业务控制网关 54 (Service ControIGateway，SCG)、UBA 服务器 55、策略服务器 PCRF56、计费服务器 57、用户套餐信息SPR库58以及爬取服务器组（游戏服务器60、网页服务器61、邮件服务器62 和DNS服务器63)。其中，业务控制网关54连接因特网Internet。[0165]	请参阅图6A，为本发明实施例提供一种UBA数据挖掘方法的流程示意图，该方法可以应用于如图2或3所示的UBA子系统（即UBA服务器），如图6A所示，该方法可以包括如下步骤：[0166]	S601、获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；其中，所述远端三元组信息包括传输协议、服务器端 IP地址和服务器端端口 ；[0167]	较优的，每条记录包括：成对应关系的应用信息、五元组信息；这里的五元组信息包括客户端IP地址和客户端端口、传输协议、服务器端IP地址和服务器端 端口。[0168]	S602、对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果。[0169]	其中，本发明实施例中的服务负载量包括但不限于：流量汇总值，连接数中的任一个或组合。这里的流量汇总值表示每个连接下传输的网络数据的流量的汇总值，换言之，五元组信息能唯一的标识一条连接。而本发明这里的连接数表示五元组信息中具有相同远端三元组信息的连接的个数。[0170]	S603、根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息；[0171]	应当理解的是，S602步骤中聚类的结果中存在不真实的、成对应关系的远端三元组与应用信息，比如，当前网络环境中存在越来越多的代理服务器，通过步骤S603对S602 中得到的聚类结果进行收敛处理，去掉不真实的应用特征；[0172]	在一种实现方式下，所述根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，可以包括：[0173]	根据所述服务负载量的大小与第一阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的服务负载量的大小大于或等于第一阈值；[0174]	或，根据所述服务负载量的比重与第二阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的服务负载量的比重大于或等于第二阈值。[0175]	需要说明的是，这里的第一阈值和第二阀值是可以根据实际应用或经验值灵活设置，本发明实施例对此不作限定。 [0176]	S604、向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息。[0177]	可见，本发明实施例提供的UBA数据挖掘方法中，UBA子系统（UBA服务器）获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、 远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；并根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息；从而实现了 UBA子系统的数据挖掘分析结果同步作用于 DPI子系统，换言之，实现了 UBA子系统反哺DPI子系统，即所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的应用信息和远端三元组信息所建立或更新的；从而在接收到第二网络数据后，DPI子系统能快速的根据所述第二网络数据中包含的远端三元组信息，从前述的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息，从而较大程度的提升了 DPI识别性能和应用识别率，尤其是大幅提升加密协议的应用识别率，大幅提升承载类协议的应用识别率。[0178]	进一步的，DPI子系统对接收的前续第一网络数据进行协议识别处理，向UBA子系统直接或间接的输出相应的第一协议识别结果;UBA子系统获得待处理数据，所述待处理数据包括多条记录，其中每条记录至少包括：成对应关系的应用信息、远端三元组信息，其中所述待处理数据是根据至少包括所述第一协议识别结果的数据源生成的；从而实现DPI 子系统的输入或输出与UBA子系统的输入或输出在一定程度上是可以互相转化的；[0179]	以及，通过本发明实施例提供的通信系统由于实现了 UBA子系统反哺DPI子系统， 即所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的，从而解决了现有技术中固定配置带来维护成本与不适应变化的问题，从而实现了自适应更新或维护应用信息和远端三元组信息的对应关系，进而减轻维护工作。[0180]	请参阅图6B，为本发明实施例提供另一种UBA数据挖掘方法的流程示意图，该方法可以应用于如图2或3所示的UBA子系统（即UBA服务器），如图6B所示，该方法可以包括如下步骤：[0181]	S6011、针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；[0182]	其中，爬取技术属于现有技术，在此不再赘述。[0183]	S6012、获得所述DPI子系统输出的第一协议识别结果，所述第一协议识别结果包括远端三元组信息；[0184]	较优的，所述第一协议识别结果包括五元组信息、七层（L7)协议信息；[0185]	需要说明的是，S6011和S6012之间没有执行顺序之分。[0186]	S6013、根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录至少包括：成对应关系的应用信息和远端三元组信息；[0187]	较优的，每条记录包括：成对应关系的流标识、五元组信息和应用信息。[0188]	S6014、对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，累加所述待处理数据中的远端三元组信息及应用信息相同的记录的个数作为对应于所述远端三元组信息及应用信息的连接数，得到包含成对应关系的远端三元组信息、应用信息及连接数的聚类结果；[0189]	应当理解的是，如果S6012中获得的包括五元组信息的第一协议识别结果，相应的，S6014具体为：对所述待处理数据中远端三元组信息及应用信息相同且客户端IP地址和客户端端口不同的记录进行聚类处理，累加所述待处理数据中的远端三元组信息及应用信息相同且客户端IP地址和客户端端口不同的记录的个数作为对应于所述远端三元组信息及应用信息的连接数，得到包含成对应关系的远端三元组信息、应用信息及连接数的聚类结果。[0190]	S6015、根据所述连接数的大小与第一连接数阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数的大小大于或等于第一连接数阈值；或，根据所述连接数占所有连接数的比重与第 二连接数占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述远端三元组与应用信息的连接数占所有连接数的比重大于或等于第二连接数占有比例阈值。[0191]	需要说明的是，这里的第一连接数阈值和第二连接数占有比例阈值是可以根据实际应用或经验值灵活设置，例如第一连接数阈值可以是根据网络的规模来决定，这里不对其数值进行限定。第二连接数占有比例阈值，例如可以为90%或者为85%-90%的范围，在某些应用场景下，第二连接数占有比例阈值也可以设置为30 %以上。[0192]	S6016、向DPI子系统发送所述选取的、成对应关系的远端三元组与应用信息。[0193]	请参阅图6C，为本发明实施例提供另一种UBA数据挖掘方法的流程示意图，该方法可以应用于如图2或3所示的UBA子系统（即UBA服务器），如图6C所示，本实施例与图 6B所示的实施例的区别在于：[0194]用	S6010 替代 S6011 和 S6012，其中：[0195]	S6010、获得所述DPI子系统输出的第一协议识别结果和爬取子系统输出的爬取结果，所述第一协议识别结果包括远端三元组信息，所述爬取结果包含成对应关系的应用信息、域名信息和IP地址信息；由于其他步骤相同，故本实施例对此不再赘述。[0196]	需要说明的是，这里的第一协议识别结果和爬取结果可以分别是所述DPI子系统和所述爬取系统保存于数据库中的，也可以分别是所述DPI子系统和所述爬取系统直接发送给UBA子系统（即UBA服务器）的。换言之即，DPI子系统输出的第一协议识别结果可以是直接或间接的传递到UBA子系统，间接的方式即在一种实现方式下，DPI子系统向数据库输出相应的第一协议识别结果；同样的，爬取子系统输出的爬取结果可以是直接或间接的传递到UBA子系统，间接的方式即在一种实现方式下，爬取子系统向数据库输出爬取结果。[0197]	请参阅图6D，为本发明实施例提供再一种UBA数据挖掘方法的流程示意图，该方法可以应用于如图2或3所示的UBA子系统（即UBA服务器），如图6D所示，该方法可以包括如下步骤：[0198]	S6021、接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；[0199]	S6022、针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；[0200]	其中，爬取技术属于现有技术，在此不再赘述。[0201]	S6023、获得所述DPI子系统输出的针对所述第一网络数据的第一协议识别结果， 所述第一协议识别结果包括五元组信息；[0202]	较优的，所述第一协议识别结果包括五元组信息、七层（L7)协议信息；[0203]	需要说明的是，S6021、S6022和S6023之间没有执行顺序之分。[0204]	S6024、根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和`流量，其中所述对应于所述五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值。[0205]	较优的，每条记录包括：成对应关系的流标识、五元组信息、应用信息和流量。[0206]	S6025、对所述待处理数据中远端三元组信息及应用信息相同且客户端IP地址和客户端端口不同的记录进行聚类处理，并累加所述待处理数据中的远端三元组信息及应用信息相同的记录中的流量作为对应于所述远端三元组信息及应用信息的流量汇总值，得到包含成对应关系的远端三元组信息、应用信息及流量汇总值的聚类结果；[0207]	S6026、根据所述流量汇总值的大小与第一流量阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值的大小大于或等于第一流量阈值；或，根据所述流量汇总值占所有流量的比重与第二流量占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值占所有流量的比重大于或等于第二流量占有比例阈值。[0208]	需要说明的是，这里的第一流量阈值和第二流量占有比例阈值是可以根据实际应用或经验值灵活设置，例如第一流量阈值可以是根据应用的类型来确定，不同的应用对应不同的第一流量阈值，如网络视频类对应的第一流量阈值上G，邮件类对应的第一流量阈值为几百兆，如300M，或者300M-500M的范围。第二流量占有比例阈值，例如可以为90%或者为80%-90%的范围。本发明对此不作限定。[0209]	S6027、向DPI子系统发送所述选取的、成对应关系的远端三元组与应用信息。[0210]	请参阅图6E，为本发明实施例提供又一种UBA数据挖掘方法的流程示意图，该方法可以应用于如图2或3所示的UBA子系统（即UBA服务器），如图6E所示，本实施例与图 6D所示的实施例的区别在于：[0211]用	S6023'替代 S6022 和 S6023，其中：    [0212]	SS6023'、获得所述DPI子系统输出的针对所述第一网络数据的第一协议识别结果和爬取子系统输出的爬取结果，所述第一协议识别结果包括五元组信息，所述爬取结果包含成对应关系的应用信息、域名信息和IP地址信息；由于其他步骤相同，故本实施例对此不再赘述。[0213]	需要说明的是，这里的第一协议识别结果和爬取结果可以分别是所述DPI子系统和所述爬取系统保存于数据库中的，也可以分别是所述DPI子系统和所述爬取系统直接发送给UBA子系统（即UBA服务器）的。换言之即，DPI子系统输出的第一协议识别结果可以是直接或间接的传递到UBA子系统，间接的方式即在一种实现方式下，DPI子系统向数据库输出相应的第一协议识别结果；同样的，爬取子系统输出的爬取结果可以是直接或间接的传递到UBA子系统，间接的方式即在一种实现方式下，爬取子系统向数据库输出爬取结果。[0214]	请参阅图7，为本发明实施例提供一种应用识别方法的流程示意图，需要说明的是，该方法可以应用于如图2或3所示的DPI子系统。在实际应用中，在一种实现方式下， 本发明实施例的DPI子系统10可以为独立的DPI服务器；在另一种实现方式下，DPI子系统10也可以是具有DPI功能的网元设备，其产品形态可以是路由器，网关设备，RNC、GGSN、 SCG或PDSN等等；应当理解的是，DPI子系统支持独立外置，DPI子系统能与现有设备进行对接，也可以内置于现网的网元设备上，例如通过插卡或软件集成方式。如图7所示，该方法可以包括如下步骤：[0215]	S701、接收第二网络数据和UBA子系统发送的成对应关系的应用信息和远端三元组信息，其中，所述远端三元组信息包括传输协议、服务器端IP地址和服务器端端口 ；[0216]	S702、根据所述第二网络数据中包含的远端三元组信息，从DPI子系统维护的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息以识别出所述第二网络数据的应用类型，其中，所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的。[0217]	请参阅图8，较优的，在S701之前，本发明实施例的方法进一步包括：[0218]	S700、对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，使得UBA子系统根据至少包括第一协议识别结果的数据源所述向所述 DPI子系统发送成对应关系的远端三元组信息与应用信息，所述第一协议识别结果包括远端三元组信息，或者，所述第一协议识别结果包括五元组信息。[0219]	较优的，所述第一协议识别结果包括五元组信息、七层L7协议信息；应当理解的是，这里的协议识别处理包括2层特征、3层特征以及简单的7层特征匹配（例如：IP地址、 端口、传输协议、TCP帧头、固定位置的短子串等）。[0220]	需要说明的是，DPI子系统可以将网络数据的协议识别结果直接或者间接的传递给UBA子系统，UBA子系统通过数据挖掘、聚类和收敛等方法获得符合条件的应用特征集， 并同步到DPI子系统。应当理解的是，这是一个不断循环的过程。即，前续网络数据的协议识别结果（尤其是没有识别出应用信息的协议识别结果）触发了 UBA子系统反哺应用特征集，而该应用特征集能被DPI子系统用于快速识别后续网络数据的应用信息。[0221]	需要说明的是，这里的第一网络数据和第二网络数据可以是同一个网络应用下的不同的网络数据包，也可以是不同网络应用下的不同的网络数据包。[0222]	以及，当S702中查找失败时，本发明实施例的方法进一步包括：[0223]	S703、对所述第二网络数据进行七层L7层特征的匹配，得到第二协议识别结果， 并向所述UBA子系统输出所述第二协议识别结果，所述第二协议识别结果包括：成对应关系的远端三元组信息和应用信息，或成对应关系的五元组信息和应用信息；或者，所述第二协议识别结果包括：成对应关系的远端三元组信息和七层L7协议信息，或成对应关系的五元组信息和七层L7协议信息。[0224]	较优的，在S701之后，本发明实施例的方法进一步包括：[0225]	根据所述UBA子系统发送的成对应关系的远端三元组信息与应用信息建立或更新DPI子系统维护的应用信息和远端三元组信息的对应关系，并存储所述建立或更新的应用信息和远端三元组信息之间的对应关系；或者，[0226]	存储所述UBA子系统发送的成对应关系的远端三元组信息与应用信息。[0227]	应当理解的是，对于“或者”之后的后者情况，通常是DPI子系统维护的特征库为空时，在收到UBA子系统发送的成对应关系的远端三元组信息与应用信息或，直接存储所述UBA子系统发送的成对应关系的远端三元组信息与应用信息。[0228]	可见，本发明实施例提供的应用识别方法中，在UBA子系统向所述DPI子系统发送 /同步成对应关系的远端三元组与应用信息后，实现了 UBA子系统的数据挖掘分析结果同步作用于DPI子系统，换言之，实现了 UBA子系统反哺DPI子系统，即所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的应用信息和远端三元组信息建立或更新的；从而在接收到第二网络数据后，DPI子系统能快速的根据所述第二网络数据中包含的远端三元组信息，从前述的应用信息和远端三元组信  息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息，从而较大程度的提升了 DPI识别性能和应用识别率，尤其是大幅提升加密协议的应用识别率，大幅提升承载类协议的应用识别率；[0229]	进一步的，DPI子系统对接收的前续第一网络数据进行协议识别处理，向UBA子系统直接或间接的输出相应的第一协议识别结果；UBA子系统获得待处理数据，所述待处理数据包括多条记录，其中每条记录至少包括：成对应关系的应用信息、远端三元组信息，其中所述待处理数据是根据至少包括所述第一协议识别结果的数据源生成的；从而实现DPI 子系统的输入或输出与UBA子系统的输入或输出在一定程度上是可以互相转化的；[0230]	以及，通过本发明实施例提供的通信系统由于实现了 UBA子系统反哺DPI子系统， 即所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的，从而解决了现有技术中固定配置带来维护成本与不适应变化的问题，从而实现了自适应更新或维护应用信息和远端三元组信息的对应关系，进而减轻维护工作。[0231]	下面结合实际应用即用户通过用户终端使用浏览器访问某在线视频服务商网站观看视频短片，来详细介绍下通过本发明实施例的方法来实现运营商对视频流量进行计费。下面针对此场景进行描述：[0232]	请参阅图9，为本发明实施例的另一种UBA数据挖掘方法的流程示意图，应用于如图5所示的网络环境下，如图9所示，该方法包括：[0233]	S900、初始状态下，业务控制网关54维护的应用信息和远端三元组信息的对应关系（简称为DPI应用关联表）为空，配置目标域名列表（如mail, google. com、t. sina. com 等），这里的业务控制网关54部署有本发明的DPI子系统；[0234]	S901a_S901b、当网络数据进入业务控制网关54 (业务控制网关54上部署有DPI 子系统)后，业务控制网关54对该网络数据进行协议识别处理，向UBA服务器55输出相应的协议识别结果。本实施例中，这里的协议识别结果如表A所示，协议识别结果包括流I D、 五元组信息和七层L7协议信息。[0235]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00341.png"> <img id="idf0001" file="CN103051725AD00341.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00341.png" class="patent-full-image" alt="Figure CN103051725AD00341"> </a> </div>
    <p>[0236]表	A[0237]	S902、UBA服务器55与爬取服务器组60-63交互，[0238]	针对每一种应用，根据配置的所述应用的域名列表爬取对应的IP地址列表，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；（例如：每个应用对应一个列表，如表B所示）；应当理解的是，S901和S902可并行，也可分先后顺序执行。[0239]	例如:UBA服务器55与DNS服务器63交互有如下两种方式：[0240]1、主动方式-通过DNS协议进行交互[0241]	2、被动方式&#8212;&#8212;在网络中截获DNS报文，解析获得域名与IP的关系表。这属于现有技术，在此不再赘述。[0242]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00342.png"> <img id="idf0002" file="CN103051725AD00342.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00342.png" class="patent-full-image" alt="Figure CN103051725AD00342"> </a> </div>
    <p>[0243]	表B (前四列为事先给定）[0244]	S903、UBA服务器55将表A和表B的服务器端IP地址作为外键关联两张表，生成表C。其中，表A中流ID为14的记录中的IP为74. 125. 71. 83与表B中的GMAIL项中IP 地址匹配，且表A中的识别结果为GMAIL_SSL也与表B中的GMAIL吻合，则将表A中的传输协议和端口填充表B，得到表C。示意如下：[0245]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00351.png"> <img id="idf0003" file="CN103051725AD00351.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00351.png" class="patent-full-image" alt="Figure CN103051725AD00351"> </a> </div>
    <p>[0246]表	C[0247]	S904、UBA服务器55根据表C匹配表A中的远端三兀组，如果匹配，则在表A中填入表C中的应用名，并对同一个流的每个数据包的负载长度进行累加后填充到流量字段中，生成表E。应用理解的是，五元组信息用于标识一条流，换言之，即用于标识一个连接。 至此完成分类工作。[0248]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00352.png"> <img id="idf0004" file="CN103051725AD00352.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00352.png" class="patent-full-image" alt="Figure CN103051725AD00352"> </a> </div>
    <p>[0249][0250]表	E[0251]	S905.UBA服务器55按照传输协议、服务器端IP地址和服务器端端口对表E进行聚类，并统计属于每一组传输协议、服务器端IP地址和服务器端端口下的流量汇总值，生成表F1，其中表Fl包括：成对应关系的目的IP、目的端口、传输协议、应用协议类型（即下表中的识别结果）、流量汇总值。需要说明的是，服务负载量的一个示例即流量汇总值，这里的每一组传输协议、目的IP和目的端口下的流量汇总值可以理解为每一组传输协议、服务器端IP地址和服务器端端口下的流量汇总值。[0252]	较优的，根据流量汇总值字段对表Fl进行降序排序。[0253]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00361.png"> <img id="idf0005" file="CN103051725AD00361.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00361.png" class="patent-full-image" alt="Figure CN103051725AD00361"> </a> </div>
    <p>[0254]表	Fl[0255]	S906、UBA服务器55根据表Fl中的流量汇总值这列的数据进行流量百分比的统计，较优的还进行流量累计百分比的统计，重复此过程生成表Gl ;这里的流量百分比即所述流量汇总值占所有流量的比重。[0256]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00362.png"> <img id="idf0006" file="CN103051725AD00362.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00362.png" class="patent-full-image" alt="Figure CN103051725AD00362"> </a> </div>
    <p>[0257]表	Gl[0258]	S907、第二流量占有比例阈值被设置为80%，将流量百分比这列的数据与第二流量占有比例阈值进行比较，从表Gl中选取流量百分比这列的取值大于或等于第二流量占有比例阈值的这行记录中的远端三元组与应用信息。本实施例中，表Gl的第一行数据中对应于所述选取的远端三元组与应用信息的流量百分比的取值85. 99%大于或等于第二流量占有比例阈值80% ；[0259]	或者，在另一种实现方式下，如果S906步骤进行流量累计百分比的统计的步骤， 第二流量占有比例阈值被设置为90%，而且表Fl或表Gl中的流量汇总值这列的数据是降序排列，将流量累计百分比这列的数据与第二流量占有比例阈值进行比较，从表Gl中选取流量累计百分比这列的数据大于或等于第二流量占有比例阈值的这行记录中的成对应关系的远端三元组与应用信息，其中被选取的成对应关系的远端三元组与应用信息所处的这行记录中的流量累计百分比的取值为所有大于或等于第二流量占有比例阈值的流量累计百分比的取值中的最小值。[0260]	较优的，在本实施例中，表Fl或表Gl中的流量汇总值这列的数据是降序排列，则以从上至下的方向对表Gl中的流量累计百分比这列的对象与第二流量占有比例阈值进行比较，直到找到流量累计百分比这列中最先大于或等于90%的对象（本实施例中即第二行数据，即96. 99% )，统计直到找到流量累计百分比大于或等于90%时已被比较对象（即第 I和2行）的个数得到收敛权值为2 ;具体的，如果根据流量汇总值字段对表F进行降序排序，则进行比较的方向就是从上到下；如果根据流量汇总值字段对表Fl进行升序排序，则进行比较的方向就是从下到上。[0261]	进一步的，设置收敛阈值为5，UBA服务器55校验收敛权值，包括：判断收敛权值是否小于或等于收敛阈值，当收敛权值小于或等于收敛阈值时，则允许向业务控制网关54输出或同步如下表Hl所示的信息。应当理解的是，校验收敛权值的步骤是可选的，也可以省掉这个步骤。[0262]	S908a_S908b、UBA服务器55向业务控制网关54输出或同步如下表Hl所示的成对应关系的远端三元组信息和应用信息，便于业务控制网关54基于UBA服务器55同步过来的成对应关系的远端三元组信息和应用信息建立或更新本地维护的应用信息和远端三元组信息的对应关系。[0263]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00371.png"> <img id="idf0007" file="CN103051725AD00371.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00371.png" class="patent-full-image" alt="Figure CN103051725AD00371"> </a> </div>
    <p>[0264]表	Hl[0265]	S909、当用户使用用户终端50a_50b通过认证登录到无线接入网，用户终端 50a-50b发起的网络数据经过基站51，基站控制器RNC52到达GGSN53，由GGSN53将网络数据路由到业务控制网关54;[0266]	S910a_S910b、业务控制网关54根据该网络数据中包含的远端三元组信息，从本地维护的应用信息和远端三元组信息的对应关系中，查找与该网络数据中包含的远端三元组信息匹配的应用信息；如果查找成功，将匹配的应用信息向策略服务器PCRF56发送；需要说明的是，本实施例中，根据应用信息能获知用户是在进行观看视频；[0267]	S911a_S911b、策略服务器PCRF56根据传输过来的应用信息获知用户是在进行观看视频，并根据从用户套餐信息SPR库58中找到的用户终端50a/50b向运营商网络注册的用户套餐信息，确认需要对产生的视频流量进行计费后，发送计费信息到计费服务器57进行计费处理。[0268]	S912a_S912b、计费服务器57确定开始计费后，将网络数据（比如视频访问请求） 转发到服务提供商网站的服务器，比如网页服务器61。[0269]	上述实施例以流量汇总值为例，详细的介绍了整个处理流程，对于所述服务负载量为连接数的情况，本领域技术人员可以参考前述实施例的原理和细节来实现。不同的实现内容，例如用下表F2替代图9所示的实施例中表F1，用下表G2替代图9所示的实施例中表Gl,以及用下表H2替代图9所不的实施例中表Hl,由于大多数内容相同或相似,故在此不再赘述。[0270]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00381.png"> <img id="idf0008" file="CN103051725AD00381.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00381.png" class="patent-full-image" alt="Figure CN103051725AD00381"> </a> </div>
    <p>[0271]表	F2[0272]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00382.png"> <img id="idf0009" file="CN103051725AD00382.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00382.png" class="patent-full-image" alt="Figure CN103051725AD00382"> </a> </div>
    <p>[0273][0274]表	G2[0275]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00383.png"> <img id="idf0010" file="CN103051725AD00383.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN103051725A/CN103051725AD00383.png" class="patent-full-image" alt="Figure CN103051725AD00383"> </a> </div>
    <p>[0276]表	H2[0277]	本发明实施例还提供相关装置和系统。[0278]	参见图10、本发明实施例提供一种UBA数据挖掘装置1000，可包括：内容获取模块 1001、聚类模块1002、收敛模块1003和同步模块1004，其中：[0279]	内容获取模块1001，用于获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；其中，所述远端三元组信息包括传输协议、服务器端IP地址和服务器端端口 ；较优的，每条记录包括：成对应关系的应用信息、五元组信息；这里的五元组信息包括客户端IP地址和客户端端口、传输协议、服务器端 IP地址和服务器端端口。[0280]	聚类模块1002，与所述内容获取模块1001相连，用于对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；[0281]	这里的服务负载量包括但不限于：流量汇总值，连接数中的任一个或组合。这里的流量汇总值表示每个连接下传输的网络数据的流量的汇总值，换言之，五元组信息能唯一的标识一条连接。而本发明这里的连接数表示五元组信息中具有相同远端三元组信息的连接的个数。[0282]	收敛模块1003，与所述聚类模块1002相连，用于根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息；[0283]	在一种实现方式下，收敛模块1003具体用于根据所述服务负载量的大小与第一阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的服务负载量的大小大于或等于第一阈值；或，根据所述服务负载量的比重与第二阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的服务负载量的比重大于或等于第二阈值。需要说明的是，这里的第一阈值和第二阀值是可以根据实际应用或经验值灵活设置，本发明实施例对此不作限定。[0284]	同步模块1004，与所述收敛模块1003相连，用于向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息。[0285]	针对服务负载量为连接数的情况，在一种实现方式下，所述内容获取模块1001具体用于：针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；获得所述 DPI子系统输出的第一协议识别结果，所述第一协议识别结果包括远端三元组信息；根据所述爬取结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP 地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信息。[0286]	在另一种实现方式下，所述内容获取模块1001具体用于：获得所述DPI子系统输出的第一协议识别结果和爬取子系统输出的爬取结果，所述第一协议识别结果包括远端三元组信息，所述爬取结果包含成对应关系的应用信息、域名信息和IP地址信息；根据所述爬取 结果和所述第一协议识别结果，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息和远端三元组信息。[0287]	以及，相应的，聚类模块1002具体用于对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，累加所述待处理数据中的远端三元组信息及应用信息相同的记录的个数作为对应于所述远端三元组信息及应用信息的连接数，得到包含成对应关系的远端三元组信息、应用信息及连接数的聚类结果；[0288]	以及，相应的，收敛模块1003具体用于根据所述连接数的大小与第一连接数阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的连接数的大小大于或等于第一连接数阈值；或，根据所述连接数占所有连接数的比重与第二连接数占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述远端三元组与应用信息的连接数占所有连接数的比重大于或等于第二连接数占有比例阈值。[0289]	需要说明的是，这里的第一连接数阈值和第二连接数占有比例阈值是可以根据实际应用或经验值灵活设置，例如第一连接数阈值可以是根据网络的规模来决定，这里不对其数值进行限定。第二连接数占有比例阈值，例如可以为90%或者为85%-90%的范围，在有的应用场景下，第二连接数占有比例阈值也可以设置为30%以上。[0290]	针对服务负载量为流量汇总值的情况，所述待处理数据中的每条记录还可以包括：客户端IP地址和客户端端口，以及对应于应用信息和五元组信息的流量，其中客户端 IP地址、客户端端口和远端三元组信息构成所述五元组信息，相应的，在一种实现方式下， 所述内容获取模块1001具体用于：接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；针对每一种应用，根据所述应用对应的域名信息爬取与所述域名信息对应的IP地址信息，得到包含成对应关系的应用信息、域名信息和IP地址信息的爬取结果；获得所述DPI子系统输出的针对所述第一网络数据的第一协议识别结果，所述第一协议识别结果包括五元组信息；根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于所述五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值。[0291]	在另一种实现方式下，所述内容获取模块1001具体用于：接收第一网络数据，所述第一网络数据包括一个或多个数据流，所述每个数据流包括一个或多个数据包；获得所述DPI子系统输出的针对所述第一网络数据的第一协议识别结果和爬取子系统输出的爬取结果，所述第一协议识别结果包括五元组信息，所述爬取结果包含成对应关系的应用信息、域名信息和IP地址信息；根据所述爬取结果、所述第一协议识别结果以及所述第一网络数据，以所述爬取结果和第一协议识别结果中相同的IP地址作为关联条件，关联生成所述待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、五元组信息和流量，其中所述对应于五元组信息的流量为第一网络数据中包含所述五元组信息的一个或多个数据包的负载长度的累加值。[0292]	以及，相应的，聚类模块1002具体用于对所述待处理数据中远端三元组信息及应用信息相同且客户端IP地址和客户端端口不同的记录进行聚类处理，并累加所述待处理数据中的远端三元组信息及应用信息相同的记录中的流量作为对应于所述远端三元组信息及应用信息的流量汇总值，得到包含成对应关系的远端三元组信息、应用信息及流量汇总值的聚类结果；[0293]	以及，相应的，收敛模块1003具体用于根据所述流量汇总值的大小与第一流量阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值的大小大于或等于第一流量阈值；或，根据所述流量汇总值占所有流量的比重与第二流量占有比例阈值的比较结果，从所述聚类结果中选取成对应关系的远端三元组与应用信息，其中对应于所述选取的远端三元组与应用信息的流量汇总值占所有流量的比重大于或等于第二流量占有比例阈值。[0294]	需要说明的是，这里的第一流量阈值和第二流量占有比例阈值是可以根据实际应用或经验值灵活设置，例如第一流量阈值可以是根据应用的类型来确定，不同的应用对应不同的第一流量阈值，如网络视频类对应的第一流量阈值上G，邮件类对应的第一流量阈值为 几百兆，如300M，或者300M-500M的范围。第二流量占有比例阈值，例如可以为90%或者为80% -90%的范围。本发明对此不作限定。[0295]	由上可见，本发明实施例中，UBA数据挖掘装置获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；并根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息；从而实现了 UBA数据挖掘装置的数据挖掘分析结果同步作用于DPI子系统，换言之，实现了 UBA数据挖掘装置反哺DPI子系统，即所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA数据挖掘装置发送的应用信息和远端三元组信息所建立或更新的；从而在接收到第二网络数据后，DPI子系统能快速的根据所述第二网络数据中包含的远端三元组信息，从前述的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息，从而较大程度的提升了 DPI识别性能和应用识别率，尤其是大幅提升加密协议的应用识别率，大幅提升承载类协议的应用识别率。[0296]	进一步的，DPI子系统对接收的前续第一网络数据进行协议识别处理，向UBA数据挖掘装置直接或间接的输出相应的第一协议识别结果;UBA数据挖掘装置获得待处理数据，所述待处理数据包括多条记录，其中每条记录至少包括：成对应关系的应用信息、远端三元组信息，其中所述待处理数据是根据至少包括所述第一协议识别结果的数据源生成的；从而实现DPI子系统的输入或输出与UBA数据挖掘装置的输入或输出在一定程度上是可以互相转化的。[0297]	参见图11、本发明实施例提供一种UBA服务器1100，可包括：用于执行用户行为分析或用户兴趣分析的UBA内容解析引擎1101，以及，与所述UBA内容解析引擎耦合的UBA数据挖掘引擎1102，所述UBA数据挖掘引擎1102为前述实施例所述的UBA数据挖掘装置。[0298]	本发明实施例UBA内容解析引擎1101可以采用现有技术来实现，比如:UBA内容解析引擎通过数据解析的方式从网页浏览的内容中提取关键字，并根据关键字进行用户兴趣建模，得到用户兴趣，从而支撑根据用户兴趣推荐业务。需要说明的是，所述UBA内容解析引擎与UBA数据挖掘引擎1102之间耦合的方式，即UBA内容解析引擎1101在用户兴趣挖掘的过程中，可以调用UBA数据挖掘引擎1102来完成数据的聚类或收敛等。[0299]	本实施例提供的UBA数据挖掘引擎1102，可以用于执行前述方法实施例的技术方案中UBA服务器或UBA子系统对应执行的部分，其实现原理和技术效果类似，此处不再赘述。[0300]	由上可见，本发明实施例中，UBA服务器获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元 组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；并根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息；从而实现了 UBA服务器的数据挖掘分析结果同步作用于DPI子系统，换言之，实现了 UBA服务器反哺DPI子系统，即所述DPI子系统维护的应用信息和远端三元组信息的对应关系是基于所述UBA服务器发送的应用信息和远端三元组信息所建立或更新的；从而在接收到第二网络数据后，DPI子系统能快速的根据所述第二网络数据中包含的远端三元组信息，从前述的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息，从而较大程度的提升了 DPI识别性能和应用识别率，尤其是大幅提升加密协议的应用识别率，大幅提升承载类协议的应用识别率。[0301]	进一步的，DPI子系统对接收的前续第一网络数据进行协议识别处理，向UBA服务器直接或间接的输出相应的第一协议识别结果；UBA服务器获得待处理数据，所述待处理数据包括多条记录，其中每条记录至少包括：成对应关系的应用信息、远端三元组信息，其中所述待处理数据是根据至少包括所述第一协议识别结果的数据源生成的；从而实现DPI 子系统的输入或输出与UBA服务器的输入或输出在一定程度上是可以互相转化的。[0302]	参见图12A、本发明实施例提供一种应用识别装置1200，可包括：通信接口模块 1201和快速识别模块1202，其中：[0303]	通信接口模块1201用于接收第二网络数据和UBA子系统发送的成对应关系的应用信息和远端三元组信息，其中，所述远端三元组信息包括传输协议、服务器端IP地址和服务器端端口；[0304]	应当理解的是，如果应用识别装置为外挂的部署方式，则通信接口模块1201用于接收第二网络数据的镜像；如果应用识别装置串联在网络架构中，例如，在移动网络中串联在GGSN和业务控制网关之间；在固网中串联在宽带接入服务器和业务控制网关之间，或者集成/内置在网元设备中，则通信接口模块1201用于接收第二网络数据本身，需要说明的是，本发明实施例中提到的第一网络数据和/或第二网络数据包含前述提到的两种情况。[0305]	快速识别模块1202，与所述通信接口模块1201连接，用于根据所述第二网络数据中包含的远端三元组信息，从应用识别装置1200维护的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息以识别出所述第二网络数据的应用类型，其中，应用识别装置1200维 护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的。[0306]	在一种实现方式下，所述应用识别装置维护的应用信息和远端三元组信息的对应关系可以存储在所述应用识别装置中的存储模块中，也可以是存储在与所述应用识别装置具有通信连接的外部数据库中。对于前一种情况，本发明实施例的应用识别装置进一步包括：[0307]	存储模块1203，用于存储应用信息和远端三元组信息的对应关系；[0308]	需要说明的是，快速识别模块1202可以将网络数据的协议识别结果直接或者间接的传递给UBA子系统，UBA子系统通过数据挖掘、聚类和收敛等方法获得符合条件的应用特征集，并同步到应用识别装置，具体可以是同步到应用识别装置中的快速识别模块1202 和/或深度识别模块1204 (如图12B所示）。应当理解的是，这是一个不断循环的过程。即， 前续网络数据的协议识别结果（尤其是没有识别出应用信息的协议识别结果）触发了 UBA子系统反哺应用特征集，而该应用特征集能被用于快速识别后续网络数据的应用信息。[0309]	相应的，通信接口模块1201还用于接收第一网络数据；需要说明的是，这里的第一网络数据和第二网络数据可以是同一个网络应用下的不同的网络数据包，也可以是不同网络应用下的不同的网络数据包。[0310]	相应的，所述快速识别模块1202还用于对接收的第一网络数据进行协议识别处理，向所述UBA子系统输出相应的第一协议识别结果，所述第一协议识别结果包括远端三元组信息，或者，所述第一协议识别结果包括五元组信息。较优的，所述第一协议识别结果包括五元组信息、七层L7协议信息；使得所述UBA子系统根据至少包括所述第一协议识别结果的数据源得到成对应关系的远端三元组信息与应用信息，向应用识别装置返回所述成对应关系的远端三元组信息与应用信息，从而便于应用识别装置尤其是快速识别模块1202 快速的识别出后续网络数据的应用信息。较优的，所述第一协议识别结果包括五元组信息、 七层L7协议信息；应当理解的是，这里的协议识别处理包括2层特征、3层特征以及简单的 7层特征匹配（例如：IP地址、端口、传输协议、TCP帧头、固定位置的短子串等）。[0311]	由上可见，本发明实施例中，在UBA子系统向所述应用识别装置发送/同步对应关系的远端三元组与应用信息后，实现了 UBA子系统的数据挖掘分析结果同步作用于应用识别装置，换言之，实现了 UBA子系统反哺应用识别装置，即所述应用识别装置维护的应用信息和远端三元组信息的对应关系是基于UBA子系统发送的应用信息和远端三元组信息建立或更新的；从而在接收到后续的第二网络数据后，应用识别装置能快速的根据所述第二网络数据中包含的远端三元组信息，从前述的应用信息和远端三元组信息的对应关系中， 查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息，从而较大程度的提升了 DPI识别性能和应用识别率，尤其是大幅提升加密协议的应用识别率，大幅提升承载类协议的应用识别率。[0312]	参见图12B、本发明实施例提供另一种应用识别装置1200，在图12A所示的装置结构的基础上，本发明实施例的应用识别装置进一步包括深度识别模块1204，其中：[0313]	快速识别模块1202还用于当查找不到与所述第二网络数据中包含的远端三元组信息匹配的应用信息时，将所述第二网络数据传递给所述深度识 别模块；[0314]	深度识别模块1204用于对所述第二网络数据进行七层L7层特征的匹配，得到第二协议识别结果，并向所述UBA子系统输出所述第二协议识别结果，所述第二协议识别结果包括：成对应关系的远端三元组信息和应用信息，或成对应关系的五元组信息和应用信息；或者，所述第二协议识别结果包括：成对应关系的远端三元组信息和七层L7协议信息， 或成对应关系的五元组信息和七层L7协议信息。[0315]	需要说明的是，深度识别模块1204也可以将第二协议识别结果直接或者间接的传递给UBA子系统，UBA子系统通过数据挖掘、聚类和收敛等方法获得符合条件的应用特征集，并同步到应用识别装置，具体可以是同步到应用识别装置中的快速识别模块1202和/ 或深度识别模块1204。[0316]	应当理解的是，快速识别模块1202负责完成包括2层特征、3层特征以及简单的7 层特征匹配（例如：IP地址、端口、传输协议、TCP帧头、固定位置的短子串等），深度识别模块1204负责完成复杂特征匹配及承载特征匹配。[0317]	以及，本发明实施例的应用识别装置进一步包括：[0318]	应用特征关系管理模块1205，用于根据所述UBA子系统发送的成对应关系的远端三元组信息与应用信息建立或更新应用信息和远端三元组信息的对应关系；[0319]	存储模块1203，用于存储所述建立或更新应用信息和远端三元组信息之间的对应关系；或者，用于存储所述UBA子系统发送的成对应关系的远端三元组信息与应用信息。[0320]	由上可见，本发明实施例中，应用识别装置对接收的第一网络数据进行协议识别处理，向UBA子系统直接或间接的输出相应的第一协议识别结果；UBA子系统获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息，其中所述待处理数据是根据至少包括所述第一协议识别结果的数据源生成的； 对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；并根据所述服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息，向所述应用识别装置发送所述可信度高的成对应关系的远端三元组与应用信息；从而实现了 UBA子系统的数据挖掘分析结果同步作用于应用识别装置，换言之，实现了 UBA子系统反哺应用识别装置，即应用识别装置维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的应用信息和远端三元组信息所建立或更新的；从而在接收到第二网络数据后，应用识别装置能快速的根据所述第二网络数据中包含的远端三元组信息，从前述的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息，从而较大程度的提升了 DPI识别性能和应用识别率，尤其是大幅提升加密协议的应用识别率，大幅提升承载类协议的应用识别率。[0321]	进一步的，应用识别装置对接收的前续第一网络数据进行协议识别处理，向UBA 子系统直接或间接的输出相应的第一协议识别结果；UBA子系统获得待处理数据，所述待处理数据包括多条记录，其中每条记录至少包括：成对应关系的应用信息、远端三元组信息，其中所述待处理数据是根据至少包括所述第一协议识别结果的数据源生成的；从而实现应用识别装置的输入或输出与UBA子系统的输入或输出在一定程度上是可以互相转化的；[0322]	以及，通过本发明实施例的应用识别装置维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的，从而解决了现有技术中固定配置带来维护成本与不适应变化的问题，从而实现了自适应更新或维护应用信息和远端三元组信息的对应关系，进而减轻维护工作。[0323]	参见图13、本发明实施例提供一种通信设备1300，可包括：收发信机1301和与所述收发信机1301耦合的用于进行网络通信的处理器1303，以及所述通信设备1300还包括： 与所述收发信机1301耦合的深度包检测DPI引擎1302，所述DP I引擎1302为前述实施例所述的应用识别装置。应当理解的是，收发信机1301用于接收网络数据，还用于发送所述网络数据或所述DPI引擎输出的应用信息。[0324]	本发明实施例提供的通信`设备就是具有DPI功能的网元设备，其产品形态可以是路由器，网关设备，RNC、GGSN、SCG或TOSN等等；应当理解的是，前述实施例所述的应用识别装置可以内置于现网的网元设备上，例如通过插卡或软件集成方式。[0325]	本实施例提供的深度包检测DPI引擎1302，可以用于执行前述方法实施例的技术方案中DPI子系统对应执行的部分，其实现原理和技术效果类似，其他详细实现细节请参考前述方法和装置实施例，这里不再赘述。[0326]	可见，本发明实施例中，在UBA子系统向具有DPI功能的网元设备发送/同步成对应关系的远端三元组与应用信息后，实现了 UBA子系统的数据挖掘分析结果同步作用于具有DPI功能的网元设备，换言之，实现了 UBA子系统反哺具有DPI功能的网元设备，即具有DPI功能的网元设备维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的应用信息和远端三元组信息建立或更新的；从而在接收到第二网络数据后，具有 DPI功能的网元设备能快速的根据所述第二网络数据中包含的远端三元组信息，从前述的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息，从而较大程度的提升了 DPI识别性能和应用识别率，尤其是大幅提升加密协议的应用识别率，大幅提升承载类协议的应用识别率；[0327]	进一步的，具有DPI功能的网元设备对接收的前续第一网络数据进行协议识别处理，向UBA子系统直接或间接的输出相应的第一协议识别结果;UBA子系统获得待处理数据，所述待处理数据包括多条记录，其中每条记录至少包括：成对应关系的应用信息、远端三元组信息，其中所述待处理数据是根据至少包括所述第一协议识别结果的数据源生成的；从而实现具有DPI功能的网元设备的输入或输出与UBA子系统的输入或输出在一定程度上是可以互相转化的；[0328]	以及，通过本发明实施例提供的具有DPI功能的网元设备维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的，从而解决了现有技术中固定配置带来维护成本与不适应变化的问题，从而实现了自适应更新或维护应用信息和远端三元组信息的对应关系，进而减轻维护工作。[0329]	参见图14、本发明实施例提供一种DPI服务器1400，可包括：用于接收网络数据或网络数据的镜像的接收器1401，与所述接收器1401耦合的深度包检测DPI引擎1402，以及用于发送所述网络数据或所述DPI引擎1402输出的应用信息的发送器1403，所述DPI引擎 1402为前述实施例所述的应用识别装置。[0330]	进一步的，本发明实施例的DPI服务器1400还可以包括：存储器1404，其中，存储器1404用于存储应用信息和远端三元组信息的对应关系；[0331]	接收器1401具体用于接收第二网络数据和UBA子系统发送的成对应关系的应用信息和远端三元组信息，其中，所述远端三元组信息包括传输协议、服务器端IP地址和服务器端端口；[0332]	DPI识别引擎1402具体用于当收到第二网络数据时，根据所述第二网络数据中包含的远端三元组信息，从存储器1404中存储的应用信息和远端三元组信息的对应关系中， 查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息以识别出所述第二网络数据的应用类型。[0333]	接收器1401还用于接收第一网络数据；需要说明的是，这里的第一网络数据和第二网络数据可以是同一个网络应用下的不同的网络数据包 ，也可以是不同网络应用下的不同的网络数据包。[0334]	DPI识别引擎1402还用于对接收的第一网络数据进行协议识别处理，向所述UBA 子系统输出相应的第一协议识别结果，所述第一协议识别结果包括远端三元组信息，或者， 所述第一协议识别结果包括五元组信息。[0335]	需要说明的是，DPI识别引擎1402可以将网络数据的协议识别结果直接或者间接的传递给UBA子系统，UBA子系统通过数据挖掘、聚类和收敛等方法获得符合条件的应用特征集，并同步到DPI识别引擎1402。应当理解的是，这是一个不断循环的过程。即，前续网络数据的协议识别结果（尤其是没有识别出应用信息的协议识别结果）触发了 UBA子系统反哺应用特征集，而该应用特征集能被DPI识别引擎1402用于快速识别后续网络数据的应用信息。[0336]	进一步的，DPI识别引擎1402还用于当查找不到与所述第二网络数据中包含的远端三元组信息匹配的应用信息时，对所述第二网络数据进行七层L7层特征的匹配，得到第二协议识别结果，并向UBA子系统输出所述第二协议识别结果，所述第二协议识别结果包括：成对应关系的远端三元组信息和应用信息，或成对应关系的五元组信息和应用信息； 或者，所述第二协议识别结果包括：成对应关系的远端三元组信息和七层L7协议信息，或成对应关系的五元组信息和七层L7协议信息。[0337]	需要说明的是，DPI识别引擎1402也可以将第二协议识别结果直接或者间接的传递给UBA子系统，UBA子系统通过数据挖掘、聚类和收敛等方法获得符合条件的应用特征集，并同步到DPI识别引擎1402。[0338]	应当理解的是，DPI识别引擎1402既能完成包括2层特征、3层特征以及简单的7 层特征匹配，也能完成复杂特征匹配及承载特征匹配。[0339]	本实施例提供的DPI服务器1400，可以用于执行前述方法实施例的技术方案中 DPI子系统对应执行的部分，其实现原理和技术效果类似，其他详细实现细节请参考前述方法和装置实施例，这里不再赘述。[0340]	由上可见，本发明实施例中，在UBA子系统向DPI服务器发送/同步可信度高的成对应关系的远端三元组与应用信息；实现了 UBA子系统的数据挖掘分析结果同步作用于 DPI服务器，换言之，实现了 UBA子系统反哺DPI服务器，即所述DPI服务器维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的应用信息和远端三元组信息所建立或更新的；从而在接收到第二网络数据后，DPI服务器能快速的根据所述第二网络数据中包含的远端三元组信息，从前述的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息，从而较大程度的提升了 DPI识别性能和应用识别率，尤其是大幅提升加密协议的应用识别率，大幅提升承载类协议的应用识别率。[0341]	进一步的，DPI服务器对接收的前续第一网络数据进行协议识别处理，向UBA子系统直接或间接的输出相应的第一协议识别结果;UBA子系统获得待处理数据，所述待处理数据包括多条记录，其中每条记录至少包括：成对应关系的应用信息、远端三元组信息，其中所述待处理数据是根据至少包括所述第一协议识别结果的数据源生成的；从而实现DPI 服务器的输入或输出与UBA子系统的输入或输出在一定程度上是可以互相转化的；[0342]	以及，通过本发明 实施例提供的通信系统由于实现了 UBA子系统反哺DPI服务器， 即所述DPI服务器维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的，从而解决了现有技术中固定配置带来维护成本与不适应变化的问题，从而实现了自适应更新或维护应用信息和远端三元组信息的对应关系，进而减轻维护工作。[0343]	本发明实施例进一步给出实现上述方法实施例中各步骤及方法的装置实施例。本发明实施例可应用于各种通信系统中的通信设备。图15示出了一种通信设备的实施例，在该实施例中，通信设备1500包括发射电路1502、接收电路1503、功率控制器1506、解码处理器1505、处理器1506，存储器1507及天线1501。处理器1506控制通信设备1500的操作。 存储器1507可以包括只读存储器和随机存取存储器，并向处理器1506提供指令和数据。存储器1507的一部分还可以包括非易失行随机存取存储器（NVRAM)。具体的应用中，通信设备1500可以嵌入或者本身可以就是例如业务控制网关之类的通信设备，还可以包括容纳发射电路1502和接收电路1503的载体，以允许通信设备1500和远程位置之间进行数据发射和接收。发射电路1502和接收电路1503可以耦合到天线1501。通信设备1500的各个组件通过总线系统5100耦合在一起，其中总线系统5100除包括数据总线之外，还包括电源总线、控制总线和状态信号总线。但是为了清楚说明起见，在图中将各种总线都标为总线系统5100。通信设备1500还可以包括用于处理信号的处理器1506、此外还包括功率控制器 1504、解码处理器1505。[0344]	上述本发明实施例揭示的各种方法可以应用于解码处理器1505中，或者说由解码处理器1505以实现。解码处理器1505可能是一种集成电路芯片，具有信号的处理能力。在实现过程中，上述方法的各步骤可以通过解码处理器1505中的硬件的集成逻辑电路或者软件形式的指令完成。这些指令可以通过其中的处理器1506以配合实现及控制。用于执行本发明实施例揭示的方法，上述的解码处理器可以是通用处理器、数字信号处理器 (DSP)、专用集成电路（ASIC)、现成可编程门阵列（FPGA)或者其他可编程逻辑器件、分立门或者晶体管逻辑器件、分立硬件组件。可以实现或者执行本发明实施例中的公开的各方法、 步骤及逻辑框图。通用处理器可以是微处理器或者该处理器也可以是任何常规的处理器， 解码器等。结合本发明实施例所公开的方法的步骤可以直接体现为硬件解码处理器执行完成，或者用解码处理器中的硬件及软件模块组合执行完成。软件模块可以位于随机存储器， 闪存、只读存储器，可编程只读存储器或者电可擦写可编程存储器、寄存器等本领域成熟的存储介质中。该存储介质位于存储器1507，解码处理器1505读取存储器1507中的信息，结合其硬件完成上述方法的步骤。[0345]图16为本发明提供的一种计算机系统1600意图，如图16所示，本实施例的计算机系统包括至少一个总线1601、与总线1601相连的至少一个处理器1602以及与总线1601 相连的至少一个存储器1603。其中，处理器1602通过总线1601，调用存储器1603中存储的代码以用于：获得待处理数据，所述待处理数据包括多条记录，其中每条记录包括：成对应关系的应用信息、远端三元组信息；其中，所述远端三元组信息包括传输协议、服务器端IP 地址和服务器端端口 ；对所述待处理数据中远端三元组信息及应用信息相同的记录进行聚类处理，并根据所述待处理数据中远端三元组信息及应用信息相同的记录计算对应于所述远端三元组信息及应用信息的服务负载量，得到包含成对应关系的远端三元组信息、应用信息及服务负载量的聚类结果；根据所述`服务负载量的大小或比重从所述聚类结果中选取可信度高的成对应关系的远端三元组与应用信息；向DPI子系统发送所述可信度高的成对应关系的远端三元组与应用信息。[0346]	本实施例提供的计算机系统，可以用于执行前述方法实施例的技术方案中UBA子系统或UBA服务器应执行的部分，其实现原理和技术效果类似，此处不再赘述。图16仅为本发明提供的计算机系统的结构的一种示意图，具体结构可根据实际进行调整。[0347]	可以理解的是，本实施例的计算机系统1600中各器件的功能可根据上述方法实施例中的方法具体实现，其具体实现过程可以参照上述方法实施例的相关描述，此处不再赘述。[0348]图17为本发明提供的一种计算机系统的结构示意图，如图17所示，本实施例的计算机系统1700包括至少一个总线1701、与总线1701相连的至少一个处理器1702以及与总线1701相连的至少一个存储器1703。其中，处理器1702通过总线1701，调用存储器1703 中存储的代码以用于：接收第二网络数据和UBA子系统发送的成对应关系的应用信息和远端三元组信息，其中，所述远端三元组信息包括传输协议、服务器端IP地址和服务器端端口 ；根据所述第二网络数据中包含的远端三元组信息，从计算机系统1700维护的应用信息和远端三元组信息的对应关系中，查找与所述第二网络数据中包含的远端三元组信息匹配的应用信息以识别出所述第二网络数据的应用类型，其中，所述计算机系统1700维护的应用信息和远端三元组信息的对应关系是基于所述UBA子系统发送的成对应关系的应用信息和远端三元组信息建立或更新的。[0349]	本实施例提供的计算机系统，可以用于执行前述方法实施例的技术方案中DPI子系统或DPI服务器或集成有DPI功能的网元设备对应执行的部分，其实现原理和技术效果类似，此处不再赘述。图17仅为本发明提供的计算机系统的结构的一种示意图，具体结构可根据实际进行调整。[0350]	可以理解的是，本实施例的计算机系统1700中各器件的功能可根据上述方法实施例中的方法具体实现，其具体实现过程可以参照上述方法实施例的相关描述，此处不再赘述。[0351]	本领域普通技术人员可以理解实现上述实施例方法中的全部或部分流程，是可以通过计算机程序来指令相关的硬件来完成，所述的程序可存储于一计算机可读取存储介质中，该程序在执行时，可包括如上述各方法的实施例的流程。其中，所述的存储介质可为磁碟、光盘、只读存储记忆体（Read-OnlyMemory, ROM)或随机存储记忆体（Random Access Memory, RAM)等。[0352]	以上举较佳实施例，对本发明的目的、技术方案和优点进行了进一步详细说明，所应理解的是，以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之 内。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102075404A?cl=zh">CN102075404A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2009年11月19日</td><td class="patent-data-table-td patent-date-value">2011年5月25日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">一种报文检测方法及装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102523274A?cl=zh">CN102523274A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年12月8日</td><td class="patent-data-table-td patent-date-value">2012年6月27日</td><td class="patent-data-table-td ">北京亿赞普网络技术有限公司</td><td class="patent-data-table-td ">基于核心网侧的无线个性化精准信息主动推送系统及方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102726026A?cl=zh">CN102726026A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年12月30日</td><td class="patent-data-table-td patent-date-value">2012年10月10日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">一种用户行为的获取方法、设备及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2006111970A1?cl=zh">WO2006111970A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2006年4月20日</td><td class="patent-data-table-td patent-date-value">2006年10月26日</td><td class="patent-data-table-td ">Netbarrage Ltd.</td><td class="patent-data-table-td ">Method and system for detecting and managing peer-to-peer traffic over a data network</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2014101402A1?cl=zh">WO2014101402A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年7月29日</td><td class="patent-data-table-td patent-date-value">2014年7月3日</td><td class="patent-data-table-td ">Huawei Technologies Co., Ltd.</td><td class="patent-data-table-td ">应用识别方法、数据挖掘方法、装置及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2014187414A1?cl=zh">WO2014187414A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2014年6月10日</td><td class="patent-data-table-td patent-date-value">2014年11月27日</td><td class="patent-data-table-td ">Zte Corporation</td><td class="patent-data-table-td ">应用会话五元组的获取方法、装置及计算机存储介质</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=w1PwBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029080000">H04L29/08</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=w1PwBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=G06F0017300000">G06F17/30</a></span></td></tr><tr><td class="patent-data-table-td "> 合作分类</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=w1PwBwABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L63/1408">H04L63/1408</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=w1PwBwABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L67/22">H04L67/22</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2013年4月17日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年5月15日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2015年7月29日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Granted</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/e3d7874e7aa59a2dd552/CN103051725A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E5%BA%94%E7%94%A8%E8%AF%86%E5%88%AB%E6%96%B9%E6%B3%95_%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%96%B9%E6%B3%95.pdf?id=w1PwBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U0flbx241brBiJ8EmEJkyM3mESGVQ"},"sample_url":"https://www.google.com/patents/reader?id=w1PwBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>