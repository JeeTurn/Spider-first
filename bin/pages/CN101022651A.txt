<!DOCTYPE html><html><head><title>专利 CN101022651A - 一种组合鉴权架构及其实现方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种组合鉴权架构及其实现方法"><meta name="DC.contributor" content="何承东" scheme="inventor"><meta name="DC.contributor" content="华为技术有限公司" scheme="assignee"><meta name="DC.date" content="2006-2-13" scheme="dateSubmitted"><meta name="DC.description" content="本发明提供了一种组合鉴权架构，其业务鉴权提供商和启动引导服务器功能为一个实体，本发明还提供了一种组合鉴权架构的实现方法，在IP多媒体业务子系统用户和业务提供商实体的通信过程中包括通用鉴权架构鉴权过程和身份标识联盟鉴权过程；从而实现了身份标识联盟架构和通用鉴权架构的互通，并且提供了一种解决方法，解决了现有技术中存在的UE和IdP如何知道是否需要先执行GBA过程，然后再执行SSO过程的缺陷，因此在保持原有鉴权架构的安全性的同时，增加了终端操作的简便性，并扩展终端的应用场景，以使用已有的各种WEB业务。"><meta name="DC.date" content="2007-8-22"><meta name="citation_patent_publication_number" content="CN:101022651:A"><meta name="citation_patent_application_number" content="CN:200610033529"><link rel="canonical" href="https://www.google.com/patents/CN101022651A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101022651A?cl=zh"/><meta name="title" content="专利 CN101022651A - 一种组合鉴权架构及其实现方法"/><meta name="description" content="本发明提供了一种组合鉴权架构，其业务鉴权提供商和启动引导服务器功能为一个实体，本发明还提供了一种组合鉴权架构的实现方法，在IP多媒体业务子系统用户和业务提供商实体的通信过程中包括通用鉴权架构鉴权过程和身份标识联盟鉴权过程；从而实现了身份标识联盟架构和通用鉴权架构的互通，并且提供了一种解决方法，解决了现有技术中存在的UE和IdP如何知道是否需要先执行GBA过程，然后再执行SSO过程的缺陷，因此在保持原有鉴权架构的安全性的同时，增加了终端操作的简便性，并扩展终端的应用场景，以使用已有的各种WEB业务。"/><meta property="og:title" content="专利 CN101022651A - 一种组合鉴权架构及其实现方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101022651A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101022651A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=S-WGAAABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101022651A&amp;usg=AFQjCNFmAsXatV4LtfqGrGbX87A5e7oMKQ" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/fa9ee6048d28c95cc7a5/CN101022651A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/fa9ee6048d28c95cc7a5/CN101022651A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101022651A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101022651A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN101022651A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN101022651B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101022651A?cl=zh" style="display:none"><span itemprop="description">本发明提供了一种组合鉴权架构，其业务鉴权提供商和启动引导服务器功能为一个实体，本发明还提供了一种组合鉴权架构的实现方法，在IP多媒体业务子系统用户和业务提供商实体的通信过程中包括通用鉴权架构鉴权过程和身 ...</span><span itemprop="url">https://www.google.com/patents/CN101022651A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101022651A - 一种组合鉴权架构及其实现方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101022651A - 一种组合鉴权架构及其实现方法" title="专利 CN101022651A - 一种组合鉴权架构及其实现方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101022651 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200610033529</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2007年8月22日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2006年2月13日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2006年2月13日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101022651B?hl=zh-CN&amp;cl=zh">CN101022651B</a>, </span><span class="patent-bibdata-value"><a href="/patents/WO2007093115A1?hl=zh-CN&amp;cl=zh">WO2007093115A1</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200610033529.9, </span><span class="patent-bibdata-value">CN 101022651 A, </span><span class="patent-bibdata-value">CN 101022651A, </span><span class="patent-bibdata-value">CN 200610033529, </span><span class="patent-bibdata-value">CN-A-101022651, </span><span class="patent-bibdata-value">CN101022651 A, </span><span class="patent-bibdata-value">CN101022651A, </span><span class="patent-bibdata-value">CN200610033529, </span><span class="patent-bibdata-value">CN200610033529.9</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E4%BD%95%E6%89%BF%E4%B8%9C%22">何承东</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E5%8D%8E%E4%B8%BA%E6%8A%80%E6%9C%AF%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">华为技术有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101022651A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101022651A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101022651A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (6),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (5),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=S-WGAAABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200610033529&amp;usg=AFQjCNFaGRKVL3_IpBrBu3SMjl2Ng2P9Jg"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=S-WGAAABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101022651A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNH4BY59unGQUj5WKn3B-VDOW8L59Q"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT121933256" lang="ZH" load-source="patent-office">一种组合鉴权架构及其实现方法</invention-title>
    </span><br><span class="patent-number">CN 101022651 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA108166932" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明提供了一种组合鉴权架构，其业务鉴权提供商和启动引导服务器功能为一个实体，本发明还提供了一种组合鉴权架构的实现方法，在IP多媒体业务子系统用户和业务提供商实体的通信过程中包括通用鉴权架构鉴权过程和身份标识联盟鉴权过程；从而实现了身份标识联盟架构和通用鉴权架构的互通，并且提供了一种解决方法，解决了现有技术中存在的UE和IdP如何知道是否需要先执行GBA过程，然后再执行SSO过程的缺陷，因此在保持原有鉴权架构的安全性的同时，增加了终端操作的简便性，并扩展终端的应用场景，以使用已有的各种WEB业务。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(22)</span></span></div><div class="patent-text"><div mxw-id="PCLM50754443" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.一种组合鉴权架构，在通用鉴权架构和身份标识联盟架构的基础上实现互通，其特征在于：启动引导服务器功能实体和业务鉴权提供商实体为一个实体。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.根据权利要求1所述的组合鉴权架构，其特征在于，所述业务鉴权提供商实体与归属用户服务器实体之间的接口功能通过扩展Zh接口实现。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.根据权利要求1所述的组合鉴权架构，其特征在于，所述业务鉴权提供商实体与归属用户服务器实体之间的接口功能通过新增启动引导服务器功能实体与归属用户服务器实体之间的接口功能实现。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.根据权利要求1所述的组合鉴权架构，其特征在于，所述IP多媒体业务子系统用户与业务鉴权提供商实体之间的接口功能通过扩展Ub接口实现。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.根据权利要求1所述的组合鉴权架构，其特征在于，所述IP多媒体业务子系统用户与业务鉴权提供商实体之间的接口功能通过新增IP多媒体业务子系统用户与启动引导服务器功能实体之间的接口功能实现。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.根据权利要求1所述的组合鉴权架构，其特征在于，所述业务提供商实体与业务鉴权提供商实体之间的接口功能通过扩展Zn接口实现。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.根据权利要求1所述的组合鉴权架构，其特征在于，所述业务提供商实体与业务鉴权提供商实体之间的接口功能通过新增启动引导服务器功能实体与业务提供商实体之间的接口功能实现。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.根据权利要求1所述的组合鉴权架构，其特征在于，所述IP多媒体业务子系统用户与业务提供商实体之间的接口功能通过扩展Ua接口实现。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.根据权利要求1所述的组合鉴权架构，其特征在于，所述IP多媒体业务子系统用户与业务提供商实体之间的接口功能通过新增IP多媒体业务子系统用户与网络应用功能实体之间的接口功能实现。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.根据权利要求1所述的组合鉴权架构，其特征在于，所述网络应用功能实体与业务提供商实体为一个实体。</div>
    </div>
    </div> <div class="claim"> <div num="11" class="claim">
      <div class="claim-text">11.一种组合鉴权架构的实现方法，其特征在于，IP多媒体业务子系统用户和业务提供商实体的通信过程中包括通用鉴权架构鉴权过程和身份标识联盟鉴权过程；其包括步骤：A1、在通用鉴权架构鉴权过程中，引导服务功能实体生成引导事务标识和根密钥有效期，并且发送给IP多媒体业务子系统用户，在引导服务功能实体和IP多媒体业务子系统用户两端都生成根密钥；A2、在身份联盟功能鉴权过程中，业务鉴权提供商实体生成鉴权申明，并且发送给IP多媒体业务子系统用户。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12.根据权利要求11所述的实现方法，其特征在于，在步骤A1之前还包括步骤：B1、IP多媒体业务子系统用户向业务提供商实体发送应用请求；B2、业务提供商实体向IP多媒体业务子系统用户发送响应信息，所述响应信息携带业务鉴权提供商地址和身份标识联盟请求鉴权信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13.根据权利要求11所述的实现方法，其特征在于，步骤A1包括步骤：C1、IP多媒体业务子系统用户向业务鉴权提供商发送身份标识联盟鉴权请求消息，其中携带上述身份标识联盟请求鉴权信息；C2、业务鉴权提供商向IP多媒体业务子系统用户发送挑战响应消息，要求其携带身份标识信息；C3、IP多媒体业务子系统用户通过启动引导服务器实体完成通用鉴权架构引导过程，IP多媒体业务子系统用户得到引导事务标识和根密钥，所述引导事务标识是身份标识；C4、IP多媒体业务子系统用户向启动引导服务器实体发送鉴权请求消息，其携带引导事务标识和所述身份标识联盟请求鉴权信息；C5、启动引导服务器实体对IP多媒体业务子系统用户进行通用鉴权架构鉴权。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="14" class="claim">
      <div class="claim-text">14.根据权利要求13所述的实现方法，其特征在于，所述步骤C1之前还包括以下步骤：D1、所述启动引导服务器实体检查所述鉴权请求消息中携带有效的引导事务标识参数，并且根密钥在有效期内，则直接从步骤C4开始执行。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="15" class="claim">
      <div class="claim-text">15.根据权利要求13所述的实现方法，其特征在于，所述步骤C1的所述鉴权请求消息还携带一标识，所述标识表示所述IP多媒体业务子系统用户支持通用鉴权架构机制。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="16" class="claim">
      <div class="claim-text">16.根据权利要求13所述的实现方法，其特征在于，所述步骤C2的所述挑战响应消息还携带一标识，所述标识表示需要IP多媒体业务子系统用户执行通用鉴权架构机制鉴权。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="17" class="claim">
      <div class="claim-text">17.根据权利要求13所述的实现方法，其特征在于，所述步骤C4的所述鉴权请求消息还携带一标识，所述标识表示所述IP多媒体业务子系统用户支持通用鉴权架构机制。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="18" class="claim">
      <div class="claim-text">18.根据权利要求13所述的实现方法，其特征在于，通过配置业务鉴权提供商实体上的本地策略，要求IP多媒体业务子系统用户先完成通用鉴权架构机制鉴权过程后，再执行身份标识联盟鉴权过程。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="19" class="claim">
      <div class="claim-text">19.根据权利要求11所述的实现方法，其特征在于，步骤A2包括步骤：E1、业务鉴权提供商对IP多媒体业务子系统用户进行身份标识联盟鉴权；E2、鉴权成功后，业务鉴权提供商实体向IP多媒体业务子系统用户发送鉴权成功响应消息；E3、IP多媒体业务子系统用户向业务提供商实体提出请求信息，其携带上述鉴权成功响应信息，业务提供商实体完成对IP多媒体业务子系统用户的身份标识联盟鉴权。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="20" class="claim">
      <div class="claim-text">20.根据权利要求19所述的实现方法，其特征在于，所述步骤E2鉴权成功后，其还包括以下步骤：F1、业务鉴权提供商实体向IP多媒体业务子系统用户返回是否与各业务提供商结成身份标识联盟的选择信息；F2、IP多媒体业务子系统用户向业务鉴权提供商实体确认所述信息，并完成和所述业务提供商实体结成身份标识联盟。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="21" class="claim">
      <div class="claim-text">21.据权利要求19所述的实现方法，其特征在于，所述步骤E3中所述鉴权成功响应信息包含鉴权申明信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="22" class="claim">
      <div class="claim-text">22.根据权利要求19所述的实现方法，其特征在于，所述步骤E3中所述鉴权成功响应信息包含鉴权申明链接信息；所述步骤E3还包括以下步骤：G1、业务提供商实体向业务鉴权提供商实体发送请求消息，其携带所述鉴权申明链接信息；G2、业务鉴权提供商实体根据所述鉴权申明链接信息找到对应鉴权申明信息，并向业务提供商实体发送响应信息，其携带所述鉴权申明信息。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES57813782" lang="ZH" load-source="patent-office" class="description">
    <invention-title lang="ZH">一种组合鉴权架构及其实现方法</invention-title>
    <technical-field>
      <p>技术领域</p>
      <p>本发明涉及一种移动通信系统的场景互通的架构，尤其涉及的是，一种身份标识联盟架构和通用鉴权架构实现互通的组合鉴权架构及其实现方法。</p>
    </technical-field>
    <background-art>
      <p>背景技术</p>
      <p>3GPP组织中定义了一种通用鉴权架构(GBA)，如附图1所示，其通常由IMS用户(UE，IP多媒体业务子系统用户)、引导服务功能实体(BSF)、用户归属网络服务器(HSS)、用户定位功能实体(SLF)和网络业务应用实体(NAF)组成。UE与BSF通过Ub接口连接；UE与NAF通过Ua接口连接；BSF与HSS通过Zh接口连接，与NAF通过Zn接口连接，与SLF通过Dz接口连接。BSF用于与UE执行引导过程(bootstrapping)时进行互验证身份，同时生成BSF与用户的共享密钥Ks；HSS中存储用于描述用户信息的签约文件，同时HSS还兼有产生鉴权信息的功能。SLF用于当存在多个HSS时，协助BSF查找相应的HSS。NAF用于为UE提供网络业务。</p>
      <p>在Ub接口中，UE执行引导过程(bootstrapping)的流程图如附图2所示，步骤1、用户UE需要使用某种业务时，如果用户知道该业务需要到BSF进行相互鉴权过程，则直接发送鉴权请求到BSF进行相互鉴权。否则，用户会首先和该业务对应的NAF联系，如果该NAF使用GBA通用鉴权架构，并且发现该用户还未到BSF进行互认证过程，NAF则通知该UE到BSF进行互鉴权以验证身份，然后用户UE再直接发送鉴权请求到BSF进行相互鉴权。步骤2、BSF接到鉴权请求后，首先到HSS获取该用户的鉴权向量信息(AUTN，RAND，IK，CK，XRES)五元组；步骤3～6、BSF采用HTTP&#160;digest&#160;AKA协议与用户UE进行双向认证以及密钥协商，完成用户UE和BSF之间身份的互相认证。步骤7、BSF生成共享根密钥Ks。BSF还为共享密钥Ks定义了一个有效期限，以便Ks进行定期更新。步骤8、BSF分配一个引导事务标识(B-TID)，用于标识BSF和UE之间的本次鉴权交互事务。BSF将该B-TID与根密钥Ks、UE的私有用户标识(IMPI)相关联，以便以后BSF可以根据该B-TID查找出相应的Ks。然后BSF将引导事务标识(B-TID)和Ks的有效期限一起明文发送给用户UE。步骤9、UE也生成和BSF侧相同的共享根密钥Ks。完成了这个过程后，UE和BSF之间就共享了一个根密钥Ks，并且UE可以利用公式Ks_NAF＝KDF(Ks，″gba-me″，RAND，IMPI，NAF_Id)或者Ks_Ext_NAF＝KDF(Ks，″gba-me″，RAND，IMPI，NAF_Id)Ks_Int_NAF＝KDF(Ks，″gba-u″，RAND，IMPI，NAF_Id)推导出与想要访问的NAF之间的衍生的共享密钥Ks_(Ext/Int)_NAF，其中NAF_Id是由要访问的NAF以及要Ua接口上的协议标识(UaID)连接而成，RAND是一个随机数，IMPI是指UE的私有身份标识，″gba-me″和″gba-u″代表字符串；KDF是密钥导出函数的缩写。这样，UE就获取了该衍生的共享密钥Ks_(Ext/Int)_NAF。剩下的任务就是NAF如何获取该衍生的共享密钥Ks_(Ext/Int)_NAF。只有NAF和UE都获取了Ks_(Ext/Int)_NAF，才能建立双方通讯的安全通道。</p>
      <p>NAF获取Ks_(Ext/Int)_NAF的流程图如附图3所示，步骤1、UE首先根据上述公式推导出衍生的共享密钥Ks_(Ext/Int)_NAF，然后以引导事务标识(B-TID)为用户名，Ks_(Ext/Int)_NAF为口令向NAF发送连接请求。本步骤之前可能会事先建立TLS链接，以保证Ua接口的通讯安全。步骤2、NAF收到用户的连接请求后，给BSF发出认证请求消息。其中携带引导事务标识B-TID和NAF主机名。步骤3、BSF上保留有B-TID、IMPI、Ks、密钥有效期、BSF与UE之间的相互鉴权的开始时间、应用相关的GBA用户安全设置信息(GUSS)等信息。如果BSF能够根据该B-TID查找到相应的Ks，则完成相应用户的认证，然后BSF再使用与用户侧相同的上述公式计算出衍生的共享密钥Ks_(Ext/Int)_NAF，然后在认证响应消息中把Ks_(Ext/Int)_NAF、Ks_(Ext/Int)_NAF的有效期限、BSF与UE之间的相互鉴权的开始时间、以及其他应用相关的用户安全设置信息(USS，一个GUSS中可能包含多个USS)发给NAF。NAF收到后，保存这些信息。</p>
      <p>这样NAF和UE也就共享了由Ks衍生的密钥Ks_(Ext/Int)_NAF，从而这两者在后续的通信中可以进行安全通信。</p>
      <p>另外，自由联盟工程(LAP，Liberty&#160;Alliance&#160;Project)组织也定义了一些架构和规范，用于实现对Web业务的访问。其主要包含三个子架构：ID-FF(Identity&#160;Federation&#160;Framework，身份标识联盟架构)、ID-WSF(Identity&#160;Web&#160;Service&#160;Framework，身份标识Web业务架构)、ID-SIS(Identity&#160;Services&#160;Interface&#160;Specifications，身份标识业务接口规范)。其中ID-FF主要包含身份标识联盟(Identity&#160;Federation)功能和单点认证(Single&#160;Sign&#160;On)功能。ID-FF的架构如附图4所示：主要包含三个实体：终端UE、身份鉴权提供商IdP、业务提供商SP。身份标识联盟功能是指终端UE在IdP和SP上都有自己的身份标识，即用户标识。这些身份标识可以结成一个联盟。单点认证功能是指在上述身份标识联盟功能的基础上，只要终端在IdP上通过了鉴权，就等于同时在所有结成联盟的SP上也同时通过了鉴权。</p>
      <p>对于终端UE，有两种鉴权方式：一种是UE在IdP上鉴权通过后，IdP会将该UE的鉴权申明Assertion直接返回给UE。UE再将该鉴权申明Assertion发给SP。SP通过分析Assertion来对终端进行鉴权。另一种是UE在IdP上鉴权通过后，IdP会将该UE的鉴权申明链接Artifact返回给UE。UE再将该鉴权申明链接Artifact发给SP。SP再将该Artifact通过SOAP协议发给IdP。IdP根据该Artifact查询相应的Assertion，并返回给SP。最后SP通过分析Assertion来对终端进行鉴权。</p>
      <p>一方面，通用鉴权架构中UE与BSF交互获取根密钥Ks和B-TID以后，以后都需要分别以B-TID为用户名，Ks_(Ext/Int)_NAF为口令在各个NAF上鉴权，以便访问各个NAF。这种频繁的认证增强了安全性，但增加了终端操作的复杂性和不方便性。</p>
      <p>另一方面，身份标识联盟架构中通过身份标识联盟功能在各个SP与IdP之间建立身份标识安全联盟，并组成一个安全信任圈。只要在IdP上通过了鉴权，就等于在IdP所属的安全信任圈内的所有SP上也通过了鉴权。</p>
      <p>因此，如果这两种架构之间能够实现互通，既不会降低原有的安全性，也可以增加终端操作的简便性，并扩展终端的应用场景，以使用已有的多种多样的WEB业务。</p>
      <p>目前3GPP规范33.980中只定义了一种互通场景，即IdP和NAF为一个实体，如附图5所示。其主要特点是：1、原通用鉴权架构的Ub和Zn接口功能基本上不变，身份标识联盟架构的IdP和UE需要增加GBA功能。2、相关的SP和IdP/NAF通过身份标识联盟功能组成一个安全信任圈。UE访问各个SP时，首先在此IdP(NAF)上通过鉴权认证后，就等于在所有相关的其他SP上也通过了鉴权认证。</p>
      <p>对于GBA和单点认证(SSO，Single&#160;Sign&#160;On)两种机制都支持的UE来说，现有技术存在以下问题未能解决：当UE收到IdP的挑战响应后，如何知道是否需要先进行GBA过程，然后再继续进行SSO认证请求过程，还是跳过GBA过程，直接进行SSO认证请求过程？当IdP收到UE的SSO再次认证请求后，如何知道是否需要先通过Zn接口到BSF取相关的密钥等信息，然后再进行SSO认证响应，还是直接进行SSO认证响应？因此现有技术存在上述缺陷，需要改进。</p>
    </background-art>
    <disclosure>
      <p>发明内容</p>
      <p>本发明的目的在于提供一种组合鉴权架构，并且提供一种组合鉴权架构的实现方法，以实现身份标识联盟架构和通用鉴权架构的互通，同时提供一种解决方案，解决了现有技术中存在的UE和IdP如何知道是否需要先执行GBA过程，然后再执行SSO过程的缺陷。</p>
      <p>本发明的技术方案如下：一种组合鉴权架构，在通用鉴权架构和身份标识联盟架构的基础上实现互通，其中：启动引导服务器功能实体和业务鉴权提供商实体为一个实体。</p>
      <p>所述的组合鉴权架构，其中，所述业务鉴权提供商实体与归属用户服务器实体之间的接口功能通过扩展Zh接口实现。</p>
      <p>所述的组合鉴权架构，其中，所述业务鉴权提供商实体与归属用户服务器实体之间的接口功能通过新增启动引导服务器功能实体与归属用户服务器实体之间的接口功能实现。</p>
      <p>所述的组合鉴权架构，其中，所述IP多媒体业务子系统用户与业务鉴权提供商实体之间的接口功能通过扩展Ub接口实现。</p>
      <p>所述的组合鉴权架构，其中，所述IP多媒体业务子系统用户与业务鉴权提供商实体之间的接口功能通过新增IP多媒体业务子系统用户与启动引导服务器功能实体之间的接口功能实现。</p>
      <p>所述的组合鉴权架构，其中，所述业务提供商实体与业务鉴权提供商实体之间的接口功能通过扩展Zn接口实现。</p>
      <p>所述的组合鉴权架构，其中，所述业务提供商实体与业务鉴权提供商实体之间的接口功能通过新增启动引导服务器功能实体与业务提供商实体之间的接口功能实现。</p>
      <p>所述的组合鉴权架构，其中，所述IP多媒体业务子系统用户与业务提供商实体之间的接口功能通过扩展Ua接口实现。</p>
      <p>所述的组合鉴权架构，其中，所述IP多媒体业务子系统用户与业务提供商实体之间的接口功能通过新增IP多媒体业务子系统用户与网络应用功能实体之间的接口功能实现。</p>
      <p>所述的组合鉴权架构，其中，所述网络应用功能实体与业务提供商实体为一个实体。</p>
      <p>一种组合鉴权架构的实现方法，其中，IP多媒体业务子系统用户和业务提供商实体的通信过程中包括通用鉴权架构鉴权过程和身份标识联盟鉴权过程；其包括步骤：A1、在通用鉴权架构鉴权过程中，引导服务功能实体生成引导事务标识和根密钥有效期，并且发送给IP多媒体业务子系统用户，在引导服务功能实体和IP多媒体业务子系统用户两端都生成根密钥；A2、在身份联盟功能鉴权过程中，业务鉴权提供商实体生成鉴权申明，并且发送给IP多媒体业务子系统用户。</p>
      <p>所述的实现方法，其中，在步骤A1之前还包括步骤：B1、IP多媒体业务子系统用户向业务提供商实体发送应用请求；B2、业务提供商实体向IP多媒体业务子系统用户发送响应信息，所述响应信息携带业务鉴权提供商地址和身份标识联盟请求鉴权信息。</p>
      <p>所述的实现方法，其中，步骤A1包括步骤：C1、IP多媒体业务子系统用户向业务鉴权提供商发送身份标识联盟鉴权请求消息，其中携带上述身份标识联盟请求鉴权信息；C2、业务鉴权提供商向IP多媒体业务子系统用户发送挑战响应消息，要求其携带身份标识信息；C3、IP多媒体业务子系统用户通过启动引导服务器实体完成通用鉴权架构引导过程，IP多媒体业务子系统用户得到引导事务标识和根密钥，所述引导事务标识是身份标识；</p>
      <p>C4、IP多媒体业务子系统用户向启动引导服务器实体发送鉴权请求消息，其携带引导事务标识和所述身份标识联盟请求鉴权信息；C5、启动引导服务器实体对IP多媒体业务子系统用户进行通用鉴权架构鉴权。</p>
      <p>所述的实现方法，其中，所述步骤C1之前还包括以下步骤：D1、所述启动引导服务器实体检查所述鉴权请求消息中携带有效的引导事务标识参数，并且根密钥在有效期内，则直接从步骤C4开始执行。</p>
      <p>所述的实现方法，其中，所述步骤C1的所述鉴权请求消息还携带一标识，所述标识表示所述IP多媒体业务子系统用户支持通用鉴权架构机制。</p>
      <p>所述的实现方法，其中，所述步骤C2的所述挑战响应消息还携带一标识，所述标识表示需要IP多媒体业务子系统用户执行通用鉴权架构机制鉴权。</p>
      <p>所述的实现方法，其中，所述步骤C4的所述鉴权请求消息还携带一标识，所述标识表示所述IP多媒体业务子系统用户支持通用鉴权架构机制。</p>
      <p>所述的实现方法，其中，通过配置业务鉴权提供商实体上的本地策略，要求IP多媒体业务子系统用户先完成通用鉴权架构机制鉴权过程后，再执行身份标识联盟鉴权过程。</p>
      <p>所述的实现方法，其中，步骤A2包括步骤：E1、业务鉴权提供商对IP多媒体业务子系统用户进行身份标识联盟鉴权；E2、鉴权成功后，业务鉴权提供商实体向IP多媒体业务子系统用户发送鉴权成功响应消息；E3、IP多媒体业务子系统用户向业务提供商实体提出请求信息，其携带上述鉴权成功响应信息，业务提供商实体完成对IP多媒体业务子系统用户的身份标识联盟鉴权。</p>
      <p>所述的实现方法，其中，所述步骤E2鉴权成功后，其还包括以下步骤：</p>
      <p>F1、业务鉴权提供商实体向IP多媒体业务子系统用户返回是否与各业务提供商结成身份标识联盟的选择信息；F2、IP多媒体业务子系统用户向业务鉴权提供商实体确认所述信息，并完成和所述业务提供商实体结成身份标识联盟。</p>
      <p>所述的实现方法，其中，所述步骤E3中所述鉴权成功响应信息包含鉴权申明信息。</p>
      <p>所述的实现方法，其中，所述步骤E3中所述鉴权成功响应信息包含鉴权申明链接信息；所述步骤E3还包括以下步骤：G1、业务提供商实体向业务鉴权提供商实体发送请求消息，其携带所述鉴权申明链接信息；G2、业务鉴权提供商实体根据所述鉴权申明链接信息找到对应鉴权申明信息，并向业务提供商实体发送响应信息，其携带所述鉴权申明信息。</p>
      <p>采用上述方案，本发明提供了一种启动引导服务器功能实体和业务鉴权提供商实体为一个实体的组合鉴权架构，并且提供了一种身份标识联盟架构和通用鉴权架构实现互通的解决方法，还提供了一种解决方法，解决了现有技术中存在的UE和IdP如何知道是否需要先执行GBA过程，然后再执行SSO过程的缺陷，因此在保持原有鉴权架构的安全性的同时，增加了终端操作的简便性，并扩展终端的应用场景，以使用已有的各种WEB业务。</p>
    </disclosure>
    <description-of-drawings>
      <p>附图说明</p>
      <p>图1为现有技术的一种通用鉴权架构图；图2为现有技术的IMS用户执行引导过程的流程图；图3为现有技术的网络应用功能获取衍生共享密钥的流程图；图4为现有技术的身份标识联盟架构图；图5为现有技术的一种互通场景方案图；图6为本发明架构的一种组合鉴权架构图：</p>
      <p>图7为本发明架构的另一种组合鉴权架构图；图8为本发明方法的流程图；图9为本发明方法的流程图一个实例；图10为本发明方法的流程图另一个实例。</p>
    </description-of-drawings>
    <mode-for-invention>
      <p>具体实施方式</p>
      <p>以下对本发明的较佳实施例加以详细说明。</p>
      <p>本发明提供了一种组合鉴权架构，并且提供一种组合鉴权架构的实现方法，以实现身份标识联盟架构和通用鉴权架构的互通。BSF和IdP为一个实体，即BSF上增加IdP功能；UE增加身份标识联盟用户功能；BSF与SP之间接口增加对SP-IdP之间的协议接口功能的支持；BSF与UE之间接口增加对UE-IdP之间接口功能的支持，即增加对鉴权申明或鉴权申明链接内容的传送功能。IdP与HSS之间的接口功能通过扩展Zh接口实现。IdP与HSS之间的接口功能通过新增BSF与HSS之间的接口功能实现。UE与IdP之间的接口功能通过扩展Ub接口实现。UE与IdP之间的接口功能通过新增UE与BSF之间的接口功能实现。SP与IdP之间的接口功能通过扩展Zn接口实现。SP与IdP之间的接口功能通过新增BSF与SP之间的接口功能实现。UE与SP之间的接口功能通过扩展Ua接口实现或者新增UE与NAF之间的接口功能实现。NAF与SP为一个实体。</p>
      <p>当IdP与BSF为一个实体时，本发明的一种组合鉴权架构如附图6所示；如果把SP看成是一种NAF，本发明的另一种组合鉴权架构如附图7所示。GBA的BSF需要增加和SP之间的SOAP协议接口，Ub接口上需要增加对Assertion或者Artifact等内容的传送。相关的SP和IdP/BSF通过身份标识联盟功能组成一个安全信任圈。当UE访问各个SP时，在此IdP/BSF上通过鉴权认证后，就相当于在所有相关的其他SP上也通过了鉴权认证。UE和BSF/IdP之间除了原有的UE-BSF之间的Ub接口功能以外，还增加了对UE-IdP之间的UE-IdP接口功能的支持。BSF/IdP和NAF/SP之间除了原有的BSF-NAF之间的Zn接口以外，还增加了对IdP-SP之间的基于SOAP协议的接口功能的支持。上述新增功能也可以通过扩展Ub/Zn接口实现。</p>
      <p>一种组合鉴权架构的实现方法，IP多媒体业务子系统用户和业务提供商实体的通信过程中包括通用鉴权架构鉴权过程和身份标识联盟鉴权过程；其包括步骤：A1、在通用鉴权架构鉴权过程中，引导服务功能实体生成引导事务标识和根密钥有效期，并且发送给IP多媒体业务子系统用户，在引导服务功能实体和IP多媒体业务子系统用户两端都生成根密钥；A2、在身份联盟功能鉴权过程中，业务鉴权提供商实体生成鉴权申明，并且发送给IP多媒体业务子系统用户。</p>
      <p>在步骤A1之前还包括步骤：B1、UE向SP实体发送应用请求；B2、SP实体向UE发送响应信息，所述响应信息携带IdP地址和身份标识联盟请求鉴权信息。通过上述步骤，UE得到了鉴权所需的信息。</p>
      <p>步骤A1包括步骤：C1、UE向IdP发送身份标识联盟鉴权请求消息，其中携带上述身份标识联盟请求鉴权信息；C2、IdP向UE发送挑战响应消息，要求其携带身份标识信息；C3、UE通过BSF实体完成通用鉴权架构引导过程，UE得到引导事务标识和根密钥，所述引导事务标识是身份标识；C4、UE向BSF实体发送鉴权请求消息，其携带引导事务标识和所述身份标识联盟请求鉴权信息；C5、BSF实体对UE进行通用鉴权架构鉴权。</p>
      <p>步骤A2包括步骤：E1、IdP对UE进行身份标识联盟鉴权；E2、鉴权成功后，IdP实体向UE发送鉴权成功响应消息；E3、UE向SP实体提出请求信息，其携带上述鉴权成功响应信息，SP实体完成对UE的身份标识联盟鉴权。</p>
      <p>步骤E2鉴权成功后，还包括步骤：F1、IdP实体向UE返回是否与各SP结成身份标识联盟的选择信息；F2、IdP向IdP实体确认所述信息，并完成和所述SP实体结成身份标识联盟。</p>
      <p>本发明方法的流程图如附图8所示，具体说明如下：101、IP多媒体业务子系统用户向业务提供商实体发送应用请求，业务提供商实体向IP多媒体业务子系统用户发送响应信息，所述响应信息携带业务鉴权提供商地址和身份标识联盟请求鉴权信息；102、IP多媒体业务子系统用户向业务鉴权提供商发送身份标识联盟鉴权请求消息，其中携带上述身份标识联盟请求鉴权信息；103、业务鉴权提供商向IP多媒体业务子系统用户发送挑战响应消息，要求其携带身份标识信息；104、IP多媒体业务子系统用户通过启动引导服务器实体完成通用鉴权架构引导过程，IP多媒体业务子系统用户得到引导事务标识和根密钥，所述引导事务标识是身份标识；IP多媒体业务子系统用户向启动引导服务器实体发送鉴权请求消息，其携带引导事务标识和所述身份标识联盟请求鉴权信息；105、启动引导服务器实体对IP多媒体业务子系统用户进行通用鉴权架构鉴权；106、业务鉴权提供商对IP多媒体业务子系统用户进行身份标识联盟鉴权；鉴权成功后，业务鉴权提供商实体向IP多媒体业务子系统用户发送鉴权成功响应消息；107、IP多媒体业务子系统用户向业务提供商实体提出请求信息，其携带上述鉴权成功响应信息，业务提供商实体完成对IP多媒体业务子系统用户的身份标识联盟鉴权。</p>
      <p>根据IdP返回给UE的认证响应中是直接包含Assertion还是Artifact，上述附图8可以进一步详细分解为附图9和附图10两种情况来说明。</p>
      <p>当IdP返回给UE的认证响应中直接包含Assertion时，本发明的一种互通的流程图实例一如附图9所示。</p>
      <p>为保证安全，UE和SP之间事先建立TLS安全隧道。TLS安全隧道的建立不属于本发明范围，在此不作赘述。</p>
      <p>步骤1、UE向SP发出HTTP应用请求消息。</p>
      <p>步骤2、SP找到IdP的地址。</p>
      <p>步骤3、SP发送响应消息给UE，要求其先到相应的IdP上进行鉴权，其中包括身份标识鉴权请求信息AuthnRequest和IdP的地址信息。</p>
      <p>步骤4、UE给IdP发送HTTP请求消息，其中携带上一步获取的AuthnRequest。</p>
      <p>步骤5、IdP给UE发送HTTP挑战响应消息。</p>
      <p>步骤6、UE给BSF发送GBA鉴权请求消息，所述信息包含私有用户标识。</p>
      <p>步骤7、BSF和HSS交换信息，获取认证矢量，该矢量包括鉴权序号AUTN、随机数RAND、期望结果XRES、完整性密钥IK、机密性密钥CK。</p>
      <p>步骤8、BSF给予UE&#160;GBA挑战响应，其包括AUTN和RAND。</p>
      <p>步骤9、UE运行AKA算法，检查AUTN有效性以鉴权网络，并生成响应结果RES。同时根据RAND生成IK和CK。</p>
      <p>步骤10、UE给BSF发送GBA鉴权请求消息，所述信息包含私有用户标识和RES。</p>
      <p>步骤11、BSF比较响应结果RES和期望结果XRES，以检查RES的有效性以对UE进行鉴权。</p>
      <p>步骤12、BSF根据密钥CK和IK以及密钥算法生成Ks，并生成引导事务标识B-TID和Ks有效期。</p>
      <p>步骤13、BSF向UE发送GBA成功响应消息，所述消息包含B-TID和Ks有效期。</p>
      <p>步骤14、UE保存B-TID和Ks有效期，并根据CK和IK生成根密钥Ks。</p>
      <p>至此，完成GBA引导过程。</p>
      <p>步骤15、UE根据公式Ks_NAF＝KDF(Ks，″gba-me″，RAND，IMPI，NAF_Id)或者Ks_Ext_NAF＝KDF(Ks，″gba-me″，RAND，IMPI，NAF_Id)或者Ks_Int_NAF＝KDF(Ks，″gba-u″，RAND，IMPI，NAF_Id)，推导出与想要访问的NAF之间的衍生的共享密钥Ks_(Ext/Int)_NAF。</p>
      <p>步骤16、UE再次向IdP发送HTTP鉴权请求消息，其中携带所述的B-TID和AuthnRequest。</p>
      <p>步骤17、IdP/BSF根据所述公式推导出与想要访问的NAF之间的衍生的共享密钥Ks_(Ext/Int)_NAF，完成对UE的GBA鉴权过程。由于IdP和BSF为一个实体，因此IdP不需要象正常的GBA流程一样通过Zn接口获取Ks_(Ext/Int)_NAF、USS、密钥有效期、引导时间等信息，而是直接在本地获取；其中USS可能包含有一些身份标识联盟相关的信息。然后对UE进行GBA过程的鉴权。同样的由于IdP和BSF为一个实体，因此计算Ks_(Ext/Int)_NAF时BSF总是知道“NAF_ID”。本步骤在BSF上执行时，也可以放到步骤12-步骤16之间，效果是一样的。</p>
      <p>步骤18、IdP根据AuthnRequest内容对UE进行身份标识鉴权。鉴权成功后IdP将告诉UE可以和哪些SP结成身份标识联盟，UE同意并完成和SP的身份标识联盟。这样以后UE可以和相应的SP进行SSO鉴权。</p>
      <p>至此，在IP多媒体业务子系统用户和业务鉴权提供商之间建立了安全联盟。</p>
      <p>步骤19、IdP向UE返回HTTP鉴权成功响应消息，其中AuthnRes&#160;ponse中直接携带对应的Assertion，所述Assertion包含IdP的数字签名。</p>
      <p>步骤20、UE重新向SP发起HTTP应用请求消息，其中AuthnRes&#160;ponse为上一步中返回的AuthnRes&#160;ponse，其中携带对应的Assertion，其包含IdP的数字签名；步骤21、SP对Assertion进行相应处理，根据和IdP的身份标识联盟信息对UE完成SSO鉴权；步骤22、SP最后返回给UE成功的HTTP响应消息。</p>
      <p>这以后UE和SP可以继续进行通讯，直到密钥过期或者即将过期为止。</p>
      <p>当IdP返回给UE的认证响应中包含Artifact时，本发明的一种互通的流程图实例二如附图10所示。</p>
      <p>其中步骤1至步骤18，与实例一完全相同，在此不作赘述。</p>
      <p>步骤19：IdP生成相应的Artifact和Assertion，并保存两者之间的关系，然后IdP向UE返回HTTP鉴权成功响应消息，其中携带对应的Artifact。</p>
      <p>步骤20、UE重新向SP发起HTTP应用请求消息，其中AuthnRes&#160;ponse为上一步中返回的AuthnRes&#160;ponse，其中携带对应的Artifact，其包含Assertion的链接；步骤21、SP向IdP发送通过SOAP协议封装的HTTP请求消息，其中携带对应的Artifact；步骤22、IdP根据Artifact找到对应的Assertion，然后向SP返回通过SOAP协议封装的HTTP响应消息，其中携带对应的Assertion，其包含IdP的数字签名；步骤23、SP对Assertion进行相应处理，根据和IdP的身份标识联盟信息对UE完成SSO鉴权；步骤24、SP最后返回给UE成功的HTTP响应消息。</p>
      <p>这以后UE和SP可以继续进行通讯，直到密钥过期或者即将过期为止。</p>
      <p>根据AuthnRequest中的身份标识策略，IdP可能每次都要求必须先执行步骤5-步骤15，再执行步骤16，以保证每次的用户标识B-TID都是重新生成的。</p>
      <p>如果UE和IdP之间已经建立了安全联盟，并且密钥没有过期，则可以执行下面的策略：跳过步骤5-步骤15，直接执行步骤16，即UE给IdP发送的HTTP鉴权请求信息中携带已有的用户信息B-TID和密钥信息Ks_(Ext/Int)_NAF以及身份标识联盟信息AuthnRequest。</p>
      <p>如果UE和IdP之间还没有建立安全联盟，则必需先执行步骤4-步骤15，进行正常的GBA引导过程以获取用户信息B-TID和密钥信息Ks_(Ext/Int)_NAF，然后再执行步骤16。</p>
      <p>如果UE和IdP之间已经建立了安全联盟，但是密钥已经或者将要过期，则步骤4也带有已有的用户信息B-TID和密钥信息Ks_(Ext/Int)_NAF以及身份标识联盟信息AuthnRequest，然后IdP通过步骤5挑战UE。UE再执行步骤6-步骤15，进行正常的GBA引导过程获取更新的用户信息B-TID和密钥信息Ks_(Ext/Int)_NAF，然后再执行步骤16。</p>
      <p>为了解决现有方案中的缺陷，对于本发明中GBA和SSO两种机制都支持的UE，还执行以下步骤：步骤4、UE向IdP发送HTTP请求时，需要携带一个表示支持GBA机制的标识。</p>
      <p>步骤5、IdP发现UE支持GBA后，需要在发给UE的挑战响应中也携带一个表示需要UE执行GBA机制的标识。</p>
      <p>步骤6-15、UE如果在挑战响应中发现所述标识，则知道需要先执行GBA过程步骤6-步骤15，然后再执行步骤16。否则直接执行步骤16，其中的用户名、密码的获取通过现有SSO机制处理，例如给用户弹一个对话框，由用户直接输入用户名和密码。</p>
      <p>步骤16、UE再次向IdP发送HTTP请求时，也需要携带一个表示支持GBA机制的标识。如果IdP发现此标识，则知道需要先执行步骤17，然后执行步骤18；否则直接跳到步骤18执行。</p>
      <p>此外，也可以通过配置IdP来实现上述功能。通过配置IdP实体上的本地策略，要求UE先完成通用鉴权架构机制鉴权过程后，再执行身份标识联盟鉴权过程。</p>
      <p>应当理解的是，对本领域普通技术人员来说，可以根据上述说明加以改进或变换，而所有这些改进和变换都应属于本发明所附权利要求的保护范围。</p>
    </mode-for-invention>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101488880B?cl=zh">CN101488880B</a></td><td class="patent-data-table-td patent-date-value">2008年1月16日</td><td class="patent-data-table-td patent-date-value">2012年3月14日</td><td class="patent-data-table-td ">北京航空航天大学</td><td class="patent-data-table-td ">一种提高服务组合可信性的自适应维护方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102638440A?cl=zh">CN102638440A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年2月15日</td><td class="patent-data-table-td patent-date-value">2012年8月15日</td><td class="patent-data-table-td ">中兴通讯股份有限公司</td><td class="patent-data-table-td ">在ims网络中实现单点登录的方法和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103460738A?cl=zh">CN103460738A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年3月23日</td><td class="patent-data-table-td patent-date-value">2013年12月18日</td><td class="patent-data-table-td ">交互数字专利控股公司</td><td class="patent-data-table-td ">用于使网络通信安全的系统和方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2012000313A1?cl=zh">WO2012000313A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年1月24日</td><td class="patent-data-table-td patent-date-value">2012年1月5日</td><td class="patent-data-table-td ">Zte Corporation</td><td class="patent-data-table-td ">一种家庭网关认证方法和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2013064040A1?cl=zh">WO2013064040A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年10月26日</td><td class="patent-data-table-td patent-date-value">2013年5月10日</td><td class="patent-data-table-td ">Zte Corporation</td><td class="patent-data-table-td ">一种ims单点登录的组合鉴权方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2015035649A1?cl=zh">WO2015035649A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年9月16日</td><td class="patent-data-table-td patent-date-value">2015年3月19日</td><td class="patent-data-table-td ">Huawei Device Co., Ltd.</td><td class="patent-data-table-td ">一种网络注册的方法和系统</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=S-WGAAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0009320000">H04L9/32</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=S-WGAAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029060000">H04L29/06</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=S-WGAAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04Q0007380000">H04Q7/38</a></span></td></tr><tr><td class="patent-data-table-td "> 合作分类</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=S-WGAAABERAJ&amp;q=http://worldwide.espacenet.com/classification&amp;usg=AFQjCNGs5WqSrPE3A4ZP63zGuM6PRNfEFA#!/CPC=H04L63/0815">H04L63/0815</a></span></td></tr><tr><td class="patent-data-table-td "> 欧洲专利分类号</td><td class="patent-data-table-td "><span class="nested-value">H04L63/08B</span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2007年8月22日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2008年10月1日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年5月2日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Granted</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/fa9ee6048d28c95cc7a5/CN101022651A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E7%BB%84%E5%90%88%E9%89%B4%E6%9D%83%E6%9E%B6%E6%9E%84%E5%8F%8A%E5%85%B6%E5%AE%9E%E7%8E%B0%E6%96%B9.pdf?id=S-WGAAABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U2HQen1-db94xL4XoJ6u233wqYCvQ"},"sample_url":"https://www.google.com/patents/reader?id=S-WGAAABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>