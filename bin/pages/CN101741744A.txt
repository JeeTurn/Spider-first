<!DOCTYPE html><html><head><title>专利 CN101741744A - 一种网络流量识别方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_50a6672b5f82ffbd39b7a9e87fd4594c/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_50a6672b5f82ffbd39b7a9e87fd4594c__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种网络流量识别方法"><meta name="DC.contributor" content="侯旭勃" scheme="inventor"><meta name="DC.contributor" content="孙庆庆" scheme="inventor"><meta name="DC.contributor" content="张弘" scheme="inventor"><meta name="DC.contributor" content="张春" scheme="inventor"><meta name="DC.contributor" content="张金玺" scheme="inventor"><meta name="DC.contributor" content="朱一星" scheme="inventor"><meta name="DC.contributor" content="权新" scheme="inventor"><meta name="DC.contributor" content="王开" scheme="inventor"><meta name="DC.contributor" content="王梁" scheme="inventor"><meta name="DC.contributor" content="裴文江" scheme="inventor"><meta name="DC.contributor" content="许浩伟" scheme="inventor"><meta name="DC.contributor" content="东南大学" scheme="assignee"><meta name="DC.date" content="2009-12-17" scheme="dateSubmitted"><meta name="DC.description" content="本发明提供一种网络流量识别方法，包括有DPI(Deep?Packet?Inspection)深度包检测和DFI(Deep?Flow?Inspection)深度流检测两个大的模块，其中DPI模块又包括流表检测模块和流识别模块。流识别模块根据数据流特征库中的特征识别网络协议。DFI模块包括样本获取模块，分类器训练模块和分类器分类预测模块。样本获取模块将DPI中的流识别模块能够准确识别的数据流划分成几个大类，并且将其作为样本对分类器训练模块经行训练，获得能对网络流量进行大类区分的分类模型。这样让网络流量先经过DFI系统进行大类的区分，再流经DPI的流识别模块进行细分，达到提高网络流量分类精度的目的。"><meta name="DC.date" content="2010-6-16"><meta name="citation_patent_publication_number" content="CN:101741744:A"><meta name="citation_patent_application_number" content="CN:200910263262"><link rel="canonical" href="https://www.google.com/patents/CN101741744A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101741744A?cl=zh"/><meta name="title" content="专利 CN101741744A - 一种网络流量识别方法"/><meta name="description" content="本发明提供一种网络流量识别方法，包括有DPI(Deep?Packet?Inspection)深度包检测和DFI(Deep?Flow?Inspection)深度流检测两个大的模块，其中DPI模块又包括流表检测模块和流识别模块。流识别模块根据数据流特征库中的特征识别网络协议。DFI模块包括样本获取模块，分类器训练模块和分类器分类预测模块。样本获取模块将DPI中的流识别模块能够准确识别的数据流划分成几个大类，并且将其作为样本对分类器训练模块经行训练，获得能对网络流量进行大类区分的分类模型。这样让网络流量先经过DFI系统进行大类的区分，再流经DPI的流识别模块进行细分，达到提高网络流量分类精度的目的。"/><meta property="og:title" content="专利 CN101741744A - 一种网络流量识别方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101741744A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101741744A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=kYh-BwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101741744A&amp;usg=AFQjCNFIIIVmx6C9yQtQ5OoDB5YJyiDUcQ" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/629a71bfd446c5e411d2/CN101741744A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/629a71bfd446c5e411d2/CN101741744A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101741744A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101741744A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN101741744A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN101741744B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101741744A?cl=zh" style="display:none"><span itemprop="description">本发明提供一种网络流量识别方法，包括有DPI(Deep?Packet?Inspection)深度包检测和DFI(Deep?Flow?Inspection)深度流检测两个大的模块，其中DPI模块又包括流表检测模块和流识别模块。流识别模块根据数据流特征库中的特征识别网络协议。DF...</span><span itemprop="url">https://www.google.com/patents/CN101741744A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101741744A - 一种网络流量识别方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101741744A - 一种网络流量识别方法" title="专利 CN101741744A - 一种网络流量识别方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101741744 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200910263262</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2010年6月16日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2009年12月17日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2009年12月17日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101741744B?hl=zh-CN&amp;cl=zh">CN101741744B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200910263262.6, </span><span class="patent-bibdata-value">CN 101741744 A, </span><span class="patent-bibdata-value">CN 101741744A, </span><span class="patent-bibdata-value">CN 200910263262, </span><span class="patent-bibdata-value">CN-A-101741744, </span><span class="patent-bibdata-value">CN101741744 A, </span><span class="patent-bibdata-value">CN101741744A, </span><span class="patent-bibdata-value">CN200910263262, </span><span class="patent-bibdata-value">CN200910263262.6</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E4%BE%AF%E6%97%AD%E5%8B%83%22">侯旭勃</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%AD%99%E5%BA%86%E5%BA%86%22">孙庆庆</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%BC%A0%E5%BC%98%22">张弘</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%BC%A0%E6%98%A5%22">张春</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%BC%A0%E9%87%91%E7%8E%BA%22">张金玺</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%9C%B1%E4%B8%80%E6%98%9F%22">朱一星</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%9D%83%E6%96%B0%22">权新</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%8E%8B%E5%BC%80%22">王开</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%8E%8B%E6%A2%81%22">王梁</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E8%A3%B4%E6%96%87%E6%B1%9F%22">裴文江</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E8%AE%B8%E6%B5%A9%E4%BC%9F%22">许浩伟</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%22">东南大学</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101741744A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101741744A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101741744A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (9),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (2),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (4)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=kYh-BwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200910263262&amp;usg=AFQjCNFQ0-2qLuLPxrXBhzqDGizkF5VjlQ"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=kYh-BwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101741744A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNEHlKi6zQsmj0ImHsyr39B-tzQoDg"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT95935627" lang="ZH" load-source="patent-office">一种网络流量识别方法</invention-title>
      </span><br><span class="patent-number">CN 101741744 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA78463211" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明提供一种网络流量识别方法，包括有DPI(Deep?Packet?Inspection)深度包检测和DFI(Deep?Flow?Inspection)深度流检测两个大的模块，其中DPI模块又包括流表检测模块和流识别模块。流识别模块根据数据流特征库中的特征识别网络协议。DFI模块包括样本获取模块，分类器训练模块和分类器分类预测模块。样本获取模块将DPI中的流识别模块能够准确识别的数据流划分成几个大类，并且将其作为样本对分类器训练模块经行训练，获得能对网络流量进行大类区分的分类模型。这样让网络流量先经过DFI系统进行大类的区分，再流经DPI的流识别模块进行细分，达到提高网络流量分类精度的目的。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(2)</span></span></div><div class="patent-text"><ol mxw-id="PCLM32050972" lang="ZH" load-source="patent-office" class="claims">
    <li class="claim"> <div num="1" class="claim">
      <div class="claim-text">一种网络流量识别方法，其特征在于：包括以下步骤：(a)将网络数据流发送至已经训练过的DFI流量识别系统中的分类器分类预测模块进行数据流大类的区分，将数据流根据相应的分类打上标签，然后进入(b)步骤；(b)将经过(a)步骤处理过的数据流发送至DPI业务识别系统中的流表检测模块进行检测，检测当前数据流的业务类型是否在流表检测模块维护的状态表中，当结果为是，则直接将当前数据流标记，然后将该数据流发送至协议处理模块进行具体业务的处理，同时也将该数据流发送至DFI流量识别系统中的样本获取模块，获取样本文件；当结果为否，则进入(c)步骤；(c)将(b)步骤中未标记的数据流发送至流识别模块，检索该数据流是否含有与DPI业务识别系统的数据流特征库中匹配的任意一条特征，当检索到有匹配的特征，则标记当前报文对应的数据流为特定的数据流，并更新流表检测模块中维护的状态表；同时将该数据流标记以后送入协议处理模块；当没有检索到匹配的特征，则直接将该数据流发送至协议处理模块，进入(d)步骤；(d)协议处理模块根据以上步骤中对数据流的不同标记，分别进行具体业务或者针对不同大类的处理。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2. 根据权利要求1所述的网络流量识别方法，其特征在于：所述DFI分类器分类预测模块进行训练的步骤为：A、 流表检测模块将维护的状态表中的数据流发送至DFI流量识别系统中的样本获取 模块；B、 样本获取模块在线获得该数据流的样本文件以后，将该样本文件发送至分类器训练 模块进行离线训练，获得分类模型；C、 分类器训练模块将此分类模型发送至分类器分类预测模块；D、 分类器分类预测模块根据训练得到的分类模型对（a)步骤中的数据流进行分类。</div>
    </div>
  </li> </ol>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES37417921" lang="ZH" load-source="patent-office" class="description">
    <p>一种网络流量识别方法</p>
    <p>技术领域</p>
    <p>[0001] 本发明涉及一种网络流量识别方法，属于网络数据传输领域。</p>
    <p>背景技术</p>
    <p>[0002]     BT和Edonkey为代表的P2P应用已经占据了整个互联网流量的2/3以上，运营商</p>
    <p>的基础网络建设陷入了"拥塞_扩容_再拥塞"的非正常局面，盈利能力相应降低。无法实</p>
    <p>现业务识别增加了运营商的运营成本，降低了客户的满意度。于是，如何深度感知网络应</p>
    <p>用，提供网络业务控制和管理手段，构建可以运营、可以管理的和谐网络，对P2P有效限制，</p>
    <p>合理引导，化不利为我所用，已经成为电信运营商目前亟需研究的一个热门课题。</p>
    <p>[0003]     基于以上原因，必须通过技术手段识别出基于不同的网络数据流量，从而可以对</p>
    <p>其进行控制和管理。</p>
    <p>[0004]      目前识别网络数据流业务的方法主要有以下几种：</p>
    <p>[0005] (1)基于端口的网络数据流业务识别技术：这种识别技术是通过各种不同的应用 在IANA(Internet Assigned Numbers Authority)中注册的不同端口号来进行识别的。例 如检测到端口号为80时，则认为该应用代表着普通上网应用。而当前网络上的一些非法应 用会采用隐藏或假冒端口号的方式躲避检测和监管，造成仿冒合法报文的数据流侵蚀着网 络。比如新型的P2P协议所使用的端口是变化的，因此端口号识别的准确率已经越来越低， 该方法已经越来越不适合对现有网络数据流业务的识别。</p>
    <p>[0006] (2)DPI(De印Packet Inspection)深度包检测网络数据流业务识别技术：当碰到 某些使用动态端口的新型的协议时，采用基于端口的识别技术就会无能为力。DPI技术除了 对4层以下的基础信息进行分析外，还增加了应用层分析，识别各种应用及其内容。就是通 过对一系列数据包的应用层负载特征进行分析，找出其应用层的特征字，从而对各种业务 进行识别。这种方法在遇到应用层数据加密的时候处理起来就会非常困难。 [0007] (3) DFI (De印Flow Inspection)深度流检测网络数据流业务识别技术：当DPI识 别技术遇到应用层数据加密的时候，就很难通过分析应用层数据的特征来对其进行识别。 DFI技术是根据流的特征来对业务进行识别的技术，即不同的应用类型体现在会话连接或 数据流上的状态各有不同。DFI的特点是对整个数据流的特征进行分析，例如每个流的平均 包长，每个包到达的时间间隔等。无须对应用层数据进行检测，因而应用层数据加密与否对 这种识别技术来讲没有区别。属于同种类型业务的数据流的特征一般都是非常接近的，例 如QQ和MSN这两种IM软件的流量特征可能就非常接近，因此这种方法的缺点是只能对网 络流量的几个大类进行区分。例如&#38914;，P2P， WEB等。</p>
    <p>发明内容</p>
    <p>[0008] 发明目的：</p>
    <p>[0009] 本发明要解决的技术问题在于，针对基于端口识别技术的准确率低，DPI和DFI技 术分别存在对应用层数据加密的业务的识别非常困难，和只能对网络流量进行大类区分的缺陷，提出了将DFI和DPI相结合的网络流量分类方法。 [0010]     技术方案：</p>
    <p>[0011] 本发明解决其技术问题所采用的技术方案是：先对网络流量进行大类的区分，然 后构造DPI网络数据流业务识别系统，对应用层没有加密的业务进行应用层特征提取，将 提取到的特征放入特征库中，然后以DPI能够识别的协议的数据流作为DFI业务识别模块 的样本，对DFI进行训练，训练完成以后将DFI模块加在DPI业务识别系统之前，让网络流 量先经过DFI进行大类的区分，然后再进入DPI系统进行细分。 [0012]     本发明的网络流量识别方法的具体步骤为：</p>
    <p>[0013] (a)将网络数据流发送至已经训练过的DFI流量识别系统中的分类器分类预测模 块进行数据流大类的区分，将数据流根据相应的分类打上标签，然后进入（b)步骤； [0014] (b)将经过（a)步骤处理过的数据流发送至DPI业务识别系统中的流表检测模块 进行检测，检测当前数据流的业务类型是否在流表检测模块维护的状态表中，当结果为是， 则直接将当前数据流标记，然后将该数据流发送至协议处理模块进行具体业务的处理，同 时也将该数据流发送至DFI流量识别系统中的样本获取模块，获取样本文件；当结果为否， 则进入(c)步骤;</p>
    <p>[0015] (c)将（b)步骤中未标记的数据流发送至流识别模块，检索该数据流是否含有与 DPI业务识别系统的数据流特征库中匹配的任意一条特征，当检索到有匹配的特征，则标记 当前报文对应的数据流为特定的数据流，并更新流表检测模块中维护的状态表；同时将该 数据流标记以后送入协议处理模块；当没有检索到匹配的特征，则直接将该数据流发送至 协议处理模块，进入（d)步骤；</p>
    <p>[0016] (d)协议处理模块根据以上步骤中对数据流的不同标记，分别进行具体业务或者 针对不同大类的处理。</p>
    <p>[0017]     本发明的网络流量识别方法所述DFI分类器分类预测模块进行训练的步骤为： [0018]     A、流表检测模块将维护的状态表中的数据流发送至DFI流量识别系统中的样本 获取模块；</p>
    <p>[0019] B、样本获取模块在线获得该数据流的样本文件以后，将该样本文件发送至分类器 训练模块进行离线训练，获得分类模型；</p>
    <p>[0020]     C、分类器训练模块将此分类模型发送至分类器分类预测模块；</p>
    <p>[0021]     D、分类器分类预测模块根据训练得到的分类模型对（a)步骤中的数据流进行分类。</p>
    <p>[0022] 在本发明所述的DPI业务识别系统中，包括：流表检测模块，判断当前的数据流是 否为已经标记类型的数据流；数据流特征库，存储数据流的特征；流识别模块，根据数据流 特征库中的特征识别网络流量代表的不同业务；协议处理模块，用于对具体业务的处理，以 及对网络大类的处理。所述数据流特征库，包括网络流量各个大类中的部分业务的应用层 特征。例如：属于即时消息这一大类的业务有QQ和百度HI等，QQ的应用层特征为数据包以 0x02开始，以0x03结束，百度HI的应用层特征为前八个字节为0x0000010031564d49。属于 P2P这一大类的业务有TTlive和Sopcast等，TTlive的应用层特征为每个流的第一个包的 净载荷长度为52字节，前三个字节为OxffffOl，最后两个字节为0x0002， Sopcast的应用层 特征为第一个有净载荷的数据包的特征字用正则表达式表示为："DESCRIBE. *User-Agent :</p>
    <p>4丽Pl罕r。</p>
    <p>[0023] 在本发明所述的DFI流量识别系统中，有样本获取模块，分类器训练模块和分类 器分类预测模块。所述样本获取模块将DPI能够精确识别的业务的流特征提取出来，分成 不同的类别，作为分类器训练模块的训练样本。所述分类器训练模块对样本获取模块提供 的样本进行训练获得一个训练模型，所述预测模块就是根据分类器训练模块获得的模型对 其他数据进行分类。 [0024]     有益效果：</p>
    <p>[0025] 本发明的网络流量分类方法，先对网络数据流进行大类的区分，然后进入DPI系 统进行细分，增加了对网络流量进行分类的准确性。</p>
    <p>附图说明</p>
    <p>[0026]      图1是DPI识别模块的结构框图； [0027]      图2是DFI识别模块的结构框图； [0028]     图3是本发明DPI和DFI相结合的网络流 [0029]     图4是本发明DPI和DFI相结合的网络流</p>
    <p>具体实施方式</p>
    <p>[0030] 如图1所示，在本发明的DFI和DPI相结合的网络流量分类系统的第一实施步骤 中，网络流量识别系统连接到基于TCP/IP协议的网络中，其中有一个流表检测模块，一个 协议处理模块， 一个流识别模块以及一个数据流特征库。</p>
    <p>[0031] 数据流特征库中包含有分别属于几个网络流量大类的各种不同的业务。举例如 下：</p>
    <p>[0032] (1)属于IM(即时通讯）这一大类的有QQ和百度HI等，QQ的应用层特征为数据 包以0x02开始，以0x03结束，百度HI的应用层特征为前八个字节为0x0000010031564d49。 [0033] (2)属于P2P这一大类的业务有TTlive和Sopcast等，TTlive的应用层特征 为每个流的第一个包的净载荷长度为52字节，前三个字节为Oxffff01，最后两个字节为 0x0002， Sopcast的应用层特征为第一个有净载荷的数据包的特征字用正则表达式表示为： 'DESCRIBE. Wser-Agent :丽Player。 [0034] 数据流特征库中存储有上述各类业务的特征。</p>
    <p>[0035]     流表检测模块维护一张状态表，表中信息包括数据流的五元组（源ip地址，目的</p>
    <p>ip地址，源端口，目的端口，协议号）以及所属协议类型的ID，网络数据流进入以后首先将</p>
    <p>自己的五元组与状态表中的信息比对，查看是否在该状态表中，若在该状态表中则将其用</p>
    <p>所属协议类型的ID标注后送入协议处理模块。</p>
    <p>[0036]     例如状态表中维护的一条信息格式如下表第二行：</p>
    <p>[0037]&lt;table&gt;table see original document page 5&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;</p>
    <p>量分类方法的框图； 量分类方法的流程图。[0038] 其中119. 147. 18. 47是源ip地址，10. 8. 7. 43是目的ip地址，8000是源端口 ， 4000 是目的端口 ， 0x11是协议号（UDP协议），5是可以自己定义的协议ID，比如我们把QQ的协 议ID定为5，那么5就代表QQ的数据流。 一旦有新数据流进入流表检测模块，首先将自己 的五元组与表中的信息的前五项（五元组）进行比对，如果发现状态表中存在有自己的五 元组，则将该数据流用协议ID进行标注后送入协议处理模块，若在状态表中没有发现与自 己五元组匹配的记录则进入流识别模块。</p>
    <p>[0039] 流识别模块先对网络数据流应用层数据进行分析，并将其应用层特征与数据流特 征库中的特征进行比对，若应用层数据的特征字符串符合数据流特征库中的一个或者多个 特征，则流识别模块将其标记为对应的协议ID，并且将该流量更新到流表检测模块，若在数 据流特征库中不存在与其特征字符串匹配的特征，则数据流识别模块不对其进行标记，而 是将其送入DFI识别模块，由DFI识别模块对其进行进一步识别。</p>
    <p>[0040] 数据流特征库中存放有事先已经识别的业务的应用层特征字，比如bitspirit的 应用层前20个字节恒为0xl3426974546f7272656e742070726f746f636f6c， PP点点通下载 文件时应用层前5个字节恒为0x3c00000001。流量识别模块就是通过与库中特征比对来判 断数据流是否能够识别以及属于何种协议。</p>
    <p>[0041] 如图2所示，是DPI和DFI相结合的网络流量分类系统中的DFI部分的结构框图， 其中主要有样本获取模块，分类器训练模块，和分类器分类预测模块、样本获取模块，将图1 中的流识别模块能够准确识别的数据流作为样本，将其归入之前分好的几个网络流量的大 类中，并从中提取出所需要的流特征，比如QQ是流识别模块能够准确识别的，并且QQ属于 M(即时通讯）这一大类，那么每个QQ网络数据流都可以作为一个IM这一大类的样本。同 样我们也能对百度HI进行准确识别，并且百度HI也属于IM这一大类，那么每个百度HI网 络数据流也可以作为一个IM这一大类的样本。获得样本后我们计算出每个样本的流特征， 比如该流的平均包长，包的平均时间间隔等，并对这个样本进行标记以确定其所属的大类。 采用同样的方法我们可以通过对TTlive和Sopcast网络数据流提取出P2P这一个大类的 样本，以及其他几个大类的样本，将所有这些样本集中在一起我们就可以获得一个样本文</p>
    <p>件。其文件格式如下表： [0042]</p>
    <p>&lt;table&gt;table see original document page 6&lt;/column&gt;&lt;/row&gt;
&lt;table&gt;					[0043] 该文件中每一行都代表一个样本，每列的第一个字符表示该行样本所属的大类， 例如我们把P2P这一大类用1这个ID表示，把M(即时通讯）这一大类用2表示，把WEB 应用这一大类用3表示，那么这个文件的第一行和第三行表示是P2P的样本数据，第二行表 示是IM(即时通讯）的样本数据，第四行表示是WEB应用的样本数据。文件每一行的大类ID后面是特征索引和该特征的值，例如我们把流的平均包长这一流特征用1索引，把包到 达的平均时间间隔用2索引，那么代表第一行就表明这一样本数据的平均包长为IOOO，包 到达的平均时间间隔为O. 005。每个流的特征肯定不止两项，其他特征这里不再列出。样本 获取模块的作用就是从流识别模块能够准确识别的数据流中提取其流特征，将该特征以样 本文件的形式保存。</p>
    <p>[0044] 分类器训练模块通过对样本获取模块获取的样本的训练获得一个预测模型。 [0045] 分类器分类预测模块通过预测模型对流识别模块无法识别的流量进行分类。 [0046] 图3是DPI识别模块和DFI识别模块的结合，可以将其分成在线和离线两个大类， 流表检测模块，协议处理模块，流识别模块，数据流特征库，样本获取模块，分类器分类预测 模块是在线的，分类器训练模块是离线的。样本获取模块在线获得样本文件以后可以对分 类器进行离线训练，获得分类模型，当DPI系统中的流识别模块无法识别时，再经过DFI系 统的分类器分类预测模块，分类器分类预测模块根据训练得到的分类模型对流识别模块无 法识别数据流进行分类。</p>
    <p>[0047] 图4是本发明DPI和DFI相结合的网络流量分类方法的流程图。 [0048] 首先，在网络流量到达时，根据报文中的报头检测当前报文是否已经标记。若当前 报文对应数据流的类型已经标记，则使用与类型对应的方式处理当前数据流。若当前报文 对应数据流的类型没有标记，则进入流量识别模块进行识别判断，若流量识别模块能够识 别则在流表中标记该流量，以便使属于同一流量的报文在流表检测时就能检测出来。然后 在将识别出来的流量送入协议处理模块，若流量识别模块无法识别，则进入分类器分类预 测模块，由于所有网络数据流量必然属于几个大类中的一类，所以在这里所有DPI的流量 识别模块无法识别的流量都被按大类进行了分类。分类完成以后送入协议处理模块，协议 处理模块根据类别的不同分别进行处理。这里的协议处理模块包含两大处理对象，一个是 对具体业务的处理，另外一个是对网络大类的处理。</p>
    <p>[0049] 通过上述方式处理网络流量，比单纯地使用DPI或者DFI来得全面，它能够对应用 层没有加密的业务进行精确地识别，也能够对应用层加密的业务进行大类的区分。</p>
    <p>7</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102025623A?cl=zh">CN102025623A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年12月7日</td><td class="patent-data-table-td patent-date-value">2011年4月20日</td><td class="patent-data-table-td ">苏州迈科网络安全技术股份有限公司</td><td class="patent-data-table-td ">智能化网络流控方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102025623B?cl=zh">CN102025623B</a></td><td class="patent-data-table-td patent-date-value">2010年12月7日</td><td class="patent-data-table-td patent-date-value">2013年3月20日</td><td class="patent-data-table-td ">苏州迈科网络安全技术股份有限公司</td><td class="patent-data-table-td ">智能化网络流控方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102045347A?cl=zh">CN102045347A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年11月30日</td><td class="patent-data-table-td patent-date-value">2011年5月4日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">协议识别方法和装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102045347B?cl=zh">CN102045347B</a></td><td class="patent-data-table-td patent-date-value">2010年11月30日</td><td class="patent-data-table-td patent-date-value">2013年8月7日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">协议识别方法和装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102420830A?cl=zh">CN102420830A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年12月15日</td><td class="patent-data-table-td patent-date-value">2012年4月18日</td><td class="patent-data-table-td ">北京大学</td><td class="patent-data-table-td ">一种p2p协议类型识别方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103312565A?cl=zh">CN103312565A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年6月28日</td><td class="patent-data-table-td patent-date-value">2013年9月18日</td><td class="patent-data-table-td ">南京邮电大学</td><td class="patent-data-table-td ">一种基于自主学习的对等网络流量识别方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103312565B?cl=zh">CN103312565B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年6月28日</td><td class="patent-data-table-td patent-date-value">2015年12月23日</td><td class="patent-data-table-td ">南京邮电大学</td><td class="patent-data-table-td ">一种基于自主学习的对等网络流量识别方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8825884">US8825884</a></td><td class="patent-data-table-td patent-date-value">2011年12月28日</td><td class="patent-data-table-td patent-date-value">2014年9月2日</td><td class="patent-data-table-td ">Huawei Technologies Co., Ltd.</td><td class="patent-data-table-td ">Method and device for protocol identification</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2012071854A1?cl=zh">WO2012071854A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年5月12日</td><td class="patent-data-table-td patent-date-value">2012年6月7日</td><td class="patent-data-table-td ">Huawei Technologies Co., Ltd.</td><td class="patent-data-table-td ">协议识别方法和装置</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=kYh-BwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0012801000">H04L12/801</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=kYh-BwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029080000">H04L29/08</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2010年6月16日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2010年9月1日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2011年12月14日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Granted</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2015年2月4日</td><td class="patent-data-table-td ">C17</td><td class="patent-data-table-td ">Cessation of patent right</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/629a71bfd446c5e411d2/CN101741744A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_50a6672b5f82ffbd39b7a9e87fd4594c.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F%E8%AF%86%E5%88%AB%E6%96%B9%E6%B3%95.pdf?id=kYh-BwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U2XN8YkH2kvBGHfCIDXNo-hrgq1mQ"},"sample_url":"https://www.google.com/patents/reader?id=kYh-BwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>