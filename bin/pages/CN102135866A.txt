<!DOCTYPE html><html><head><title>专利 CN102135866A - 一种基于Xen安全计算机显示优化的方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_50a6672b5f82ffbd39b7a9e87fd4594c/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_50a6672b5f82ffbd39b7a9e87fd4594c__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种基于Xen安全计算机显示优化的方法"><meta name="DC.contributor" content="刘发贵" scheme="inventor"><meta name="DC.contributor" content="吴刚" scheme="inventor"><meta name="DC.contributor" content="周魏" scheme="inventor"><meta name="DC.contributor" content="谢然" scheme="inventor"><meta name="DC.contributor" content="华南理工大学" scheme="assignee"><meta name="DC.date" content="2010-10-29" scheme="dateSubmitted"><meta name="DC.description" content="本发明提供了一种基于Xen安全计算机显示优化的方法，包括宿主系统的简化后端、客户系统的定制前端驱动、以及前后端之间的通信优化；所述宿主系统的简化后端，包括实现PCI设备接口，以及引入Frame Buffer的支持，通过对Frame Buffer的读写直接将帧缓存图像绘制于屏幕上；所述客户系统的定制前端驱动，包括直接获取后端设备提供的内存I/O及端口I/O资源，并通过系统GDI显示接口实现基于Frame Buffer的显示环境；所述前后端之间的通信优化，首先后端设备在宿主系统中注册指定I/O端口，前端驱动访问这些I/O将直接引发后端实现的回调函数而完成前后端同步的交互；其次后端还提供一块与前端驱动交互的内存空间，并将此内存空间映射至客户系统的内存空间，通过共享内存的方式实现交互。"><meta name="DC.date" content="2011-7-27"><meta name="DC.relation" content="CN:101667144:A" scheme="references"><meta name="DC.relation" content="WO:2008008675:A2" scheme="references"><meta name="citation_patent_publication_number" content="CN:102135866:A"><meta name="citation_patent_application_number" content="CN:201010529692"><link rel="canonical" href="https://www.google.com/patents/CN102135866A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN102135866A?cl=zh"/><meta name="title" content="专利 CN102135866A - 一种基于Xen安全计算机显示优化的方法"/><meta name="description" content="本发明提供了一种基于Xen安全计算机显示优化的方法，包括宿主系统的简化后端、客户系统的定制前端驱动、以及前后端之间的通信优化；所述宿主系统的简化后端，包括实现PCI设备接口，以及引入Frame Buffer的支持，通过对Frame Buffer的读写直接将帧缓存图像绘制于屏幕上；所述客户系统的定制前端驱动，包括直接获取后端设备提供的内存I/O及端口I/O资源，并通过系统GDI显示接口实现基于Frame Buffer的显示环境；所述前后端之间的通信优化，首先后端设备在宿主系统中注册指定I/O端口，前端驱动访问这些I/O将直接引发后端实现的回调函数而完成前后端同步的交互；其次后端还提供一块与前端驱动交互的内存空间，并将此内存空间映射至客户系统的内存空间，通过共享内存的方式实现交互。"/><meta property="og:title" content="专利 CN102135866A - 一种基于Xen安全计算机显示优化的方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN102135866A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN102135866A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=8LyXBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN102135866A&amp;usg=AFQjCNGZ6tdaW9U4pAEye8qeEfy9RN3erA" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/68bb6518fe246a771193/CN102135866A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/68bb6518fe246a771193/CN102135866A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN102135866A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN102135866A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN102135866A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN102135866B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN102135866A?cl=zh" style="display:none"><span itemprop="description">本发明提供了一种基于Xen安全计算机显示优化的方法，包括宿主系统的简化后端、客户系统的定制前端驱动、以及前后端之间的通信优化；所述宿主系统的简化后端，包括实现PCI设备接口，以及引入Frame Buffer的支持，通过对Frame Buffer的读写直接将帧缓存图像绘制于屏幕上；所述客户系统的定制前端驱动，包括直接获取后端设备提供的内存I/O及端口I/O资源，并通过系统GDI显示接口实现基于Frame...</span><span itemprop="url">https://www.google.com/patents/CN102135866A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN102135866A - 一种基于Xen安全计算机显示优化的方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN102135866A - 一种基于Xen安全计算机显示优化的方法" title="专利 CN102135866A - 一种基于Xen安全计算机显示优化的方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN102135866 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201010529692</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2011年7月27日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2010年10月29日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2010年10月29日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102135866B?hl=zh-CN&amp;cl=zh">CN102135866B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201010529692.0, </span><span class="patent-bibdata-value">CN 102135866 A, </span><span class="patent-bibdata-value">CN 102135866A, </span><span class="patent-bibdata-value">CN 201010529692, </span><span class="patent-bibdata-value">CN-A-102135866, </span><span class="patent-bibdata-value">CN102135866 A, </span><span class="patent-bibdata-value">CN102135866A, </span><span class="patent-bibdata-value">CN201010529692, </span><span class="patent-bibdata-value">CN201010529692.0</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%88%98%E5%8F%91%E8%B4%B5%22">刘发贵</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%90%B4%E5%88%9A%22">吴刚</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%91%A8%E9%AD%8F%22">周魏</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E8%B0%A2%E7%84%B6%22">谢然</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E5%8D%8E%E5%8D%97%E7%90%86%E5%B7%A5%E5%A4%A7%E5%AD%A6%22">华南理工大学</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102135866A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102135866A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102135866A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (2),</span> <span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (7),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (2),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=8LyXBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201010529692&amp;usg=AFQjCNGo1BeubrC87iGcyi_2TZ1lAcPzwA"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=8LyXBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D102135866A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNFchqghsrccKtZn1rDkMKQaRV3sMA"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT104330597" lang="ZH" load-source="patent-office">一种基于Xen安全计算机显示优化的方法</invention-title>
      </span><br><span class="patent-number">CN 102135866 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA86216913" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明提供了一种基于Xen安全计算机显示优化的方法，包括宿主系统的简化后端、客户系统的定制前端驱动、以及前后端之间的通信优化；所述宿主系统的简化后端，包括实现PCI设备接口，以及引入Frame&#160;Buffer的支持，通过对Frame&#160;Buffer的读写直接将帧缓存图像绘制于屏幕上；所述客户系统的定制前端驱动，包括直接获取后端设备提供的内存I/O及端口I/O资源，并通过系统GDI显示接口实现基于Frame&#160;Buffer的显示环境；所述前后端之间的通信优化，首先后端设备在宿主系统中注册指定I/O端口，前端驱动访问这些I/O将直接引发后端实现的回调函数而完成前后端同步的交互；其次后端还提供一块与前端驱动交互的内存空间，并将此内存空间映射至客户系统的内存空间，通过共享内存的方式实现交互。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(7)</span></span></div><div class="patent-text"><div mxw-id="PCLM37823452" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.	一种基于Xen安全计算机显示优化的方法，其特征在于包括宿主系统的简化后端、 客户系统的定制前端驱动、以及前后端之间的通信优化；所述宿主系统的简化后端，包括实现PCI设备接口，以及引入Frame Buffer的支持，通 过对Frame Buffer的读写直接将帧缓存图像绘制于屏幕上；所述客户系统的定制前端驱动，包括直接获取后端设备提供的内存I/O及端口 I/O资 源，并通过系统⑶I显示接口实现基于Frame Buffer的显示环境；所述前后端之间的通信优化，首先后端设备在宿主系统中注册指定I/O端口，前端驱 动访问这些I/O将直接引发后端实现的回调函数而完成前后端同步的交互；其次后端还提 供一块与前端驱动交互的内存空间，并将此内存空间映射至客户系统的内存空间，通过共 享内存的方式实现交互。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.根据权利要求1所述的基于Xen安全计算机显示优化的方法，其特征在于通过前后 端分离机制的虚拟设备实现一张虚拟显卡EMOS VGA，所述EMOS VGA的后端设备引入Frame Buffer的支持，而前端驱动定制基于Windows客户系统的显示驱动，前后端之间的通信则 基于共享内存及I/O端口截获的方式实现。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.根据权利要求2所述的基于Xen安全计算机显示优化的方法，其特征在于所述EMOS VGA的后端设备构成包括：Std VGA接口的实现、Frame Buffer的支持及PCI设备仿真的实 现，通过EMOS VGA设备直接访问Frame Buffer，将Frame Buffer中保存的位图直接绘制于 显示器之上，完成显示工作。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.根据权利要求3所述的基于Xen安全计算机显示优化的方法，其特征在于所述EMOS VGA的后端设备工作流程如下：1)后端设备初始化，通过PCI设备接口注册PCI总线设备；2)填充PCI配置空间，设置类型为VGA设备；3)获取Frame	Buffer帧缓冲设备和指定显示模式并保存于后端设备属性中；4)设置Frame	Buffer地址为共享空间并映射给前端设备；5)在宿主机中注册后端显示设备指定I/O端口	；6)实现与Md	VGA接口的连接并初始化Md VGA ；7)客户系统加载前端驱动，触发显示操作；8)后端设备调用回调函数操作Frame	Buffer完成显示工作。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.根据权利要求2所述的基于Xen安全计算机显示优化的方法，其特征在于所述EMOS VGA前端驱动存在于虚拟Windows客户系统中，负责EMOS VGA显示工作的驱动程序，前端驱 动程序使用Windows⑶I接口基于Frame Buffer完成显示工作，其操作的EMOS VGA设备 资源是由后端直接映射的共享内存空间。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.根据权利要求2所述的基于Xen安全计算机显示优化的方法，其特征在于所述前后 端之间的通信采用共享内存的方式为：后端将供访问的Frame Buffer地址空间直接映射 给前端驱动程序，通过Xen提供的API实现Windows客户系统直接读写Frame Buffer。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.根据权利要求2所述的基于Xen安全计算机显示优化的方法，其特征在于所述前后 端之间的通信采用I/O端口截获的方式为：后端在Xen虚拟机中注册指定I/O端口，用于与 前端驱动同步的通信，前端驱动访问指定I/O端口将导致该指令被虚拟机截获。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES43402492" lang="ZH" load-source="patent-office" class="description">
    <p>一种基于Xen安全计算机显示优化的方法</p>
    <p>技术领域</p>
    <p>[0001]	本发明属于虚拟化技术应用领域，特别是涉及Xen安全计算机的显示模块优化的 领域。</p>
    <p>技术背景</p>
    <p>[0002]	随着计算机和网络技术的飞速发展与广泛应用，全球信息化程度不断提高，信息 安全问题日益受到各领域的关注。由于我国信息技术起步较晚，软硬件水平落后于国际，并 且暂无绝对的技术知识产权优势，因此大力发展和研究自主的安全计算机产品是现阶段计 算机终端发展的主要任务。</p>
    <p>[0003]	虚拟化技术的发展正迅速改变着信息技术的面貌，并从根本上改变着传统的计算 方式。利用虚拟化，可以在一台物理机上运行多个虚拟机，在充分利用硬件环境的前提下， 构建一个多系统资源共享并有效隔离的计算环境。虚拟化技术的优势在于复用硬件平台、 拓展硬件平台并且可以使硬件平台透明化，除此之外虚拟化技术可以提供高安全级的系统 隔离，拥有先天的安全性能。</p>
    <p>[0004]	基于以上的时代和技术背景促使了安全计算机与虚拟化技术的联姻，通过硬件技 术的支持结合虚拟化技术实现多个虚拟操作系统间有效隔离和资源共享。</p>
    <p>[0005]	虽然安全计算机提供了有效隔离和安全可控的操作环境，但是基于虚拟化的安全 计算机通常面临硬件共享下的运行效能问题。提高虚拟操作系统的用户体验和操作性能是 安全计算机要解决的主要问题，也是其在桌面应用面临的最大障碍。</p>
    <p>[0006]	虚拟显示环境效果不理想主要存在以下三个原因：设备实现复杂、通信机制开销 大、外部图形库的性能瓶颈。</p>
    <p>[0007]	虚拟显示设备的实现考虑到接口的完整物理特性及虚拟显卡的设备规范，这样的 好处可以保证显示设备的通用性及无须改动的显示设备驱动程序；但是因此而产生的负面 效果却是设备实现机制的复杂和执行效率的低下。</p>
    <p>[0008]	基于设备接口完全模拟的显示设备的驱动不需要任何改动，而显示驱动与虚拟显 示设备之间的通信开销却因为这样的实现方式而变得难于控制。在客户系统中驱动程序试 图访问硬件设备完成显示工作的过程，CPU环境在VMX root和VMX non-root模式间频繁 切换，这样则会导致CPU时间的浪费。</p>
    <p>[0009]	X-window在提供Linux友好而便捷的操作环境的同时也直接影响操作系统性能 和运行效能。在系统空闲时，X-window的守护进程依然占用较多的系统资源。而虚拟客户 系统的全部显示都是基于X-window桌面操作环境，这样的实现方式将所有的显示性能都 转嫁到X-window图形绘制的效率，而这也是直接导致客户系统显示效果不佳的性能瓶颈。</p>
    <p>发明内容</p>
    <p>[0010]	本发明的目的在于克服现有技术的不足，提供一种基于Xen安全计算机显示优化 的方法。[0011]	为实现上述发明目的，采用的技术方案如下：</p>
    <p>[0012]	一种基于Xen安全计算机显示优化的方法，包括宿主系统的简化后端、客户系统 的定制前端驱动、以及前后端之间的通信优化；所述宿主系统的简化后端，包括实现PCI设 备接口，以及引入Frame Buffer的支持，通过对Frame Buffer的读写直接将帧缓存图像绘 制于屏幕上；所述客户系统的定制前端驱动，包括直接获取后端设备提供的内存I/O及端 口 I/O资源，并通过系统⑶I显示接口实现基于Frame Buffer的显示环境；所述前后端之 间的通信优化，首先后端设备在宿主系统中注册指定I/O端口，前端驱动访问这些I/O将直 接引发后端实现的回调函数而完成前后端同步的交互；其次后端还提供一块与前端驱动交 互的内存空间，并将此内存空间映射至客户系统的内存空间，通过共享内存的方式实现交 互。</p>
    <p>[0013]	本发明针对现有Xen安全计算机显示模块的不足。提出了在不增加额外硬件开销 的前提下，采用前后端分离的方式，取代设备接口完全模拟的方式来实现Xen虚拟显示设 备，以提高显示环境效果的优化方案。</p>
    <p>[0014]	本发明的技术方案具体可归纳为：简化后端实现机制、定制前端驱动、改善通信方 式。</p>
    <p>[0015]	所述简化后端实现机制，即在虚拟显示设备的设计上，对虚拟显示设备的后端采 用尽可能简单和直接的实现方法。后端显示设备的实现主要集中以下两方面内容：仅实现 必要的PCI设备接口、引入Frame Buffer的支持。</p>
    <p>[0016]	所述定制前端驱动，即改进方案通过前后端分离设备模拟方式来替代完全的设备 接口模拟。因此在客户系统中需要定制虚拟显示设备的前端驱动，该定制的前端驱动将替 代原生的设备驱动。定制的前端驱动，直接获取后端设备提供的内存Ι/0(ΜΜΙ0)及端口 I/ 0资源，并通过系统⑶I显示接口同样实现基于Frame Buffer的显示环境。</p>
    <p>[0017]	所述改善通信方式，即通过前后端分离的机制实现的显示设备的通信过程不同于 完全设备接口模拟，后端设备在虚拟机中注册指定I/O端口，前端驱动访问这些I/O将直接 引发后端实现的回调函数而完成前后端同步的交互；其次后端还提供一块与前端驱动交互 的内存空间，并将此内存空间映射至客户系统的内存空间，通过共享内存的方式实现交互。 通过以上两种前后端通信机制将有效减少CPU模拟的切换，从而提高客户系统显示及工作 效率。</p>
    <p>[0018]	本发明通过定制硬件平台并结合Xen虚拟机技术为用户提供多个虚拟透明的操 作系统，并对虚拟操作系统从数据、网络、操作域等多方面进行安全隔离。为实现良好的用 户体验，并节约硬件成本，本发明着重关注基于Xen安全计算机中虚拟设备模型的研究并 通过对Xen设备虚拟化的分析，构建自主定制的虚拟设备并应用于显示环境中，从而提高 基于Xen安全计算机虚拟系统的显示效果，满足用户对虚拟客户系统的良好体验，可以解 决目前Xen安全计算机显示模块性能方面的问题，对安全计算机在桌面环境上的应用具有 重要意义。</p>
    <p>附图说明</p>
    <p>[0019]	图1为本发明的总体架构示意图；</p>
    <p>[0020]	图2为前端显示驱动与⑶I接口交互示意图；[0021]	图3为前端显示驱动架构示意图；</p>
    <p>[0022]	图4为前后端基于I/O端口通信流程图；</p>
    <p>[0023]	图5为前后端基于内存通信流程图。</p>
    <p>具体实施方式</p>
    <p>[0024]	本发明的总体设计思路，是通过前后端分离机制的虚拟设备替代原有的完全设备 接口模拟，实现一张虚拟显卡，本发明将这张虚拟显卡命名为EMOS VGA。虚拟显示设备EMOS VGA的后端设计引入Frame Buffer的支持；前端定制基于Windows客户系统的显示驱动； 而前后端的通信基于共享内存及I/O端口截获的方式。</p>
    <p>[0025]	本发明的总体架构如图1所示，总体设计中包含三个重要组成部分：后端设备、前 端驱动及前后端通信。</p>
    <p>[0026]	EMOS VGA后端显示设备是显示优化方案中的重点部分，它是一张定制的、简单的 PCI接口显示设备，后端设备的构成主要包括：Std VGA接口的实现、FrameBuffer的支持及 PCI设备仿真的实现。通过EMOS VGA设备可以直接访问FrameBuffer JfFrame Buffer中 保存的位图直接绘制于显示器之上，完成显示工作。</p>
    <p>[0027]	EMOS VGA后端的设计具有简单、灵活和实用的特点，后端不需要设计额外的VGA 设备资源如：VGA BIOS、VGA Register等，相反后端EMOS VGA设备在实现Md VGA的支持 外，仅需实现PCI设备接口提供的PCI设备创建及相应的PCI配置空间的填充。在EMOS VGA 的后端设备中引入Frame Buffer的支持，后端设备的显示原理将放弃SDL图形接口的实现 方式，通过读Frame Buffer的读写方式直接将帧缓存图像绘制于屏幕之上。</p>
    <p>[0028]	后端显示设备工作流程如下：</p>
    <p>[0029]	1、后端设备初始，通过PCI设备接口注册PCI总线设备；</p>
    <p>[0030]	2、填充PCI配置空间，设置类型为VGA设备；</p>
    <p>[0031]	3、获取Frame Buffer帧缓冲设备和指定显示模式并保存于后端设备属性中；</p>
    <p>[0032]	4、设置Frame Buffer地址为共享空间并映射给前端；</p>
    <p>[0033]	5、在虚拟机中注册后端显示设备指定I/O端口 ；</p>
    <p>[0034]	6、实现与Md VGA接口的连接并初始化Md VGA ；</p>
    <p>[0035]	7、客户系统加载前端驱动，触发显示操作；</p>
    <p>[0036]	8、后端设备调用回调函数操作Frame Buffer完成显示工作。</p>
    <p>[0037]	从后端显示设备的工作流程来看，后端设备的主要内容集中于PCI设备的实现及 Frame Buffer机制的引进，一旦完成初始化的工作后，Frame Buffer的显示操作中的关键 数据结构DisplayState中的回调函数既被绑定，后续的工作将由前端驱动引发显示更新 的事件来触发后端的显示实现。</p>
    <p>[0038]	EMOS VGA前端驱动是存在于虚拟Windows客户系统中的，负责EMOS VGA显示工作 的驱动程序，前端驱动程序使用Windows⑶I接口基于Frame Buffer完成显示工作，其操 作的EMOS VGA设备资源是由后端直接映射的共享内存空间。</p>
    <p>[0039]	EMOS VGA设备的前端驱动是基于Windows环境下的显示设备驱动程序，由于处于 虚拟环境下，EMOS VGA前端的驱动程序无法直接访问物理显示设备。通过上一节后端设备 的设计方案，后端已经将Frame Buffer的地址直接映射给客户系统，因此客户系统中的前端驱动的工作将 直接对帧缓存进行操作。Windows环境下显示驱动的实现方式有多种，在本 文中采用较简单的Windows提供⑶I接口实现显示驱动。</p>
    <p>[0040]	GDI (Graphics Display Interface)是Windows系统中应用程序与图像引擎之间 的接口，通过调用⑶I接口可以实现图像显示输出的功能。如图2所示显示驱动与⑶I之 间的交互图，用户态程序通过对⑶I接口的访问，⑶I接口将陷入到内核态并通过DDI接口 (设备驱动接口）访问驱动程序，最后调用GDI完成显示。</p>
    <p>[0041]	EMOS VGA的前端驱动主要包括两部分：display driver和video miniportdriver。</p>
    <p>[0042]	video miniport driver处理一些需要和内核其他部分交互的操作，例如：硬件初 始化、内存映射，这些操作是需要和内核1/0部分交互的操作。videominiport driver的 任务包括资源管理，比如硬件配置、物理内存映射，不同的硬件需要不同的video miniport driver。Display Driver通过调用videominiport driver来完成一些不常用的操作，例 如资源管理、物理设备映射、响应中断等。作为EMOS VGA前端驱动中的video miniport driver负责完成的功能包括：</p>
    <p>[0043]	1)初始化EMOS VGA的PCI显示设备；</p>
    <p>[0044]	2)读取PCI配置空间并获取PCI资源；</p>
    <p>[0045]	3)对获取到的1/0端口及匪10资源进行转存；</p>
    <p>[0046]	4)将EMOS VGA硬件设备资源映射到Display Driver所在的地址空间。</p>
    <p>[0047]	Display Driver是一个内核模式的DLL，它的首要责任是渲染。当应用程序调用一 个设备无关图形的Win32函数，图形设备接口（⑶I)解释这些指令，并调用Display Driver 中的相关接口。Display Driver将这些请求转化为发送给视频硬件的命令，从而在屏幕上 绘制图形。</p>
    <p>[0048]	在EMOS VGA显示驱动中采用了 Frame Buffer的显示环境，而Display Driver的 实现在默认情况下，采用GDI处理标准格式的位图，这跟硬件包含帧缓冲格式一样。原本 Display Driver将实现一些硬件提供了特殊支持的绘图函数，由于此时的显示设备是虚拟 的，无法提供任何硬件功能，Display Driver则将显示工作交给⑶I接口处理。</p>
    <p>[0049]	具体video miniport driver与Display Driver组成的前端驱动架构图3所示。</p>
    <p>[0050]	前后端之间的通信采用共享内存的方式，后端将可访问的Frame Buffer地址空间 直接映射给前端驱动程序，通过Xen提供的API可以实现Windows客户系统直接读写Frame Buffer的效果；同时后端在Xen虚拟机中注册指定1/0端口，用于与前端驱动同步的通信， 前端驱动访问指定1/0端口将导致该指令被虚拟机截获。优化后的通信方式预期可以大大 减少CPU特权模式的频繁切换。</p>
    <p>[0051]	前后端通信通过两种方式来实现：1/0端口实现、共享内存实现。</p>
    <p>[0052]	在EMOS VGA后端的1/0端口注册设计中已经涉及到使用1/0端口来实现前后端 的通信，这样的通信方式主要是实现前后端之间的快速的同步通信。前后端基于1/0端口 的通信过程图4所示。</p>
    <p>[0053]	同样在EMOS VGA后端的共享内存设计中提及了共享内存的通信方式，与1/0端口 截获的通信方式不同，基于共享内存通信方式可以交互相对较多的信息量。前后端基于内 存的通信过程图5所示：[0054] 后端开辟共享内存空间并把空间地址映射给前端的客户系统驱动后，之后前后的 通信将直接在这块共享内存区域进行，通信过程将绕过Xen虚拟机，这样的通过方式无疑 提高前端显示 驱动的工作效率。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101667144A?cl=zh">CN101667144A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2009年9月29日</td><td class="patent-data-table-td patent-date-value">2010年3月10日</td><td class="patent-data-table-td ">北京航空航天大学</td><td class="patent-data-table-td ">一种基于共享内存的虚拟机通信方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2008008675A2?cl=zh">WO2008008675A2</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年7月3日</td><td class="patent-data-table-td patent-date-value">2008年1月17日</td><td class="patent-data-table-td ">Device Vm, Inc.</td><td class="patent-data-table-td ">Method and apparatus for virtualization of appliances</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102523204A?cl=zh">CN102523204A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年12月2日</td><td class="patent-data-table-td patent-date-value">2012年6月27日</td><td class="patent-data-table-td ">华中科技大学</td><td class="patent-data-table-td ">面向QoS的虚拟机网络带宽分配系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102523204B?cl=zh">CN102523204B</a></td><td class="patent-data-table-td patent-date-value">2011年12月2日</td><td class="patent-data-table-td patent-date-value">2014年8月27日</td><td class="patent-data-table-td ">华中科技大学</td><td class="patent-data-table-td ">面向QoS的虚拟机网络带宽分配系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102609231A?cl=zh">CN102609231A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年2月22日</td><td class="patent-data-table-td patent-date-value">2012年7月25日</td><td class="patent-data-table-td ">中国人民解放军国防科学技术大学</td><td class="patent-data-table-td ">基于飞腾处理器平台的多显示屏输出方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102609231B?cl=zh">CN102609231B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年2月22日</td><td class="patent-data-table-td patent-date-value">2014年12月31日</td><td class="patent-data-table-td ">中国人民解放军国防科学技术大学</td><td class="patent-data-table-td ">基于飞腾处理器平台的多显示屏输出方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102609638A?cl=zh">CN102609638A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年12月22日</td><td class="patent-data-table-td patent-date-value">2012年7月25日</td><td class="patent-data-table-td ">中国航天科工集团第二研究院七�六所</td><td class="patent-data-table-td ">基于UEFI运行时服务的Xen虚拟机架构及其实现方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103197915B?cl=zh">CN103197915B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年3月1日</td><td class="patent-data-table-td patent-date-value">2015年8月19日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">一种处理敏感指令的方法、装置以及物理机</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2014139367A1?cl=zh">WO2014139367A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2014年3月5日</td><td class="patent-data-table-td patent-date-value">2014年9月18日</td><td class="patent-data-table-td ">Zte Corporation</td><td class="patent-data-table-td ">消息交互处理方法及装置</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=8LyXBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=G06F0003140000">G06F3/14</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=8LyXBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=G06F0009455000">G06F9/455</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2011年7月27日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2011年9月7日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年7月17日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Granted</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/68bb6518fe246a771193/CN102135866A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_50a6672b5f82ffbd39b7a9e87fd4594c.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8EXen%E5%AE%89%E5%85%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%98%BE%E7%A4%BA%E4%BC%98.pdf?id=8LyXBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U0yAOG_Eec8nsAvu3b-6ZTQq4BIqQ"},"sample_url":"https://www.google.com/patents/reader?id=8LyXBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>