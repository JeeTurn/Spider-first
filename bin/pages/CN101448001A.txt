<!DOCTYPE html><html><head><title>专利 CN101448001A - 一种实现wap手机银行交易安全控制的系统及方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种实现wap手机银行交易安全控制的系统及方法"><meta name="DC.contributor" content="军 张" scheme="inventor"><meta name="DC.contributor" content="凯 曾" scheme="inventor"><meta name="DC.contributor" content="实 曾" scheme="inventor"><meta name="DC.contributor" content="王万芬" scheme="inventor"><meta name="DC.contributor" content="中国工商银行股份有限公司" scheme="assignee"><meta name="DC.date" content="2008-11-19" scheme="dateSubmitted"><meta name="DC.description" content="本发明公开了一种实现WAP手机银行交易安全控制的系统及方法。系统包括：客户终端；WEB服务器，用于提供域名地址服务，将接收自客户终端的交易请求转发至WAP门户服务器；WAP门户服务器，用于获取客户终端的手机号码，根据运营商手机号绑定关系生成手机令牌，将该手机令牌与交易请求发送给WAP交易服务器；WAP交易服务器，用于验证手机令牌的合法性，检查客户运营商的绑定信息与令牌信息是否一致；移动通讯运营商系统设备，用于提供接口给WAP门户服务器，WAP门户服务器通过与移动通讯运营商系统设备通讯，获取手机号码。利用本发明，能够防止客户通过互联网访问WAP手机银行，有效地提高访问手机银行的安全性。"><meta name="DC.date" content="2009-6-3"><meta name="citation_patent_publication_number" content="CN:101448001:A"><meta name="citation_patent_application_number" content="CN:200810226682"><link rel="canonical" href="https://www.google.com/patents/CN101448001A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101448001A?cl=zh"/><meta name="title" content="专利 CN101448001A - 一种实现wap手机银行交易安全控制的系统及方法"/><meta name="description" content="本发明公开了一种实现WAP手机银行交易安全控制的系统及方法。系统包括：客户终端；WEB服务器，用于提供域名地址服务，将接收自客户终端的交易请求转发至WAP门户服务器；WAP门户服务器，用于获取客户终端的手机号码，根据运营商手机号绑定关系生成手机令牌，将该手机令牌与交易请求发送给WAP交易服务器；WAP交易服务器，用于验证手机令牌的合法性，检查客户运营商的绑定信息与令牌信息是否一致；移动通讯运营商系统设备，用于提供接口给WAP门户服务器，WAP门户服务器通过与移动通讯运营商系统设备通讯，获取手机号码。利用本发明，能够防止客户通过互联网访问WAP手机银行，有效地提高访问手机银行的安全性。"/><meta property="og:title" content="专利 CN101448001A - 一种实现wap手机银行交易安全控制的系统及方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101448001A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101448001A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=vWJqBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101448001A&amp;usg=AFQjCNHhf2IWQe7o3P0ODx26c-XZIGnOZg" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/2bb23ba8b372aa35d468/CN101448001A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/2bb23ba8b372aa35d468/CN101448001A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101448001A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101448001A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN101448001A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN101448001B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101448001A?cl=zh" style="display:none"><span itemprop="description">本发明公开了一种实现WAP手机银行交易安全控制的系统及方法。系统包括：客户终端；WEB服务器，用于提供域名地址服务，将接收自客户终端的交易请求转发至WAP门户服务器；WAP门户服务器，用于获取客户终端的手机号码，根据...</span><span itemprop="url">https://www.google.com/patents/CN101448001A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101448001A - 一种实现wap手机银行交易安全控制的系统及方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101448001A - 一种实现wap手机银行交易安全控制的系统及方法" title="专利 CN101448001A - 一种实现wap手机银行交易安全控制的系统及方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101448001 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200810226682</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2009年6月3日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2008年11月19日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2008年11月19日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101448001B?hl=zh-CN&amp;cl=zh">CN101448001B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200810226682.2, </span><span class="patent-bibdata-value">CN 101448001 A, </span><span class="patent-bibdata-value">CN 101448001A, </span><span class="patent-bibdata-value">CN 200810226682, </span><span class="patent-bibdata-value">CN-A-101448001, </span><span class="patent-bibdata-value">CN101448001 A, </span><span class="patent-bibdata-value">CN101448001A, </span><span class="patent-bibdata-value">CN200810226682, </span><span class="patent-bibdata-value">CN200810226682.2</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%86%9B+%E5%BC%A0%22">军 张</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%87%AF+%E6%9B%BE%22">凯 曾</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%AE%9E+%E6%9B%BE%22">实 曾</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%8E%8B%E4%B8%87%E8%8A%AC%22">王万芬</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E4%B8%AD%E5%9B%BD%E5%B7%A5%E5%95%86%E9%93%B6%E8%A1%8C%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">中国工商银行股份有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101448001A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101448001A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101448001A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (11),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (1),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=vWJqBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200810226682&amp;usg=AFQjCNGAm9XrIRzNCEQUyP5HzqJMeaOaWg"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=vWJqBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101448001A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNHgWJI-OYWhu-xmasW4yZGiQ5A89w"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT75737975" lang="ZH" load-source="patent-office">一种实现wap手机银行交易安全控制的系统及方法</invention-title>
      </span><br><span class="patent-number">CN 101448001 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA53492976" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明公开了一种实现WAP手机银行交易安全控制的系统及方法。系统包括：客户终端；WEB服务器，用于提供域名地址服务，将接收自客户终端的交易请求转发至WAP门户服务器；WAP门户服务器，用于获取客户终端的手机号码，根据运营商手机号绑定关系生成手机令牌，将该手机令牌与交易请求发送给WAP交易服务器；WAP交易服务器，用于验证手机令牌的合法性，检查客户运营商的绑定信息与令牌信息是否一致；移动通讯运营商系统设备，用于提供接口给WAP门户服务器，WAP门户服务器通过与移动通讯运营商系统设备通讯，获取手机号码。利用本发明，能够防止客户通过互联网访问WAP手机银行，有效地提高访问手机银行的安全性。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(14)</span></span></div><div class="patent-text"><div mxw-id="PCLM13485648" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1、一种实现WAP手机银行交易安全控制的系统，其特征在于，该系统包括：客户终端；WEB服务器，用于提供域名地址服务，将接收自客户终端的交易请求转发至WAP门户服务器；WAP门户服务器，用于在接收到WEB服务器转发的交易请求后获取客户终端的手机号码，并根据运营商手机号绑定关系生成手机令牌，然后将该手机令牌与交易请求发送给WAP交易服务器；WAP交易服务器，用于在接收到手机令牌与交易请求后，验证手机令牌的合法性，并检查客户运营商的绑定信息与令牌信息是否一致，一致则继续交易；不一致拒绝交易；移动通讯运营商系统设备，用于提供接口给WAP门户服务器，WAP门户服务器通过与移动通讯运营商系统设备通讯，获取客户终端的的手机号码。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2、 根据权利要求1所述的实现WAP手机银行交易安全控制的系统， 其特征在于，所述客户终端是客户访问WAP手机银行的载体。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3、 根据权利要求2所述的实现WAP手机银行交易安全控制的系统， 其特征在于，所述客户访问WAP手机银行的载体是手机。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4、 根据权利要求1所述的实现WAP手机银行交易安全控制的系统， 其特征在于，对于直接输入域名访问WAP手机银行的客户终端，所述WAP 门户服务器提供给客户终端选择运营商页面，根据运营商手机号绑定关系 参数，通过与运营商协定的通讯接口，从移动通讯运营商系统设备获取客 户终端的手机号码，根据绑定关系和是否获得手机号信息，根据相应的算 法，生成手机令牌。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5、 根据权利要求1所述的实现WAP手机银行交易安全控制的系统， 其特征在于，对于通过运营商页面链接访问WAP手机银行的客户终端， 所述WAP门户服务器从交易请求中获取手机号码和运营商信息，并根据 运营商手机号绑定关系参数生成手机令牌。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6、 根据权利要求1所述的实现WAP手机银行交易安全控制的系统，其特征在于，所述WAP交易服务器在验证手机令牌的合法性后，如果合法，则根据是否绑定手机号码向客户终端提供不同的登录页面，客户终端 登录后，根据客户终端注册时预留的手机号码信息，检查客户运营商的绑定信息与令牌信息是否一致；如果WAP交易服务器验证手机令牌的不合 法，则拒绝交易。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7、 根据权利要求6所述的实现WAP手机银行交易安全控制的系统， 其特征在于，在WAP交易服务器检查客户运营商的绑定信息与令牌信息 不一致或者验证手机令牌的不合法而拒绝交易时，客户终端能够浏览简单 的信息页面，无法进行交易。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8、 一种实现WAP手机银行交易安全控制的方法，应用于权利要求l 所述的系统，其特征在于，该方法包括：客户终端向WEB服务器提出交易请求，WEB服务器将该交易请求转 发至WAP门户服务器；WAP门户服务器在接收到WEB服务器转发的交易请求后，获取客户 终端的手机号码，并根据运营商手机号绑定关系生成手机令牌，然后将该 手机令牌与交易请求发送给WAP交易服务器；WAP交易服务器在接收到手机令牌与交易请求后，验证手机令牌的 合法性，并检查客户运营商的绑定信息与令牌信息是否一致，如果一致， 则继续交易；如果不一致，则拒绝交易。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9、 根据权利要求8所述的实现WAP手机银行交易安全控制的方法， 其特征在于，所述客户终端向WEB服务器提出交易请求，通过以下两种 方式实现：方式一、客户终端通过移动通讯运营商的服务页面，链接到WAP手 机银行服务界面，向WEB服务器提出交易请求；方式二、客户终端直接输入域名访问WAP手机银行，向WEB服务器 提出交易请求。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10、 根据权利要求9所述的实现WAP手机银行交易安全控制的方法， 其特征在于，对于客户终端通过第一种方式访问WAP手机银行的情况， 如果运营商要求绑定手机号码，则运营商在链接到WAP手机银行时，将手机号码以参数的形式一并传递给WAP手机银行门户服务器；如果对于 手机号绑定无要求或者要求不绑定，则不要求运营商在链接过来时提供手 机号码；其中，所述绑定是指一个手机号码只能访问一个客户终端的WAP手机银行；对于客户终端通过第二种方式访问WAP手机银行的情况，如果运营 商要求绑定，则在客户终端访问WAP手机银行时，提供给客户终端移动 通讯运营商选择页面，客户终端选择后，需要银行和移动通讯运营商按照 约定的接口进行后台通讯，以获取客户终端的手机号码信息，如不能获得 手机号码，则限制客户终端的访问权限，只能浏览网页，不能登录WAP 手机银行；如果不要求绑定，则不需获取客户的手机号码，客户终端的访 问权限也不做控制；如果对于是否绑定不做要求，则尝试去获取客户终端 的手机号码，能获得则按照正常获取手机号码的流程去处理，不能获取则 按照不绑定的要求去处理。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="11" class="claim">
      <div class="claim-text">11、根据权利要求8所述的实现WAP手机银行交易安全控制的方法， 其特征在于，所述WAP门户服务器在接收到WEB服务器转发的交易请求 后，获取客户终端的手机号码，并根据运营商手机号绑定关系生成手机令 牌，然后将该手机令牌与交易请求发送给WAP交易服务器，具体包括：步骤l: WAP门户服务器在接收到WEB服务器转发的交易请求，提 供给客户终端运营商选择页面；步骤2:客户终端选择运营商；步骤3: WAP门户服务器检&#26619;运营商手机号绑定信息，如果绑定或无 要求继续执行步骤4，如果不绑定，跳转至步骤6;步骤4: WAP门户服务器取得移动通讯运营商系统设备地址，发送请 求获取客户终端的手机号码，如果正常获取客户终端的手机号码，则继续 步骤5，否则，如果运营商对手机号码绑定无要求跳转至步骤6，要求绑 定而不能获取手机号码，生成获取手机号码异常令牌，跳转至步骤7;步骤5: WAP门户服务器检查手机号码与运营商信息的一致性， 一致生成正常获取手机号码令牌，不一致生成获取手机号码异常令牌，跳转至步骤7;步骤6:对于运营商不绑定手机号，及不要求绑定手机号而且无法获得手机号的情况，WAP门户服务器生成无手机号令牌；步骤7: WAP门户服务器将交易请求和手机令牌信息转发至WAP交 易服务器。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12、 根据权利要求8所述的实现WAP手机银行交易安全控制的方法， 其特征在于，所述WAP交易服务器在接收到手机令牌与交易请求后，进 一步包括：WAP交易服务器获取客户信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13、 根据权利要求12所述的实现WAP手机银行交易安全控制的方法， 其特征在于，所述WAP交易服务器获取客户信息，具体包括：WAP交易服务器在接收到手机令牌与交易请求后，如果是正常获取 手机令牌，提供给客户终端输入登录密码页面，以手机号码和登录密码为 条件登录，获取客户信息；如果是获取手机号码异常令牌，显示给客户终 端WAP银行信息浏览页面，限制客户终端不能登录WAP手机银行，结束； 如果是无手机号令牌，提供给客户终端输入卡号、登录密码的登录页面， 以卡号和登录密码作为条件登录获取客户信息。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="14" class="claim">
      <div class="claim-text">14、 根据权利要求8所述的实现WAP手机银行交易安全控制的方法， 其特征在于，所述验证手机令牌的合法性，并检查客户运营商的绑定信息 与令牌信息是否一致，具体包括：WAP交易服务器在获取客户信息后，检查客户注册手机银行时预留 的手机号码信息，检&#26619;此手机号码对应的运营商信息以及绑定信息，与令 牌中信息是否一致，如果一致，则客户终端登录成功，继续交易；如果不 一致，提示客户登录失败，拒绝交易，限制客户只能访问WAP手机银行 信息浏览页面。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES18872661" lang="ZH" load-source="patent-office" class="description">
    <p>一种实现WAP手机银行交易安全控制的系统及方法</p>
    <p>技术领域</p>
    <p>本发明涉及手机银行技术领域，尤其涉及一种实现WAP手机银行交 易安全控制的系统及方法。</p>
    <p>背景技术</p>
    <p>目前的WAP手机银行，其实现过程一般如下：银行提供WAP站点接 入地址，客户根据该接入地址利用手机通过GPRS或者WAP接入WAP手 机银行网站，浏览网站信息或进行相关交易。</p>
    <p>一般的WAP手机银行网站，对于接入方是否是真正的手机，并没有 严格的控制，而且目前有很多浏览器，支持用户通过互联网访问WAP手 机银行网站，例如：Opera。</p>
    <p>WAP手机银行的目标客户是手机用户，限于手机厂商、型号的多样 性，手机操作的复杂性和现有手机网络的局限性，现有WAP手机银行网 站的安全措施要求比较低。比如：页面上的密码输入框是没有控件加密的， 页面提交上来的数据包中，密码是以明文的方式存在的。</p>
    <p>如果对于通过互联网的访问不作限制，电脑操作的方便性和互联网的 普及性，势必造成WAP手机银行网站的重要安全信息存在很大的被非法 盗取（截取页面上送包信息等手段）的可能性。</p>
    <p>所以，迫切需要提供一种安全控制方法，屏蔽通过互联网的访问WAP 手机银行网站，限制客户只能通过手机访问WAP手机银行，从而保证客 户个人资产信息的安全。</p>
    <p>发明内容</p>
    <p>(一）要解决的技术问题 有鉴于此，本发明的主要目的在于提供一种实现WAP手机银行交易 安全控制的系统及方法，以防止客户通过互联网访问WAP手机银行，有效提高访问手机银行的安全性。</p>
    <p>(二）技术方案 为达到上述目的，本发明采用的技术方案如下： 一种实现WAP手机银行交易安全控制的系统，该系统包括： 客户终端；</p>
    <p>WEB服务器，用于提供域名地址服务，将接收自客户终端的交易请 求转发至WAP门户服务器；</p>
    <p>WAP门户服务器，用于在接收到WEB服务器转发的交易请求后获取 客户终端的手机号码，并根据运营商手机号绑定关系生成手机令牌，然后 将该手机令牌与交易请求发送给WAP交易服务器;</p>
    <p>WAP交易服务器，用于在接收到手机令牌与交易请求后，验证手机 令牌的合法性，并检查客户运营商的绑定信息与令牌信息是否一致， 一致 则继续交易；不一致拒绝交易；</p>
    <p>移动通讯运营商系统设备，用于提供接口给WAP门户服务器，WAP 门户服务器通过与移动通讯运营商系统设备通讯，获取客户终端的的手机 号码。</p>
    <p>上述方案中，所述客户终端是客户访问WAP手机银行的载体。所述 客户访问WAP手机银行的载体是手机。</p>
    <p>上述方案中，对于直接输入域名访问WAP手机银行的客户终端，所 述WAP门户服务器提供给客户终端选择运营商页面，根据运营商手机号 绑定关系参数，通过与运营商协定的通讯接口，从移动通讯运营商系统设 备获取客户终端的手机号码，根据绑定关系和是否获得手机号信息，根据 相应的算法，生成手机令牌。对于通过运营商页面链接访问WAP手机银 行的客户终端，所述WAP门户服务器从交易请求中获取手机号码和运营 商信息，并根据运营商手机号绑定关系参数生成手机令牌。</p>
    <p>上述方案中，所述WAP交易服务器在验证手机令牌的合法性后，如 果合法，则根据是否绑定手机号码向客户终端提供不同的登录页面，客户 终端登录后，根据客户终端注册时预留的手机号码信息，检查客户运营商 的绑定信息与令牌信息是否一致；如果WAP交易服务器验证手机令牌的不合法，则拒绝交易。</p>
    <p>上述方案中，在WAP交易服务器检&#26619;客户运营商的绑定信息与令牌 信息不一致或者验证手机令牌的不合法而拒绝交易时，客户终端能够浏览 简单的信息页面，无法进行交易。</p>
    <p>一种实现WAP手机银行交易安全控制的方法，该方法包括：</p>
    <p>客户终端向WEB服务器提出交易请求，WEB服务器将该交易请求转 发至WAP门户服务器；</p>
    <p>WAP门户服务器在接收到WEB服务器转发的交易请求后，获取客户 终端的手机号码，并根据运营商手机号绑定关系生成手机令牌，然后将该 手机令牌与交易请求发送给WAP交易服务器；</p>
    <p>WAP交易服务器在接收到手机令牌与交易请求后，验证手机令牌的 合法性，并检查客户运营商的绑定信息与令牌信息是否一致，如果一致， 则继续交易；如果不一致，则拒绝交易。</p>
    <p>上述方案中，所述客户终端向WEB服务器提出交易请求，通过以下</p>
    <p>两种方式实现：</p>
    <p>方式一、客户终端通过移动通讯运营商的服务页面，链接到WAP手 机银行服务界面，向WEB服务器提出交易请求；</p>
    <p>方式二、客户终端直接输入域名访问WAP手机银行，向WEB服务器 提出交易请求。</p>
    <p>上述方案中，对于客户终端通过第一种方式访问WAP手机银行的情 况，如果运营商要求绑定手机号码，则运营商在链接到WAP手机银行时， 将手机号码以参数的形式一并传递给WAP手机银行门户服务器；如果对 于手机号绑定无要求或者要求不绑定，则不要求运营商在链接过来时提供 手机号码；其中，所述绑定是指一个手机号码只能访问一个客户终端的 WAP手机银行；</p>
    <p>对于客户终端通过第二种方式访问WAP手机银行的情况，如果运营 商要求绑定，则在客户终端访问WAP手机银行时，提供给客户终端移动 通讯运营商选择页面，客户终端选择后，需要银行和移动通讯运营商按照 约定的接口进行后台通讯，以获取客户终端的手机号码信息，如不能获得 手机号码，则限制客户终端的访问权限，只能浏览网页，不能登录WAP手机银行；如果不要求绑定，则不需获取客户的手机号码，客户终端的访 问权限也不做控制；如果对于是否绑定不做要求，则尝试去获取客户终端 的手机号码，能获得则按照正常获取手机号码的流程去处理，不能获取则 按照不绑定的要求去处理。</p>
    <p>上述方案中，所述WAP门户服务器在接收到WEB服务器转发的交易 请求后，获取客户终端的手机号码，并根据运营商手机号绑定关系生成手 机令牌，然后将该手机令牌与交易请求发送给WAP交易服务器，具体包 括：</p>
    <p>步骤l: WAP门户服务器在接收到WEB服务器转发的交易请求，提 供给客户终端运营商选择页面；</p>
    <p>步骤2:客户终端选择运营商；</p>
    <p>步骤3: WAP门户服务器检&#26619;运营商手机号绑定信息，如果绑定或无 要求继续执行步骤4，如果不绑定，跳转至步骤6;</p>
    <p>步骤4: WAP门户服务器取得移动通讯运营商系统设备地址，发送请</p>
    <p>求获取客户终端的手机号码，如果正常获取客户终端的手机号码，则继续</p>
    <p>步骤5，否则，如果运营商对手机号码绑定无要求跳转至步骤6，要求绑</p>
    <p>定而不能获取手机号码，生成获取手机号码异常令牌，跳转至步骤7;</p>
    <p>步骤5: WAP门户服务器检&#26619;手机号码与运营商信息的一致性， 一致</p>
    <p>生成正常获取手机号码令牌，不一致生成获取手机号码异常令牌，跳转至</p>
    <p>步骤7;</p>
    <p>步骤6:对于运营商不绑定手机号，及不要求绑定手机号而且无法获 得手机号的情况，WAP门户服务器生成无手机号令牌；</p>
    <p>步骤7: WAP门户服务器将交易请求和手机令牌信息转发至WAP交</p>
    <p>易服务器。</p>
    <p>上述方案中，所述WAP交易服务器在接收到手机令牌与交易请求后， 进一步包括：WAP交易服务器获取客户信息。所述WAP交易服务器获取</p>
    <p>客户信息，具体包括：WAP交易服务器在接收到手机令牌与交易请求后，</p>
    <p>如果是正常获取手机令牌，提供给客户终端输入登录密码页面，以手机号</p>
    <p>码和登录密码为条件登录，获取客户信息；如果是获取手机号码异常令牌， 显示给客户终端WAP银行信息浏览页面，限制客户终端不能登录WAP手机银行，结束；如果是无手机号令牌，提供给客户终端输入卡号、登录密 码的登录页面，以卡号和登录密码作为条件登录获取客户信息。</p>
    <p>上述方案中，所述验证手机令牌的合法性，并检查客户运营商的绑定 信息与令牌信息是否一致，具体包括：WAP交易服务器在获取客户信息 后，检&#26619;客户注册手机银行时预留的手机号码信息，检查此手机号码对应 的运营商信息以及绑定信息，与令牌中信息是否一致，如果一致，则客户</p>
    <p>终端登录成功，继续交易；如果不一致，提示客户登录失败，拒绝交易， 限制客户只能访问WAP手机银行信息浏览页面。</p>
    <p>(三）有益效果 从上述技术方案可以看出，本发明具有以下有益效果：</p>
    <p>1、 本发明提供的实现WAP手机银行交易安全控制的系统及方法，能 够防止客户通过互联网访问WAP手机银行，有效地提高访问手机银行的 安全性。</p>
    <p>2、 本发明提供的实现WAP手机银行交易安全控制的系统及方法，可 以有效的控制通过互联网访问WAP手机银行的问题，降低了通过更容易 操作的电脑和互联网，暴力破解WAP手机银行，特别是手机银行密码的 可能性。</p>
    <p>3、 本发明提供的实现WAP手机银行交易安全控制的系统及方法，通 过限制WAP手机银行接入的唯一性，和手机号码绑定方案，保证客户只 能通过自己的手机访问WAP手机银行，使WAP手机银行安全性得到很大 的提高。</p>
    <p>4、 本发明提供的实现WAP手机银行交易安全控制的系统及方法，同 样也适用于WAP手机银行B2C购物。</p>
    <p>附图说明</p>
    <p>图1是本发明提供的实现WAP手机银行交易安全控制系统的结构示 意图；</p>
    <p>图2是本发明提供的实现WAP手机银行交易安全控制的方法流程图； 图3是依照本发明实施例提供的实现WAP手机银行交易安全控制的示意图；</p>
    <p>图4是本发明客户终端访问WAP手机银行生成手机令牌的方法流程</p>
    <p>图；</p>
    <p>图5是本发明对手机令牌进行验证处理的方法流程图。 具体实施方式</p>
    <p>为使本发明的目的、技术方案和优点更加清楚明白，以下结合具体实 施例，并参照附图，对本发明进一步详细说明。</p>
    <p>为了控制限制客户通过互联网访问WAP手机银行，首先必须控制 WAP手机银行接入地址的唯一性，对于手机银行来说，通过对WAP手机 银行接入的检&#26619;控制，保证所有的请求必须通过WAP门户服务器提交到 WAP交易服务器，从而拒绝通过互联网访问的客户。</p>
    <p>要控制客户只能通过手机访问WAP手机银行，获取客户的手机号码 是关键，因为通过互联网访问WAP手机银行是无法获得客户的手机号码 的。要获取客户真实的手机号码，只能通过和移动通信运营商的合作，在 客户使用手机访问WAP手机银行的时候，运营商将客户的手机号等信息， 传递给WAP手机银行站点。</p>
    <p>客户访问WAP手机银行主要分为两种方式：</p>
    <p>第一种是通过移动通讯运营商的服务页面，链接到银行的WAP手机 银行服务界面。</p>
    <p>第二种是客户直接输入域名访问WAP手机银行。</p>
    <p>为了获取客户的手机号码，首先，银行方与移动通讯运营商达成协议， 明确WAP手机银行是否需要手机号码绑定的限制（即一个手机号码只能 访问一个客户的WAP手机银行），并预设置运营商是否要求绑定手机号码 的安全参数，参数取值包括：绑定、不绑定、无要求。</p>
    <p>对于客户通过第一种方式访问WAP手机银行的情况，如果运营商要 求绑定手机号码，则要求运营商在链接到WAP银行站点时，将手机号码 以参数的形式一并传递给WAP手机银行门户服务器。如果对于手机号绑 定无要求或者要求不绑定，则不要求运营商在链接过来时提供手机号码。</p>
    <p>对于客户通过第二种方式访问WAP手机银行的情况，如果运营商要求绑定，则在客户访问WAP手机银行的时候，提供给客户移动通讯运营 商选择页面，客户选择后，需要银行和移动通讯运营商按照约定的接口进 行后台通讯，以获取客户的手机号信息，如不能获得手机号，将限制客户 的访问权限（只能浏览网页，不能登录WAP手机银行）；如果不绑定，则 不需获取客户的手机号码，客户的访问权限也不做控制；如果对于是否绑</p>
    <p>定不作要求，则尝试去获取客户的手机号码，能获得则按照正常获取手机 号码的流程去处理，不能获取则按照不绑定的要求去处理。</p>
    <p>同时在银行系统中建立WAP网关IP地址列表、手机号段和运营商的 对应关系列表；</p>
    <p>通过"WAP网关IP地址列表"，可以判断从运营商处获取客户手机号 码的目标地址信息，是否是和运营商约定好的地址信息，限制手机号码的 信息来源地址。</p>
    <p>通过"手机号段和运营商的对应关系列表"，可以通过手机号码知晓客 户的运营商信息。</p>
    <p>在运营商返回了客户的手机号码等信息之后，通过"手机号段和运营 商的对应关系列表"，判断客户的移动通讯运营商与其在页面上选择的运 营商信息是否一致，不一致则报错。根据信息的返回地址，检&#26619;该地址与 "WAP网关IP地址列表"中的地址是否一致，不一致则报错拒绝交易。</p>
    <p>上面本发明提到的交易入口的唯一性控制，获取客户手机号码的控 制，都是在WAP手机银行的门户服务器完成的，WAP门户服务器主要是 提供给客户一些静态页面类的浏览信息，而WAP手机银行的所有交易， 都是在WAP手机银行交易服务器完成的。要做到保证所有的交易都是在 安全限制的控制之下的，就必须保证所有的交易都是通过WAP门户服务 器，转发到WAP交易服务器的。</p>
    <p>为了实现这个目的，本发明增加了手机令牌的设计，客户终端访问 WAP手机银行的时候，在WAP门户服务器，根据客户的运营商的是否绑 定手机号的要求，和是否获得了客户的手机号码，根据一定的算法，生成 不同类型的令牌，连同客户的交易请求一起转发到WAP交易服务器。WAP 交易服务器在接收到交易请求之后，首先检查令牌信息，检&#26619;通过继续进 行交易，不通过则直接拒绝继续交易。令牌设计如下：</p>
    <p>手机令牌格式可以为：令牌类型l手机号码l时间戳l验证串</p>
    <p>令牌类型：2位数字字符，OO表示令牌中不包含手机号码，Ol表示令</p>
    <p>牌中包含有手机号码；70&#12316;99用来表示异常。</p>
    <p>手机号码：当令牌中有手机号码时，填入经过加密的手机号码。加密 的方式可以是将手机号码+服务器当前时间为源串，使用加密算法（例如</p>
    <p>3Des算法），使用在WAP门户和WAP交易平台配置密钥进行加密，获得 加密串。</p>
    <p>时间戳：yyyyMMddHHmmss，产生令牌的当前服务器时间，此令牌 在特定时间段范围内有效。</p>
    <p>验证串：将前面参数拼串做加密运算，生成验证字符串，如MD5运 算，生成MD5摘要作为验证串</p>
    <p>(说明：对于可以从运营商获得手机号的情况，令牌中包含手机号码 信息，其它只能生成没有手机号码的令牌。）</p>
    <p>在令牌校验成功后，对于要求手机号码绑定的运营商，以手机号码作 为客户的登录ID，要求客户输入登录密码和验证码完成登录。对于不要求 绑定的客户的运营商，要求客户输入登录卡号、密码、验证码完成登录。 登录WAP手机银行后，交易服务器获取到客户开通手机银行时所预留的 手机号码，根据该手机号码再判断其运营商信息及是否要求绑定，是否与 该客户在门户选择的交易信息以及令牌信息一致，验证成功，再进入手机 交易功能。（说明： 一般情况下，绑定手机号是银行方出于安全方面的要 求，但通讯运营商可以不要求绑定手机号，这种情况下，不能限制此运营 商的用户通过互联网访问银行的WAP手机银行。）</p>
    <p>下面结合附图对本发明的具体实施方式作进一步的详细说明。</p>
    <p>如图1所示，图1是本发明提供的实现WAP手机银行交易安全控制 系统的结构示意图，该系统包括客户终端、WEB服务器、WAP门户服务 器、WAP交易服务器和移动通讯运营商系统设备。其中，客户终端是客 户访问WAP手机银行的载体， 一般是指手机。WEB服务器用于提供域名 地址服务，将接收自客户终端的交易请求转发至WAP门户服务器。WAP 门户服务器，用于在接收到WEB服务器转发的交易请求后获取客户终端的手机号码，并根据运营商手机号绑定关系生成手机令牌，然后将该手机 令牌与交易请求发送给WAP交易服务器。WAP交易服务器，用于在接收 到手机令牌与交易请求后，验证手机令牌的合法性，并检&#26619;客户运营商的</p>
    <p>绑定信息与令牌信息是否一致， 一致则继续交易；不一致拒绝交易。移动 通讯运营商系统设备，用于提供接口给WAP门户服务器，WAP门户服务 器通过与移动通讯运营商系统设备通讯，获取客户终端的的手机号码。</p>
    <p>对于直接输入域名访问WAP手机银行的客户终端，所述WAP门户服 务器提供给客户终端选择运营商页面，根据运营商手机号绑定关系参数， 通过与运营商协定的通讯接口，从移动通讯运营商系统设备获取客户终端 的手机号码，根据绑定关系和是否获得手机号信息，根据相应的算法，生 成手机令牌。</p>
    <p>对于通过运营商页面链接访问WAP手机银行的客户终端，所述WAP 门户服务器从交易请求中获取手机号码和运营商信息，并根据运营商手机 号绑定关系参数生成手机令牌。</p>
    <p>所述WAP交易服务器在验证手机令牌的合法性后，如果合法，则根 据是否绑定手机号码向客户终端提供不同的登录页面，客户终端登录后， 根据客户终端注册时预留的手机号码信息，检查客户运营商的绑定信息与 令牌信息是否一致；如果WAP交易服务器验证手机令牌的不合法，则拒 绝交易。在WAP交易服务器检查客户运营商的绑定信息与令牌信息不一 致或者验证手机令牌的不合法而拒绝交易时，客户终端能够浏览简单的信 息页面，无法进行交易。</p>
    <p>基于图1示出的实现WAP手机银行交易安全控制的系统，图2示出 了本发明提供的实现WAP手机银行交易安全控制的方法流程图，该方法 包括以下步骤：</p>
    <p>步骤20h客户终端向WEB服务器提出交易请求，WEB服务器将该 交易请求转发至WAP门户服务器；</p>
    <p>步骤202:WAP门户服务器在接收到WEB服务器转发的交易请求后， 获取客户终端的手机号码，并根据运营商手机号绑定关系生成手机令牌， 然后将该手机令牌与交易请求发送给WAP交易服务器；</p>
    <p>步骤203: WAP交易服务器在接收到手机令牌与交易请求后，验证手机令牌的合法性，并检&#26619;客户运营商的绑定信息与令牌信息是否一致，如 果一致，则继续交易；如果不一致，则拒绝交易。</p>
    <p>步骤201中所述客户终端向WEB服务器提出交易请求，通过以下两 种方式实现：</p>
    <p>方式一、客户终端通过移动通讯运营商的服务页面，链接到WAP手 机银行服务界面，向WEB服务器提出交易请求；</p>
    <p>方式二、客户终端直接输入域名访问WAP手机银行，向WEB服务器 提出交易请求。</p>
    <p>对于客户终端通过第一种方式访问WAP手机银行的情况，如果运营 商要求绑定手机号码，则运营商在链接到WAP手机银行时，将手机号码 以参数的形式一并传递给WAP手机银行门户服务器；如果对于手机号绑 定无要求或者要求不绑定，则不要求运营商在链接过来时提供手机号码； 其中，所述绑定是指一个手机号码只能访问一个客户终端的WAP手机银 行。</p>
    <p>对于客户终端通过第二种方式访问WAP手机银行的情况，如果运营 商要求绑定，则在客户终端访问WAP手机银行时，提供给客户终端移动 通讯运营商选择页面，客户终端选择后，需要银行和移动通讯运营商按照 约定的接口进行后台通讯，以获取客户终端的手机号码信息，如不能获得 手机号码，则限制客户终端的访问权限，只能浏览网页，不能登录WAP 手机银行；如果不要求绑定，则不需获取客户的手机号码，客户终端的访 问权限也不做控制；如果对于是否绑定不做要求，则尝试去获取客户终端 的手机号码，能获得则按照正常获取手机号码的流程去处理，不能获取则 按照不绑定的要求去处理。</p>
    <p>步骤202中所述WAP门户服务器在接收到WEB服务器转发的交易请</p>
    <p>求后，获取客户终端的手机号码，并根据运营商手机号绑定关系生成手机 令牌，然后将该手机令牌与交易请求发送给WAP交易服务器，具体包括-</p>
    <p>步骤l: WAP门户服务器在接收到WEB服务器转发的交易请求，提 供给客户终端运营商选择页面；</p>
    <p>步骤2:客户终端选择运营商；</p>
    <p>步骤3: WAP门户服务器检&#26619;运营商手机号绑定信息，如果绑定或无要求继续执行步骤4，如果不绑定，跳转至步骤6;</p>
    <p>步骤4: WAP门户服务器取得移动通讯运营商系统设备地址，发送请 求获取客户终端的手机号码，如果正常获取客户终端的手机号码，则继续 步骤5，否则，如果运营商对手机号码绑定无要求跳转至步骤6，要求绑 定而不能获取手机号码，生成获取手机号码异常令牌，跳转至步骤7;</p>
    <p>步骤5: WAP门户服务器检查手机号码与运营商信息的一致性， 一致 生成正常获取手机号码令牌，不一致生成获取手机号码异常令牌，跳转至 步骤7;</p>
    <p>步骤6:对于运营商不绑定手机号，及不要求绑定手机号而且无法获 得手机号的情况，WAP门户服务器生成无手机号令牌；</p>
    <p>步骤7: WAP门户服务器将交易请求和手机令牌信息转发至WAP交</p>
    <p>易服务器。</p>
    <p>步骤203中所述WAP交易服务器在接收到手机令牌与交易请求后，</p>
    <p>进一步包括：WAP交易服务器获取客户信息，该获取客户信息的步骤具 体包括：WAP交易服务器在接收到手机令牌与交易请求后，如果是正常</p>
    <p>获取手机令牌，提供给客户终端输入登录密码页面，以手机号码和登录密</p>
    <p>码为条件登录，获取客户信息；如果是获取手机号码异常令牌，显示给客 户终端WAP银行信息浏览页面，限制客户终端不能登录WAP手机银行， 结束；如果是无手机号令牌，提供给客户终端输入卡号、登录密码的登录 页面，以卡号和登录密码作为条件登录获取客户信息。</p>
    <p>步骤203中所述验证手机令牌的合法性，并检&#26619;客户运营商的绑定信 息与令牌信息是否一致，具体包括：WAP交易服务器在获取客户信息后， 检&#26619;客户注册手机银行时预留的手机号码信息，检查此手机号码对应的运 营商信息以及绑定信息，与令牌中信息是否一致，如果一致，则客户终端 登录成功，继续交易；如果不一致，提示客户登录失败，拒绝交易，限制 客户只能访问WAP手机银行信息浏览页面。</p>
    <p>基于图1和图2，以下参照图3详细描述了依照本发明实施例提供的 实现WAP手机银行交易安全控制的示意图，该方法具体包括以下步骤：</p>
    <p>步骤l:客户通过手机客户终端，输入域名，访问wap手机银行；</p>
    <p>步骤2: wap手机银行Web服务器将交易请求转发至wap门户服务器;步骤3:   WAP门户服务器在接收到WEB服务器转发的交易请求，提</p>
    <p>供给客户终端运营商选择页面；</p>
    <p>步骤4:客户终端选择运营商；</p>
    <p>步骤5: WAP门户服务器检查运营商手机号绑定信息，如果绑定或无 要求继续执行步骤6，如果不绑定，跳转至步骤8;</p>
    <p>步骤6: WAP门户服务器取得移动通讯运营商系统设备地址，发送请</p>
    <p>求获取客户终端的手机号码，如果正常获取客户终端的手机号码，则继续</p>
    <p>步骤7，否则，如果运营商对手机号码绑定无要求跳转至步骤8，要求绑</p>
    <p>定而不能获取手机号码，生成获取手机号码异常令牌，跳转至步骤9;</p>
    <p>步骤7: WAP门户服务器检&#26619;手机号码与运营商信息的一致性， 一致</p>
    <p>生成正常获取手机号码令牌，不一致生成获取手机号码异常令牌，跳转至</p>
    <p>步骤9;</p>
    <p>步骤8:对于运营商不绑定手机号，及不要求绑定手机号而且无法获 得手机号的情况，WAP门户服务器生成无手机号令牌；</p>
    <p>步骤9: WAP门户服务器将交易请求和手机令牌信息转发至WAP交 易服务器；</p>
    <p>步骤10:  WAP交易服务器在接收到手机令牌与交易请求后，如果是</p>
    <p>正常获取手机令牌，提供给客户终端输入登录密码页面，以手机号码和登</p>
    <p>录密码为条件登录，获取客户信息；如果是获取手机号码异常令牌，显示 给客户终端WAP银行信息浏览页面，限制客户终端不能登录WAP手机银 行，结束；如果是无手机号令牌，提供给客户终端输入卡号、登录密码的 登录页面，以卡号和登录密码作为条件登录获取客户信息；</p>
    <p>步骤11:  WAP交易服务器在获取客户信息后，检查客户注册手机银</p>
    <p>行时预留的手机号码信息，检&#26619;此手机号码对应的运营商信息以及绑定信</p>
    <p>息，与令牌中信息是否一致，如果一致，则客户终端登录成功，继续交易； 如果不一致，提示客户登录失败，拒绝交易，限制客户只能访问WAP手</p>
    <p>机银行信息浏览页面，结束。</p>
    <p>下面结合图4和图5，介绍手机令牌的生成和使用方法。 参照图4，本发明客户终端访问WAP手机银行，手机令牌的生成的 方法，以客户直接输入域名访问为例，包括以下步骤：步骤401:客户通过手机直接输入域名访问WAP手机银行；</p>
    <p>步骤402:   WAP手机银行的WAP门户服务器提示客户选择手机运营</p>
    <p>商；</p>
    <p>步骤403:客户选择手机运营商，WAP门户服务器据客户的选择输入， 检查运营商手机银行安全参数，如果运营商要求不绑定手机号码，生成不</p>
    <p>绑定手机号码令牌，请求转发至交易服务器，WAP门户服务器流程结束;</p>
    <p>如果运营商要求绑定或者对于是否绑定没有要求，向运营商发送请求，获</p>
    <p>取客户的手机号码；</p>
    <p>步骤404: WAP门户服务器判检查安全参数，如果安全参数要求绑定 手机号，进行步骤405;否则（运营商对于手机号码绑定没有要求），进行 步骤406;</p>
    <p>步骤405: WAP门户服务器根据运营商反馈的数据进行判断，如果没 有从运行商成功获取手机号码，则生成获取手机号码异常令牌，客户只能 浏览WAP门户信息页面；如果正常获取手机号码，检查手机号码与运营 商的一致性（例如匹配"WAP网关IP地址列表"和"手机号段和运营商的对 应关系列表"），如果不一致，生成获取手机号码异常令牌，客户只能浏览 WAP门户信息页面；如果手机号码与运营商一致，生成绑定手机号码令 牌，WAP门户服务器流程结束；</p>
    <p>步骤406: WAP门户服务器根据运营商反馈的数据进行判断，如果没 有从运营商获取手机号码，生成无手机号码令牌；如果正常获取手机号码， 检&#26619;手机号码与运营商的一致性（匹配"WAP网关IP地址列表"和"手机号 段和运营商的对应关系列表"），如果不一致，生成无手机号码令牌；如果 手机号码与运营商一致，生成获得手机号码令牌。</p>
    <p>参照图5，本发明手机令牌的验证处理方法，包括以下步骤： 步骤501: WAP门户服务器向交易服务器提交令牌参数，交易服务器</p>
    <p>根据约定的令牌格式，取手机号码、交易时间等信息，检查时间是否有效，</p>
    <p>根据是否能取到手机号码匹配令牌类型，根据约定的算法验证验证串是否</p>
    <p>正确，如果非法，拒绝交易；</p>
    <p>步骤502:交易服务器根据令牌类型显示不同的登录页面，无手机号</p>
    <p>码、不绑定的令牌，显示输入卡号、登录密码的登录页面；有手机号码、绑定的令牌，显示输入登录密码的登录页面；</p>
    <p>步骤503:交易服务器根据客户的输入项，查询客户注册时预先登记</p>
    <p>的客户信息，获取客户注册手机银行的手机号码；</p>
    <p>步骤504:根据注册手机号码检查客户运营商信息，如果不一致，提</p>
    <p>示错误，拒绝客户交易请求， 一致，则允许客户继续交易。</p>
    <p>以上所述的具体实施例，对本发明的目的、技术方案和有益效果进行 了进一步详细说明，所应理解的是，以上所述仅为本发明的具体实施例而 已，并不用于限制本发明，凡在本发明的精神和原则之内，所做的任何修 改、等同替换、改进等，均应包含在本发明的保护范围之内。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101860824A?cl=zh">CN101860824A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年5月6日</td><td class="patent-data-table-td patent-date-value">2010年10月13日</td><td class="patent-data-table-td ">上海海基业高科技有限公司</td><td class="patent-data-table-td ">一种基于短消息的数字签名认证系统及数字签名的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101860824B?cl=zh">CN101860824B</a></td><td class="patent-data-table-td patent-date-value">2010年5月6日</td><td class="patent-data-table-td patent-date-value">2013年6月12日</td><td class="patent-data-table-td ">上海海基业高科技有限公司</td><td class="patent-data-table-td ">一种基于短消息的数字签名认证系统及数字签名的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102118743A?cl=zh">CN102118743A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年3月2日</td><td class="patent-data-table-td patent-date-value">2011年7月6日</td><td class="patent-data-table-td ">中兴通讯股份有限公司</td><td class="patent-data-table-td ">一种登录手机网上银行的方法和系统、银行服务器</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102215227A?cl=zh">CN102215227A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年5月30日</td><td class="patent-data-table-td patent-date-value">2011年10月12日</td><td class="patent-data-table-td ">中国联合网络通信集团有限公司</td><td class="patent-data-table-td ">移动通信网络的电子商务身份认证方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102404115A?cl=zh">CN102404115A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年9月16日</td><td class="patent-data-table-td patent-date-value">2012年4月4日</td><td class="patent-data-table-td ">林新格</td><td class="patent-data-table-td ">用sd卡实现wap手机银行系统中手机与服务器的双向安全认证的方法及其系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102457842A?cl=zh">CN102457842A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年10月22日</td><td class="patent-data-table-td patent-date-value">2012年5月16日</td><td class="patent-data-table-td ">中国移动通信集团宁夏有限公司</td><td class="patent-data-table-td ">一种手机交易方法、装置及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102457842B?cl=zh">CN102457842B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年10月22日</td><td class="patent-data-table-td patent-date-value">2015年8月19日</td><td class="patent-data-table-td ">中国移动通信集团宁夏有限公司</td><td class="patent-data-table-td ">一种手机交易方法、装置及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103095659A?cl=zh">CN103095659A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年11月3日</td><td class="patent-data-table-td patent-date-value">2013年5月8日</td><td class="patent-data-table-td ">北京神州泰岳软件股份有限公司</td><td class="patent-data-table-td ">一种互联网中账户登录方法和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103095659B?cl=zh">CN103095659B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年11月3日</td><td class="patent-data-table-td patent-date-value">2016年1月20日</td><td class="patent-data-table-td ">北京神州泰岳软件股份有限公司</td><td class="patent-data-table-td ">一种互联网中账户登录方法和系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103237096A?cl=zh">CN103237096A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年4月23日</td><td class="patent-data-table-td patent-date-value">2013年8月7日</td><td class="patent-data-table-td ">长春吉联科技集团有限公司</td><td class="patent-data-table-td ">一种使用手机号注册网站用户的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103457733A?cl=zh">CN103457733A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年8月15日</td><td class="patent-data-table-td patent-date-value">2013年12月18日</td><td class="patent-data-table-td ">中电长城网际系统应用有限公司</td><td class="patent-data-table-td ">一种云计算环境数据共享方法和系统</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=vWJqBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029060000">H04L29/06</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2009年6月3日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2009年7月29日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年3月21日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Granted</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/2bb23ba8b372aa35d468/CN101448001A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E5%AE%9E%E7%8E%B0wap%E6%89%8B%E6%9C%BA%E9%93%B6%E8%A1%8C%E4%BA%A4%E6%98%93%E5%AE%89%E5%85%A8.pdf?id=vWJqBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U0woz1kHdAA603XEuJDgdpHaLD7HA"},"sample_url":"https://www.google.com/patents/reader?id=vWJqBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>