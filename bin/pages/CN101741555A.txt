<!DOCTYPE html><html><head><title>专利 CN101741555A - 身份认证和密钥协商方法及系统 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="身份认证和密钥协商方法及系统"><meta name="DC.contributor" content="丁添添" scheme="inventor"><meta name="DC.contributor" content="沈晓芹" scheme="inventor"><meta name="DC.contributor" content="禹忠" scheme="inventor"><meta name="DC.contributor" content="许文丽" scheme="inventor"><meta name="DC.contributor" content="中兴通讯股份有限公司" scheme="assignee"><meta name="DC.date" content="2008-11-12" scheme="dateSubmitted"><meta name="DC.description" content="本发明公开了一种身份认证和密钥协商方法及系统，其中，该方法包括：MS根据公钥广播协议从多个VLR中选择一个VLR，获取选择的VLR的公钥，并选择第一随机数；MS将其公钥、HLR的标识、第一随机数、以及利用选择的VLR的公钥加密的MS的国际移动用户识别码即IMSI发送给选择的VLR；选择的VLR利用其私钥解密得到IMSI，利用选择的VLR与HLR的共享密钥对解密的IMSI加密并发送至HLR，并且生成第二随机数，将第二随机数发送给MS；MS利用其私钥、第一随机数、第二随机数构造中间变量，并将中间变量发送给选择的VLR，选择的VLR通过中间变量对MS进行认证。"><meta name="DC.date" content="2010-6-16"><meta name="citation_patent_publication_number" content="CN:101741555:A"><meta name="citation_patent_application_number" content="CN:200810177730"><link rel="canonical" href="https://www.google.com/patents/CN101741555A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101741555A?cl=zh"/><meta name="title" content="专利 CN101741555A - 身份认证和密钥协商方法及系统"/><meta name="description" content="本发明公开了一种身份认证和密钥协商方法及系统，其中，该方法包括：MS根据公钥广播协议从多个VLR中选择一个VLR，获取选择的VLR的公钥，并选择第一随机数；MS将其公钥、HLR的标识、第一随机数、以及利用选择的VLR的公钥加密的MS的国际移动用户识别码即IMSI发送给选择的VLR；选择的VLR利用其私钥解密得到IMSI，利用选择的VLR与HLR的共享密钥对解密的IMSI加密并发送至HLR，并且生成第二随机数，将第二随机数发送给MS；MS利用其私钥、第一随机数、第二随机数构造中间变量，并将中间变量发送给选择的VLR，选择的VLR通过中间变量对MS进行认证。"/><meta property="og:title" content="专利 CN101741555A - 身份认证和密钥协商方法及系统"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101741555A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101741555A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=P4l-BwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101741555A&amp;usg=AFQjCNH2hwapK4bLeAVak5CXVd2vylWs_w" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/935bac41e198d7543353/CN101741555A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/935bac41e198d7543353/CN101741555A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101741555A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101741555A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN101741555A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN101741555B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101741555A?cl=zh" style="display:none"><span itemprop="description">本发明公开了一种身份认证和密钥协商方法及系统，其中，该方法包括：MS根据公钥广播协议从多个VLR中选择一个VLR，获取选择的VLR的公钥，并选择第一随机数；MS将其公钥、HLR的标识、第一随机数、以及利用选择的VLR的公钥加 ...</span><span itemprop="url">https://www.google.com/patents/CN101741555A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101741555A - 身份认证和密钥协商方法及系统</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101741555A - 身份认证和密钥协商方法及系统" title="专利 CN101741555A - 身份认证和密钥协商方法及系统"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101741555 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200810177730</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2010年6月16日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2008年11月12日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2008年11月12日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101741555B?hl=zh-CN&amp;cl=zh">CN101741555B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200810177730.3, </span><span class="patent-bibdata-value">CN 101741555 A, </span><span class="patent-bibdata-value">CN 101741555A, </span><span class="patent-bibdata-value">CN 200810177730, </span><span class="patent-bibdata-value">CN-A-101741555, </span><span class="patent-bibdata-value">CN101741555 A, </span><span class="patent-bibdata-value">CN101741555A, </span><span class="patent-bibdata-value">CN200810177730, </span><span class="patent-bibdata-value">CN200810177730.3</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E4%B8%81%E6%B7%BB%E6%B7%BB%22">丁添添</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%B2%88%E6%99%93%E8%8A%B9%22">沈晓芹</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%A6%B9%E5%BF%A0%22">禹忠</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E8%AE%B8%E6%96%87%E4%B8%BD%22">许文丽</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E4%B8%AD%E5%85%B4%E9%80%9A%E8%AE%AF%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">中兴通讯股份有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101741555A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101741555A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101741555A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (9),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (2),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=P4l-BwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200810177730&amp;usg=AFQjCNHo3SrG4j6Wlbb9TNrPfjkzCQVUVQ"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=P4l-BwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101741555A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNG2NbpZ4-G0xPccLiTVrEZ82Fc34w"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT95935438" lang="ZH" load-source="patent-office">身份认证和密钥协商方法及系统</invention-title>
    </span><br><span class="patent-number">CN 101741555 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA78463022" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明公开了一种身份认证和密钥协商方法及系统，其中，该方法包括：MS根据公钥广播协议从多个VLR中选择一个VLR，获取选择的VLR的公钥，并选择第一随机数；MS将其公钥、HLR的标识、第一随机数、以及利用选择的VLR的公钥加密的MS的国际移动用户识别码即IMSI发送给选择的VLR；选择的VLR利用其私钥解密得到IMSI，利用选择的VLR与HLR的共享密钥对解密的IMSI加密并发送至HLR，并且生成第二随机数，将第二随机数发送给MS；MS利用其私钥、第一随机数、第二随机数构造中间变量，并将中间变量发送给选择的VLR，选择的VLR通过中间变量对MS进行认证。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(13)</span></span></div><div class="patent-text"><ol mxw-id="PCLM32050783" lang="ZH" load-source="patent-office" class="claims">
    <li class="claim"> <div num="1" class="claim">
      <div class="claim-text">一种身份认证和密钥协商方法，应用于包括证书授权中心即CA、归属局即HLR、多个拜访局即VLR、以及隶属于所述HLR的移动站即MS的系统，其中，所述CA用于为所述HLR、所述多个VLR、以及所述MS颁发公钥和私钥，其特征在于，所述方法包括：所述MS根据公钥广播协议从所述多个VLR中选择一个VLR，获取选择的所述VLR的公钥，并选择第一随机数；所述MS将其公钥、所述HLR的标识、所述第一随机数、以及利用选择的所述VLR的公钥加密的所述MS的国际移动用户识别码即IMSI发送给选择的所述VLR；选择的所述VLR利用其私钥解密得到所述IMSI，利用选择的所述VLR与所述HLR的共享密钥对解密的所述IMSI加密并发送至所述HLR，并且生成第二随机数，将所述第二随机数发送给所述MS；所述MS利用其私钥、所述第一随机数、所述第二随机数构造中间变量，并将所述中间变量发送给选择的所述VLR，选择的所述VLR通过所述中间变量对所述MS进行认证。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2. 根据权利要求1所述的方法，其特征在于，在所述VLR向所述MS发送所述第二随机数时，进一步包括：选择的所述VLR利用所述第一随机数以预定加密方式对所述HLR的身份令牌、所述第二随机数、以及所述MS的临时移动用户识别码进行加密并发送至所述MS。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3. 根据权利要求2所述的方法，其特征在于，所述预定加密方式为异或操作。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4. 根据权利要求1所述的方法，其特征在于，在所述HLR接收到所述IMSI之后，进一步包括：所述HLR利用所述共享密钥解密得到所述IMSI，生成多个认证向量组，并利用所述共享密钥对所述多个认证向量组加密并发送至选择的所述VLR ;选择的所述VLR利用所述共享密钥解密得到所述认证向量组，并从中选择一个认证向量组发送给所述MS。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5. 根据权利要求1所述的方法，其特征在于，在所述MS首次通过认证的情况下，进一步包括：所述MS利用其TMSI替代所述IMSI。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6. 根据权利要求5所述的方法，其特征在于，在MS通过首次认证后，进一步包括：选择的所述VLR产生新的TMSI，用于在所述MS进行下次认证的情况下分配给所述MS以替代原有的TMSI。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7. 根据权利要求1至6中任一项所述的方法，其特征在于，所述CA根据以下公式生成所述MS的公钥：&lt;formula&gt;formula see original document page 2&lt;/formula&gt;其中，PK【为所述MS的公钥；n为所述CA的长度为1024bit以上的模数；g为基元，且g为整数；d为所述CA的签字私钥；e为所述CA的验证公钥；SK【为所述CA为用户随机选取的私钥，其长度为160bit以上；H^为所述HLR的标识；MSI为所述MS的国际移动用户识别码。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8. 根据权利要求1至6中任一项所述的方法，其特征在于，所述MS根据以下公式得到所述中间变量：&lt;formula&gt;formula see original document page 2&lt;/formula&gt;其中，y为所述中间变量，Nu为所述第一随机数，N【为所述第二随机数，SKMS为所述MS的私钥。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9. 根据权利要求8所述的方法，其特征在于，所述VLR根据以下公式对所述MS进行认证： &lt;formula&gt;formula see original document page 3&lt;/formula&gt;其中，在该公式成立的情况下，确定所述MS通过认证，否则确定所述MS未通过认证；g为基元，且g为整数；y为所述中间变量；PKMS为所述MS的公钥；IMSI为所述MS的国际移动用户识别码；H^为所述HLR的标识；n为所述CA的长度为1024bit以上的模数；x等于; &lt;formula&gt;formula see original document page 3&lt;/formula&gt;为hash运算。</div>
    </div>
    </li> <li class="claim"> <div num="10" class="claim">
      <div class="claim-text">10. &#8212;种身份认证和密钥协商系统，包括证书授权中心即CA、归属局即HLR、多个拜访局即VLR、以及隶属于所述HLR的移动站即MS的系统，其中，所述CA用于为所述HLR、所述多个VLR、以及所述MS颁发公钥和私钥，其特征在于，所述MS用于根据公钥广播协议从所述多个VLR中选择一个VLR，并随机选择第一随机数；利用选择的所述VLR的公钥对所述MS的国际移动用户识别码即IMSI进行第一加密，并将所述MS的公钥、所述HLR的标识、所述第一随机数、以及第一加密的所述IMSI发送给选择的所述VLR，以及利用所述MS的私钥、所述第一随机数、选择的所述VLR返回的第二随机数构造中间变量；所述多个VLR中的每个VLR，用于在其被所述MS选择的情况下，利用其私钥对来自所述MS的第一加密后的IMSI进行解密得到所述IMSI，利用所述VLR与所述HLR的共享密钥对解密的所述&#38914;SI进行第二加密，将第二加密后的所述IMSI发送至所述HLR，并将生成的所述第二随机数发送至所述MS，以及根据所述MS生成的所述中间变量对所述MS进行认证；所述HLR用于利用所述共享密钥对加密的所述IMSI进行解密。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="11" class="claim">
      <div class="claim-text">11. 根据权利要求10所述的系统，其特征在于，所述MS进一步包括：选择模块，用于根据所述公钥广播协议从所述多个VLR中选择所选的所述VLR，并随机选择所述第一随机数；获取模块，用于获取选择的所述VLR的公钥；第一加密模块，用于利用选择的所述VLR的公钥进行所述第一加密；第一发送模块，用于将所述MS的公钥、所述HLR的标识、所述第一随机数、以及第一加密的所述MSI发送给选择的所述VLR ;构造模块，用于利用所述MS的私钥、所述第一随机数、选择的所述VLR返回的第二随机数构造所述中间变量。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12. 根据权利要求10所述的系统，其特征在于，所述VLR包括：第一解密模块，用于利用其所在的VLR的私钥对第一加密后的所述IMSI进行解密得到所述&#38914;SI ;第二加密模块，用于利用其所在的VLR与所述HLR的共享密钥对解密的所述IMSI进行所述第二加密；第二发送模块，用于将所述第二加密模块加密后的所述MSI发送至所述HLR ;生成模块，用于生成所述第二随机数，并将所述第二随机数发送至所述MS ;认证模块，用于根据所述MS构造的所述中间变量对所述MS进行认证。</div>
    </div>
    </li> <li class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13.根据权利要求10所述的系统，其特征在于，所述VLR包括：第二解密模块，用于利用所述共享密钥对第二加密的所述IMSI进行解密。</div>
    </div>
  </li> </ol>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES37417732" lang="ZH" load-source="patent-office" class="description">
    <p>身份认证和密钥协商方法及系统</p>
    <p>技术领域</p>
    <p>[0001] 本发明涉及通信领域，并且特别地，涉及一种身份认证和密钥协商方法及系统。</p>
    <p>背景技术</p>
    <p>[0002] 认证禾口密钥协商（Authentication, and Key Agreement,简称为AKA)或可扩 展的认证协议_AKA (Extensible Authentication Protocol-Authentication, and Key Agreement,简称为EAP-AKA)是基于挑战-应答机制和对称密码机制，该机制运行在用户身 份识别模块上，基于AKA的认证与密钥分发协议需要三方参与：移动站（MobileStation)， 拜访局（VLR)，归属局（HLR) 。 EAP-AKA协议由VLR发起，VLR首先向MS发送一个EAP请求 /身份标志消息，然后就开始了认证与密钥分配过程。下面对相关协议进行描述： [0003] (1) MS &#8212; VLR : MS I ， HLR ; [0004]     (2) VLR &#8212;HLR : MSI ;</p>
    <p>[0005]     (3) HLR &#8212; VLR :AV = RAND | | XRES | | CK | | IK | | AUTN ; [0006]     (4) VLR &#8212; MS :RAND | | AUTN ; [0007]     (5) MS &#8212; VLR : RES 。</p>
    <p>[0008] 认证中心AuC产生认证向量组的流程如图1所示，其中，国际移动用户识别 码（&#38914;SI)为用户的永久身份识别，AV为认证向量，SQN为序列号，AMF认证管理域， 爿(7rA^SgA^^nMMFIIM4C为认证令牌，MAC = flK(SQN， RAND， AMF)为消息认证码，用 于认证消息的正确性，XRES = f2K(RAND)为期望的认证回答，CK = f3K(RAND)为加密密 钥，IK = f4K(RAND)为完整性密钥，AK = f5K(RAND)为匿名密钥，用于隐藏序列号，RES = f2K(RAND)为认证回答，XMAC = flK(SQN， RAND， AMF)为期望的消息认证码，fl至f5为单向 陷门函数。</p>
    <p>[0009] 具体地，在MS收到RAND | | AUTN后将会计算XMAC并和AUTN中的MAC比较，若两者 不同，则向VLR发送拒绝认证消息，认证失败；若两者相同，则MS验证SQN是否为新鲜，如果 不能通过验证，MS会向VLR发送同步接收失败消息，此时认证失败；如果上述两项都通过验 i正，则MS向VLR发送到RES， VLR收到RES后，比较XRES和RES，若不同，认证失败，如果相 同则通过认证，认证过程结束。</p>
    <p>[0010] 在上述流程完成后，MS用户与网络之间就实现了双向认证。并且，MS与VLR之间 共享了会话密钥，这些密钥可用于通信中的机密性和一致性保护。</p>
    <p>[0011] 具体地，在图1中，f0是一个伪随机数生成函数，只存放于AuC中，用于生成随机 数RAND。认证向量中有一个"认证令牌"，即，AUTN，其中包含了一个序列号，使得用户可以 避免受到重传攻击。其中，因为序列号可能会暴露用户的身份和位置信息，所以将AK用于 在AUTN中隐藏序列号。</p>
    <p>[0012] 当认证中心HLR收到VLR的认证请求时，会发送N个认证向量组给VLR。在VLR 中，每个用户的N个认证向量组，按照"先入先出"(FIFO)的规则发送给移动台，用于鉴权认 证。[0013]     在发送向量组的过程中，VLR会初始化一个认证过程，选择一个认证向量组，发送 其中的RAND和AUTN给用户。用户收到RANDl |AUTN后，在用户端的身份认证模块中进行如 图2所示操作。在图2所示的MS所进行的操作中，MS同样需要根据与AuC中相同的函数 f0-f5来进行验证，其处理方式与AuC中的处理过程对应，这里不再重复。 [0014]     然而，在目前采用的鉴权和密钥协商过程中，存在如下两个问题。 [0015]( &#8212; ）明文传输IMSI或临时移动用户识别码（TMSI)</p>
    <p>[0016] 通过上述过程可以看出，当用户首次注册到网络、或者网络无法从TMSI恢复出 MSI的时候（比如VLR的数据库错误），拜访地VLR会向用户请求IMSI，用户将向网络以明 文形式发送IMSI，此时IMSI的传输非常不安全，很容易导致IMSI被窃听，遭到中间人的攻击。</p>
    <p>[0017] 目前，在3G中可选择使用保密的用户身份来增强用户身份的机密性。MS/USIM在 收到VLR的身份请求后，由MS将IMSI加密后嵌入HE-message中，并且用HE-id来向VLR指 明可以解密该HE-message的HE/UIC的地址。VLR收到HE-message后，根据HE_id再将该 消息传送到相应的HE/UIC， HE/UIC解密后将用户的IMSI传递给VLR。在收到用户的IMSI 后，就可以启动TMSI分配过程，此后将使用TMSI来识别移动用户身份。 [0018] 尽管这种增强型身份加密机制在一定程度上加强了用户身份的机密性，但该方法 增加了消息在信道中传输的过程，导致传输时延增加；另一方面，该方法只是将原来由无线 接入部分传送明文&#38914;SI的过程变成在网络内传送明文IMSI，并不能彻底解决IMSI安全性 的问题；并且，对于移动用户的临时身份TMSI，如果泄漏了，就有可能获得与永久身份标识 IMSI之间的映射关系，如果进而获得用户的具体位置信息，这样就可能会发生针对特定用 户的拒绝服务攻击。</p>
    <p>[0019]     ( 二 ）在目前采用的鉴权和密钥协商过程中，MS和HLR都没有对VLR进行认证。 [0020] 无线网络处在比较开放的环境中，鉴权和密钥协商协议实现了用户与网络之间的 相互认证，即MS和HLR之间的双向认证，以及VLR对MS的认证，但双方都没有对VLR的身 份进行认证。因此攻击者X可在MS与VLR之间发起中间人攻击，例如，攻击过程如下： [0021]     (1)MS &#8212;X:MSI; [0022]     (2)X &#8212; VLR :MSI ; [0023]     (3) VLR &#8212;HLR : MSI ;</p>
    <p>[0024]     (4) HLR &#8212; VLR :AV = RAND | | XRES | | CK | | IK | | AUTN ; [0025]     (5) VLR &#8212; X :RAND | | AUTN ; [0026]     (6) X &#8212; MS :RAND | | AUTN ; [0027]     (7)MS &#8212;X:RES; [0028]     (8)X &#8212; VLR :RES。</p>
    <p>[0029] 这样，由于HLR将无线网通信中机密性和完整性保护的会话密钥直接以明文的形 式发送给VLR，攻击者X就可以假冒该MS入网，此时，由于CK与IK未在无线接口中传输，所 以攻击者无法获得这些密钥而进行正常的通信，但是如果攻击者X对VLR与HLR之间的信 息进行窃听，就可能获得HLR传给VLR的认证向量AV，进而获得CK与IK。此后攻击者X再 假冒该MS入网，S卩，可实现正常的保密通信，而合法用户传送的信息也就失去了保密性。另 外，由于用户在不同的公共陆地移动网络（Public Land Mobile Network,简称为PLMN)之间漫游，这些不同的PLMN甚至可以位于不同的国家，为了对用户进行鉴权认证，HLR (用户 的本地网络）会将用户的鉴权五元组发送到用户当前漫游的网络的VLR，在这个过程中，用 户鉴权向量组将穿过不同的网络，因此很容易受到攻击。</p>
    <p>[0030] 如果攻击者首先利用某种方式（如DoS攻击）攻陷VLR，然后假冒成VLR则可以获 取无线网的会话密钥，这样就使得无线网的通信失去了保密性。</p>
    <p>[0031]     针对相关技术中IMSI和密钥传输保密性差的问题，目前尚未提出有效的解决方案。</p>
    <p>发明内容</p>
    <p>[0032] 考虑到上述IMSI和密钥传输保密性差的问题而做出本发明，为此，本发明的主要 目的在于提供一种身份认证和密钥协商方法和系统。</p>
    <p>[0033] 根据本发明的一个方面，提供了一种身份认证和密钥协商方法，该方法可应用于 包括证书授权中心即CA、归属局即HLR、多个拜访局即VLR、以及隶属于HLR的移动站即MS 的系统，其中，CA用于为HLR、多个VLR、以及MS颁发公钥和私钥。</p>
    <p>[0034] 根据本发明的身份认证和密钥协商方法包括：MS根据公钥广播协议从多个VLR中 选择一个VLR，获取选择的VLR的公钥，并选择第一随机数；MS将其公钥、HLR的标识、第一 随机数、以及利用选择的VLR的公钥加密的MS的国际移动用户识别码即IMSI发送给选择 的VLR ;选择的VLR利用其私钥解密得到IMSI，利用选择的VLR与HLR的共享密钥对解密的 IMSI加密并发送至HLR，并且生成第二随机数，将第二随机数发送给MS ;MS利用其私钥、第 一随机数、第二随机数构造中间变量，并将中间变量发送给选择的VLR，选择的VLR通过中 间变量对MS进行认证。</p>
    <p>[0035] 其中，在VLR向MS发送第二随机数时，该方法可进一步包括：选择的VLR利用第一 随机数以预定加密方式对HLR的身份令牌、第二随机数、以及MS的临时移动用户识别码进 行加密并发送至MS。优选地，预定加密方式为异或操作。</p>
    <p>[0036]     之后，在HLR接收到IMSI之后，该方法可进一步包括：HLR利用共享密钥解密得到 MSI，生成多个认证向量组，并利用共享密钥对多个认证向量组加密并发送至选择的VLR ; 选择的VLR利用共享密钥解密得到认证向量组，并从中选择一个认证向量组发送给MS。 [0037]     此外，在MS首次通过认证的情况下，该方法还可以进一步包括：MS利用其TMSI替 代&#38914;SI。</p>
    <p>[0038]     其中，在MS通过首次认证后，该方法可进一步包括：选择的VLR产生新的TMSI，用 于在MS进行下次认证的情况下分配给MS以替代原有的TMSI。 [0039]     优选地，CA可根据以下公式生成MS的公钥： [0040] = (g_s』-丽/ -叫）"mod "</p>
    <p>[0041]     其中，PKB为MS的公钥；n为CA的长度为1024bit以上的模数；g为基元，且g为 整数；d为CA的签字私钥；e为CA的验证公钥；SKMS为CA为用户随机选取的私钥，其长度为 160bit以上；IDH为HLR的标识；MSI为MS的国际移动用户识别码。 [0042]     并且，MS可根据以下公式得到中间变量： [0043]     Y = N【+NvXSK【</p>
    <p>[0044]     其中，y为中间变量，NU为第一随机数，NMS为第二随机数，SKMS为MS的私钥。[0045]     其中，VLR可根据以下公式对MS进行认证： [0046]    i/[g^(尸《M/ + /MS/ + mod"]=;c</p>
    <p>[0047]     其中，在该公式成立的情况下，确定MS通过认证，否则确定MS未通过认证； [0048]     g为基元，且g为整数；y为中间变量；PKMS为MS的公钥；IMSI为MS的国际移动用 户识别码；IDH为HLR的标识；n为CA的长度为1024bit以上的模数；x等于^ = H(gWMS mod"); H为hash运算。</p>
    <p>[0049] 根据本发明的另一方面，提供了一种身份认证和密钥协商系统。</p>
    <p>[0050]     根据本发明的身份认证和密钥协商系统包括证书授权中心即CA、归属局即HLR、</p>
    <p>多个拜访局即VLR、以及隶属于HLR的移动站即MS的系统，其中，CA用于为HLR、多个VLR、</p>
    <p>以及MS颁发公钥和私钥。</p>
    <p>[0051 ] 其中，MS用于根据公钥广播协议从多个VLR中选择一个VLR，并随机选择第一随机 数；利用选择的VLR的公钥对MS的国际移动用户识别码即IMSI进行第一加密，并将MS的 公钥、HLR的标识、第一随机数、以及第一加密的IMSI发送给选择的VLR，以及利用MS的私 钥、第一随机数、选择的VLR返回的第二随机数构造中间变量；</p>
    <p>[0052] 多个VLR中的每个VLR，用于在其被MS选择的情况下，利用其私钥对来自MS的第 一加密后的MSI进行解密得到IMSI，利用VLR与HLR的共享密钥对解密的IMSI进行第二 加密，将第二加密后的MSI发送至HLR，并将生成的第二随机数发送至MS，以及根据MS生 成的中间变量对MS进行认证；</p>
    <p>[0053]     HLR用于利用共享密钥对加密的IMSI进行解密。</p>
    <p>[0054] 优选地，MS可以进一步包括：选择模块，用于根据公钥广播协议从多个VLR中选择 所选的VLR，并随机选择第一随机数；获取模块，用于获取选择的VLR的公钥；第一加密模 块，用于利用选择的VLR的公钥进行第一加密；第一发送模块，用于将MS的公钥、HLR的标 识、第一随机数、以及第一加密的IMSI发送给选择的VLR ;构造模块，用于利用MS的私钥、 第一随机数、选择的VLR返回的第二随机数构造中间变量。</p>
    <p>[0055] 另外，VLR可以进一步包括：第一解密模块，用于利用其所在的VLR的私钥对第一 加密后的IMSI进行解密得到IMSI ;第二加密模块，用于利用其所在的VLR与HLR的共享密 钥对解密的MSI进行第二加密；第二发送模块，用于将第二加密模块加密后的IMSI发送至 HLR ;生成模块，用于生成第二随机数，并将第二随机数发送至MS ;认证模块，用于根据MS构 造的中间变量对MS进行认证。</p>
    <p>[0056] 此外，上述的VLR可以进一步包括：第二解密模块，用于利用共享密钥对第二加密 的IMSI进行解密。</p>
    <p>[0057] 借助本发明的上述技术方案，通过引入可信的CA来分配公钥和私钥，实现了基于 自验证公钥的密钥交互方法，能够有效解决相关技术中IMSI和TMSI明文传输所带来的用 户身份和位置信息被泄漏的安全隐患，并且解决了由于缺乏对VLR的认证而导致容易被伪 基站或中间人攻击的问题，本发明增加了少量加解密和异或的运算量，有效保证了 IMSI和 TMSI传输的安全性，并且能够保证系统的效率不受影响。</p>
    <p>附图说明</p>
    <p>[0058] 此处所说明的附图用来提供对本发明的进一步理解，构成本申请的一部分，本发明的示意性实施例及其说明用于解释本发明，并不构成对本发明的不当限定。在附图中：</p>
    <p>[0059]      图1是相关技术中认证中心AuC产生认证向量组的示意图；</p>
    <p>[0060]      图2是相关技术中MS的认证模块中进行的操作示意图；</p>
    <p>[0061]      图3是根据本发明方法实施例的身份认证和密钥协商方法的流程图；</p>
    <p>[0062]      图4是根据本发明方法实施例的身份认证和密钥协商方法的详细处理过程的信</p>
    <p>令流程图；</p>
    <p>[0063]     图5是根据本发明系统实施例的身份认证和密钥协商系统的框图。</p>
    <p>具体实施方式 [0064] 功能概述</p>
    <p>[0065]     本发明考虑到相关技术中IMSI和密钥传输保密性差的问题，本发明采用公钥广 播协议（Public Key Broadcast Protocol-PKBP)，在网络中引入了可信的证书授权中心 (Certificate Authority, CA)对VLR和HLR生成私钥并颁发公钥，借助自验证公钥的身份 认证方案有效提高了 IMSI和密钥传输的保密性。 [0066] 方法实施例</p>
    <p>[0067]     在本实施例中，提供了一种身份认证和密钥协商方法，应用于包括CA、 HLR、多个</p>
    <p>VLR、以及隶属于HLR的MS的系统，其中，CA可为HLR、多个VLR、以及MS颁发公钥和私钥。</p>
    <p>[0068]     如图3所示，根据本实施例的身份认证和密钥协商方法包括：</p>
    <p>[0069]     步骤S302，MS根据公钥广播协议从多个VLR中选择一个VLR，获取该选择的VLR的</p>
    <p>公钥，并选择第一随机数；</p>
    <p>[0070] 步骤S304， MS将其公钥、HLR的标识、第一随机数、以及利用所选的VLR的公钥加 密的MS的国际移动用户识别码即IMSI发送给VLR ;</p>
    <p>[0071]     步骤S306，所选的VLR利用其私钥解密得到IMSI，利用该所选的VLR与HLR的共 享密钥对解密的MSI加密并发送至HLR，并且生成第二随机数，将第二随机数发送给MS ; [0072]     步骤S308， MS利用其私钥、第一随机数、第二随机数构造中间变量，并将中间变量 发送给所选的VLR，所选的VLR通过中间变量对MS进行认证。</p>
    <p>[0073] 针对各个VLR的公钥的获取，系统中相互临近的VLR利用BCCH(广播控制信道） 将认证参数（公钥PKv、网络标识IDv和模数nv)以联合广播的方式从BS发布。艮卩，各个BS 同时广播自己及其相邻基站归属的VLR的认证参数，最终形成一个无缝的覆盖。 [0074] 在实际情况中，伪基站的数目远小于真实基站的数目，即便伪基站以很强的信号 广播自己的公钥参数，但其数量远小于合法BS联合广播的参数。MS可在SIM卡中利用一个 较小的存储区对一段时间内收到的参数予以缓存，统计出现次数较多的参数，再在其中选 择对应信号最强的BS接入。如果一个参数在缓存中出现的次数很少，即便其对应的发射信 号强度再大MS也不考虑接入。利用此方法，MS可抵抗伪基站攻击，并避免验证VLR公钥证 书的合法性，从而避免验证公钥证书带来的网络拥塞。</p>
    <p>[0075]     并且，在上述步骤S302之前，CA可以根据以下公式（1)为MS产生公钥PKMS :</p>
    <p>[0076]   尸K泌=&#8212;B/57 &#8212; /Z^)rf mod "公式（l)</p>
    <p>[0077] 其中，n是CA长度为1024bits以上的模数；g为基元，且g G Z ;d是CA的签字私 钥；e是CA的验证公钥；SKB为CA对用户随机选取的长度为160bit以上的私钥；将g、SKMS、PKB、 IDH(归属地HLR的网络标识号）和MSI写入用户的SM卡。随后，CA销毁SKMS，并在 自己的数据库中存储g，PK【，ID【。可选地，系统中用户可选用相同的g(选择相同的g并不 会影响安全性），且所有VLR和HLR都拥有CA的公钥证书。 [0078] 下面将结合具体的处理实例描述本发明的处理过程。</p>
    <p>[0079]     参数说明：下文中出现的|X|表示X的长度；A、B、S为3个整数，且满足|B| =32，</p>
    <p>S| = 160， |A| = |S| + |B|+80。</p>
    <p>[0080]     如图4所示，根据本发明实施例的密钥协商方法包括以下步骤：</p>
    <p>[0081]     步骤401， MS根据公钥广播协议，选择出合适的VLR(公钥PKV、网络标识IDV和模</p>
    <p>数riv);</p>
    <p>[0082]     步骤402，MS随机选择NMS G [0， A](第一随机数），计算^ = ^(g^ mod");(步骤</p>
    <p>401和步骤402对应于上述步骤S302)</p>
    <p>[0083] 步骤403， MS发送IDH、 PK【J&#12316;（&#27710;r II从股II "给VLR ;(步骤403对应于上述步骤 S304)</p>
    <p>[0084]     步骤404， VLR收到MS的消息后，用SKV解密丑&#12316;II&#20175;^ II",获得&#38914;SI和x，并 产生随机数Nv G [0， B](第二随机数）和TMSI ; [0085]     步骤405 ， VLR发送&#163;^ (/AflS/) , IDV给HLR ;</p>
    <p>[0086] 步骤406， HLR收到VLR的消息后，根据IDV，找到与VLR之间的共享密钥KHV，解密 &#163;^ (/MS7),获得MSI，根据mSI确定与MS之间的共享密钥K，然后产生m个认证向量组</p>
    <p>AV(1，2， . &#8226; &#8226; ， m) ， (AV(i) = RAND   XRES   CK | IK|AUTN);</p>
    <p>[0087]     步骤407， HLR将加密后的m个认证向量组S^ G^(l,二…，m))发送给VLR ;</p>
    <p>[0088]     步骤408， VLR收到HLR的消息后，利用共享密钥K肌解密&amp;&#20874;G^(1A…，附)），获得多</p>
    <p>个认证向量组，然后选一认证向量组；</p>
    <p>[0089] 步骤409， VLR将HLR的随机数和HLR的身份令牌RAND | |AUTN以及 Ex, (Nv| I TMSI I I MSI) &#8212;起发送给MS，其中x'为x的低128bit s，具体的加密方法可以是 异或运算（可以减少运算量，保证系统效率）；（步骤404和步骤409对应于上述步骤S306) [0090] 步骤410， MS利用x还原IMSI， TMSI和Ny，如果收到的IMSI与自己发送的一致， 则保存TMSI以备下次认证时使用，随后MS根据公式（2)进行计算，构造中间变量y : [0091]     Y = N【+NvXSK【 公式（2);</p>
    <p>[0092] 此外，在步骤S410中，还需要判断SQN是否在正确范围内，以及判断MAC的正确 性；</p>
    <p>[0093] 步骤411，MS向VLR发送消息^(Avr威)(""/ ||力，具体的加密方法可以是异或运 算；</p>
    <p>[0094] 步骤412， VLR利用Nv和TMSI还原y和IMSI，若IMSI与消息(1)中包含的MSI 一致，则判断下面的公式（3)是否成立：</p>
    <p>[0095] &lt;formula&gt;formula see original document page 10&lt;/formula&gt;公式（3)</p>
    <p>[0096]      如公式（3)不成立，则中止处理过程；</p>
    <p>[0097]     步骤413，如果公式（3)成立，MS通过认证，MS计算CK和IK，这样MS和VLR就可以用CK和IK作为数据加密密钥和完整性密钥进行通信。（步骤410至步骤413对应于上 述步骤S308)</p>
    <p>[0098] 并且，在首次认证通过后，MS可利用TMSI替代MSI，以进一步提高系统的安全性； 之后VLR再产生TMSI'，该TMSI'可用于对MS进行为下次认证，在下次MS进行认证时，MS 就可以用TMSI'代替原有的TMSI。</p>
    <p>[0099] 此外，在步骤404中，MS通过公钥广播协议，可获得合法VLR的参数信息（公钥 PV网络标识IDv和模数nv)，VLR的身份也得到了认证，这样就可以解决伪基站攻击。步骤 412中，对i/[g《尸尺肌e +/MS/ + /D&#8222;)&#12316;mod"]^;c的验证，实际上就是通过证书颁</p>
    <p>发中心CA的公钥e来认证MS的合法性。</p>
    <p>[0100] 通过上述处理可以看出，用户的身份信息IMSI和TMSI等都是以加密方式传输的 (例如在步骤403、405、409、411等步骤中），增强了用户身份信息的机密性，有效防止了用 户身份的泄漏和针对具体用户的DoS攻击。并且，在根据本发明的密钥协商处理过程中，认 证消息传递次数并未增加，仅仅轻微增加了加解密和异或的运算量，并且上述处理中通过 采用共享密钥加密和异或运算来尽可能减少运算量，从而保证系统的效率不受影响。 [0101] 系统实施例</p>
    <p>[0102] 在本实施例中，提供了一种身份认证和密钥协商系统。如图5所示，根据本实施例 的身份认证和密钥协商系统包括CA 10、 HLR20、多个VLR 30、以及隶属于HLR 20的MS 40 的系统，其中，CA IO用于为HLR 20、多个VLR 30、以及MS 40颁发公钥和私钥。 [0103] 具体地，MS 40用于根据公钥广播协议从多个VLR 30中选择一个VLR 30，并随机 选择第一随机数；利用选择的VLR 30的公钥对MS 40的国际移动用户识别码即IMSI进行 第一加密，并将MS 40的公钥、HLR 20的标识、第一随机数、以及第一加密的IMSI发送给选 择的VLR 30，以及利用MS 40的私钥、第一随机数、选择的VLR 30返回的第二随机数构造中 间变量；</p>
    <p>[0104]     多个VLR 30中的每个VLR 30，用于在其被MS 40选择的情况下，利用其私钥对来 自MS 40的第一加密后的IMSI进行解密得到IMSI，利用该所在VLR 30与HLR 20的共享密 钥对解密的MSI进行第二加密，将第二加密后的IMSI发送至HLR 20，并将生成的第二随机 数发送至MS 40，以及根据MS 40生成的中间变量对MS进行认证； [0105]     HLR 20用于利用共享密钥对加密的IMSI进行解密。</p>
    <p>[0106] 图5进一步示出了 HLR 20、VLR 30、MS 40的具体结构。如图5所示，MS 40包括： 选择模块42，用于根据公钥广播协议从多个VLR 30中选择一个VLR 30，并随机选择第一随 机数；获取模块44，用于获取所选的VLR的公钥；第一加密模块46，用于利用选择的VLR 30 的公钥对MSI进行第一加密；第一发送模块48，用于将MS 40的公钥、HLR 20的标识、第 一随机数、以及第一加密的&#38914;SI发送给所选的VLR 30 ;构造模块49，用于利用MS 40的私 钥、第一随机数、选择的VLR 30返回的第二随机数构造中间变量。</p>
    <p>[0107] VLR 30包括：第一解密模块32，用于利用其所在的VLR 30的私钥对第一加密后的 MSI进行解密得到IMSI ;第二加密模块34，用于利用其所在的VLR 30与HLR 20的共享密 钥对解密的IMSI进行第二加密；第二发送模块36，用于将第二加密模块34加密后的IMSI 发送至HLR ;生成模块38，用于生成第二随机数，并将第二随机数发送至MS 40 (具体地，可 以发送至MS的构造模块49);认证模块39，用于根据MS 40的构造模块49生成的中间变量对MS进行认证；</p>
    <p>[0108] HLR 20包括：第二解密模块22，用于利用共享密钥对来自第二发送模块36的加密 的IMSI进行解密。</p>
    <p>[0109]     该系统中各个实体间的交互过程可以参见图4，这里不再重复。</p>
    <p>[0110]     综上所述，借助于本发明的技术方案，通过引入可信的CA来对MS、HLR、VLR分配公</p>
    <p>钥和私钥，实现了基于自验证公钥的密钥交互方法，能够有效解决相关技术中IMSI和TMSI</p>
    <p>明文传输所带来的用户身份和位置信息被泄漏的安全隐患，并且解决了由于缺乏对VLR的</p>
    <p>认证而导致容易被伪基站或中间人攻击的问题，本发明增加了少量加解密和异或的运算</p>
    <p>量，有效保证了 IMSI和TMSI传输的安全性，并且能够保证系统的效率不受影响。</p>
    <p>[0111] 以上所述仅为本发明的优选实施例而已，并不用于限制本发明，对于本领域的技</p>
    <p>术人员来说，本发明可以有各种更改和变化。凡在本发明的精神和原则之内，所作的任何修</p>
    <p>改、等同替换、改进等，均应包含在本发明的保护范围之内。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101969638A?cl=zh">CN101969638A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年9月30日</td><td class="patent-data-table-td patent-date-value">2011年2月9日</td><td class="patent-data-table-td ">中国科学院软件研究所</td><td class="patent-data-table-td ">一种移动通信中对imsi进行保护的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101969638B?cl=zh">CN101969638B</a></td><td class="patent-data-table-td patent-date-value">2010年9月30日</td><td class="patent-data-table-td patent-date-value">2013年8月14日</td><td class="patent-data-table-td ">中国科学院软件研究所</td><td class="patent-data-table-td ">一种移动通信中对imsi进行保护的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102036238A?cl=zh">CN102036238A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年12月27日</td><td class="patent-data-table-td patent-date-value">2011年4月27日</td><td class="patent-data-table-td ">中国科学院软件研究所</td><td class="patent-data-table-td ">一种基于公钥实现用户与网络认证和密钥分发的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102036238B?cl=zh">CN102036238B</a></td><td class="patent-data-table-td patent-date-value">2010年12月27日</td><td class="patent-data-table-td patent-date-value">2013年12月11日</td><td class="patent-data-table-td ">中国科学院软件研究所</td><td class="patent-data-table-td ">一种基于公钥实现用户与网络认证和密钥分发的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102752269A?cl=zh">CN102752269A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年4月21日</td><td class="patent-data-table-td patent-date-value">2012年10月24日</td><td class="patent-data-table-td ">中国移动通信集团广东有限公司</td><td class="patent-data-table-td ">基于云计算的身份认证的方法、系统及云端服务器</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102752269B?cl=zh">CN102752269B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年4月21日</td><td class="patent-data-table-td patent-date-value">2015年10月7日</td><td class="patent-data-table-td ">中国移动通信集团广东有限公司</td><td class="patent-data-table-td ">基于云计算的身份认证的方法、系统及云端服务器</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/US8639929">US8639929</a></td><td class="patent-data-table-td patent-date-value">2012年12月28日</td><td class="patent-data-table-td patent-date-value">2014年1月28日</td><td class="patent-data-table-td ">Huawei Technologies Co., Ltd.</td><td class="patent-data-table-td ">Method, device and system for authenticating gateway, node and server</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2011140924A1?cl=zh">WO2011140924A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年4月28日</td><td class="patent-data-table-td patent-date-value">2011年11月17日</td><td class="patent-data-table-td ">Huawei Technologies Co., Ltd.</td><td class="patent-data-table-td ">一种网关、节点和服务器进行鉴权的方法、装置及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/WO2012024872A1?cl=zh">WO2012024872A1</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年12月10日</td><td class="patent-data-table-td patent-date-value">2012年3月1日</td><td class="patent-data-table-td ">Zte Corporation</td><td class="patent-data-table-td ">移动互联网加密通讯的方法、系统及相关装置</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=P4l-BwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0009080000">H04L9/08</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=P4l-BwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0009320000">H04L9/32</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2010年6月16日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2010年9月1日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年7月4日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Granted</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/935bac41e198d7543353/CN101741555A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E5%92%8C%E5%AF%86%E9%92%A5%E5%8D%8F%E5%95%86%E6%96%B9%E6%B3%95%E5%8F%8A%E7%B3%BB.pdf?id=P4l-BwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U2WjI9nVrWT2jEEa0N3yYelaJs-bw"},"sample_url":"https://www.google.com/patents/reader?id=P4l-BwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>