<!DOCTYPE html><html><head><title>专利 CN102319482A - 一种功能性电刺激模糊控制方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_5115ea495017d9115e613207d3810e5a/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_5115ea495017d9115e613207d3810e5a__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种功能性电刺激模糊控制方法"><meta name="DC.contributor" content="万柏坤" scheme="inventor"><meta name="DC.contributor" content="徐瑞" scheme="inventor"><meta name="DC.contributor" content="明东" scheme="inventor"><meta name="DC.contributor" content="王璐" scheme="inventor"><meta name="DC.contributor" content="綦宏志" scheme="inventor"><meta name="DC.contributor" content="邱爽" scheme="inventor"><meta name="DC.contributor" content="天津大学" scheme="assignee"><meta name="DC.date" content="2011-5-20" scheme="dateSubmitted"><meta name="DC.description" content="本发明公开了一种功能性电刺激模糊控制方法，涉及残疾人康复医疗器械技术领域，多信道采集表面肌电信号；高通滤波器进行滤波处理，滤除电极滑动所引起的低频噪声；通过快速独立分量分析进行滤波处理，滤除工频干扰；对第二滤波后表面肌电信号进行时域分析，获取均方根；将输出的均方根矩阵值与期望的均方根矩阵值之间的误差以及误差变化率作为模糊控制器的输入，将刺激电流强度精确量作为输出；将误差以及误差变化率按适当比例转换到论域的数值，确定隶属度函数；运用控制规则和隶属度函数对误差以及误差变化率进行推论处理，而得到刺激电流强度模糊量；进行反模糊化处理，获取刺激电流强度精确量。能够有效地提高FES系统的准确性和稳定性。"><meta name="DC.date" content="2012-1-18"><meta name="citation_patent_publication_number" content="CN:102319482:A"><meta name="citation_patent_application_number" content="CN:201110132829"><link rel="canonical" href="https://www.google.com/patents/CN102319482A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN102319482A?cl=zh"/><meta name="title" content="专利 CN102319482A - 一种功能性电刺激模糊控制方法"/><meta name="description" content="本发明公开了一种功能性电刺激模糊控制方法，涉及残疾人康复医疗器械技术领域，多信道采集表面肌电信号；高通滤波器进行滤波处理，滤除电极滑动所引起的低频噪声；通过快速独立分量分析进行滤波处理，滤除工频干扰；对第二滤波后表面肌电信号进行时域分析，获取均方根；将输出的均方根矩阵值与期望的均方根矩阵值之间的误差以及误差变化率作为模糊控制器的输入，将刺激电流强度精确量作为输出；将误差以及误差变化率按适当比例转换到论域的数值，确定隶属度函数；运用控制规则和隶属度函数对误差以及误差变化率进行推论处理，而得到刺激电流强度模糊量；进行反模糊化处理，获取刺激电流强度精确量。能够有效地提高FES系统的准确性和稳定性。"/><meta property="og:title" content="专利 CN102319482A - 一种功能性电刺激模糊控制方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN102319482A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN102319482A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=vtWEBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN102319482A&amp;usg=AFQjCNFLegLIyUXoAC-gzuKDMes06F-bnw" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/e1973af07dfdcd91dc34/CN102319482A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/e1973af07dfdcd91dc34/CN102319482A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN102319482A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN102319482A?cl=en&amp;hl=zh-CN"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN102319482A?cl=zh" style="display:none"><span itemprop="description">本发明公开了一种功能性电刺激模糊控制方法，涉及残疾人康复医疗器械技术领域，多信道采集表面肌电信号；高通滤波器进行滤波处理，滤除电极滑动所引起的低频噪声；通过快速独立分量分析进行滤波处理，滤除工频干扰；...</span><span itemprop="url">https://www.google.com/patents/CN102319482A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN102319482A - 一种功能性电刺激模糊控制方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN102319482A - 一种功能性电刺激模糊控制方法" title="专利 CN102319482A - 一种功能性电刺激模糊控制方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN102319482 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201110132829</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2012年1月18日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2011年5月20日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2011年5月20日</td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201110132829.3, </span><span class="patent-bibdata-value">CN 102319482 A, </span><span class="patent-bibdata-value">CN 102319482A, </span><span class="patent-bibdata-value">CN 201110132829, </span><span class="patent-bibdata-value">CN-A-102319482, </span><span class="patent-bibdata-value">CN102319482 A, </span><span class="patent-bibdata-value">CN102319482A, </span><span class="patent-bibdata-value">CN201110132829, </span><span class="patent-bibdata-value">CN201110132829.3</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E4%B8%87%E6%9F%8F%E5%9D%A4%22">万柏坤</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%BE%90%E7%91%9E%22">徐瑞</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%98%8E%E4%B8%9C%22">明东</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%8E%8B%E7%92%90%22">王璐</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%B6%A6%E5%AE%8F%E5%BF%97%22">綦宏志</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%82%B1%E7%88%BD%22">邱爽</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E5%A4%A9%E6%B4%A5%E5%A4%A7%E5%AD%A6%22">天津大学</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102319482A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102319482A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102319482A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (3),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (1),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=vtWEBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201110132829&amp;usg=AFQjCNHItM3w9y8Nz7s7tBaZk4JMY_5T3A"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=vtWEBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D102319482A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNEOnhmXUf9Xwu8E9bvZT6i3VGWOzQ"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT110140801" lang="ZH" load-source="patent-office">一种功能性电刺激模糊控制方法</invention-title>
      </span><br><span class="patent-number">CN 102319482 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA92370701" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明公开了一种功能性电刺激模糊控制方法，涉及残疾人康复医疗器械技术领域，多信道采集表面肌电信号；高通滤波器进行滤波处理，滤除电极滑动所引起的低频噪声；通过快速独立分量分析进行滤波处理，滤除工频干扰；对第二滤波后表面肌电信号进行时域分析，获取均方根；将输出的均方根矩阵值与期望的均方根矩阵值之间的误差以及误差变化率作为模糊控制器的输入，将刺激电流强度精确量作为输出；将误差以及误差变化率按适当比例转换到论域的数值，确定隶属度函数；运用控制规则和隶属度函数对误差以及误差变化率进行推论处理，而得到刺激电流强度模糊量；进行反模糊化处理，获取刺激电流强度精确量。能够有效地提高FES系统的准确性和稳定性。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(9)</span></span></div><div class="patent-text"><div mxw-id="PCLM39638870" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.	一种功能性电刺激模糊控制方法，其特征在于，所述方法包括以下步骤：(1)通过多信道采集人体行走过程中下肢股直肌、股二头肌、腓肠肌和胫前肌处的表面肌电信号；(2)通过高通滤波器对所述表面肌电信号进行滤波处理，滤除电极滑动所引起的低频噪声，获取第一滤波后表面肌电信号；(3)通过快速独立分量分析对所述第一滤波后表面肌电信号进行滤波处理，滤除工频干扰，获取第二滤波后表面肌电信号；(4)对所述第二滤波后表面肌电信号进行时域分析，获取所述第二滤波后表面肌电信号中的均方根；(5)根据所述均方根获取均方根矩阵值与期望的均方根矩阵值之间的误差以及误差变化率，定义误差的量化论域、误差变化率的量化论域、刺激电流强度的量化论域、模糊控制器的量化因子和模糊控制器的比例因子，将所述误差以及所述误差变化率作为模糊控制器的输入，将刺激电流强度精确量作为所述模糊控制器的输出；(6)将误差以及误差变化率按照计算比例转换到论域的数值，确定隶属度函数；(7)确定控制规则，运用所述控制规则和所述隶属度函数，对所述误差以及所述误差变化率进行推论处理，得到刺激电流强度模糊量；(8)对所述刺激电流强度模糊量进行反模糊化处理，获取所述刺激电流强度精确量。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.根据权利要求1所述的一种功能性电刺激模糊控制方法，其特征在于，步骤（3)中的所述快速独立分量分析具体为：<div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AC00021.png"> <img id="icf0001" file="CN102319482AC00021.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AC00021.png" class="patent-full-image" alt="Figure CN102319482AC00021"> </a> </div>令t = 0，初始化权值向量W(O)；对分离矩阵进行调整:w(t+l) = E{Xg(wT(t)X)}-E{g' (wT(t)X)}w(t)；归一处理:w(n+l) = w(n+l)/ w(n+l) | | ；判断所述快速独立分量分析是否收敛，如果是，重新对分离矩阵进行调整，直到满足最大迭代次数；如果否，获取一个独立分量卩.=^. =M^X，依次迭代出权值向量&lt;，w2T, AwnT,构成所述分离矩阵的行向量。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.根据权利要求1所述的一种功能性电刺激模糊控制方法，其特征在于，步骤（4)中所述对所述第二滤波后表面肌电信号进行时域分析，获取所述第二滤波后表面肌电信号中的均方根具体为：均方根在连续域定义如下：<div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AC00022.png"> <img id="icf0002" file="CN102319482AC00022.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AC00022.png" class="patent-full-image" alt="Figure CN102319482AC00022"> </a> </div>其中：s(t)为肌电信号；T为观测时间长度；、为观测起始时间；均方根在离散域定义如下：其中：Xi为S(t)的采样值；N为观测点数；根据Parseval关系式，可将均方根和频域中的功率谱密度联系起来，<div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AC00031.png"> <img id="icf0003" file="CN102319482AC00031.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AC00031.png" class="patent-full-image" alt="Figure CN102319482AC00031"> </a> </div>其中=PSDi为功率谱密度中第i个成分；K为功率谱密度成份的数量； 对均方根进行标准化，其中j表示信道序号：<div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AC00032.png"> <img id="icf0004" file="CN102319482AC00032.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AC00032.png" class="patent-full-image" alt="Figure CN102319482AC00032"> </a> </div>^其中j为第二滤波后表面肌电信号标准化后的RMS值；RMS^silft, j为第二滤波后表面肌电信号未标准化前的RMS值；Mj为的均值；Sj为RMS^afcj标准差。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.根据权利要求1所述的一种功能性电刺激模糊控制方法，其特征在于，所述模糊控制器具体为二维模糊控制器。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.根据权利要求1所述的一种功能性电刺激模糊控制方法，其特征在于， 所述误差的量化论域为X = {-n, -n+1, L 0，L，n-1, η}；所述误差变化率的量化论域为\ = {-m, -m+1, L 0，L，m_l，m}； 所述刺激电流强度的量化论域为Y = {_k，-k+1，L 0，L，k-1，k}； 所述模糊控制的量化因子为Ke = n/Xe ；Kec = m/Xec ； 所述模糊控制器的比例因子为Ku = k/Yu。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.根据权利要求1或5所述的一种功能性电刺激模糊控制方法，其特征在于，所述方法还包括：将所述误差的量化论域、所述误差变化率的量化论域、所述刺激电流强度的量化论域、 所述模糊控制器的量化因子和所述模糊控制器的比例因子保存在知识库中。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.根据权利要求1所述的一种功能性电刺激模糊控制方法，其特征在于，所述隶属度函数由三角形函数和Z函数组成。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.根据权利要求1所述的一种功能性电刺激模糊控制方法，其特征在于，所述控制规则为：<div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AC00033.png"> <img id="icf0005" file="CN102319482AC00033.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AC00033.png" class="patent-full-image" alt="Figure CN102319482AC00033"> </a> </div>其中，E1 = (EiliL ani), EC1 = (bnL bmi), U1 = (CliL cti) (i = 1, L ρ)。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.根据权利要求1所述的一种功能性电刺激模糊控制方法，其特征在于，步骤（8)中的所述对所述刺激电流强度模糊量进行反模糊化处理，获取所述刺激电流强度精确量具体为：<div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AC00034.png"> <img id="icf0006" file="CN102319482AC00034.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AC00034.png" class="patent-full-image" alt="Figure CN102319482AC00034"> </a> </div>其中，η为刺激电流集U的分割等级数，Ui'为刺激电流离散论域的点，μ (Ui')为相应Ui处的隶属函数值； 实际的电流变化值为 Δ Ui = u ‘ ku ；所述刺激电流强度精确量为 u(k) = u(k-l) + Au(k)。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES45132248" lang="ZH" load-source="patent-office" class="description">
    <p>一种功能性电刺激模糊控制方法</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及残疾人康复医疗器械技术领域，特别涉及一种功能性电刺激模糊控制方法。</p>
    <p>背景技术</p>
    <p>[0002]	FES (Functional Electrical Stimulation，功能性电刺激）是通过电流脉冲序列来刺激肢体运动肌群及其外周神经，有效地恢复或重建截瘫患者的部分运动功能的技术。 据统计，由于脊髓再生能力微弱，针对脊髓损伤瘫痪患者，目前尚未有可直接修复损伤的有效医治方法，实施功能康复训练是一有效的措施。脊髓损伤瘫痪患者人数逐年增多，功能康复训练是亟待需求的技术。20世纪60年代，Liberson首次成功地利用电刺激腓神经矫正了偏瘫患者足下垂的步态，开创了功能性电刺激用于运动和感觉功能康复治疗的新途径。目前，FES已经成为了恢复或重建截瘫患者的部分运动功能，是重要的康复治疗手段。然而，如何精密控制FES的触发时序和脉冲电流强度以保证电刺激作用效果能准确完成预定的功能动作仍是FES的技术关键。据统计，目前FES触发控制的方式研究尚少，而且根据作用效果与预定动作偏差，用闭环控制来自动调整FES刺激强度和时序参数，从而大大提高了 FES 系统的准确性和稳定性，但是现在有效的控制方法仍然在探索之中。</p>
    <p>发明内容</p>
    <p>[0003]	为了能够有效地提高FES系统的准确性和稳定性，并获得可观的社会效益和经济效益，本发明提供了一种功能性电刺激模糊控制方法，详见下文描述：</p>
    <p>[0004]	一种功能性电刺激模糊控制方法，所述方法包括以下步骤：</p>
    <p>[0005]	(1)通过多信道采集人体行走过程中下肢股直肌、股二头肌、腓肠肌和胫前肌处的表面肌电信号；</p>
    <p>[0006]	(2)通过高通滤波器对所述表面肌电信号进行滤波处理，滤除电极滑动所引起的低频噪声，获取第一滤波后表面肌电信号；</p>
    <p>[0007]	(3)通过快速独立分量分析对所述第一滤波后表面肌电信号进行滤波处理，滤除工频干扰，获取第二滤波后表面肌电信号；</p>
    <p>[0008]	(4)对所述第二滤波后表面肌电信号进行时域分析，获取所述第二滤波后表面肌电信号中的均方根；</p>
    <p>[0009]	(5)根据所述均方根获取均方根矩阵值与期望的均方根矩阵值的期望之间的误差以及误差变化率，定义误差的量化论域、误差变化率的量化论域、刺激电流强度的量化论域、模糊控制器的量化因子和模糊控制器的比例因子，将所述误差以及所述误差变化率作为模糊控制器的输入，将刺激电流强度精确量作为所述模糊控制器的输出，定义了模糊变量；</p>
    <p>[0010]	(6)将误差以及误差变化率按照适当计算比例转装换到论域的数值，确定隶属度函数；。[0011]	(7)确定控制规则，运用所述控制规则和所述隶属度函数即模糊逻辑和模糊推论， 对所述误差以及所述误差变化率信号进行推论处理，而得到刺激电流强度模糊量；</p>
    <p>[0012]	(8)对所述刺激电流强度模糊量进行反模糊化处理，获取所述刺激电流强度精确量。</p>
    <p>[0013]	步骤（3)中的所述快速独立分量分析具体为：</p>
    <p>[0014]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00061.png"> <img id="idf0001" file="CN102319482AD00061.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00061.png" class="patent-full-image" alt="Figure CN102319482AD00061"> </a> </div>
    <p>[0015]	w' = w+/ I I w+1</p>
    <p>[0016]	令t = 0，初始化权值向量w(0)；</p>
    <p>[0017]对分离矩阵进行调整：w(t+l)	=E{Xg(wT(t)X)}-E{g' (wT(t)X)}w(t)；</p>
    <p>[0018]归一处理:w(n+l)	= w(n+l)/ w(n+l) | | ；</p>
    <p>[0019]	判断所述快速独立分量分析是否收敛，如果是，重新执行对分离矩阵进行调整，直到满足最大迭代次数；如果否，获取一个独立分量％ =^. =M^X，依次迭代出权值向量《Λ W2T, Λ WnT，构成所述分离矩阵W的行向量。</p>
    <p>[0020]	步骤（4)中所述对所述第二滤波后表面肌电信号进行时域分析，获取所述第二滤波后表面肌电信号中的均方根具体为：</p>
    <p>[0021 ] 均方根在连续域定义如下：</p>
    <p>[0022]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00062.png"> <img id="idf0002" file="CN102319482AD00062.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00062.png" class="patent-full-image" alt="Figure CN102319482AD00062"> </a> </div>
    <p>[0023]	其中：S(t)为肌电信号；T为观测时间长度；tQ为观测起始时间；</p>
    <p>[0024]	均方根在离散域定义如下：</p>
    <p>[0025]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00063.png"> <img id="idf0003" file="CN102319482AD00063.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00063.png" class="patent-full-image" alt="Figure CN102319482AD00063"> </a> </div>
    <p>[0026]	其中：Xi为S(t)的采样值；N为观测点数；</p>
    <p>[0027]	根据Parseval关系式，可将均方根和频域中的功率谱密度联系起来，</p>
    <p>[0028]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00064.png"> <img id="idf0004" file="CN102319482AD00064.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00064.png" class="patent-full-image" alt="Figure CN102319482AD00064"> </a> </div>
    <p>[0029]	其中：PSDi为功率谱密度中第i个成分；K为功率谱密度成份的数量；</p>
    <p>[0030]	对均方根进行标准化，其中j表示信道序号：</p>
    <p>[0031]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00065.png"> <img id="idf0005" file="CN102319482AD00065.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00065.png" class="patent-full-image" alt="Figure CN102319482AD00065"> </a> </div>
    <p>[0032]	其中：RMS&#171;化,j为第二滤波后的表面肌电信号标准化后的RMS值；RMS未标靴,j为第二滤波后的表面肌电信号未标准化前的RMS值；Mj为RMS^afcj的均值；Sj为RMS</p>
    <p>j的标准差。</p>
    <p>[0033]	所述模糊控制器具体为二维模糊控制器。</p>
    <p>[0034]	所述误差的量化论域为X = {-n, -n+1, L 0，L，n_l，η}；[0035]	所述误差变化率的量化论域为X1 = {-m, -m+1, L 0，L，m_l，m}；</p>
    <p>[0036]	所述刺激电流强度的量化论域为Y = {_k，-k+1，L 0，L，k-1，k}；</p>
    <p>[0037]	所述模糊控制的量化因子为Ke = n/Xe ；Kec = m/Xec ；</p>
    <p>[0038]	所述模糊控制器的比例因子为Ku = k/Yu。</p>
    <p>[0039]	所述方法还包括：</p>
    <p>[0040]	将所述误差的量化论域、所述误差变化率的量化论域、所述刺激电流强度的量化论域、所述模糊控制器的量化因子和所述模糊控制器的比例因子保存在知识库中。</p>
    <p>[0041]	所述隶属度函数由三角形函数和Z函数组成。</p>
    <p>[0042]	所述控制规则为：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00071.png"> <img id="idf0006" file="CN102319482AD00071.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00071.png" class="patent-full-image" alt="Figure CN102319482AD00071"> </a> </div>
    <p>[0044]	R= (EiX CEi)T1X Ci</p>
    <p>[0045]其中，E1	= (EiliL ani)，EC1 = (bnL bmi)，U1 = (CliL cti) (i = 1，L ρ)。</p>
    <p>[0046]	步骤（8)中的所述对所述刺激电流强度模糊量进行反模糊化处理，获取所述刺激电流强度精确量具体为：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00072.png"> <img id="idf0007" file="CN102319482AD00072.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00072.png" class="patent-full-image" alt="Figure CN102319482AD00072"> </a> </div>
    <p>[0048]	其中，η为刺激电流集U的分割等级数，这里取η = 7，Ui'为刺激电流离散论域的点，μ (u/ )为相应u/处的隶属函数值；。</p>
    <p>[0049]	实际的电流变化值为</p>
    <p>[0050]	Δ Ui = U ‘ ku ；</p>
    <p>[0051]	所述刺激电流强度精确量刺激器输出刺激电流应为</p>
    <p>[0052]	u(k) = u(k-l) + Au(k)。</p>
    <p>[0053]	本发明提供的技术方案的有益效果是：</p>
    <p>[0054]	本发明提供了一种功能性电刺激模糊控制方法，本发明提出了利用表面肌电直接控制功能性电刺激的的电流水平强度新方法，本发明的最终目的是通过采集下肢表面肌电信号并分析不同肌肉活动情况下的肌电信号的变化特征和规律，采用模糊控制器输出电流，控制腿部肌肉，实现行走模式，实现其自动化控制的目的并提高控制效率；通过多信道采集人体行走过程中下肢股直肌、股二头肌、腓肠肌和胫前肌处的表面肌电信号，运用高通滤波器有效地抑制了因电极滑动所引起的低频噪声；以快速独立分量分析滤波方法降低工频干扰，在保留表面肌电信号有用信息方面有很好的效果；提取各关键模态内表面肌电信号的均方根并进行分析，发现随着关键模态的转换，均方根有明显的变化；利用均方根输入模糊控制器，输出电流控制肌肉，即通过获取躯干的表面肌电信号（surface electromyography, sEMG)，然后将其映射为FES的刺激信号，实现瘫痪患者的行走；本发明中的控制参数选择来自受试者肌肉的信息，而非手动产生的触发信号，受试者可以根据自己的步行状态调整功能性电刺激，从而回复部分运动功能，不需要他人协助，满足了实际应用中的多种需要；并且能够有效地提高FES系统的准确性和稳定性，并获得可观的社会效益和经济效益。 附图说明</p>
    <p>[0055]	图1为本发明提供的一种功能性电刺激模糊控制方法的流程图；</p>
    <p>[0056]	图2为本发明提供的行走周期划分示意图；</p>
    <p>[0057]	图3为本发明提供的快速独立分量分析滤除高频干扰后单周期八通道表面肌电信号时域分析示意图；</p>
    <p>[0058]	图4-1为本发明提供的右腿股直肌与左腿股直肌肌电在一个周期中RMS变化的示意图；</p>
    <p>[0059]	图4-2为本发明提供的右腿股二头肌与左腿股二头肌肌电在一个周期中RMS变化的示意图；</p>
    <p>[0060]	图4-3为本发明提供的右腿腓肠肌与左腿腓肠肌肌电在一个周期中RMS变化的示意图；</p>
    <p>[0061]	图4-4为本发明提供的右腿胫前肌与左腿胫前肌肌电在一个周期中RMS变化的示意图；</p>
    <p>[0062]	图5为本发明提供的功能性电刺激模糊控制的结构示意图；</p>
    <p>[0063]	图6为本发明提供的隶属度函数的示意图。</p>
    <p>具体实施方式</p>
    <p>[0064]	为使本发明的目的、技术方案和优点更加清楚，下面将结合附图对本发明实施方式作进一步地详细描述。</p>
    <p>[0065]	为了能够有效地提高FES系统的准确性和稳定性，并获得可观的社会效益和经济效益，参见图1和图5，本发明实施例提供了一种功能性电刺激模糊控制方法及模糊控制器，详见下文描述：</p>
    <p>[0066]	表面肌电（sEMG)信号是一种从人体骨骼肌表面通过电极记录下来的神经、肌肉系统活动时发放的复杂的生物电信号，是电极所接触到的许多运动单元发放的动作电位的总和。非损伤状态下它能实时反映神经和肌肉的功能状态。表面肌电信号的分析研究是肌电应用的前提。近年来，随着科学技术的发展，国内外学者对表面肌电信号的研究也逐渐深入，使得表面肌电信号不仅在临床医学、运动医学、康复医学及体育运动等领域被广泛应用，而且还成为人工假肢和神经假体的理想控制信号。如通过对某些动作模态的表面肌电特征做模式分类来驱动假肢。在运动医学中，国内外研究者已将表面肌电信号特征参数的变化作为肌肉疲劳的指标。在功能性电刺激研究中，人们正尝试利用表面肌电信号来控制电刺激器完成各种动作。表面肌电信号的研究，特别是如何提取表面肌电信号中的关键特征，实现对电刺激器和多自由度假肢控制，已成为康复医学研究的热点问题，而对它们的精确控制主要取决于表面肌电信号的特征提取与控制方法，因此表面肌电信号的特征提取与利用特征实现控制的研究具有重要的理论意义与实际应用价值。</p>
    <p>[0067]	模糊控制是一种通过模糊逻辑和近似推理的方法，把人的经验形式化和模型化， 变成计算机可以接受的控制模型，让计算机代替人来进行实时地控制被控对象的高级策略和新颖的技术方法，可有效地提高控制算法的可控性、适应性和合理性，尤其是针对复杂而用数学方程难于建模且有丰富手控经验的对象具有奇特的优势，而人体肌肉的复杂性和时变性操作环境使其建立数学模型尤为困难，模糊控制器为FES的精密控制提供了新方案。 模糊控制器核心技术就是确定模糊控制器的结构、所采用的模糊规则、合成推理算法以及模糊决策的方法等因素。本发明实施例提取表面肌电信号特征参数，输入模糊控制，实现对 FES的精密控制。</p>
    <p>[0068]	众所周知，人体自由行走时下肢动作具有周期性。参见图2，一般可将人体行走周期划分为以下四个关键模态：左腿在前的双腿跨立状态，业内记为=Left double Stance(L-DS)；左腿站立、右腿摆动状态，本发明实施例中记为：Left single stance (L-SS)；右腿在前的双腿跨立状态，业内记为：Right double stance (R-DS)；右腿站立、左腿摆动状态，本发明实施例记为：Right single stance (R-SS)。在以下的行走关键模态描述中，本发明实施例将分别用L-DS、L-SS、R-DS、R-SS来标记这四种关键模态。</p>
    <p>[0069]	101 ：通过多信道采集人体行走过程中下肢股直肌、股二头肌、腓肠肌和胫前肌处的表面肌电信号；</p>
    <p>[0070]	102 ：通过高通滤波器对表面肌电信号进行滤波处理，滤除电极滑动所引起的低频噪声，获取第一滤波后表面肌电信号；</p>
    <p>[0071]	其中，表面肌电信号峰-峰（Peak to Peak)幅值范围为O-lOmv，表面肌电信号的大部分能量主要集中在500Hz以下，绝大部分能量集中在50-150Hz之间。在众多噪声中不可避免的50Hz以及由50Hz所产生的谐波、电极滑动所引起的低频噪声是本发明实施例中的主要噪声来源。</p>
    <p>[0072]	其中，通过该步骤有效地抑制了因电极滑动所引起的低频噪声，获取到第一滤波后表面肌电信号。本发明实施例中的高通滤波器采用20Hz的高通滤波器，具体实现时，可根据实际应用中的需要采用适当频率的高通滤波器，本发明实施例对此不做限制。</p>
    <p>[0073]	103 ：通过 FastICA 快速（Inckpendent Component Analysis，独立分量分析）对第一滤波后表面肌电信号进行滤波处理，滤除工频干扰，获取第二滤波后表面肌电信号；</p>
    <p>[0074]	虽然利用陷波器可将工频干扰滤除，但是不可避免地也会将表面肌电信号中有用的成分滤除。为此，本发明实施例设计将!^stICA引入表面肌电信号处理过程中，以克服工频陷波器的不足。FastICA的目的是要寻找一种线性变化将观察数据分解，并使分解出的成份在统计上有最大的独立性。</p>
    <p>[0075]	本发明实施例选择以负熵作为独立性指标的FastICA算法，这是一种基于最大熵原理的负熵估计方法，具体为：</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00091.png"> <img id="idf0008" file="CN102319482AD00091.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00091.png" class="patent-full-image" alt="Figure CN102319482AD00091"> </a> </div>
    <p>[0077]	其中，ki是正实数，是标准高斯随机变量，y具有零均值和单位方差，G是非二次函数，常见G的形式为：</p>
    <p>[0078]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00092.png"> <img id="idf0009" file="CN102319482AD00092.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00092.png" class="patent-full-image" alt="Figure CN102319482AD00092"> </a> </div>
    <p>[0079]	 [0080]	 [0081]	其中，u为输入的信号。</p>
    <p>[0082]	这里，负熵可以近似表示为：[0093]</p>
    <p>[0094]</p>
    <p>[0095]</p>
    <p>[0083]	J(y) - [E{G(y)}-E{G(v)]2	(5)</p>
    <p>[0084]	由y = wTX (y为其中一个独立分量，w为分离矩阵W的一行，X为混合矩阵，T为转置），负熵的近似函数可定义为：</p>
    <p>[0085]	Jg(W) [E{G(wTX)}-E{G(ν)]2	(6)</p>
    <p>[0086]	则!^stICA算法的问题变为：求解分离矩阵W，使分离出的估计信号y = wTX能使函数Je(W)达到最大，由Kuhn-Tucker条件转化为无限制条件的优化问题，得到目标函数：</p>
    <p>[0087]	F (w) =E {G (wTX)} +c (| | w | 2"1)	(7)</p>
    <p>[0088]	基于负熵极大的!^stICA算法的迭代过程。对于公式（7)，由牛顿法求解该目标函数，得到!^stICA的迭代式：</p>
    <p>[0089]	w+ = E {Xg (wTX)} -E {g ‘ (wTX)} w</p>
    <p>[0090]	(8)</p>
    <p>[0091]	w' = w+/ I I w+ I</p>
    <p>[0092]	迭代步骤如下：</p>
    <p>(1)令t	= 0，初始化权值向量W(O)；</p>
    <p>(2)对分离矩阵	W 进行调整:w(t+l) = E{Xg(wT(t)X)}-E{g' (wT(t)X)}w(t)；</p>
    <p>(3)归一处理:w(n+l)	= w(n+l)/ w(n+l) | | ；</p>
    <p>[0096]	(4)判断!^stICA是否收敛，如果是，转入步骤（2)继续迭代，直到满足最大迭代次数；如果否，获取一个独立分量卩.=^. =M^X，依次迭代出权值向量《Λ w2T, AwnT，构成分离矩阵W的行向量。</p>
    <p>[0097]	其中，最大迭代次数根据实际应用中的需要进行设定，具体实现时，本发明实施例对此不做限制。</p>
    <p>[0098]	参见图3，通过该图可以看出FastICA方法不仅能够有效地消除表面肌电信号中的工频干扰，而且对表面肌电信号其它频率成分造成的影响微乎其微，取得了明显的工频滤波效果。</p>
    <p>[0099]	104:对第二滤波后表面肌电信号进行时域分析，获取第二滤波后表面肌电信号中的均方根RMS ；</p>
    <p>[0100]	其中，时域分析是将表面肌电信号看作时间的函数，通过分析得到表面肌电信号的某些统计特征，例如：MAV(Mean Absolute Value，平均绝对值）、RMS(Root Mean Square, 均方根）、幅值的直方图、过零次数、均方值、三阶原点矩或四阶原点矩等。因为RMS可以用来衡量表面肌电信号的功率，以及能代表表面肌电信号的能量，有明确的物理意义，并且相对计算简单，表面肌电信号的RMS被认为是时域中最可靠的参数。</p>
    <p>[0101] RMS在连续域定义如下：</p>
    <p>[0102]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00101.png"> <img id="idf0010" file="CN102319482AD00101.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00101.png" class="patent-full-image" alt="Figure CN102319482AD00101"> </a> </div>
    <p>[0103]	其中：S(t)为肌电信号；T为观测时间长度；、为观测起始时间,</p>
    <p>[0104]	RMS在离散域定义如下：[0105]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00111.png"> <img id="idf0011" file="CN102319482AD00111.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00111.png" class="patent-full-image" alt="Figure CN102319482AD00111"> </a> </div>
    <p>[0106]	其中:Xi为S(t)的采样值；N为观测点数。</p>
    <p>[0107]	根据Parseval关系式，可将RMS和频域中的功率谱密度联系起来，因此RMS可以用来表示肌电信号的能量，如式11所示：</p>
    <p>[0108]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00112.png"> <img id="idf0012" file="CN102319482AD00112.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00112.png" class="patent-full-image" alt="Figure CN102319482AD00112"> </a> </div>
    <p>[0109]	其中=PSDi为功率谱密度中第i个成分；K为功率谱密度成份的数量。</p>
    <p>[0110]	本发明实施例中提取每个行走周期中四个模态的RMS作为特征值，假定每个关键模态的能量是变化的，是有差别的。受试者在每个行走周期中表面肌电信号会有差异，那么相应的RMS值也会有差异，为消除RMS自身变异大小和数值大小的影响，故将数据标准化。</p>
    <p>[0111]	对RMS进行标准化，其中j表示信道序号：</p>
    <p>[0112]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00113.png"> <img id="idf0013" file="CN102319482AD00113.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00113.png" class="patent-full-image" alt="Figure CN102319482AD00113"> </a> </div>
    <p>[0113]	其中：RMS&#171;化,j为第二滤波后表面肌电信号标准化后的RMS值；」为第二滤波后表面肌电信号未标准化前的RMS值；Mj为RMS未_化,j的均值；Sj为RMS^ilft, j的标准差。</p>
    <p>[0114]	参见图4-1、图4-2、图4-3和图4_4，RMS时间平移窗为矩形窗，窗长度为50ms，左腿和右腿在一个周期中RMS变化是对应的。在每一个关键模态各块肌肉的表面肌电信号都有着明显的变化趋势和强弱分别。那么对RMS这个特征值来说，在每一个关键模态中的RMS 值都会与其他关键模态内的RMS值有着差别，那么此RMS特征值就可以作为模糊控制器的输入向量。所以在每一个周期每一块肌肉在一个关键模态只有一个RMS值。本发明实施例中选择了八块肌肉，那么每一个关键模态需要8个RMS值来表征，即以：[al a2 a3 a4 a5 a6 a7 a8]来表征一个关键模态，其中Eii表示第i块肌肉对应的RMS值。</p>
    <p>[0115]	105 ：根据RMS获取RMS矩阵值与期望的RMS矩阵值之间的误差e(k)以及误差变化率ec (k)，定义误差的量化论域、误差变化率的量化论域、刺激电流强度的量化论域、模糊控制器的量化因子和模糊控制器的比例因子，将误差e(k)以及误差变化率ec(k)作为模糊控制器的输入，将刺激电流强度精确量作为模糊控制器的输出；</p>
    <p>[0116]	模糊控制器结构选择的实质是模糊控制器输入语言变量和输出语言变量的选择和模糊控制器的不同组合与扩展问题，模糊控制器结构选择是否合理，直接影响模糊控制器的性能。控制功能性电刺激时，肌肉结构比较复杂，具有非线性和时滞性，虽然对刺激电流的精度要求很精确，但并不是过于精确，而且要求控制速度和算法比较稳定，本发明实施例中优选的模糊控制器为二维模糊控制器。</p>
    <p>[0117]	由于人的特殊性，FES领域对模糊控制器的稳定性、鲁棒性和实时性要求严格，设计模糊控制器均衡稳定性和实时性时选择了二维模糊控制器，即两个输入变量分别是RMS 矩阵值与期望的RMS矩阵值之间的误差e(k)以及误差变化率ec(k)，其论域为FE= [-E，E]，FEC = [-EC，EC]，输出的刺激电流强度精确量u (k)，其论域为FU = [-U，U]。</p>
    <p>[0118]	其中，误差e(k)的量化论域为</p>
    <p>[0119]	X = {-n，-n+1，L 0，L，n-1，η}	(13)</p>
    <p>[0120]	误差变化率ec (k)的量化论域为</p>
    <p>[0121]	X1 = {-m，-m+1，L 0，L，m-1，m} ；	(14)</p>
    <p>[0122]	刺激电流强度精确量u (k)的量化论域为</p>
    <p>[0123]	U= {-k，-k+l，AO, Λ , k-1, k}	(15)</p>
    <p>[0124]	模糊控制器的量化因子和比例因子直接影响模糊分割的划分，这是模糊控制器的</p>
    <p>关键之一。</p>
    <p>[0125]	模糊控制器的量化因子分别为：</p>
    <p>[0126]	Ke = η/Χ	(16)</p>
    <p>[0127]	Kec = m/Xec	(17)</p>
    <p>[0128]	模糊控制器的比例因子为：</p>
    <p>[0129]	Ku = k/Yu	(18)</p>
    <p>[0130]	本发明实施例中以误差e(k)的论域为{-3 -2-10123}；误差变化率ec(k)的论域为{-3 -2-1012 3}，刺激电流强度精确量的论域为{-3 -2-10123}为例进行说明。通常情况下，模糊控制器的量化因子越大，产生的过激电流越大，系统稳定所需要时间越长，易引起滞后，易造成更大的过激；而模糊控制器的量化因子越小，刺激电流变化较为缓慢，稳态精度降低。而模糊控制器的量化因子ke。越大，则电流变化率较小，跟踪比较困难，模糊控制器的量化因子、越小，刺激电流变化越快，则易引起电流过激。模糊控制器的量化因子越大，对应的语言值越大。模糊控制器的比例因子相当于常规控制系统的比例增益，主要作用是加快上升时间，但是易引起超调，刺激电流过大，会加快肌肉的疲劳，甚至造成损伤。</p>
    <p>[0131]	其中，为了方便以后的计算，可以将误差e(k)的量化论域、误差变化率ec(k)的量化论域、刺激电流强度u(k)的量化论域、模糊控制的量化因子和模糊控制器的比例因子保存在知识库中，下次使用时，可以直接从知识库中调用，提高了运算速度。</p>
    <p>[0132]	106 ：将误差以及误差变化率按照计算比例转换到论域的数值，确定隶属度函数；</p>
    <p>[0133]	模糊控制的模糊语言值实质上是模糊子集，可由隶属度函数描述。参见图6，本发明实施例中采用的隶属度函数由三角形函数和Z函数组成。实际上，隶属度函数的形状对模糊化的影响不大，因为论域中每一点所对应的隶属度，可利用隶属度函数分布调节，所以最为关键的是其隶属度的分布。一般，比较陡窄的隶属度函数能使模糊控制器的灵敏度较为高；反之能使模糊控制器的灵敏度较低和平稳，所以误差较小的区域采用较陡的隶属度函数，误差较大的区域采用较为平坦的隶属度函数。</p>
    <p>[0134]	其中，计算比例根据误差与论域的取值确定。</p>
    <p>[0135]	107:确定控制规则，运用控制规则和隶属度函数，对误差以及误差变化率进行推论处理，得到刺激电流强度模糊量；</p>
    <p>[0136]	其中，模糊控制器的控制规则是模糊控制系统的核心，其设计原则是：当误差 e(k)较大时，控制量的变化应尽量使误差e(k)迅速减小；当误差e(k)较小时，除了消除误差e(k)外，还应考虑模糊控制系统的稳定性，防止不必要的超调，甚至振荡。尤其是在本发明实施例中，应防止电流过激的现象发生。在设计模糊控制器的控制规则时，还应注意到规则的完整性、相容性和干涉性等。本发明实施例中的论域是7语言值，S卩{NB正大，NM正中， NS正小，ZO零，PS负小，PM负中，PB负大}，亦是实现清晰的输入空间到定义在论域上模糊集的映射。</p>
    <p>[0137]	则可表示为{NB, NM, NS, Z0, PS, PM, PB}，采用是如下规则：</p>
    <p>[0138]	If e(k)is PB and ec(k)is NB，then Au is ZO</p>
    <p>[0139]	If e(k)is PB and ec(k)is NS，then Au is NM</p>
    <p>[0140]	即当误差e(k)为PB且ec(k)为NB时，说明误差e(k)正在迅速减小，为了防止超调过大，甚至振荡，应该使刺激电流Δ u保持不变即为Z0;若当误差e(k)为PB且ec(k)为 NS时，为了使误差e(k)减小，则刺激电流Au也应该适量减小即为匪。</p>
    <p>[0141]	模糊控制器的控制规则为：</p>
    <p>[0142]  </p>
    <p>[0143]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00131.png"> <img id="idf0014" file="CN102319482AD00131.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00131.png" class="patent-full-image" alt="Figure CN102319482AD00131"> </a> </div>
    <p>[0144]其中，E1	= (an L ani)，EC1 = (bnL bmi)，U1 = (CliL cti) (i = 1，L ρ)。</p>
    <p>[0145]	108 ：对刺激电流强度模糊量进行反模糊化处理，获取刺激电流强度精确量。</p>
    <p>[0146]	模糊控制器中模糊推理得到的是刺激电流强度的模糊量，但是要得到刺激电流强度精确量，需要对刺激电流强度模糊量进行反模糊化处理，其主要目的是根据模糊推理所得的刺激电流强度模糊量，求得最能反映刺激电流强度精确量，本发明实施例中输出模糊控制集的隶属度函数是对称的，故采用了加权平均值法，其计算公式为采用的反模糊化法是加权平均法</p>
    <p>[0147]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00132.png"> <img id="idf0015" file="CN102319482AD00132.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00132.png" class="patent-full-image" alt="Figure CN102319482AD00132"> </a> </div>
    <p>[0148]	其中，η为刺激电流集U的分割等级数，本发明实施例中以η的取值为7为例进行说明，具体实现时，本发明实施例对此不做限制。Ui'为刺激电流离散论域的点，μ (U/ ) 为相应Ui'处的隶属函数值。</p>
    <p>[0149]	实际的电流变化值为</p>
    <p>[0150]	Aui = U' ku	(22) [0151 ] 刺激器输出刺激电流强度精确量为</p>
    <p>[0152]</p>
    <div class="patent-image small-patent-image"> <a href="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00133.png"> <img id="idf0016" file="CN102319482AD00133.tif" img-content="drawing" img-format="tif" src="//patentimages.storage.googleapis.com/CN102319482A/CN102319482AD00133.png" class="patent-full-image" alt="Figure CN102319482AD00133"> </a> </div>
    <p>[0153]	综上所述，本发明实施例提供了一种功能性电刺激模糊控制方法，本发明实施例提出了利用表面肌电直接控制功能性电刺激的的电流水平强度新方法，本发明实施例的最终目的是通过采集下肢表面肌电信号并分析不同肌肉活动情况下的肌电信号的变化特征和规律，采用模糊控制器输出电流，控制腿部肌肉，实现行走模式，实现其自动化控制的目的并提高控制效率；通过多信道采集人体行走过程中下肢股直肌、股二头肌、腓肠肌和胫前肌处的表面肌电信号，运用高通滤波器有效地抑制了因电极滑动所引起的低频噪声；以快速独立分量分析滤波方法降低工频干扰，在保留表面肌电信号有用信息方面有很好的效果；提取各关键模态内表面肌电信号的均方根并进行分析，发现随着关键模态的转换，均方根有明显的变化；禾Ij用均方根输入模糊控制器，输出电流控制肌肉，即通过获取躯干的表面肌电信号，然后将其映射为FES的刺激信号，实现瘫痪患者的行走；本发明实施例中的控制参数选择来自受试者肌肉的信息，而非手动产生的触发信号，受试者可以根据自己的步行状态调整功能性电刺激，从而回复部分运动功能，不需要他人协助，满足了实际应用中的多种需要；并且能够有效地提高FES系统的准确性和稳定性，并获得可观的社会效益和经济效益。</p>
    <p>[0154]	本领域技术人员可以理解附图只是一个优选实施例的示意图，上述本发明实施例序号仅仅为了描述，不代表实施例的优劣。</p>
    <p>[0155]	以上所述仅为本发明的较佳实施例，并不用以限制本发明，凡在本发明的精神和原则之内，所作的任何修改、等同替换、改进等，均应包含在本发明的保护范围之内。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102697496A?cl=zh">CN102697496A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年6月7日</td><td class="patent-data-table-td patent-date-value">2012年10月3日</td><td class="patent-data-table-td ">天津大学</td><td class="patent-data-table-td ">一种功能性电刺激表面肌电信号的滤波方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102697496B?cl=zh">CN102697496B</a></td><td class="patent-data-table-td patent-date-value">2012年6月7日</td><td class="patent-data-table-td patent-date-value">2014年4月30日</td><td class="patent-data-table-td ">天津大学</td><td class="patent-data-table-td ">一种功能性电刺激表面肌电信号的滤波方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103076743A?cl=zh">CN103076743A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年12月28日</td><td class="patent-data-table-td patent-date-value">2013年5月1日</td><td class="patent-data-table-td ">西安建筑科技大学</td><td class="patent-data-table-td ">卷取机的张力模糊pid控制方法</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=vtWEBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=A61N0001360000">A61N1/36</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2012年1月18日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年3月14日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2014年6月11日</td><td class="patent-data-table-td ">C12</td><td class="patent-data-table-td ">Rejection of an application for a patent</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/e1973af07dfdcd91dc34/CN102319482A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_5115ea495017d9115e613207d3810e5a.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E5%8A%9F%E8%83%BD%E6%80%A7%E7%94%B5%E5%88%BA%E6%BF%80%E6%A8%A1%E7%B3%8A%E6%8E%A7%E5%88%B6%E6%96%B9.pdf?id=vtWEBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U39EIqCaBx69nYdKcpx4d6Ja-097w"},"sample_url":"https://www.google.com/patents/reader?id=vtWEBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>