<!DOCTYPE html><html><head><title>专利 CN102111406A - 一种认证方法、系统和dhcp代理服务器 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_50a6672b5f82ffbd39b7a9e87fd4594c/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_50a6672b5f82ffbd39b7a9e87fd4594c__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种认证方法、系统和dhcp代理服务器"><meta name="DC.contributor" content="于红" scheme="inventor"><meta name="DC.contributor" content="刘安" scheme="inventor"><meta name="DC.contributor" content="杭州华三通信技术有限公司" scheme="assignee"><meta name="DC.date" content="2010-12-20" scheme="dateSubmitted"><meta name="DC.description" content="本发明提供了一种认证方法、系统和DHCP代理服务器。其中，该方法包括：A，DHCP代理服务器截获DHCP服务器向终端发送的携带了DNS服务器地址的DHCP回应报文，并判断终端是否安全，如果不安全，则将该DHCP回应报文中DNS服务器的地址修改为DNS代理服务器的地址，向终端转发修改后的DHCP回应报文，以使终端在接收到修改后的DHCP回应报文后，若需要访问外部网络资源，向DNS代理服务器的地址发送域名解析请求；B，DNS代理服务器接收到域名解析请求后，触使认证服务器对所述终端进行认证。采用本发明，无需接入设备的配合即可实现终端的认证。"><meta name="DC.date" content="2011-6-29"><meta name="DC.relation" content="CN:101022340:A" scheme="references"><meta name="DC.relation" content="CN:101145907:A" scheme="references"><meta name="DC.relation" content="CN:101426004:A" scheme="references"><meta name="DC.relation" content="CN:101631133:A" scheme="references"><meta name="DC.relation" content="CN:1458760:A" scheme="references"><meta name="citation_patent_publication_number" content="CN:102111406:A"><meta name="citation_patent_application_number" content="CN:201010612102"><link rel="canonical" href="https://www.google.com/patents/CN102111406A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN102111406A?cl=zh"/><meta name="title" content="专利 CN102111406A - 一种认证方法、系统和dhcp代理服务器"/><meta name="description" content="本发明提供了一种认证方法、系统和DHCP代理服务器。其中，该方法包括：A，DHCP代理服务器截获DHCP服务器向终端发送的携带了DNS服务器地址的DHCP回应报文，并判断终端是否安全，如果不安全，则将该DHCP回应报文中DNS服务器的地址修改为DNS代理服务器的地址，向终端转发修改后的DHCP回应报文，以使终端在接收到修改后的DHCP回应报文后，若需要访问外部网络资源，向DNS代理服务器的地址发送域名解析请求；B，DNS代理服务器接收到域名解析请求后，触使认证服务器对所述终端进行认证。采用本发明，无需接入设备的配合即可实现终端的认证。"/><meta property="og:title" content="专利 CN102111406A - 一种认证方法、系统和dhcp代理服务器"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN102111406A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN102111406A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=Er-VBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN102111406A&amp;usg=AFQjCNFkNC6In7FdixvXPExZlB6gw3LTPA" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/eef94e4d2b1072f1fcf6/CN102111406A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/eef94e4d2b1072f1fcf6/CN102111406A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN102111406A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN102111406A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN102111406A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN102111406B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN102111406A?cl=zh" style="display:none"><span itemprop="description">本发明提供了一种认证方法、系统和DHCP代理服务器。其中，该方法包括：A，DHCP代理服务器截获DHCP服务器向终端发送的携带了DNS服务器地址的DHCP回应报文，并判断终端是否安全，如果不安全，则将该DHCP回应报文中DNS服务器的地...</span><span itemprop="url">https://www.google.com/patents/CN102111406A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN102111406A - 一种认证方法、系统和dhcp代理服务器</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN102111406A - 一种认证方法、系统和dhcp代理服务器" title="专利 CN102111406A - 一种认证方法、系统和dhcp代理服务器"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN102111406 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 201010612102</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2011年6月29日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2010年12月20日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2010年12月20日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102111406B?hl=zh-CN&amp;cl=zh">CN102111406B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">201010612102.0, </span><span class="patent-bibdata-value">CN 102111406 A, </span><span class="patent-bibdata-value">CN 102111406A, </span><span class="patent-bibdata-value">CN 201010612102, </span><span class="patent-bibdata-value">CN-A-102111406, </span><span class="patent-bibdata-value">CN102111406 A, </span><span class="patent-bibdata-value">CN102111406A, </span><span class="patent-bibdata-value">CN201010612102, </span><span class="patent-bibdata-value">CN201010612102.0</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E4%BA%8E%E7%BA%A2%22">于红</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%88%98%E5%AE%89%22">刘安</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E6%9D%AD%E5%B7%9E%E5%8D%8E%E4%B8%89%E9%80%9A%E4%BF%A1%E6%8A%80%E6%9C%AF%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">杭州华三通信技术有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN102111406A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102111406A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN102111406A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#backward-citations">专利引用</a> (5),</span> <span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (5),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (4),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=Er-VBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D201010612102&amp;usg=AFQjCNECZgfK5eDU9ZhTLVfyGMMJGHv_tg"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=Er-VBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D102111406A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNFYfl0CO_jR6lvcV2nDMiawntwXaQ"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT104169914" lang="ZH" load-source="patent-office">一种认证方法、系统和dhcp代理服务器</invention-title>
      </span><br><span class="patent-number">CN 102111406 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA86075850" lang="ZH" load-source="patent-office">
    <div class="abstract">本发明提供了一种认证方法、系统和DHCP代理服务器。其中，该方法包括：A，DHCP代理服务器截获DHCP服务器向终端发送的携带了DNS服务器地址的DHCP回应报文，并判断终端是否安全，如果不安全，则将该DHCP回应报文中DNS服务器的地址修改为DNS代理服务器的地址，向终端转发修改后的DHCP回应报文，以使终端在接收到修改后的DHCP回应报文后，若需要访问外部网络资源，向DNS代理服务器的地址发送域名解析请求；B，DNS代理服务器接收到域名解析请求后，触使认证服务器对所述终端进行认证。采用本发明，无需接入设备的配合即可实现终端的认证。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(16)</span></span></div><div class="patent-text"><div mxw-id="PCLM36869172" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.	一种认证方法，该方法应用于包含终端、认证服务器、DHCP服务器和DNS服务器的系 统中，其特征在于，所述系统还包括=DHCP代理服务器和DNS代理服务器；该方法包括：A，DHCP代理服务器截获DHCP服务器向终端发送的携带了 DNS服务器地址的DHCP回 应报文，并判断终端是否安全，如果不安全，则将该DHCP回应报文中DNS服务器的地址修改 为DNS代理服务器的地址，向终端转发修改后的DHCP回应报文，以使终端在接收到修改后 的DHCP回应报文后，若需要访问外部网络资源，向DNS代理服务器的地址发送域名解析请 求；B，DNS代理服务器接收到域名解析请求后，触使认证服务器对所述终端进行认证。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.根据权利要求1所述的方法，其特征在于，步骤A中，判断终端是否安全包括：Al，所述DHCP代理服务器发送询问请求至所述认证服务器；A2，所述认证服务器接收到所述询问请求后，判断已创建的安全信息列表中是否存在 所述终端的安全信息，如果是，将该存在的安全信息发送给所述DHCP代理服务器；A3，所述DHCP代理服务器判断该终端的安全信息是表示安全还是不安全，如果是前 者，则确定终端安全，如果是后者，则确定终端不安全。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.根据权利要求1或2所述的方法，其特征在于，所述DHCP回应报文还携带了终端的 MAC地址；步骤A中，DHCP代理服务器在判断终端是否安全之前进一步包括：判断所述DHCP回应报文携带的终端MAC地址是否为免认证的MAC地址，如果否，继续 执行判断终端是否安全的操作。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.根据权利要求3所述的方法，其特征在于，如果判断出终端安全，或者，如果判断出 DHCP回应报文携带的终端MAC地址为免认证的MAC地址，则该方法进一步包括：向终端转发该截获的DHCP回应报文，以使终端在接收到该DHCP回应报文后，若需要访 问外部网络资源，向该DHCP回应报文包含的DNS服务器的地址发送域名解析请求；当DNS服务器接收到域名解析请求后，执行域名解析操作，并将解析后的域名发送给 终端，以使终端访问外部网络资源。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.根据权利要求2所述的方法，其特征在于，所述DHCP回应报文为DHCP服务器对终端 发送的用于请求IP地址的DHCP请求报文的回应，其还携带了 DHCP服务器为所述终端分配 的IP地址；如果步骤Al中的询问请求发送失败，或者步骤A2中的判断结果为否，则该方法进一步 包括：所述DHCP代理服务器为所述DHCP回应报文携带的IP地址设置租期期限，在完成设 置后向所述终端发送设置后的DHCP回应报文，以使所述终端在接收的DHCP回应报文所携 带的IP地址的租期期限到达时，再次发送所述DHCP请求报文，并返回步骤A。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.根据权利要求1所述的方法，其特征在于，步骤B中，DNS代理服务器在接收到域名 解析请求之后，且在触使认证服务器对终端进行认证之前，进一步包括：判断所述域名解析请求携带的域名是否为免认证域名，如果否，执行触使认证服务器 对终端进行认证的操作，如果是，直接将所述域名解析请求发送给DNS服务器，由DNS服务 器对该域名解析请求携带的域名进行解析、并将解析后的域名发送给终端，以使终端访问 外部网络资源。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.根据权利要求1或6所述的方法，其特征在于，所述系统还包括：用于推送DHCP认证页面的DHCP WEB服务器；步骤B中，DNS代理服务器触使认证服务器对所述终端进行认证包括： Bi，DNS代理服务器将所述域名解析请求携带的域名解析为所述DHCPWEB服务器的地 址，并发送给终端，以使所述终端向所述DHCP WEB服务器的地址发送HTTP请求；B2，所述DHCP WEB服务器接收到所述HTTP请求后，提供DHCP认证页面给所述终端，以 使所述终端通过所述DHCP认证页面提交认证请求；B3，所述DHCP WEB服务器在接收到所述认证请求后，提供客户端至所述终端； B4，所述客户端触使所述认证服务器对所述终端进行认证。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.根据权利要求7所述的方法，其特征在于，步骤B4包括： B41，客户端触使终端发送身份认证请求至认证服务器；B42，所述认证服务器对所述终端进行身份认证，在所述终端通过身份认证后，告知给 终端；B43，所述客户端在获知所述终端通过身份认证后触使终端发送安全认证请求至认证 服务器；B44,所述认证服务器对所述终端进行安全认证。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="9" class="claim">
      <div class="claim-text">9.根据权利要求8所述的方法，其特征在于，该方法进一步包括：所述认证服务器在所 述终端通过安全认证后，确定该终端的安全信息为安全，并记录至所述已创建的安全信息 列表中，在所述终端未通过安全认证或者身份认证后，确定该终端的安全信息为不安全，并 记录至所述已创建的安全信息列表。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.根据权利要求8或9所述的方法，其特征在于，所述DHCP回应报文为DHCP服务器 对终端发送的用于请求IP地址的DHCP请求报文的回应；该方法进一步包括：所述认证服务器在所述终端通过安全认证后，告知给所述终端，所 述客户端在获知所述终端通过安全认证时，触使所述终端发送DHCP请求报文，并返回执行 步骤A。</div>
    </div>
    </div> <div class="claim"> <div num="11" class="claim">
      <div class="claim-text">11.	一种认证系统，该系统包括：终端、认证服务器、DHCP服务器和DNS服务器；其特征 在于，该系统还包括：DHCP代理服务器和DNS代理服务器；所述DHCP服务器用于向终端发送携带了 DNS服务器地址的DHCP回应报文； 所述DHCP代理服务器用于截获所述DHCP服务器发送的DHCP回应报文，并判断所述终 端是否安全，如果所述终端不安全，则将该DHCP回应报文中DNS服务器的地址修改为所述 DNS代理服务器的地址，向所述终端转发修改后的DHCP回应报文；所述终端用于在接收到修改后的DHCP回应报文后，若需要访问外部网络资源，向DNS 代理服务器的地址发送域名解析请求；所述DNS代理服务器用于接收到域名解析请求后，触使所述认证服务器对所述终端进 行认证。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12.根据权利要求11所述的系统，其特征在于，所述DHCP回应报文还携带了终端的 MAC地址；所述DHCP代理服务器在执行判断终端是否安全之前进一步判断所述DHCP回应报文携 带的终端MAC地址是否为免认证的MAC地址，如果否，继续执行判断终端是否安全的操作， 否则，向终端转发截获的DHCP回应报文；所述终端还用于接收该截获的DHCP回应报文，并在访问外部网络资源时，向该DHCP回 应报文携带的DNS服务器的地址发送域名解析请求；所述DNS服务器用于在接收到域名解析请求后，执行域名解析操作，并将解析后的域 名发送给终端，以使终端访问外部网络资源。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13.根据权利要求11所述的系统，其特征在于，所述DNS代理服务器在接收到域名解析 请求之后，且在触使认证服务器对终端进行认证之前，进一步用于判断所述域名解析请求 携带的域名是否为免认证域名，如果否，执行触使认证服务器对终端进行认证的操作，如果 是，直接将所述域名解析请求发送给DNS服务器，由DNS服务器对该域名解析请求携带的域 名进行解析、并将解析后的域名发送给终端，以使终端访问外部网络资源。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="14" class="claim">
      <div class="claim-text">14.根据权利要求11或13所述的系统，其特征在于，所述系统还包括：DHCP	TOB服务 器和客户端；所述DNS代理服务器用于将所述域名解析请求携带的域名解析为所述DHCP WEB服务 器的地址，并发送给终端，以使所述终端向所述DHCP WEB服务器的地址发送HTTP请求；所述DHCP WEB服务器用于接收到所述HTTP请求后，提供DHCP认证页面给所述终端， 以使所述终端通过所述DHCP认证页面提交认证请求；以及在接收到所述认证请求后，提供 客户端至所述终端；所述客户端用于触使所述认证服务器对所述终端进行认证。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="15" class="claim">
      <div class="claim-text">15.根据权利要求14所述的系统，其特征在于，所述DHCP回应报文为DHCP服务器对终 端发送的用于请求IP地址的DHCP请求报文的回应；所述认证服务器在所述终端通过认证后，告知给所述终端；所述客户端在获知所述终端通过安全认证时，触使所述终端发送DHCP请求报文。</div>
    </div>
    </div> <div class="claim"> <div num="16" class="claim">
      <div class="claim-text">16.	一种应用于认证的DHCP代理服务器，其特征在于，所述DHCP代理服务器包括：截获单元，用于截获DHCP服务器向终端发送的携带了 DNS服务器地址的DHCP回应报文；判断单元，用于判断终端是否安全；处理单元，用于在所述判断单元的判断结果为否时，将该DHCP回应报文中DNS服务器 的地址修改为DNS代理服务器的地址，向终端转发修改后的DHCP回应报文，以保证终端在 接收到修改后的DHCP回应报文后，若需要访问外部网络资源，向DNS代理服务器的地址发 送域名解析请求，由该DNS代理服务器接收到域名解析请求后，触使认证服务器对所述终 端进行认证。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES42532719" lang="ZH" load-source="patent-office" class="description">
    <p>一种认证方法、系统和DHCP代理服务器</p>
    <p>技术领域</p>
    <p>[0001]	本发明涉及网络安全技术领域，特别涉及一种认证方法、系统和动态主机配置协 议（DHCP)代理服务器。</p>
    <p>背景技术</p>
    <p>[0002]	伴随着信息时代的飞速发展，网络安全面临着前所未有的考验。为了保证企业网 内部的安全性和可用性，在网络建设上，我们不仅要从企业网外围封堵非法入侵（如：安装 防火墙、防病毒软件、各种入侵检测软件等），而且还要控制企业网内部的终端在接入网络 前的合法性和安全性。</p>
    <p>[0003]	目前，针对终端接入网络的安全控制，业界已经出现了多种认证方式，其中，比较 成熟的认证方案为IEEE 802. Ix和TOB网关方案，下面分别进行描述：</p>
    <p>[0004]	IEEE 802. IX 方案</p>
    <p>[0005]	IEEE 802. IX定义了基于端口的网络接入控制协议（Port-based NetworkAccess Control)，该网络接入控制协议是二层标准协议，其根据用户认证成功与否，控制端口的打 开或者关闭，具体如图1所示。</p>
    <p>[0006]	参见图1，图1为现有技术中IEEE 802. IX方案示意图。在图1中，IEEE802. IX方 案涉及以下三个组成部分：</p>
    <p>[0007]	1、客户端：</p>
    <p>[0008]	该客户端，为额外安装在终端上的软件，其为LAN所连接的一端的实体（entity)， 用于触使终端向认证系统（Authenticator)发起认证请求，以便对其身份的合法性进行检验。</p>
    <p>[0009]	2、认证系统：</p>
    <p>[0010]	该认证系统，为LAN连接的一端用于认证客户端的实体，其通常为支持IEEE 802. IX协议的接入设备，用于为客户端提供服务端口。</p>
    <p>[0011]	3、认证月艮务器(Authentication Server)：</p>
    <p>[0012]	该认证服务器为认证系统提供认证服务的实体。这里认证服务器所提供的服务是 指通过检验客户端发送来的认证请求，来判断该客户端是否有权使用认证系统所提供的网 络服务。</p>
    <p>[0013]	基于上述描述，IEEE 802. IX方案具体为：在初始阶段，关闭接入设备为一客户 端提供的服务端口，该客户端为特意安装在终端，用于发起认证的客户端，此时，该服务端 口仅允许该客户端发送的认证报文通过，如此，安装了该客户端的终端无法被分配到IP地 址，进而也无法接入网络；当认证服务器通过认证报文的认证后，打开该服务端口，此时，该 服务端口允许所有报文通过。如此，如图1所示，安装了该客户端的终端可通过发送DHCP 请求报文给DHCP服务器，以获取IP地址，进而根据该IP地址访问hternet资源。</p>
    <p>[0014]	以上对IEEE 802. IX方案进行了描述。该方案虽然能实现客户端的认证，但是，由 于该方案基于二层认证协议，认证策略比较简单，新业务支持能力较弱，以及兼容性差；并且，该方案要求终端额外安装客户端，安装过程复杂，给用户使用带来不方便。</p>
    <p>[0015]	为了解决IEEE 802. IX方案带来的技术问题，现有技术又提出了 WEB网关认证方 案，该WEB网关认证方案较IEEE 802. IX方案有了一定的改进，即免安装客户端，用户使用 起来比较方便，以及该方案大多采用三层协议，能够比较方便的支持新业务，下面对WEB网 关认证方案进行描述。</p>
    <p>[0016]	参见图2，图2为现有技术中TOB网关认证方案示意图。在图2中，该TOB网关认 证方案涉及以下四个组成部分：</p>
    <p>[0017]	1、认证客户端：</p>
    <p>[0018]	该认证客户端用于访问网络资源，是发起身份认证的源头。</p>
    <p>[0019]	2、接入设备：</p>
    <p>[0020]	该接入设备用于控制认证客户端访问网络资源。在认证客户端发起认证过程中， 接入设备收到WEB网关服务器的请求后，与认证服务器进行认证交互。</p>
    <p>[0021]	3、TOB网关服务器：</p>
    <p>[0022]	该WEB网关服务器用于提供WEB身份认证的网页，同时，TOB网关收到认证客户端 的认证请求后，与接入设备进行认证交互。</p>
    <p>[0023]	4、认证服务器：</p>
    <p>[0024]	该认证服务器用于提供认证服务。</p>
    <p>[0025]	基于上面描述，TOB网关认证方案具体为：认证客户端发送HTTP请求，接入设备接 收到HTTP请求后，将该HTTP请求重定向到WEB网关服务器，TOB网关服务器通过接入设备 发送认证请求至认证服务器，当认证服务器通过该认证请求后，接入设备放开对认证客户 端的权限控制，如此，认证客户端可访问hternet资源。</p>
    <p>[0026]	从上面对WEB网关认证方案的描述可以知道，虽然该WEB网关认证方案能够解决 IEEE 802. IX方案带来的技术问题，但是，在具体实现中，该WEB网关认证方案只能通过网 页方式（即发送HTTP请求）进行用户身份认证，而无法进行终端机自身的安全检查（如： 是否安装防病毒软件等），并且，该WEB网关认证方案通常采用私有协议，并要求使用支持 WEB网关私有协议的接入设备，如此，就需要改造企业网现有的网络架构，进行接入设备的 重新部署和升级。</p>
    <p>发明内容</p>
    <p>[0027]	本发明提供了认证方法、系统和DHCP服务器，无需接入设备的配合即可实现终端 的认证。</p>
    <p>[0028]	本发明提供的技术方案包括：</p>
    <p>[0029]	一种认证方法，该方法应用于包含终端、认证服务器、DHCP服务器和DNS服务器的 系统中，其特征在于，所述系统还包括=DHCP代理服务器和DNS代理服务器；该方法包括：</p>
    <p>[0030]	A，DHCP代理服务器截获DHCP服务器向终端发送的携带了 DNS服务器地址的DHCP 回应报文，并判断终端是否安全，如果不安全，则将该DHCP回应报文中DNS服务器的地址修 改为DNS代理服务器的地址，向终端转发修改后的DHCP回应报文，以使终端在接收到修改 后的DHCP回应报文后，若需要访问外部网络资源，向DNS代理服务器的地址发送域名解析 请求；[0031]	B，DNS代理服务器接收到域名解析请求后，触使认证服务器对所述终端进行认证。</p>
    <p>[0032]	一种认证系统，该系统包括：终端、认证服务器、DHCP服务器和DNS服务器；其关键 在于，该系统还包括：DHCP代理服务器和DNS代理服务器；</p>
    <p>[0033]	所述DHCP服务器用于向终端发送携带了 DNS服务器地址的DHCP回应报文；</p>
    <p>[0034]	所述DHCP代理服务器用于截获所述DHCP服务器发送的DHCP回应报文，并判断所 述终端是否安全，如果所述终端不安全，则将该DHCP回应报文中DNS服务器的地址修改为 所述DNS代理服务器的地址，向所述终端转发修改后的DHCP回应报文；</p>
    <p>[0035]	所述终端用于在接收到修改后的DHCP回应报文后，若需要访问外部网络资源，向 DNS代理服务器的地址发送域名解析请求；</p>
    <p>[0036]	所述DNS代理服务器用于接收到域名解析请求后，触使所述认证服务器对所述终 端进行认证。</p>
    <p>[0037]	一种应用于认证的DHCP代理服务器，包括：</p>
    <p>[0038]	截获单元，用于截获DHCP服务器向终端发送的携带了 DNS服务器地址的DHCP回 应报文；</p>
    <p>[0039]	判断单元，用于判断终端是否安全；</p>
    <p>[0040]	处理单元，用于在所述判断单元的判断结果为否时，将该DHCP回应报文中DNS服 务器的地址修改为DNS代理服务器的地址，向终端转发修改后的DHCP回应报文，以保证终 端在接收到修改后的DHCP回应报文后，若需要访问外部网络资源，向DNS代理服务器的地 址发送域名解析请求，由该DNS代理服务器接收到域名解析请求后，触使认证服务器对所 述终端进行认证。</p>
    <p>[0041]	由以上技术方案可以看出，本发明中，通过增加DHCP代理服务器和DNS代理服务 器，并利用网络中已部署的DHCP和DNS服务机制，能够保证终端无需额外安装客户端，无需 接入设备的配合，即可实现终端的认证；</p>
    <p>[0042]	进一步地，由于本发明不依赖于接入设备，因此，无需调整当前的网络架构，实现 比较简单。</p>
    <p>附图说明</p>
    <p>[0043]	图1为现有技术中IEEE 802. IX方案示意图；</p>
    <p>[0044]	图2为现有技术中WEB网关认证方案示意图；</p>
    <p>[0045]	图3为本发明实施例提供的基本流程图；</p>
    <p>[0046]	图4为本发明实施例提供的详细流程图；</p>
    <p>[0047]	图5为本发明实施例提供的组网示意图；</p>
    <p>[0048]	图6为本发明实施例提供的步骤418的操作流程图；</p>
    <p>[0049]	图7为本发明实施例提供的认证系统的结构图；</p>
    <p>[0050]	图8为本发明实施例提供的DHCP代理服务器的结构图。</p>
    <p>具体实施方式</p>
    <p>[0051]	为了使本发明的目的、技术方案和优点更加清楚，下面结合附图和具体实施例对 本发明进行详细描述。[0052]	本发明实施例提供的认证方法主要利用网络中已部署的DHCP和DNS服务机制，能 够保证终端无需额外安装客户端，无需接入设备的配合，即可实现身份认证和安全认证，具 体参见图3所示的流程。</p>
    <p>[0053]	参见图3，图3为本发明实施例提供的基本流程图。该流程适用于包含终端、认证 服务器、DHCP服务器、DNS服务器、DHCP代理服务器和DNS代理服务器的系统。</p>
    <p>[0054]	本流程中，DHCP代理服务器可为安装在DHCP服务器上的代理插件，当然，作为本 发明实施例的一种扩展，该DHCP代理服务器也可为独立于DHCP服务器的一个实体。该DHCP 代理服务器用于拦截DHCP服务器向终端发送的DHCP回应报文，并根据终端的安全与否确 定是否修改该DHCP回应报文中携带的DNS服务器的地址。</p>
    <p>[0055]	DNS代理服务器，其可独立于DNS服务器，也可为DNS服务器中的功能单元，本发明 实施例并不具体限定。该DNS代理服务器用于接收到终端的域名解析请求时，触使认证服 务器对该终端进行认证。</p>
    <p>[0056]	认证服务器、DHCP服务器和DNS服务器具有的功能均与现有技术类似，这里不再 赘述。</p>
    <p>[0057]	基于上面的描述，图3所示的流程可包括以下步骤：</p>
    <p>[0058]	步骤301，DHCP代理服务器截获DHCP服务器向终端发送的携带了 DNS服务器地址 的DHCP回应报文，并判断终端是否安全，如果不安全，则将该DHCP回应报文中DNS服务器 的地址修改为DNS代理服务器的地址，向终端转发修改后的DHCP回应报文，以使终端在接 收到修改后的DHCP回应报文后，若需要访问外部网络资源，向DNS代理服务器的地址发送 域名解析请求。</p>
    <p>[0059]	步骤302，DNS代理服务器接收到域名解析请求后，触使认证服务器对所述终端进 行认证。</p>
    <p>[0060]	至此，完成了图3所示的流程。下面通过图4对图3所示的流程进行描述。</p>
    <p>[0061]	参见图4，图4为本发明实施例提供的详细流程图。本流程可基于图5所示的组 网。该组网中除了包含上面描述的客户端、认证服务器、DHCP服务器、DNS服务器、DHCP代 理服务器和DNS代理服务器之外，还可以进一步包括：用于推送DHCP认证页面的DHCP WEB 服务器。该DHCP TOB服务器为DHCP WEB的门户网站，为用户推出认证页面并下载客户端 至终端，具体见步骤416至步骤420的描述。</p>
    <p>[0062]	本流程以DHCP回应报文为DHCP服务器对终端发送的用于请求IP地址的DHCP请 求报文的回应报文为例，其他情况原理类似。其中，该DHCP回应报文至少包含以下三个字 段：用于承载DNS服务器地址的第一字段、用于承载终端MAC地址的第二字段和用于承载所 述DHCP服务器为所述终端分配的IP地址的第三字段。基于此，图4所示的流程可包括以 下步骤：</p>
    <p>[0063]	步骤401，终端在启动后发送DHCP请求报文至DHCP服务器，以请求DHCP服务器为 其分配IP地址。</p>
    <p>[0064]	步骤402，DHCP服务器接收到DHCP请求报文后，从已划分的IP地址池中找到对应 的IP地址，将该IP地址、终端的MAC地址和对应的DNS服务器的地址分别携带在DHCP回 应报文的第三字段、第二字段和第一字段中，之后向终端发送该DHCP回应报文。</p>
    <p>[0065]	也就是说，执行完到本步骤402时，该DHCP回应报文携带的是DNS服务器的地址。[0066]	步骤403，DHCP代理服务器截获DHCP服务器向终端发送的DHCP回应报文，并判 断所述DHCP回应报文中第二字段的MAC地址是否为免认证的MAC地址，如果是，执行步骤 404，否则，执行步骤405。</p>
    <p>[0067]	针对某些组网，部分终端如服务器和打印机等无需进行身份认证和安全认证，即 可接入网络。也就是说，针对向这部分终端发送的DHCP回应报文，DHCP代理服务器代理会 放过，直接执行步骤404，以达到免认证的目的。本实施例中，为了达到该目的，可根据实际 情况在DHCP代理服务器上创建一个免认证MAC地址列表。如此，步骤403中的判断为：DHCP 代理服务器判断DHCP回应报文中第二字段的MAC地址是否在免认证MAC地址列表中，如果 是，则确定DHCP回应报文中第二字段的MAC地址为免认证的MAC地址，否则，确定DHCP回 应报文中第二字段的MAC地址不为免认证的MAC地址。</p>
    <p>[0068]	步骤404，向终端转发DHCP回应报文。之后执行步骤412。</p>
    <p>[0069]	步骤405，DHCP代理服务器发送询问请求至认证服务器，以询问所述终端是否安 全。</p>
    <p>[0070]	步骤406，认证服务器接收到所述询问请求后，判断已创建的安全信息列表中是否 存在所述终端的安全信息，如果是，执行步骤407，否则，执行步骤410。</p>
    <p>[0071]	在执行本步骤406之前，认证服务器会预先创建一个安全信息列表，该安全信息 列表在初始阶段可为空，也可包含管理人员根据实际情况输入的若干个终端的安全信息， 之后，由认证服务器在完成针对终端的认证后添加，具体见步骤419。该安全信息列表包含 了终端标识和安全信息之间的对应关系，其中，该安全信息可表示不安全或者安全。</p>
    <p>[0072]	基于此，可以知道，所述询问请求可包含所述终端的标识，步骤406中的判断具体 为：认证服务器以所述终端的标识为关键字，从所述安全信息列表中查找包含该关键字的 对应关系，如果查找到，确定所述安全信息列表存在所述终端的安全信息，否则，确定所述 安全信息列表不存在所述终端的安全信息。</p>
    <p>[0073]	步骤407，将所述终端的安全信息发送给DHCP代理服务器。之后执行步骤408。</p>
    <p>[0074]	步骤408，DHCP代理服务器判断该安全信息表示安全还是不安全，如果是前者，则 返回执行步骤404，否则，执行步骤409。</p>
    <p>[0075]	步骤409，将所述DHCP回应报文中第一字段的地址修改为DNS代理服务器的地址， 并向终端转发修改后的DHCP回应报文。之后执行步骤412。</p>
    <p>[0076]	也就是说，执行完本步骤409时，第一字段的地址不再是DNS服务器的地址，而是 DNS代理服务器的地址。</p>
    <p>[0077]	步骤410，将不存在的通知发送给DHCP代理服务器。之后执行步骤411。</p>
    <p>[0078]	步骤411，DHCP代理服务器接收到不存在的通知时，为所述DHCP回应报文中第三 字段的IP地址设置租期期限，以使所述终端在所述IP地址的租期期限到达时，再次返回步 骤401中发送DHCP请求报文的操作，并在完成设置后，向所述终端发送设置后的DHCP回应 报文。之后执行步骤412。</p>
    <p>[0079]	需要说明的是，作为本发明实施例的一种扩展，步骤405中，如果DHCP代理服务器 无法和认证服务器通信，即步骤405中的询问请求发送失败，也可直接执行本步骤411中的 设置操作。</p>
    <p>[0080]	步骤412，终端接收到DHCP回应报文后，存储该DHCP回应报文中第一字段、第二字段和第三字段的内容，并在访问外部网络资源时，向所述第一字段中的地址发送域名解析 请求。</p>
    <p>[0081]	本步骤412中，终端接收的DHCP回应报文中第一字段的地址存在以下两种情况： 其中一种情况为：第一字段的地址为DNS服务器的地址（记为情况1)，该情况1下，DHCP代 理服务器未对DHCP服务器发送的DHCP回应报文作任何处理，即通过步骤404发送的DHCP 回应报文；另一种情况为：第一字段的地址为DNS代理服务器的地址（记为情况幻，该情况 2下，DHCP代理服务器对DHCP服务器发送的DHCP回应报文中第一字段的地址进行了修改， 即通过步骤409发送的DHCP回应报文。针对情况1，终端向DNS服务器发送域名解析请求， 以使DNS服务器执行域名解析操作（该操作与现有技术类似，这里不再赘述），具体见步骤 414 ；针对情况2，终端向DNS代理服务器发送域名解析请求，以使DNS代理服务器接收到域 名解析请求后，触使认证服务器对该终端进行认证，具体见步骤415。</p>
    <p>[0082]	另外，执行到本步骤412时，终端接收的DHCP回应报文中第三字段的IP地址也存 在两种情况，一种情况为该IP地址被设置了租期期限，另一种情况为该IP地址未被设置租 期期限。针对IP地址被设置了租期期限的情况，终端需要实时监控该租期期限是否到达， 如果是，则返回步骤401中发送DHCP请求报文的操作。针对IP地址未被设置租期期限的 情况，可按照现有方式处理，也可长期使用该IP地址，本发明实施例并不具体限定。</p>
    <p>[0083]	步骤413，如果DNS服务器接收到域名解析请求，则执行步骤414，如果DNS代理服 务器接收到域名解析请求，则执行步骤415。</p>
    <p>[0084]	针对情况1，由于该情况1下，第一字段的地址为DNS服务器的地址，因此，步骤 412中的向第一字段中的地址发送域名解析请求实质为：向DNS服务器发送域名解析请求， 因此，执行到本步骤413时，DNS服务器会接收到域名解析请求，之后执行步骤414。针对情 况2，由于该情况2下，第一字段的地址为DNS代理服务器的地址，此时，步骤412中的向第 一字段中的地址发送域名解析请求实质为：向DNS代理服务器发送域名解析请求，因此，执 行到本步骤413时，DNS代理服务器会接收到域名解析请求，之后执行步骤415。</p>
    <p>[0085]	步骤414，DNS服务器接收到域名解析操作后，执行域名解析操作，并返回解析后 的域名给终端，以使终端访问外部网络资源。结束当前流程。</p>
    <p>[0086]	本步骤414中，DNS服务器执行的操作与现有协议中DNS服务器执行的操作类似， 这里不再赘述</p>
    <p>[0087]	步骤415，DNS代理服务器判断所述域名解析请求携带的域名是否为免认证域名， 如果是，直接将所述域名解析请求发送给DNS服务器，之后返回步骤414，否则，执行步骤 416。</p>
    <p>[0088]	在组网中，有些域名的访问是放开的，不安全终端也是可以访问的。为了达到该目 的，需要预先在DNS代理服务器上创建免认证域名列表。基于此，步骤415中的判断为：以 所述域名解析请求携带的域名为关键字在所述免认证域名列表中查找所述关键字，如果查 找到，则确定所述域名解析请求携带的域名为免认证域名，否则，确定所述域名解析请求携 带的域名不为免认证域名。</p>
    <p>[0089]	步骤416，DNS代理服务器将所述域名解析为所述DHCP WEB服务器的地址，并发送 给终端，以使所述终端向所述DHCP WEB服务器的地址发送HTTP请求。</p>
    <p>[0090]	步骤417，DHCP WEB服务器接收到所述HTTP请求后，提供DHCP认证页面给所述终端，以使所述终端通过所述DHCP认证页面提交认证请求，并在接收到所述认证请求后，提 供客户端至所述终端。</p>
    <p>[0091]	本实施例中，终端通过DHCP认证页面提交认证请求时，还可进一步提交认证参数。</p>
    <p>[0092]	本实施例中，客户端是DHCP WEB服务器提供给终端的，其采用JAVAWEB START方 式自动下载并运行，该终端的用户没有任何感知。</p>
    <p>[0093]	步骤418，客户端触使认证服务器对所述终端进行认证。</p>
    <p>[0094]	也就是说，该客户端用于实现终端的认证，其具体可参见图6。步骤419，认证服务 器在完成终端的认证后，记录认证结果至所述安全信息列表中，并发送认证结果至终端。</p>
    <p>[0095]	步骤420，客户端在获知终端通过认证时，触使所述终端返回执行步骤401中发送 DHCP请求报文的操作。结束当前流程。</p>
    <p>[0096]	至此，完成图4所示的流程。</p>
    <p>[0097]	在步骤418中，认证服务器对终端进行认证具体可包括：身份认证和安全认证，其 中，安全认证是在身份认证通过之后执行。基于此，步骤419具体为：如果终端通过安全认 证，确定该终端的安全信息为安全，并记录至所述已创建的安全信息列表中，在所述终端未 通过安全认证或者身份认证后，确定该终端的安全信息为不安全，并记录至所述已创建的 安全信息列表；之后，发送认证结果（该认证结果包含终端通过安全认证、通过身份认证、 未通过安全认证和未通过身份认证的结果）至终端。步骤420的终端通过认证实质为通过 安全认证。</p>
    <p>[0098]	下面对上述步骤418中的操作进行描述。</p>
    <p>[0099]	参见图6，图6为本发明实施例提供的步骤418的操作流程图。如图6所示，该流 程可包括以下步骤：</p>
    <p>[0100]	步骤601，客户端触使终端发送身份认证请求至认证服务器。</p>
    <p>[0101]	在上述步骤417中，DHCP WEB服务器提供的客户端携带了用户终端在所述DHCP认 证页面中提交的认证参数，如此，本步骤601中的身份认证请求可以携带所述认证参数。</p>
    <p>[0102]	步骤602，所述认证服务器对所述终端进行身份认证，在终端通过身份认证时，告 知给客户端。</p>
    <p>[0103]	通常，为实现身份认证，会预先配置一个身份认证参数表，当认证服务器接收到身 份认证请求后，会将该身份认证请求携带的认证参数和身份认证参数表中的相应认证参数 进行匹配，如果完全匹配，则表示终端通过身份认证，否则，则表示终端未通过身份认证。</p>
    <p>[0104]	作为本发明实施例的一种扩展，在终端未通过身份认证时，也可告知给客户端，只 不过该客户端不再执行下述步骤603。</p>
    <p>[0105]	步骤603，所述客户端在所述终端通过身份认证后，触使终端发送安全认证请求至 认证服务器。</p>
    <p>[0106]	步骤604，所述认证服务器对所述终端进行安全认证。</p>
    <p>[0107]	至此，完成了图6所示的流程。</p>
    <p>[0108]	在图6所示的流程中，步骤603和步骤604之间还可进一步包括以下步骤：所述认 证服务器接收到安全认证请求后，确定用于对该终端进行安全认证的认证策略，并告知给 客户端；客户端从终端上查找该认证策略对应的安全认证参数，并触使终端通知给认证服</p>
    <p>11务器。基于此，步骤604具体为：认证服务器对该安全认证参数进行安全认证，通常，为实现 安全认证，会预先配置一个安全认证参数表，当认证服务器接收到安全认证参数后，会将该 安全认证参数和安全认证参数表中的相应认证参数进行匹配，如果完全匹配，则表示终端 通过身份认证，否则，则表示终端未通过身份认证。</p>
    <p>[0109]	至此，完成了对本发明实施例提供的方法的描述。</p>
    <p>[0110]	参见图7，图7为本发明实施例提供的认证系统结构图。如图7所示，该系统包括： 终端701、认证服务器702、DHCP服务器703和DNS服务器704 ；其关键在于，该系统还包括： DHCP代理服务器705和DNS代理服务器706。</p>
    <p>[0111]	其中，DHCP服务器703用于向终端701发送携带了 DNS服务器地址的DHCP回应 报文；</p>
    <p>[0112]	DHCP代理服务器705用于截获DHCP服务器703发送的DHCP回应报文，并判断终 端701是否安全，如果终端701不安全，则将该DHCP回应报文中DNS服务器的地址修改为 DNS代理服务器的地址，向终端701转发修改后的DHCP回应报文；</p>
    <p>[0113]	终端701用于在接收到修改后的DHCP回应报文后，若需要访问外部网络资源，向 DNS代理服务器706的地址发送域名解析请求；</p>
    <p>[0114]	DNS代理服务器706用于接收到域名解析请求后，触使认证服务器702对终端701 进行认证。</p>
    <p>[0115]	本实施例中，所述DHCP回应报文还携带了终端的MAC地址；基于此，DHCP代理服 务器705在执行判断终端是否安全之前进一步判断所述DHCP回应报文携带的终端MAC地 址是否为免认证的MAC地址，如果否，继续执行判断终端701是否安全的操作，否则，向终端 701转发截获的DHCP回应报文；</p>
    <p>[0116]	终端701还用于接收该截获的DHCP回应报文，并在访问外部网络资源时，向该 DHCP回应报文携带的DNS服务器的地址发送域名解析请求；</p>
    <p>[0117]	DNS服务器704用于在接收到域名解析请求后，执行域名解析操作，并将解析后的 域名发送给终端701，以使终端701访问外部网络资源。</p>
    <p>[0118]	本实施例中，DNS代理服务器706在接收到域名解析请求之后，且在触使认证服 务器对终端进行认证之前，进一步用于判断所述域名解析请求携带的域名是否为免认证域 名，如果否，执行触使认证服务器702对终端701进行认证的操作，如果是，直接将所述域名 解析请求发送给DNS704，由DNS服务器704对该域名解析请求携带的域名进行解析、并将解 析后的域名发送给终端，以使终端访问外部网络资源。</p>
    <p>[0119]	如图7所示，该系统还包括：DHCP WEB服务器707和客户端708 ；</p>
    <p>[0120]	DNS代理服务器706用于将所述域名解析请求携带的域名解析为所述DHCP WEB服 务器的地址，并发送给终端，以使所述终端向所述DHCP WEB服务器的地址发送HTTP请求；</p>
    <p>[0121]	DHCP WEB服务器707用于接收到所述HTTP请求后，提供DHCP认证页面给所述终 端，以使所述终端通过所述DHCP认证页面提交认证请求；以及在接收到所述认证请求后， 提供客户端至所述终端。可以看出，客户端708是运行在终端701上的。</p>
    <p>[0122]	终端701上的客户端708用于触使认证服务器702对终端701进行认证。</p>
    <p>[0123]	本实施例中，所述DHCP回应报文为DHCP服务器703对终端发送的用于请求IP地 址的DHCP请求报文的回应；认证服务器702在所述终端通过认证后，告知给所述终端；该终端上的客户端在获知所述终端通过安全认证时，触使所述终端发送DHCP请求报文。</p>
    <p>[0124]	另外，本发明实施例还提供了一种应用于认证的DHCP代理服务器。参见图8，图8 为本发明实施例提供的DHCP代理服务器结构图。如图8所示，该DHCP代理服务器包括：</p>
    <p>[0125]	截获单元801，用于截获DHCP服务器向终端发送的携带了 DNS服务器地址的DHCP 回应报文；</p>
    <p>[0126]	判断单元802，用于判断终端是否安全；</p>
    <p>[0127]	处理单元803，用于在判断单元802的判断结果为否时，将该DHCP回应报文中DNS 服务器的地址修改为DNS代理服务器的地址，向终端转发修改后的DHCP回应报文，以保证 终端在接收到修改后的DHCP回应报文后，若需要访问外部网络资源，向DNS代理服务器的 地址发送域名解析请求，由该DNS代理服务器接收到域名解析请求后，触使认证服务器对 所述终端进行认证。</p>
    <p>[0128]	至此，完成图8所示的DHCP代理服务器的结构描述。</p>
    <p>[0129]	以上对本发明实施例提供的系统和DHCP代理服务器的结构进行了描述。</p>
    <p>[0130]	由以上技术方案可以看出，本发明达到的技术效果为：</p>
    <p>[0131]	1)，通过安装一个DHCP代理服务器，该DHCP代理服务器不会影响DHCP服务器为 终端分配IP地址的操作，并且，该DHCP代理服务器通常是搭载在现有DHCP服务器上的一 个插件，部署方便，不影响现有架构。</p>
    <p>[0132]	2)，通过在网络中部署一个DNS代理服务器，DNS代理服务器将不安全终端的域名 解析请求全部定向到DHCP WEB服务器上，以使DHCP WEB服务器向不安全终端提供认证页 面。该DNS代理服务器利用了已有的域名解析机制，无需任何接入设备的配合即可使DHCP WEB服务器推出认证页面，部署方便。</p>
    <p>[0133]	3)，DHCP WEB认证页面可自动将客户端下载至终端，触使终端发起认证，这样，一 方面避免了在用户终端安装客户端的复杂性，另一方面，又实现了以WEB方式实现认证（该 认证可包括身份认证和安全认证）。</p>
    <p>[0134]	4), DHCP代理服务器在发送查询请求失败或者认证服务器无法确定客户端的安全 情况时，利用DHCP分配IP地址的租期特性，为DHCP回应报文中的IP地址定义一个租期期 限（该期限一般比较短），在租期期限达时，终端会再次发送DHCP请求报文请求IP地址，保 证第一时间进入本发明提供的方法。</p>
    <p>[0135]	5)，本发明中，通过DHCP代理服务器提供免认证MAC地址的控制实现某些无需受 到认证限制即可直接访问外网的特定终端尽快访问到外网；进一步地，本发明通过DNS代 理服务器提供免认证域名的控制实现某些终端无需认证即可访问DNS服务器，这提高了本 发明的应用性。</p>
    <p>[0136]	以上所述仅为本发明的较佳实施例而已，并不用以限制本发明，凡在本发明的精 神和原则之内，所做的任何修改、等同替换、改进等，均应包含在本发明保护的范围之内。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="backward-citations"></a><div class="patent-section-header"><span class="patent-section-title">专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用的专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN1458760A?cl=zh">CN1458760A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2002年5月15日</td><td class="patent-data-table-td patent-date-value">2003年11月26日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">一种宽带网络的安全接入方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101022340A?cl=zh">CN101022340A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年3月30日</td><td class="patent-data-table-td patent-date-value">2007年8月22日</td><td class="patent-data-table-td ">武汉烽火网络有限责任公司</td><td class="patent-data-table-td ">实现城域以太网交换机接入安全的智能控制方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101145907A?cl=zh">CN101145907A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2006年9月11日</td><td class="patent-data-table-td patent-date-value">2008年3月19日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">基于dhcp实现用户认证的方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101426004A?cl=zh">CN101426004A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2007年10月29日</td><td class="patent-data-table-td patent-date-value">2009年5月6日</td><td class="patent-data-table-td ">华为技术有限公司</td><td class="patent-data-table-td ">三层会话的接入方法、系统及设备</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101631133A?cl=zh">CN101631133A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2008年7月15日</td><td class="patent-data-table-td patent-date-value">2010年1月20日</td><td class="patent-data-table-td ">华为技术有限公司;中国移动通信集团公司</td><td class="patent-data-table-td ">一种域名解析系统、设备及方法</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102404317A?cl=zh">CN102404317A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年10月31日</td><td class="patent-data-table-td patent-date-value">2012年4月4日</td><td class="patent-data-table-td ">杭州迪普科技有限公司</td><td class="patent-data-table-td ">一种防范dns缓存攻击的方法及装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103078877A?cl=zh">CN103078877A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年1月31日</td><td class="patent-data-table-td patent-date-value">2013年5月1日</td><td class="patent-data-table-td ">中国科学院计算机网络信息中心</td><td class="patent-data-table-td ">基于dns的用户认证和域名访问控制方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103078877B?cl=zh">CN103078877B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年1月31日</td><td class="patent-data-table-td patent-date-value">2015年9月16日</td><td class="patent-data-table-td ">中国科学院计算机网络信息中心</td><td class="patent-data-table-td ">基于dns的用户认证和域名访问控制方法及系统</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103297564A?cl=zh">CN103297564A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年7月3日</td><td class="patent-data-table-td patent-date-value">2013年9月11日</td><td class="patent-data-table-td ">深圳市共进电子股份有限公司</td><td class="patent-data-table-td ">一种自动切换外部代理服务器地址的方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103327008A?cl=zh">CN103327008A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年5月22日</td><td class="patent-data-table-td patent-date-value">2013年9月25日</td><td class="patent-data-table-td ">杭州华三通信技术有限公司</td><td class="patent-data-table-td ">一种http重定向方法及装置</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=Er-VBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029120000">H04L29/12</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=Er-VBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04W0012080000">H04W12/08</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=Er-VBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029080000">H04L29/08</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=Er-VBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029060000">H04L29/06</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2011年6月29日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2011年9月14日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Entry into substantive examination</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2014年2月5日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Grant of patent or utility model</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/eef94e4d2b1072f1fcf6/CN102111406A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_50a6672b5f82ffbd39b7a9e87fd4594c.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E8%AE%A4%E8%AF%81%E6%96%B9%E6%B3%95_%E7%B3%BB%E7%BB%9F%E5%92%8Cdhcp%E4%BB%A3%E7%90%86.pdf?id=Er-VBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U0UW8p4xwGcmrgWjwd2XrRlLy35cA"},"sample_url":"https://www.google.com/patents/reader?id=Er-VBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>