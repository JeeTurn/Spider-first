<!DOCTYPE html><html><head><title>专利 CN101009005A - 保障基于互联网的支付安全的方法、系统和平台 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_6e802a6b2b28d51711baddc2f3bec198/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_6e802a6b2b28d51711baddc2f3bec198__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="保障基于互联网的支付安全的方法、系统和平台"><meta name="DC.contributor" content="杨可可" scheme="inventor"><meta name="DC.contributor" content="王爱宝" scheme="inventor"><meta name="DC.contributor" content="齐秋生" scheme="inventor"><meta name="DC.contributor" content="王刚" scheme="inventor"><meta name="DC.contributor" content="刘伟" scheme="inventor"><meta name="DC.contributor" content="卢燕青" scheme="inventor"><meta name="DC.contributor" content="徐雄" scheme="inventor"><meta name="DC.contributor" content="吴恒章" scheme="inventor"><meta name="DC.contributor" content="中国电信股份有限公司" scheme="assignee"><meta name="DC.date" content="2006-1-24" scheme="dateSubmitted"><meta name="DC.description" content="一种基于互联网的支付方法，包括步骤：客户机访问支付平台并下载安全插件；安全插件获取客户机的主机信息并连同合法性验证请求发送至支付平台中的安全插件后台；插件后台验证安全插件的合法性并记录客户机信息；安全插件判断客户机是否采用了代理或被远程控制，判断结果连同支付请求提交给支付平台；插件后台基于安全插件的判断结果、客户机信息和支付请求判断客户机是否采用了代理或被远程控制，如果是，则拒绝支付请求。本发明还提供一种支付系统和支付平台。根据本发明，下载到客户机的安全插件与宽带应用平台中的插件后台进行交互作用，并各自识别处理远程控制型和代理型木马程序，有效地防止了采用木马软件进行盗用支付，保证了支付安全。"><meta name="DC.date" content="2007-8-1"><meta name="citation_patent_publication_number" content="CN:101009005:A"><meta name="citation_patent_application_number" content="CN:200610006033"><link rel="canonical" href="https://www.google.com/patents/CN101009005A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101009005A?cl=zh"/><meta name="title" content="专利 CN101009005A - 保障基于互联网的支付安全的方法、系统和平台"/><meta name="description" content="一种基于互联网的支付方法，包括步骤：客户机访问支付平台并下载安全插件；安全插件获取客户机的主机信息并连同合法性验证请求发送至支付平台中的安全插件后台；插件后台验证安全插件的合法性并记录客户机信息；安全插件判断客户机是否采用了代理或被远程控制，判断结果连同支付请求提交给支付平台；插件后台基于安全插件的判断结果、客户机信息和支付请求判断客户机是否采用了代理或被远程控制，如果是，则拒绝支付请求。本发明还提供一种支付系统和支付平台。根据本发明，下载到客户机的安全插件与宽带应用平台中的插件后台进行交互作用，并各自识别处理远程控制型和代理型木马程序，有效地防止了采用木马软件进行盗用支付，保证了支付安全。"/><meta property="og:title" content="专利 CN101009005A - 保障基于互联网的支付安全的方法、系统和平台"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101009005A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101009005A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=qBmHAAABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101009005A&amp;usg=AFQjCNGMTI_OfhXDLenEycYl1_LXw2DiYQ" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/bad7f9f1bff46fd80e24/CN101009005A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/bad7f9f1bff46fd80e24/CN101009005A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101009005A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101009005A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN101009005A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN101009005B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101009005A?cl=zh" style="display:none"><span itemprop="description">一种基于互联网的支付方法，包括步骤：客户机访问支付平台并下载安全插件；安全插件获取客户机的主机信息并连同合法性验证请求发送至支付平台中的安全插件后台；插件后台验证安全插件的合法性并记录客户机信息；安全...</span><span itemprop="url">https://www.google.com/patents/CN101009005A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101009005A - 保障基于互联网的支付安全的方法、系统和平台</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101009005A - 保障基于互联网的支付安全的方法、系统和平台" title="专利 CN101009005A - 保障基于互联网的支付安全的方法、系统和平台"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101009005 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200610006033</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2007年8月1日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2006年1月24日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2006年1月24日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101009005B?hl=zh-CN&amp;cl=zh">CN101009005B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200610006033.2, </span><span class="patent-bibdata-value">CN 101009005 A, </span><span class="patent-bibdata-value">CN 101009005A, </span><span class="patent-bibdata-value">CN 200610006033, </span><span class="patent-bibdata-value">CN-A-101009005, </span><span class="patent-bibdata-value">CN101009005 A, </span><span class="patent-bibdata-value">CN101009005A, </span><span class="patent-bibdata-value">CN200610006033, </span><span class="patent-bibdata-value">CN200610006033.2</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E6%9D%A8%E5%8F%AF%E5%8F%AF%22">杨可可</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%8E%8B%E7%88%B1%E5%AE%9D%22">王爱宝</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E9%BD%90%E7%A7%8B%E7%94%9F%22">齐秋生</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E7%8E%8B%E5%88%9A%22">王刚</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%88%98%E4%BC%9F%22">刘伟</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%8D%A2%E7%87%95%E9%9D%92%22">卢燕青</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%BE%90%E9%9B%84%22">徐雄</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%90%B4%E6%81%92%E7%AB%A0%22">吴恒章</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E4%B8%AD%E5%9B%BD%E7%94%B5%E4%BF%A1%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">中国电信股份有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101009005A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101009005A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101009005A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (8),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (3),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=qBmHAAABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200610006033&amp;usg=AFQjCNFleNC4kNGb8p6xIlt0daP4Y1LnrQ"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=qBmHAAABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101009005A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNF0dp907zoafjmL6EKHQ6rwF4ttIw"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT121909828" lang="ZH" load-source="patent-office">保障基于互联网的支付安全的方法、系统和平台</invention-title>
    </span><br><span class="patent-number">CN 101009005 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA108143531" lang="ZH" load-source="patent-office">
    <div class="abstract">一种基于互联网的支付方法，包括步骤：客户机访问支付平台并下载安全插件；安全插件获取客户机的主机信息并连同合法性验证请求发送至支付平台中的安全插件后台；插件后台验证安全插件的合法性并记录客户机信息；安全插件判断客户机是否采用了代理或被远程控制，判断结果连同支付请求提交给支付平台；插件后台基于安全插件的判断结果、客户机信息和支付请求判断客户机是否采用了代理或被远程控制，如果是，则拒绝支付请求。本发明还提供一种支付系统和支付平台。根据本发明，下载到客户机的安全插件与宽带应用平台中的插件后台进行交互作用，并各自识别处理远程控制型和代理型木马程序，有效地防止了采用木马软件进行盗用支付，保证了支付安全。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(17)</span></span></div><div class="patent-text"><div mxw-id="PCLM50731017" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1.一种保障基于互联网的支付安全的方法，其特征在于包括以下步骤：客户机访问支付平台并下载一个安全插件；所述安全插件获取其所在的客户机的主机信息并连同合法性验证请求发送至所述支付平台中的安全插件后台；所述安全插件后台响应于所述合法性验证请求，对所述安全插件的合法性进行验证，获取并记录客户机信息；所述安全插件判断所述客户机是否采用了代理或者被远程控制，所得到的判断结果连同用户输入的支付请求被提交给所述支付平台；所述支付平台中的安全插件后台基于所述安全插件的判断结果、所述记录的客户机信息和所述支付请求判断所述客户机是否采用了代理或者被远程控制，如果是，则所述支付平台拒绝支付请求。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="2" class="claim">
      <div class="claim-text">2.如权利要求1所述的方法，其特征在于，所述安全插件执行的判断代理的步骤包括：对所述安全插件到所述安全插件后台的连接的目的地址与所述安全插件后台的IP地址进行比较，如果二者不一致，则判断所述客户机采用了代理。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="3" class="claim">
      <div class="claim-text">3.如权利要求2所述的方法，其特征在于，所述安全插件执行的判断代理的步骤还包括：对客户机的浏览器的注册表进行检查，以检查在浏览器中是否设置了HTTP或Socket代理。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="4" class="claim">
      <div class="claim-text">4.如权利要求1所述的方法，其特征在于，所述安全插件执行的判断远程控制的步骤包括：判断所述支付请求是否是通过物理键盘或物理鼠标输入的，如果不是，则判断所述客户机被远程控制。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="5" class="claim">
      <div class="claim-text">5.如权利要求1所述的方法，其特征在于，所述安全插件还执行下述操作：在支付时，切断所述客户机对除了所述支付平台的白名单的IP地址以外的所有TCP连接。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="6" class="claim">
      <div class="claim-text">6.如权利要求1所述的方法，其特征在于，所述安全插件后台执行的判断步骤包括：对所述记录的客户机信息中包含的客户机IP地址与提出所述支付请求的实际请求源的IP地址进行比较，如果二者不一致，则判断所述客户机采用了代理。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="7" class="claim">
      <div class="claim-text">7.如权利要求6所述的方法，其特征在于，所述安全插件后台执行的判断步骤还包括：对所述记录的客户机信息中包含的下列信息中的至少一个与提出所述支付请求的实际请求源的相应信息进行比较，如果二者不一致，则判断所述客户机采用了代理，所述的这些信息包括：宽带接入物理线路、MAC地址、硬盘ID和CPU系列号。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="8" class="claim">
      <div class="claim-text">8.如权利要求6所述的方法，其特征在于，所述安全插件后台执行的判断步骤还包括：通过识别HTTP包头的特征字段来识别HTTP代理。</div>
    </div>
    </div> <div class="claim"> <div num="9" class="claim">
      <div class="claim-text">9.一种基于互联网的安全支付系统，包括支付平台和客户机，其特征在于：所述客户机包括一浏览器，该浏览器用于与所述支付平台通信，并从所述支付平台下载一个安全插件，所述安全插件包括：主机信息获取模块，用于获取其所在的客户机的主机信息并连同合法性验证请求发送至所述支付平台，和识别处理模块，用于判断所述客户机是否采用了代理或者被远程控制；所述支付平台包括用于接收支付请求的支付接口页面和安全插件后台，所述安全插件后台包括：安全插件生成单元，用于生成所述安全插件，安全插件验证单元，用于响应于所述合法性验证请求，对下载到所述客户机的安全插件的合法性进行验证，并获取客户机信息；客户机信息存储单元，用于记录所述客户机信息，和识别处理单元，用于基于所述安全插件中的识别处理模块的判断结果、所述记录的客户机信息和用户的支付请求判断所述客户机是否采用了代理或者被远程控制，如果是，则拒绝支付请求。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="10" class="claim">
      <div class="claim-text">10.如权利要求9所述的系统，其特征在于，所述安全插件中的识别处理模块执行的判断代理的操作包括：对所述安全插件到所述安全插件后台的连接的目的地址与所述安全插件后台的IP地址进行比较，如果二者不一致，则判断所述客户机采用了代理。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="11" class="claim">
      <div class="claim-text">11.如权利要求10所述的系统，其特征在于，所述安全插件中的识别处理模块执行的判断代理的操作还包括：对客户机的浏览器的注册表进行检查，以检查在浏览器中是否设置了HTTP或Socket代理。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="12" class="claim">
      <div class="claim-text">12.如权利要求9所述的系统，其特征在于，所述安全插件中的识别处理模块执行的判断远程控制的操作包括：判断所述支付请求是否是通过物理键盘或物理鼠标输入的，如果不是，则判断所述客户机被远程控制。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="13" class="claim">
      <div class="claim-text">13.如权利要求9所述的系统，其特征在于，所述安全插件中的识别处理模块还执行下述操作：在支付时，切断所述客户机对除了所述支付平台的白名单的IP地址以外的所有TCP连接。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="14" class="claim">
      <div class="claim-text">14.如权利要求9所述的系统，其特征在于，所述安全插件后台中的识别处理单元执行的判断操作包括：对所述记录的客户机信息中包含的客户机IP地址与提出所述支付请求的实际请求源的IP地址进行比较，如果二者不一致，则判断所述客户机采用了代理。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="15" class="claim">
      <div class="claim-text">15.如权利要求14所述的系统，其特征在于，所述安全插件后台中的识别处理单元执行的判断操作还包括：对所述记录的客户机信息中包含的下列信息中的至少一个与提出所述支付请求的实际请求源的相应信息进行比较，如果二者不一致，则判断所述客户机采用了代理，所述的这些信息包括：宽带接入物理线路、MAC地址、硬盘ID和CPU系列号。</div>
    </div>
    </div> <div class="claim-dependent"> <div num="16" class="claim">
      <div class="claim-text">16.如权利要求14所述的系统，其特征在于，所述安全插件后台中的识别处理单元执行的判断操作还包括：通过识别HTTP包头的特征字段来识别HTTP代理。</div>
    </div>
    </div> <div class="claim"> <div num="17" class="claim">
      <div class="claim-text">17.一种基于互联网的支付平台，其特征在于包括：支付接口页面，用于接收支付请求；和安全插件后台，其包括：安全插件生成单元，用于生成一安全插件，该安全插件被下载到客户机，并判断所述客户机是否采用了代理或者被远程控制，所述判断的结果连同用户输入的支付请求被提交给所述安全插件后台；安全插件验证单元，基于与下载到所述客户机的安全插件的交互，对该安全插件的合法性进行验证，并获取客户机信息；客户机信息存储单元，用于记录所述客户机信息，和识别处理单元，用于基于所述安全插件的判断结果、所述记录的客户机信息和用户的支付请求判断所述客户机是否采用了代理或者被远程控制，如果是，则拒绝支付请求。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES57790356" lang="ZH" load-source="patent-office" class="description">
    <invention-title lang="ZH">保障基于互联网的 支付安全的方法、系统和平台</invention-title>
    <technical-field>
      <p>技术领域</p>
      <p>本发明涉及在基于互联网的支付中使用的方法、系统和平台。更具体地，涉及在通过互联网进行支付时保证支付安全的方法、系统和平台。</p>
    </technical-field>
    <background-art>
      <p>背景技术</p>
      <p>近年来，随着互联网宽带应用的不断发展，由银行、电信等部门提供的宽带收费平台给用户提供了极大的便利。但是，由于出现了通过帐号窃取以及通过利用木马(Trojan&#160;horse)程序进行盗用消费的情况，严重地威胁了互联网支付安全，给后续的宽带业务良性发展带来了很大的隐患。针对帐号窃取情况，可以采用将帐号与物理线路绑定的方式应对。而对于“木马程序”盗用消费的情况，还没有根本的防范方式。</p>
      <p>目前最为普遍的木马程序是代理型木马和远程控制型木马。图1中示意性地说明了黑客使用代理型木马和远程控制型木马进行盗用的情况。黑客通过其计算机101，使用端口扫描程序来对需要盗取的IP网段进行大范围的漏洞扫描，以试图找到一台存在安全漏洞的互联网用户主机。在黑客成功找到一台存在安全漏洞(例如存在管理员账号弱口令、系统安装的SQLServer数据库的管理员SA默认空口令等安全漏洞)的用户主机102后，黑客向该用户主机(受害者机器)102上传代理型木马程序或者远程控制型木马程序。在代理的情况下，黑客将其本机101的浏览器中的代理地址设为受害者机器102的地址，然后黑客就可以通过受害者机器102使用宽带应用平台103提供的所有服务，并进行消费。由于黑客的消费IP为受害者机器102的IP，消费的费用一般被记在受害者的账户上。而在远程控制的情况下，黑客通过网络远程控制受害者机器102，使用宽带应用平台103提供的服务进行消费，而将消费的费用记在受害者的账户上。</p>
      <p>目前，针对代理型木马和远程控制型木马盗用的情况，在客户端102侧和宽带应用平台103侧分别采取了一些防范方法。在宽带应用平台103侧，通过检查HTTP(HyperTextTransferProtocol，超文本传输协议)头部的某些字段特征，例如Pragma、Via、X-Forwarded-For、Cache-Control字段，对代理型木马进行识别检测。具体地说，如果平台103从HTTP包头的特征字段看到的是机器102，而实际请求支付的却是另一台机器101，则判断存在采用代理的方式进行消费的情况从而拒绝支付请求。但是，这种通过宽带应用平台103识别HTTP包头的特征字段的方法只能检测HTTP代理，而无法防范其他类型的代理如SOCKET代理、SocksCap+Socks等等。在客户端102侧，通常是通过查杀木马工具对远程控制型和代理型木马程序进行识别和处理。这种方法的缺陷是，目前大部分用户的安全防范意识薄弱，仅靠用户采取安全措施效果不理想。另外，所有的木马查杀工具只能识别常见的已知木马程序，而无法防范未知的木马程序，因而不能从根本上抑制宽带应用中的利用木马程序进行盗用消费的现象。</p>
    </background-art>
    <disclosure>
      <p>发明内容</p>
      <p>本发明的目的是在通过互联网进行支付的过程中，对远程控制型和代理型木马程序进行有效的检测和处理，以防止通过木马程序进行盗用的情况，从而保证支付安全。</p>
      <p>为实现上述目的，根据本发明的一个方面，提供一种保障基于互联网的支付安全的方法，其中包括以下步骤：客户机访问支付平台并下载一个安全插件；所述安全插件获取其所在的客户机的主机信息并连同合法性验证请求发送至所述支付平台中的安全插件后台；所述安全插件后台响应于所述合法性验证请求，对所述安全插件的合法性进行验证，获取并记录客户机信息；所述安全插件判断所述客户机是否采用了代理或者被远程控制，所得到的判断结果连同用户输入的支付请求被提交给所述支付平台；所述支付平台中的安全插件后台基于所述安全插件的判断结果、所述记录的客户机信息和所述支付请求判断所述客户机是否采用了代理或者被远程控制，如果是，则所述支付平台拒绝支付请求。</p>
      <p>根据本发明的另一个方面，提供一种基于互联网的安全支付系统，包括支付平台和客户机，其中：所述客户机包括一浏览器，该浏览器用于与所述支付平台通信，并从所述支付平台下载一个安全插件，所述安全插件包括：主机信息获取模块，用于获取其所在的客户机的主机信息并连同合法性验证请求发送至所述支付平台，和识别处理模块，用于判断所述客户机是否采用了代理或者被远程控制；所述支付平台包括用于接收支付请求的支付接口页面和安全插件后台，所述安全插件后台包括：安全插件生成单元，用于生成所述安全插件，安全插件验证单元，用于响应于所述合法性验证请求，对下载到所述客户机的安全插件的合法性进行验证，并获取客户机信息；客户机信息存储单元，用于记录所述客户机信息，和识别处理单元，用于基于所述安全插件中的识别处理模块的判断结果、所述记录的客户机信息和用户的支付请求判断所述客户机是否采用了代理或者被远程控制，如果是，则拒绝支付请求。</p>
      <p>根据本发明的另一个方面，提供一种基于互联网的支付平台，其中包括：支付接口页面，用于接收支付请求；和安全插件后台，其包括：安全插件生成单元，用于生成一安全插件，该安全插件被下载到客户机，并判断所述客户机是否采用了代理或者被远程控制，所述判断的结果连同用户输入的支付请求被提交给所述安全插件后台；安全插件验证单元，基于与下载到所述客户机的安全插件的交互，对该安全插件的合法性进行验证，并获取客户机信息；客户机信息存储单元，用于记录所述客户机信息，和识别处理单元，用于基于所述安全插件的判断结果、所述记录的客户机信息和用户的支付请求判断所述客户机是否采用了代理或者被远程控制，如果是，则拒绝支付请求。</p>
      <p>本发明的一个优点是，通过客户机侧的安全插件和宽带应用平台侧的插件后台自动双重检测远程控制型和代理型木马的情况，可以从根本上有效防范基于木马程序的盗用消费。</p>
      <p>本发明的另一个优点是，通过浏览器主动推送防木马安全插件，易于安装、推广和维护管理。</p>
      <p>另外，根据本发明的一种优选实施方式，可以通过动态的白名单方式，在对用户上网行为影响最小的情况下，有效抑制黑客利用木马程序进行盗用消费。</p>
    </disclosure>
    <description-of-drawings>
      <p>附图说明</p>
      <p>从下面结合附图对本发明优选实施例的描述，本领域的技术人员可以更清楚地理解本发明的进一步目的、特征和优点。在这些附图中，相同或相似的附图标记表示相同或相似的部件，其中：图1是说明黑客使用木马程序进行盗用的情况的示意图；图2A是根据本发明的支付系统的客户机侧的框图；图2B是根据本发明的支付系统的宽带应用平台侧的框图；图3是根据本发明对代理型木马进行检测的示意图；图4是根据本发明对远程控制型木马进行检测的示意图；图5是根据本发明的方法的流程图；图6是说明在根据本发明的一个优选实施例中，客户机侧的安全插件对代理型木马进行识别的方法的流程图；图7是说明在根据本发明的一个优选实施例中，客户机侧的安全插件对远程控制型木马进行识别的方法的流程图；图8是说明在根据本发明的一个优选实施例中，客户机侧的安全插件通过切断合法支付链路以外的所有链路来防范木马程序的方法的流程图；图9是说明在根据本发明的一个优选实施例中，宽带应用平台侧的安全插件后台对木马程序进行识别和处理的方法的流程图。</p>
    </description-of-drawings>
    <mode-for-invention>
      <p>具体实施方式</p>
      <p>图2A和图2B分别概略地示出了根据本发明的支付系统的客户机侧和宽带应用平台侧的框图。</p>
      <p>如图2A中所示，客户机201包括一个浏览器211，例如微软公司的IE浏览器，用于与宽带应用平台进行通信，并从该平台下载一个安全插件212。在支付的过程中，该安全插件212通过与平台侧的安全插件后台(后面将说明)的交互作用，在客户机201侧对木马程序进行检测和处理。该安全插件212包括以下组成部分：主机信息获取模块241和木马程序识别处理模块242。关于该安全插件212的各组成模块及其子模块(图中未示出)的功能将在下文中进行更详细的说明。</p>
      <p>如图2B中所示，宽带应用平台203，例如中国电信互联网宽带业务平台即VNET平台，包括支付接口页面231，用于接收用户通过客户机201上的浏览器211发出的支付请求。宽带应用平台203还包括一个安全插件后台232，用于通过与客户机201侧的安全插件212的交互作用，在平台侧实现对木马程序进行检测和处理。该安全插件后台232包括以下组成部分：安全插件生成单元251，安全插件验证单元252，木马程序识别单元253，安全插件文件存储单元255，和客户机信息存储单元256。</p>
      <p>需要说明的是，在图2B中，将插件后台232示为平台203的功能模块。但是，本领域的技术人员可以理解，插件后台232也可作为独立的功能实体实现。另外，为了避免模糊本发明的内容，宽带应用平台203中的那些与现有支付平台相同的部分以及那些并非与本发明密切相关的部分在图2B中没有示出。</p>
      <p>根据本发明的支付系统通过在请求支付的客户机上安装安全插件，并通过安全插件和宽带应用平台侧的插件后台之间的交互作用，实现木马程序的检测、识别和处理。下面结合图5详细说明根据本发明的方法。</p>
      <p>首先是安全插件检测、安装阶段。</p>
      <p>在步骤S1，用户利用浏览器211访问宽带应用平台203的支付接口页面231。</p>
      <p>在步骤S2，宽带应用平台203的支付接口页面231的脚本程序检查浏览器211中是否已经安装了防木马安全插件。如果不存在安全插件或安全插件的完整性被破坏，则在步骤S3a，该支付接口页面231提示用户通过浏览器211下载安装安全插件212。该安全插件212由图2B中所示的安全插件后台232中的安全插件生成单元251生成。如果浏览器211中已经安装了安全插件212，则在步骤S3b激活该安全插件212。</p>
      <p>接下来，进行到安全插件合法性检查及用户端口定位阶段。</p>
      <p>在步骤S4，安全插件212向宽带应用平台203发送插件合法性验证请求。具体地说，该安全插件212向安全插件后台232中的安全插件验证单元252发送一个插件合法性验证请求Question，其中包括由安全插件212生成的随机字符串k和由安全插件212中的主机信息获取模块241获得的关于客户机201的主机信息HostInfo，以及按照预定算法计算的Answer值。所述的随机字符串k例如可以只包含数字。所述的主机信息HostInfo例如可以包括客户机201的MAC地址、CPU系列号和硬盘ID。所述的预定算法例如可以为3DES算法，其中采用用户密码的SHA1值为密钥。</p>
      <p>接着进行到步骤S5。在宽带应用平台203侧，安全插件后台232中的安全插件验证单元252对安全插件212的合法性进行验证。具体地说，安全插件验证单元252提取插件合法性验证请求Question中的随机字符串k和主机信息HostInfo，与保存在插件后台232中的安全插件文件存储单元255中的安全插件文件一起作为输入参数，按照与安全插件212在客户机201侧相同的算法计算Answer值。如果安全插件验证单元252计算的Answer值与从插件合法性验证请求Question中提取的Answer值一致，则判断安全插件212合法，否则为不合法。另外，验证单元252还获取客户机201的端口信息。例如，验证单元252可以根据安全插件后台232与客户机201的TCP/IP连接数据包中的源IP地址向宽带接入认证系统查询客户机201的宽带接入物理线路、接入帐号等信息，或者，验证单元252可以直接获取插件合法性验证请求Question中的主机信息HostInfo作为客户机201的端口信息。</p>
      <p>在验证单元252判断安全插件212合法的情况下，则为获得此安全插件212的客户机201的publicIP建立一个SessionID，并将所述的客户机201的端口信息和SessionID记录在客户机信息存储单元256中。</p>
      <p>接着，在步骤S6，插件后台232向客户机201侧的安全插件212返回合法性请求验证结果，该结果中包含宽带应用平台203获取到的安全插件212所在的客户机201的IP地址和为其建立的SessionID。在本发明的一个实施例中，在该步骤S6，插件后台232还向客户机201侧的安全插件212返回宽带应用平台203的IP地址白名单，后面将对其进行说明。</p>
      <p>接下来，进行到安全插件和宽带应用平台中的安全插件后台对远程控制及代理型木马进行识别和处理的阶段。</p>
      <p>在步骤S7，安全插件212中的木马程序识别处理模块242按照一定的策略对代理型和远程控制型木马程序分别进行防范处理。</p>
      <p>对代理型木马的判断及处理在黑客利用代理型木马进行盗用消费的情况下，上面结合图2和图5描述的客户机201作为黑客机器运行。更具体地，如图3中所示，黑客机器201通过受害者机器302作为代理访问宽带应用平台203并请求支付。在这种情况下，按照本发明，安全插件212被下载到黑客机器201中并在其中运行。安全插件212需要对这种情况(即，该安全插件212所在的客户机201是一台采用了代理的黑客机器)进行识别和处理。</p>
      <p>图6示出了根据本发明的一个优选实施例，通过客户机201侧的安全插件212对代理型木马进行识别和处理的方法的流程图。</p>
      <p>在步骤601，安全插件212对浏览器211的注册表进行检查，以检查浏览器211中是否设置了HTTP或Socket代理。在步骤602中，如果该检查的结果为“是”，则直接提示用户“代理方式下不允许用户消费”，并将检查结果返回给平台。也就是说，此时安全插件212认为其所在的客户机201是一台通过代理方式进行盗用消费的黑客机器，则用户的支付请求被拒绝。</p>
      <p>如果在步骤602中，该检查的结果为“否”，即不存在HTTP或Socket代理，则继续进行步骤603-606，以对其他类型的代理例如SocksCap+Socks代理进行检查。具体来讲，当黑客使用了代理型木马时，安全插件212和浏览器211到宽带应用平台203或插件后台232的请求都会通过受害者机器302(图3)的代理进行。当安全插件212对插件后台232发出SOAP(Simple&#160;Object&#160;Access&#160;Protocol，简单对象访问协议)请求时，这个请求的目的地址肯定不会是插件后台203的IP地址，而是受害者机器302的地址。为此，在步骤603中，安全插件212对从该安全插件212到插件后台232的连接的目的地址进行检查，并在步骤604中对检查到的目的地址与插件后台203的IP地址进行比较。如果在步骤604中的比较结果是二者一致，则判断不存在代理(步骤606)。而如果在步骤604中的比较结果是二者不一致，则判断存在代理型木马(步骤605)，也就是说，此时安全插件212认为其所在的客户机201是通过代理方式进行盗用消费的黑客机器，则用户的支付请求将会被拒绝。</p>
      <p>需要说明的是，以上结合图6描述的识别方法是本发明的一种优选的实施方式。其中，通过首先采用步骤601和602，可以简单地对HTTP或Socket代理进行识别。在判断出存在这两种代理的情况下，则无需再执行下面的检查连接目的地址和比较的步骤。但是，本领域的技术人员可以理解的是，本发明的识别代理型木马的方法不限于此。例如，在本发明的另一个实施例中，可以省去步骤601和602，直接执行步骤603-606中的操作。</p>
      <p>另外，本领域技术人员可以理解，上面描述的识别、处理过程可以由安全插件212的木马程序识别处理模块242中一个相应的子模块完成。为了简明起见，没有在附图中示出该子模块。</p>
      <p>对远程控制型木马的处理利用远程控制型木马进行盗用消费的情况与代理型木马的情况有所不同。在远程控制型木马的情况中，上面结合图2和图5描述的客户机201作为受害者机器运行。更具体地，如图4中所示，黑客机器401通过网络对受害者机器201进行远程控制，访问宽带应用平台203并请求进行支付。在这种情况下，安全插件212被下载到受害者机器201中并在其中运行。安全插件212需要对这种情况(即，该插件212所在的客户机201是一台被黑客远程控制的受害者机器)进行防范和处理。</p>
      <p>以上结合图6描述的通过检查目的地址的识别方法不足以防范远程控制型木马。因为，在远程控制的情况下，从安全插件212到插件后台232的连接的目的地址就是插件后台232的IP地址，如图4中所示。</p>
      <p>为了对远程控制型木马进行防范，根据本发明的一个实施例，安全插件212采用了只允许用户通过物理键盘或物理鼠标输入支付帐号和密码的方式，而对于不是通过物理键盘或物理鼠标输入的支付帐号和密码，安全插件212将其判断为由黑客通过远程控制输入的信息。</p>
      <p>更具体地，以物理键盘输入识别为例，如图7中所示，在步骤701中，安全插件212提供一个输入框来代替浏览器211的输入框，并调用Windows的SDK中的API函数SetWindowsHookEx()来安装键盘钩子函数。在步骤702，当该密码输入框所在的窗体获得焦点时(此时用户输入支付帐号和密码)，系统就会调用键盘钩子的回调函数。在步骤703，回调函数可首先截获系统发给窗体的键盘输入的消息，得到对此消息的控制权。在步骤704，钩子函数识别支付帐号和密码是否是通过物理键盘输入的。关于物理键盘识别的更具体的描述，例如可参见微软公司的Knowledge&#160;Base的文章“Q320583&#160;HOW&#160;TO：TrapKeystrokes&#160;in.NET&#160;Controls&#160;by&#160;Using&#160;Visual&#160;Basic.NET:http://support.microsoft.com/kb/320583/en-us)。如果步骤704中的判断结果为“是”，则认为不存在远程控制(步骤706)。如果步骤704中的判断结果为“否”，则认为存在远程控制(步骤705)。也就是说，在这种情况下，该安全插件212认为其所在的客户机201是一台被黑客远程控制的受害者机器。</p>
      <p>同样，本领域技术人员可以理解，上面描述的识别、处理过程可以由安全插件212的木马程序识别处理模块242中一个相应的子模块完成，而为了简明起见，没有在附图中示出该子模块。</p>
      <p>对远程控制型和代理型木马的同时处理根据本发明的一个优选实施例，安全插件212的木马程序识别处理模块242还包括另一个子模块(图中没有示出)，其可以对远程控制型和代理型木马同时进行处理。</p>
      <p>如图4所示，当黑客机器401对受害者机器201进行远程控制时，由于黑客需要操纵受害者机器201上的浏览器211来进行消费，因此必然要在黑客机器401和受害者机器201之间建立网络连接。同时，黑客还要捕捉受害者机器201的远程屏幕，这就要求有稳定的连接进行数据传输。黑客机器401与受害者机器201之间的传输链路在图4中表示为链路411。目前能够进行远程屏幕控制的远程控制工具都使用了TCP(Transmission&#160;Control&#160;Protocol，传输控制协议)。基于这一考虑，根据本发明的一个优选实施例，安全插件212在用户进行支付时切断所有不是到宽带应用平台203的活动的TCP连接。也就是说，在支付过程中，安全插件212只允许客户机201保持连接至宽带应用平台203的链路412，而切断包括链路411在内的其他一切链路。</p>
      <p>这一方案的流程图如图8中所示。安全插件212被激活后，通过HTTP请求从插件后台232动态下载宽带应用平台203的IP地址白名单文件(结合参照图5，该获取步骤是在对S4步骤的响应即步骤S6中完成的)。然后，安全插件212启动一条线程，该线程例如每隔50毫秒把客户机201对所述白名单以外的所有TCP连接全部关闭。该切断链路的方案例如可以采用防火墙的包过滤的方式实现。另外，根据本发明的一种优选实施方式，在TCP/IP协议栈的Socket层有选择地关闭部分TCP&#160;Socket连接。因此，一方面可以不用针对不同操作系统安装不同的驱动程序，另一方面可以动态灵活地更新控制策略。更具体地说，根据本发明，通过组合使用Windows的多个API函数，例如通过操作系统Netstat&#160;API获取当前活动的TCP/UDP链接，通过Closesocket&#160;API关闭当前非白名单的活动链接来实现TCP链路的切断。应该注意的是，该线程是在图5中的步骤S7启动的，但该线程在整个支付请求处理中一直持续，直到支付请求处理结束，浏览器211退出支付页面，该线程才终止。通过这种方式，在黑客机器401企图通过链路411对客户机(受害者机器)201进行远程控制并请求支付的情况下，有效地切断了该控制链路411，使得支付不能进行。</p>
      <p>上面所述的通过切断除合法支付链路以外的所有链路的方案同样适用于防范代理型木马。如图3中所示，在代理型木马的情况下，黑客机器201是通过链路311、经由受害者机器302连接到平台203的。所以，在支付请求处理中，当安装在黑客机器201内的安全插件212启动上述线程来切断对白名单以外的所有TCP连接时，有效地切断了链路311，使得支付不能进行。</p>
      <p>现在回到图5，继续描述步骤S8。浏览器211向支付接口页面231提交用户输入的支付请求，包括前面所述的支付帐号和密码，并携带安全插件212在前面描述的过程中得到的判断结果(图6中的步骤605和606；图7中的步骤705和706)。接着，在步骤S9，支付接口页面231向安全插件后台232提交支付请求。</p>
      <p>在步骤S10，插件后台232中的木马程序识别单元253根据支付请求中携带的安全插件212的判断结果以及平台203侧的代理型木马判断策略，确定是否同意支付请求。图9中示出了在根据本发明的一个实施例中，插件后台232对木马程序的判断及处理方法。</p>
      <p>在步骤901，插件后台232接收支付接口页面231提交的支付请求。在步骤902，插件后台232对该支付请求进行分析，以检查安全插件212的判断结果是否为存在木马(代理型和远程控制型)。如果步骤902的检查结果为“是”，则进行到步骤905，即拒绝支付请求。如果步骤902的检查结果为“否”，则继续执行步骤903-906，以便基于平台203侧的代理型木马识别策略对代理型木马进行进一步判断，以进一步提高系统的安全性。更具体地，如图3所示，当黑客机器201通过受害者机器302的代理访问宽带应用平台203时，只要受害者机器302与黑客机器201不在同一LAN下，受害者机器302的外部IP地址与黑客机器201的外部IP地址不可能一致。所以，通过对这两个地址进行比较，可以识别出代理的情形。为此，在图9中的步骤903，宽带应用平台203从客户机信息存储单元256中提取在图5中的步骤S5获得并记录的安全插件212所在的客户机201的合法IP地址(公有IP地址)，并从支付请求中分析提出该支付请求的实际请求源的IP地址，然后对这二者进行比较。如果在步骤903中判断这二者不相符，则说明此请求是通过代理发送到宽带应用平台203的，于是拒绝支付请求(步骤905)。如果在步骤903中的判断结果是这二者相符，则进入步骤904。通过实际请求源与安全插件后台232的TCP/IP连接数据包中的源IP地址向宽带接入认证系统查询实际请求源的宽带接入物理线路、接入帐号等信息，或者获取由实际请求源的MAC地址、硬盘ID和CPU系列号等特征组成的主机信息，并与客户机信息存储单元256中存储的相应信息进行比较，如果一致则接受支付请求(步骤906)，否则认为用户客户机漫游或存在代理，于是拒绝支付请求(步骤905)。</p>
      <p>本领域的技术人员可以理解的是，在平台203侧识别代理型木马的方法不限于上面描述的示例性的实施方式。例如，在本发明的另一个实施例中，可以将现有技术中采用的识别HTTP包头的特征字段的步骤与图9中所示的步骤相结合来进行代理型木马的判断。</p>
      <p>最后在步骤S11，宽带应用平台203返回处理结果，即接受或拒绝支付请求，从而结束整个支付请求处理过程。</p>
      <p>从上面的描述可以看出，根据本发明，在处理用户的支付请求的过程中，下载到客户机的安全插件与宽带应用平台中的插件后台进行交互作用。在此基础上，安全插件和插件后台各自识别处理远程控制型和代理型木马，有效地防止了采用木马软件进行盗用支付，保证了支付安全。另外，该方法对用户上网行为影响小，部署及升级维护方便。本发明的适用场合包括但不限于以下所述的场景：黑客或受害者浏览器设置了HTTP或Socket代理的方式；当黑客机器以公有地址上网并通过任何HTTP代理或Socket代理的方式；当黑客以私有地址上网，受害者上网的公有出口IP地址与黑客的上网的公有出口IP地址不相同时，使用任何HTTP代理或Socket代理的方式；当黑客和受害者在同一NAT内，浏览器和其它应用均采用HTTP代理或Socket代理的方式；黑客远程控制受害者机器方式；等等。</p>
      <p>在本申请中，使用IE浏览器和VNET宽带应用平台作为例子来描述本发明的方法和系统。但是，本领域的技术人员可以理解，该例子仅仅是用于说明的目的而非用于限制。本发明同样可以应用于其他浏览器和平台。</p>
      <p>另外，本发明提供了针对代理型木马、远程控制型木马和针对所有木马的单独的识别处理方法。本领域的技术人员可以理解，在本发明的实际实施过程中，可以对这些方法进行组合来识别处理多种木马。</p>
      <p>以上已经结合优选实施例对本发明的进行了说明。本领域技术人员很清楚，这些实施例仅仅是用于说明的目的而非对本发明的限制。在不偏离本发明的精神和范围的情况下可以对这些实施例作出各种修改。</p>
    </mode-for-invention>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN101378312B?cl=zh">CN101378312B</a></td><td class="patent-data-table-td patent-date-value">2007年8月31日</td><td class="patent-data-table-td patent-date-value">2011年7月20日</td><td class="patent-data-table-td ">中国电信股份有限公司</td><td class="patent-data-table-td ">基于宽带网络的安全支付控制系统和方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102109986B?cl=zh">CN102109986B</a></td><td class="patent-data-table-td patent-date-value">2009年12月23日</td><td class="patent-data-table-td patent-date-value">2014年10月1日</td><td class="patent-data-table-td ">阿里巴巴集团控股有限公司</td><td class="patent-data-table-td ">一种提供接入序列号以及插件接入的方法、系统及装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103164791A?cl=zh">CN103164791A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年12月13日</td><td class="patent-data-table-td patent-date-value">2013年6月19日</td><td class="patent-data-table-td ">阿里巴巴集团控股有限公司</td><td class="patent-data-table-td ">一种通过电子终端实现安全支付的方法和装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103164791B?cl=zh">CN103164791B</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2011年12月13日</td><td class="patent-data-table-td patent-date-value">2016年4月6日</td><td class="patent-data-table-td ">阿里巴巴集团控股有限公司</td><td class="patent-data-table-td ">一种通过电子终端实现安全支付的方法和装置</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103268444A?cl=zh">CN103268444A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年12月28日</td><td class="patent-data-table-td patent-date-value">2013年8月28日</td><td class="patent-data-table-td ">武汉安天信息技术有限责任公司</td><td class="patent-data-table-td ">一种基于插件加载的android恶意代码检测系统及方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103365907A?cl=zh">CN103365907A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年4月6日</td><td class="patent-data-table-td patent-date-value">2013年10月23日</td><td class="patent-data-table-td ">腾讯科技（深圳）有限公司</td><td class="patent-data-table-td ">显示支付页面的方法、系统及服务器</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103400268A?cl=zh">CN103400268A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2013年7月24日</td><td class="patent-data-table-td patent-date-value">2013年11月20日</td><td class="patent-data-table-td ">北京奇虎科技有限公司</td><td class="patent-data-table-td ">一种实现浏览器安全支付的装置和方法</td></tr><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN103428190A?cl=zh">CN103428190A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2012年5月25日</td><td class="patent-data-table-td patent-date-value">2013年12月4日</td><td class="patent-data-table-td ">阿里巴巴集团控股有限公司</td><td class="patent-data-table-td ">一种远程桌面控制识别的方法和装置</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=qBmHAAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=G06Q0020160000">G06Q20/16</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=qBmHAAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=G06F0021570000">G06F21/57</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=qBmHAAABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029060000">H04L29/06</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2007年8月1日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2008年12月31日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2013年3月20日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Granted</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/bad7f9f1bff46fd80e24/CN101009005A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_6e802a6b2b28d51711baddc2f3bec198.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%BF%9D%E9%9A%9C%E5%9F%BA%E4%BA%8E%E4%BA%92%E8%81%94%E7%BD%91%E7%9A%84%E6%94%AF%E4%BB%98%E5%AE%89%E5%85%A8%E7%9A%84.pdf?id=qBmHAAABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U1_nJRAp9ZB-noC-W1CPc9rMBrcpQ"},"sample_url":"https://www.google.com/patents/reader?id=qBmHAAABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>