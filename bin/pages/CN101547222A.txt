<!DOCTYPE html><html><head><title>专利 CN101547222A - 一种在VoIP网络中传输SIP请求历史信息的方法 -  Google 专利</title><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){var d=void 0!=b?b:(new Date).getTime();this.t[a]=[d,c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(e){}};this.tick("start",null,a)}var a;window.performance&&(a=window.performance.timing);var f=a?new e(a.responseStart):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_",
"_wtsrt",d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();})();
</script><link rel="stylesheet" href="/patents/css/_50a6672b5f82ffbd39b7a9e87fd4594c/kl_intl_patents_bundle.css" type="text/css" /><script src="/books/javascript/atb_50a6672b5f82ffbd39b7a9e87fd4594c__zh_cn.js"></script><script>function googleTranslateElementInit() {new google.translate.TranslateElement({pageLanguage: "zh",gaTrack: true,gaId: "UA-27188110-1",multilanguagePage: true});}</script><script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script><meta name="DC.type" content="Patent"><meta name="DC.title" content="一种在VoIP网络中传输SIP请求历史信息的方法"><meta name="DC.contributor" content="刚 卢" scheme="inventor"><meta name="DC.contributor" content="辉 李" scheme="inventor"><meta name="DC.contributor" content="烽火通信科技股份有限公司" scheme="assignee"><meta name="DC.date" content="2009-5-14" scheme="dateSubmitted"><meta name="DC.description" content="一种在VoIP网络中传输SIP请求历史信息的方法，具体步骤为：1.为History-Info头域定义扩展参数digest；2.当一个SIP应用收到SIP请求时，把请求历史信息加入头域后，计算头域的摘要信息并放入到digest参数中，转发该SIP请求到下一跳；3.下一跳的SIP应用从头域中提取出digest参数携带的摘要信息，然后重新计算头域的摘要信息，根据摘要信息的对比确定该History-Info头域是否可信。本发明所述方法，通过为SIP消息的请求历史信息计算摘要的方式，可以有效的规避请求历史信息被伪造、篡改、删除和重新排列等问题，而且可以摆脱对TLS这类安全网络的依赖，使该功能可以在普通的IP网络中被应用。"><meta name="DC.date" content="2009-9-30"><meta name="citation_patent_publication_number" content="CN:101547222:A"><meta name="citation_patent_application_number" content="CN:200910136696"><link rel="canonical" href="https://www.google.com/patents/CN101547222A?cl=zh"/><meta property="og:url" content="https://www.google.com/patents/CN101547222A?cl=zh"/><meta name="title" content="专利 CN101547222A - 一种在VoIP网络中传输SIP请求历史信息的方法"/><meta name="description" content="一种在VoIP网络中传输SIP请求历史信息的方法，具体步骤为：1.为History-Info头域定义扩展参数digest；2.当一个SIP应用收到SIP请求时，把请求历史信息加入头域后，计算头域的摘要信息并放入到digest参数中，转发该SIP请求到下一跳；3.下一跳的SIP应用从头域中提取出digest参数携带的摘要信息，然后重新计算头域的摘要信息，根据摘要信息的对比确定该History-Info头域是否可信。本发明所述方法，通过为SIP消息的请求历史信息计算摘要的方式，可以有效的规避请求历史信息被伪造、篡改、删除和重新排列等问题，而且可以摆脱对TLS这类安全网络的依赖，使该功能可以在普通的IP网络中被应用。"/><meta property="og:title" content="专利 CN101547222A - 一种在VoIP网络中传输SIP请求历史信息的方法"/><meta property="og:type" content="book"/><meta property="og:site_name" content="Google Books"/><meta property="og:image" content="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><link rel="image_src" href="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"/><script>if (window['_OC_timingAction']) {window['_OC_timingAction']('patents_refpage');}</script><style>#gbar,#guser{font-size:13px;padding-top:1px !important;}#gbar{height:22px}#guser{padding-bottom:7px !important;text-align:right}.gbh,.gbd{border-top:1px solid #c9d7f1;font-size:1px}.gbh{height:0;position:absolute;top:24px;width:100%}@media all{.gb1{height:22px;margin-right:.5em;vertical-align:top}#gbar{float:left}}a.gb1,a.gb4{text-decoration:underline !important}a.gb1,a.gb4{color:#00c !important}.gbi .gb4{color:#dd8e27 !important}.gbf .gb4{color:#900 !important}

#gbar { padding:.3em .6em !important;}</style></head><body ><div id=gbar><nobr><a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&sa=N&tab=tw">搜索</a> <a class=gb1 href="https://www.google.com/search?cl=zh&hl=zh-CN&tbm=isch&source=og&sa=N&tab=ti">图片</a> <a class=gb1 href="https://maps.google.com/maps?cl=zh&hl=zh-CN&sa=N&tab=tl">地图</a> <a class=gb1 href="https://play.google.com/?cl=zh&hl=zh-CN&sa=N&tab=t8">Play</a> <a class=gb1 href="https://www.youtube.com/results?cl=zh&hl=zh-CN&sa=N&tab=t1">YouTube</a> <a class=gb1 href="https://news.google.com/nwshp?hl=zh-CN&tab=tn">新闻</a> <a class=gb1 href="https://mail.google.com/mail/?tab=tm">Gmail</a> <a class=gb1 href="https://drive.google.com/?tab=to">云端硬盘</a> <a class=gb1 style="text-decoration:none" href="https://www.google.com/intl/zh-CN/options/"><u>更多</u> &raquo;</a></nobr></div><div id=guser width=100%><nobr><span id=gbn class=gbi></span><span id=gbf class=gbf></span><span id=gbe></span><a target=_top id=gb_70 href="https://www.google.com/accounts/Login?service=&continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN&hl=zh-CN" class=gb4>登录</a></nobr></div><div class=gbh style=left:0></div><div class=gbh style=right:0></div><div role="alert" style="position: absolute; left: 0; right: 0;"><a href="https://www.google.com/patents/CN101547222A?cl=zh&amp;hl=zh-CN&amp;output=html_text" title="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"><img border="0" src="//www.google.com/images/cleardot.gif"alt="屏幕阅读器用户请注意：点击此链接可进入无障碍模式。阅读器在无障碍模式下具有同样的基本功能，但可让用户获得更好的体验。"></a></div><div class="kd-appbar"><h2 class="kd-appname"><a href="/patents?hl=zh-CN"> 专利</a></h2><div class="kd-buttonbar left" id="left-toolbar-buttons"><a id="appbar-write-review-link" href=""></a><a id="appbar-view-print-sample-link" href=""></a><a id="appbar-view-ebook-sample-link" href=""></a><a id="appbar-patents-prior-art-finder-link" href="https://www.google.com/patents/related/CN101547222A"></a><a id="appbar-patents-discuss-this-link" href="https://www.google.com/url?id=8bJtBwABERAJ&amp;q=http://patents.stackexchange.com/redirect/google-patents%3Fpublication%3DCN101547222A&amp;usg=AFQjCNH7gHKmNj9iqysQsDkWCvFHcVXr4w" data-is-grant="false"></a><a id="appbar-read-patent-link" href="//docs.google.com/viewer?url=patentimages.storage.googleapis.com/pdfs/f11070be592d9d37e8c1/CN101547222A.pdf"></a><a id="appbar-download-pdf-link" href="//patentimages.storage.googleapis.com/pdfs/f11070be592d9d37e8c1/CN101547222A.pdf"></a><a class="appbar-content-language-link" data-selected="true" data-label="中文" href="/patents/CN101547222A?cl=zh&amp;hl=zh-CN"></a><a class="appbar-content-language-link" data-label="英语" href="/patents/CN101547222A?cl=en&amp;hl=zh-CN"></a><a class="appbar-application-grant-link" data-selected="true" data-label="申请" href="/patents/CN101547222A?hl=zh-CN&amp;cl=zh"></a><a class="appbar-application-grant-link" data-label="授权" href="/patents/CN101547222B?hl=zh-CN&amp;cl=zh"></a></div><div class="kd-buttonbar right" id="right-toolbar-buttons"></div></div><div id="books-microdata" itemscope=""itemtype="http://schema.org/Book"itemid="https://www.google.com/patents/CN101547222A?cl=zh" style="display:none"><span itemprop="description">一种在VoIP网络中传输SIP请求历史信息的方法，具体步骤为：1.为History-Info头域定义扩展参数digest；2.当一个SIP应用收到SIP请求时，把请求历史信息加入头域后，计算头域的摘要信息并放入到digest参数中，转发该SIP请求到下一跳；3...</span><span itemprop="url">https://www.google.com/patents/CN101547222A?cl=zh&amp;utm_source=gb-gplus-share</span><span class="main-title" itemprop="name">专利 CN101547222A - 一种在VoIP网络中传输SIP请求历史信息的方法</span><img itemprop="image" src="https://www.google.com/patents?id=&amp;printsec=frontcover&amp;img=1&amp;zoom=1"alt="专利 CN101547222A - 一种在VoIP网络中传输SIP请求历史信息的方法" title="专利 CN101547222A - 一种在VoIP网络中传输SIP请求历史信息的方法"></div><div style="display: none"><ol id="ofe-gear-menu-contents" class="gbmcc"><li class="gbe gbmtc"><a class="gbmt goog-menuitem-content" id="" href="https://www.google.com/advanced_patent_search?hl=zh-CN"> 高级专利搜索</a></li></ol></div><div id="volume-main"><div id="volume-center"><div class=vertical_module_list_row><div id=intl_patents class=about_content><div id=intl_patents_v><table class="patent-bibdata patent-drawings-missing"><tr><td class="patent-bibdata-heading"> 公开号</td><td class="single-patent-bibdata">CN101547222 A</td></tr><tr><td class="patent-bibdata-heading">发布类型</td><td class="single-patent-bibdata">申请</td></tr><tr><td class="patent-bibdata-heading"> 专利申请号</td><td class="single-patent-bibdata">CN 200910136696</td></tr><tr><td class="patent-bibdata-heading">公开日</td><td class="single-patent-bibdata">2009年9月30日</td></tr><tr><td class="patent-bibdata-heading"> 申请日期</td><td class="single-patent-bibdata">2009年5月14日</td></tr><tr><td class="patent-bibdata-heading"> 优先权日<span class="patent-tooltip-anchor patent-question-icon"data-tooltip-text="优先日期属于假设性质，不具任何法律效力。Google 对于所列日期的正确性并没有进行法律分析，也不作任何陈述。"></span></td><td class="single-patent-bibdata">2009年5月14日</td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">公告号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101547222B?hl=zh-CN&amp;cl=zh">CN101547222B</a></span></span></td></tr><tr class="patent-bibdata-list-row alternate-patent-number"><td class="patent-bibdata-heading"> 公开号</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value">200910136696.X, </span><span class="patent-bibdata-value">CN 101547222 A, </span><span class="patent-bibdata-value">CN 101547222A, </span><span class="patent-bibdata-value">CN 200910136696, </span><span class="patent-bibdata-value">CN-A-101547222, </span><span class="patent-bibdata-value">CN101547222 A, </span><span class="patent-bibdata-value">CN101547222A, </span><span class="patent-bibdata-value">CN200910136696, </span><span class="patent-bibdata-value">CN200910136696.X</span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 发明者</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E5%88%9A+%E5%8D%A2%22">刚 卢</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=ininventor:%22%E8%BE%89+%E6%9D%8E%22">辉 李</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading"> 申请人</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="https://www.google.com/search?tbo=p&amp;tbm=pts&amp;hl=en&amp;q=inassignee:%22%E7%83%BD%E7%81%AB%E9%80%9A%E4%BF%A1%E7%A7%91%E6%8A%80%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22">烽火通信科技股份有限公司</a></span></span></td></tr><tr class="patent-bibdata-list-row "><td class="patent-bibdata-heading">导出引文</td><td><span class="patent-bibdata-value-list"><span class="patent-bibdata-value"><a href="/patents/CN101547222A.bibtex?cl=zh">BiBTeX</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101547222A.enw?cl=zh">EndNote</a>, </span><span class="patent-bibdata-value"><a href="/patents/CN101547222A.ris?cl=zh">RefMan</a></span></span></td></tr><tr class="patent-internal-links"><td colspan=2><span class="patent-bibdata-value"><a href="#forward-citations"> 被以下专利引用</a> (1),</span> <span class="patent-bibdata-value"><a href="#classifications">分类</a> (3),</span> <span class="patent-bibdata-value"><a href="#legal-events">法律事件</a> (3)</span> </td></tr><tr><td colspan=2 class="patent-bibdata-external-link-spacer-top"></td></tr><tr class="patent-bibdata-external-link-spacer-bottom"></tr><tr><td colspan=2><span class="patent-bibdata-heading">外部链接:&nbsp;</span><span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=8bJtBwABERAJ&amp;q=http://211.157.104.87:8080/sipo/zljs/hyjs-yx-new.jsp%3Frecid%3D200910136696&amp;usg=AFQjCNGpScUHjaZ5MShlRYEYUK15Cvz9NQ"> 中国国家知识产权局</a>, </span><span class="patent-bibdata-value"><a href="https://www.google.com/url?id=8bJtBwABERAJ&amp;q=http://worldwide.espacenet.com/publicationDetails/biblio%3FCC%3DCN%26NR%3D101547222A%26KC%3DA%26FT%3DD&amp;usg=AFQjCNFLSnVAur3XfJWkoLQAQwpDcRKpPw"> 欧洲专利数据库 (Espacenet)</a></span></span></td></tr><tr class="patent-bibdata-group-spacer"></tr></table><div class="number-and-title"><span class="patent-title"><invention-title mxw-id="PT86510159" lang="ZH" load-source="patent-office">一种在VoIP网络中传输SIP请求历史信息的方法</invention-title>
      </span><br><span class="patent-number">CN 101547222 A</span></div><div class="patent-section patent-abstract-section"><div class="patent-section-header"><span class="patent-section-title"> 摘要</span></div><div class="patent-text"><abstract mxw-id="PA62794120" lang="ZH" load-source="patent-office">
    <div class="abstract">一种在VoIP网络中传输SIP请求历史信息的方法，具体步骤为：1.为History-Info头域定义扩展参数digest；2.当一个SIP应用收到SIP请求时，把请求历史信息加入头域后，计算头域的摘要信息并放入到digest参数中，转发该SIP请求到下一跳；3.下一跳的SIP应用从头域中提取出digest参数携带的摘要信息，然后重新计算头域的摘要信息，根据摘要信息的对比确定该History-Info头域是否可信。本发明所述方法，通过为SIP消息的请求历史信息计算摘要的方式，可以有效的规避请求历史信息被伪造、篡改、删除和重新排列等问题，而且可以摆脱对TLS这类安全网络的依赖，使该功能可以在普通的IP网络中被应用。</div>
  </abstract>
  </div></div><div class="patent-section patent-claims-section"><div class="patent-section-header"><span class="patent-section-title">权利要求<span class="patent-section-count">(1)</span></span></div><div class="patent-text"><div mxw-id="PCLM23166025" lang="ZH" load-source="patent-office" class="claims">
    <div class="claim"> <div num="1" class="claim">
      <div class="claim-text">1. 一种在VoIP网络中传输SIP请求历史信息的方法，其特征在于：其具体步骤为：步骤1，为History-Info头域定义扩展参数digest；步骤2，当一个SIP应用收到SIP请求时，把请求历史信息加入History-Info头域后，用摘要算法计算出History-Info头域包含的全部内容的摘要信息，然后在History-Info头域中增加digest参数，把所述摘要信息放入到digest参数中；转发该SIP请求到下一跳的SIP应用；步骤3，下一跳的SIP应用接收到转发来的SIP请求时，首先从History-Info头域中提取出digest参数携带的摘要信息，然后从History-Info头域中删除digest参数，然后用与步骤2相同的摘要算法重新计算一遍当前History-Info头域包含的全部内容的摘要信息，把重新计算出的摘要信息和digest参数携带的摘要信息进行比较，如果比较结果一致，则认为该History-Info头域是可信的，此时当前SIP应用把自己的信息加入到History-Info头域后，用摘要算法计算出新的History-Info头域包含的全部内容的新摘要信息，然后在新的History-Info头域中增加digest参数，把所述新摘要信息放入到digest参数中；转发当前SIP请求到下一跳的SIP应用；如果比较结果不一致，则认为该History-Info头域是不可信的，转发当前SIP请求到下一跳的SIP应用前删除不可信的History-Info头域，或者请求上一跳的SIP应用重新发起请求而不进行转发。</div>
    </div>
  </div> </div>
  </div></div><div class="patent-section patent-description-section"><div class="patent-section-header"><span class="patent-section-title"> 说明</span></div><div class="patent-text"><div mxw-id="PDES28144757" lang="ZH" load-source="patent-office" class="description">
    <p>一种在VoIP网络中传输SIP请求历史信息的方法</p>
    <p>技术领域</p>
    <p>本发明涉及通信领域，具体的说是一种在VoIP网络中传输SIP 请求历史信息的方法。</p>
    <p>背景技术</p>
    <p>会话初始协议（Session Initiation Protocol, SIP协议）是 IETF (Internet工程任务组）提出的一个支持多媒体会话的信令控 制协议，主要用于实现IP网上的信令控制，包括建立、管理和终止 由多方参与的语音会话进程。SIP协议借鉴了 HTTP、 SMTP等协议， 支持代理、重定向及登记定位用户等功能，支持用户移动。通过与 RTP/RTCP、 SDP、 RTSP等协议及DNS配合，SIP协议支持语音、视频、 数据、E-mail、状态、IM、聊天、游戏等。</p>
    <p>SIP协议是一个基于文本的应用层控制协议，独立于底层传输协 议TCP/UDP/SCTP。 SIP协议分为请求和响应两种类型，而请求又包括 REGISTER、 INVITE、 ACK、 BYE和OPTION等类型。SIP协议的基本网 络元素包括UA (User Agent,用户代理）、Proxy (代理服务器）、 Registrar (注册服务器）和Redirect Server (重定向服务器）等。</p>
    <p>VoIP (Voice over Internet Protocol)是指将模拟的声音讯号 经过压缩与封包之后，以数据封包的形式在IP网络的环境进行语音 讯号的传输，通俗来说也就是互联网电话、网络电话或者简称IP电 话的意思。VoIP的基本原理是：通过语音的压&#32302;算法对语音数据编 码进行压&#32302;处理，然后把这些语音数据按TCP/IP标准进行打包，经 过IP网络把数据包送至接收地，再把这些语音数据包串起来，经过 解压处理后，恢复成原来的语音信号，从而达到由互联网传送语音的 目的。TLS (传输层安全，Transport Layer Security)是基于SSL (安 全端口层，Secure Socket Layer)的一种协议。SSL是设计用来保 护网页通信，并且现在应用于绝大多数浏览器中。TLS是比SSL更通 用，它可以用于保护任何类型的可靠连接。TLS为可靠连接（如一个 TCP连接）提供数据的完整性和保密性。TLS包括两层：TLS握手层 (TLS handshake layer)禾口 TLS记录层(TLS record layer)。 TLS 握手层处理对等用户的认证，在这一层使用了公共密钥和证书，并协 商算法和加密实际数据传输的密钥。TLS记录层处理数据的加密，通 常它使用一个对称的算法，这个算法的密钥由握手层提供的值产生。 TLS是一个逐跳（h叩by hop)的安全措施，在SIP的应用中，TLS 保护一个SIP实体与和它相距一跳远的另一实体之间的信息交换。</p>
    <p>现有SIP网络中提供历史请求记录的方式如下图1所示。主要工 作过程如下：</p>
    <p>1. 用户代理1发送一个INVITE请求到代理服务器1;</p>
    <p>2. 代理服务器1转发这个INVITE请求到代理服务器2，代理 服务器2在转发前在INVITE请求中的History-Info头域中增加代理 服务器1以及代理服务器2的信息；以图1为例，在INVITE请求中 的History-Info头域中增加下述信息：</p>
    <p>〈sip:Bob@Pl. example, com〉； index二l， 〈sip:Bob@P2. example, com〉；index二l.l5</p>
    <p>3. 代理服务器2在给代理服务器1回响应之前，尝试把这个 INVITE请求通过SIP具有的Forking机制并行转发到用户代理2、用 户代理3、用户代理4，所说的Forking机制是指： 一个用户注册了 多个用户代理（一号多机)，到该用户的呼叫会同时转发到上述的多 个用户代理去。以图1为例，用户代理2、用户代理3和用户代理4 是属于同一个用户的用户代理，在代理服务器2转发INVITE请求前 添加用户代理的信息。具体地说，是在转发的各个INVITE请求的 History-Info头域中分别增加各个用户代理的信息；以图1为例， 图1中代理服务器2尝试把这个INVITE请求并行转发到用户代理2、用户代理3、用户代理4，在转发的各个INVITE请求的History-Info</p>
    <p>头域中增加的信息如下：</p>
    <p>在转发到用户代理2的INVITE请求的History-Info头域中增加 〈sip:User2@UA2. example. com&gt;;index=l. 1. 1，</p>
    <p>在转发到用户代理3的INVITE请求的History-Info头域中增加 〈sip:User3@UA3. example, com〉 ； index=l. 1. 2，</p>
    <p>在转发到用户代理4的INVITE请求的History-Info头域中增加 &lt;sip:User4@UA4. example. com&gt;:index=l. 1. 3;</p>
    <p>4. 当用户代理2、用户代理3、用户代理4对上述INVITE请 求的响应都是不成功或不可用时，代理服务器2发送一个480响应给 代理服务器1，在480响应的History-Info头域中增加第3步中尝 试的各个用户代理的信息以及失败原因等；以图1为例，用户代理2、 用户代理3、用户代理4对INVITE请求的响应都是不成功或不可用， 此时，代理服务器2发送一个480响应给代理服务器1，在480响应 的History-Info头域中增加信息如下：</p>
    <p>〈sip:User2@UA2. example. com"?Reason二SIP; \ cause=408;text=〃RequestTimeout〃〉；index=l.1.1， 〈sip:User3@UA3. example. com7Reason二SIP;\ cause=487;text=〃Request Terminated〃〉；index=l. 1. 2， 〈sip:User4@UA4. example. com"?Reasoiv^SIP; \ cause=603;text=〃Decline〃&gt;;index=l. 1.3;</p>
    <p>5. 当代理服务器1接收到这个480响应时，代理服务器1检 测到INVITE的另一个路由途径&#8212;&#8212;用户代理5，于是代理服务器1 把这个INVITE请求转发给用户代理5。在该INVITE请求的 History-Info头域中增加用户代理5的信息；以图1为例，代理服 务器1把这个INVITE请求转发给用户代理5，在转发到用户代理5 的INVITE请求的History-Info头域中增加信息如下：</p>
    <p>&lt;sip:User2@UA2. example. com7Reason二SIP;cause=408;\ text="RequestTimeout"&gt;;index二l. 1. 1，&lt;sip:User3@UA3. example. com*?Reason=SIP; cause=487; \</p>
    <p>text="Request Terminated"; index=l. 1.2，</p>
    <p>〈sip:User4@UA4. example. com7Reason二SIP;cause=603;\</p>
    <p>text="Decline"〉；index二l. 1. 3</p>
    <p>〈sip:User5@UA5. example. com&gt;;index=l. 2;</p>
    <p>6. 用户代理5发送200 OK响应给代理服务器1，代理服务器 1把这个200 OK响应转发给用户代理1,用户代理1向用户代理5发 送ACK响应，在用户代理1和用户代理5之间建立这个呼叫会话。</p>
    <p>虽然History-Info头域提供了请求历史信息的记录，但是由于 SIP协议是基于文本的协议，以文本形式表示消息的词法和语法分析 比较简单，非常容易被攻击者模仿、篡改，加以非法利用。 History-Info头域也有如下几个缺陷：</p>
    <p>* 一个不可信的应用程序可能插入一个伪造的请求历史信息 条目。</p>
    <p>* 一个不可信的应用程序可能重排了请求历史信息。</p>
    <p>* 一个不可信的应用程序可能删除某些请求历史信息条目。 因此在RFC4244中，提出了 History-Info头域必须在TLS这类</p>
    <p>安全网络中传输。如果没有使用TLS，则必须在转发之前删除 History-Info头域；或者对重定向该请求消息，要求客户端用户代 理通过安全的途径发起这个包含History-Info头域的请求。</p>
    <p>但由于TLS网络建设成本高，并没有大规模应用，也就导致了 History-Info头域的机制并不能在普通IP网络中大量应用。</p>
    <p>发明内容</p>
    <p>针对现有技术中存在的缺陷，本发明的目的在于提供一种在VoIP 网络中传输SIP请求历史信息的方法，通过为SIP消息的请求历史信 息计算摘要的方式，可以有效的规避请求历史信息被伪造、篡改、删 除和重新排列等问题，而且可以摆脱对TLS这类安全网络的依赖，使该功能可以在普通的IP网络中被应用。</p>
    <p>为达到以上目的，本发明采取的技术方案是：</p>
    <p>一种在VoIP网络中传输SIP请求历史信息的方法，其特征在于: 其具体步骤为：</p>
    <p>步骤1，为History-Info头域定义扩展参数digest;</p>
    <p>步骤2，当一个SIP应用收到SIP请求时，把请求历史信息加入 History-Info头域后，用摘要算法计算出History-Info头域包含的 全部内容的摘要信息，然后在History-Info头域中增加digest参数， 把所述摘要信息放入到digest参数中；转发该SIP请求到下一跳的 SIP应用；</p>
    <p>步骤3，下一跳的SIP应用接收到转发来的SIP请求时，首先从 History-Info头域中提取出digest参数携带的摘要信息，然后从 History-Info头域中删除digest参数，然后用与步骤2相同的摘要 算法重新计算一遍当前History-Info头域包含的全部内容的摘要信 息，把重新计算出的摘要信息和digest参数携带的摘要信息进行比 较，如果比较结果一致，则认为该History-Info头域是可信的，此 时当前SIP应用把自己的信息加入到History-Info头域后，用摘要 算法计算出新的History-Info头域包含的全部内容的新摘要信息， 然后在新的History-Info头域中增加digest参数，把所述新摘要信 息放入到digest参数中；转发当前SIP请求到下一跳的SIP应用； 如果比较结果不一致，则认为该History-Info头域是不可信的，转 发当前SIP请求到下一跳的SIP应用前删除不可信的History-Info 头域，或者请求上一跳的SIP应用重新发起请求而不进行转发。</p>
    <p>本发明所述的在VoIP网络中传输SIP请求历史信息的方法，通 过为SIP消息的请求历史信息计算摘要的方式，可以有效的规避请求 历史信息被伪造、篡改、删除和重新排列等问题，而且可以摆脱对 TLS这类安全网络的依赖，使该功能可以在普通的IP网络中被应用。附图说明</p>
    <p>本发明有如下附图：</p>
    <p>图1现有IP网络中记录请求历史记录的流程； 图2本发明方案示意图；</p>
    <p>图3实施例l:经过重定向服务器和代理服务器的会话流程； 图4实施例2:串行分岔会话流程。</p>
    <p>具体实施方式</p>
    <p>以下结合附图对本发明作进一步详细说明。</p>
    <p>图2为本发明所述的在VoIP网络中传输SIP请求历史信息的方 法，本发明通过对现有的SIP头域进行扩展，提供了一种在普通IP 网络中对History-Info头域进行保护的方法，使得History-Info头 域可以在普通IP网络中进行传递;本发明提供的扩展方式和目前SIP 网络的消息流程并不冲突，可以同时存在，并作为现有流程的很好补 充，为SIP应用提供了一种更为灵活的记录请求历史信息的方法，使 其摆脱了 TLS网络的限制，大大扩展了 SIP消息的请求历史信息功能 的应用场景。本发明所述的方法在RFC4244 (An Extension to the Session Initiation Protocol ( SIP ) for Request History Information)定义的基础上进行运用，并且实际运用到SIP网络的 消息流程中，History-Info头域是在RFC4244中定义，但本专利并 不限定于RFC4244。在RFC4244中定义了 History-Info头域的可选 扩展参数，这个扩展参数满足generic-param格式，其具体定义如下：</p>
    <p>History-Info = "History-Info" HC0L0N</p>
    <p>hi-entry&#27706;（CO&#40599;A hi-entry)</p>
    <p>hi-entry = hi-targeted-to-uri&#27706;(SEMI hi-param )</p>
    <p>hi-targeted-to-uri= name-addr</p>
    <p>hi-param = hi-index / hi-extension</p>
    <p>hi&#8212;index = 〃index〃 EQUAL 1*DIGIT * (DOT 1*DIGIT)hi&#8212;extension = generic-param</p>
    <p>本发明就是利用了这个扩展参数，为History-Info头域定义了 一个新的扩展参数digest。具体地说，其具体步骤为：</p>
    <p>步骤1，为History-Info头域定义扩展参数digest;</p>
    <p>步骤2，当一个SIP应用收到SIP请求时，把请求历史信息加入 History-Info头域后，用摘要算法计算出History-Info头域包含的 全部内容的摘要信息，然后在History-Info头域中增加digest参数， 把所述摘要信息放入到digest参数中；转发该SIP请求到下一跳的 SIP应用；</p>
    <p>步骤3，下一跳的SIP应用接收到转发来的SIP请求时，首先从 History-Info头域中提取出digest参数携带的摘要信息，然后从 History-Info头域中删除digest参数，然后用与步骤2相同的摘要 算法重新计算一遍当前History-Info头域包含的全部内容的摘要信 息，把重新计算出的摘要信息和digest参数携带的摘要信息进行比 较，如果比较结果一致，则认为该History-Info头域是可信的，此 时当前SIP应用把自己的信息加入到History-Info头域后，用摘要 算法计算出新的History-Info头域包含的全部内容的新摘要信息， 然后在新的History-Info头域中增加digest参数，把所述新摘要信 息放入到digest参数中；转发当前SIP请求到下一跳的SIP应用； 如果比较结果不一致，则认为该History-Info头域是不可信的，转 发当前SIP请求到下一跳的SIP应用前删除不可信的History-Info 头域，或者请求上一跳的SIP应用重新发起请求而不进行转发。</p>
    <p>所述的计算摘要的方法可以采用MD5或者SHA-1算法。</p>
    <p>图2为图1使用本发明所述方法后的各个步骤，具体地说： 步骤1，用户代理1发送一个INVITE请求到代理服务器1; 步骤2，代理服务器1转发这个INVITE请求到代理服务器2，代 理服务器2在转发前在INVITE请求中的History-Info头域中增加代 理服务器1以及代理服务器2的信息，然后计算摘要信息并通过扩展参数digest添加到History-Info头域中；以图2为例，在INVITE 请求中的History-Info头域中增加下述信息：</p>
    <p>〈sip:Bob@Pl. example, com〉 ； index=l，</p>
    <p>&lt;sip:Bob@P2. example, com〉 ； index二l. l.'</p>
    <p>digest=d41d8cd98f00b204e9800998ecf8427e</p>
    <p>步骤3，代理服务器2在给代理服务器1回响应之前，尝试把这 个INVITE请求通过SIP具有的Forking机制并行转发到用户代理2、 用户代理3、用户代理4，，在代理服务器2转发INVITE请求前添加 用户代理的信息。具体地说，是在转发的各个INVITE请求的 History-Info头域中分别增加各个用户代理的信息，然后计算各摘 要信息并通过扩展参数digest添加到History-Info头域中；以图2 为例，图2中代理服务器2尝试把这个INVITE请求并行转发到用户 代理2、用户代理3、用户代理4，在转发的各个INVITE请求的 History-Info头域中增加的信息如下：</p>
    <p>在转发到用户代理2的INVITE请求的History-Info头域中增加 &lt;sip:User2@UA2. example, com〉；index二l. 1. 1，</p>
    <p>digest=0ccl75b9c0flb6a831c399e269772661</p>
    <p>在转发到用户代理3的INVITE请求的History-Info头域中增加 〈sip:User3@UA3. example, com〉； index=l. 1.2,</p>
    <p>digest=900150983cd24fb0d6963f7d28el7f72</p>
    <p>在转发到用户代理4的INVITE请求的History-Info头域中增加 &lt;sip:User4@UA4. example. com&gt;;index=L 1. 3;</p>
    <p>digest=f96b697d7cb7938d525a2f31aafl61d0</p>
    <p>步骤4，当用户代理2、用户代理3、用户代理4对上述INVITE 请求的响应都是不成功或不可用时，代理服务器2发送一个480响应 给代理服务器1，在480响应的History-Info头域中增加第3步中 尝试的各个用户代理的信息以及失败原因等；以图2为例，用户代理 2、用户代理3、用户代理4对INVITE请求的响应都是不成功或不可 用，此时，代理服务器2发送一个480响应给代理服务器1，在480响应的History-Info头域中增加信息如下：</p>
    <p>&lt;sip:User2@UA2. example. com"?Reason二SIP; \</p>
    <p>cause二408;text二〃RequestTimeout〃〉；index二l.1.1，</p>
    <p>〈sip:User3@UA3. example. com"?Reason二SIP; \</p>
    <p>cause=487; text=〃Request Terminated"; index=l. 1. 2，</p>
    <p>〈sip:User4@UA4. example. com7Reason二SIP;\</p>
    <p>cause=603;text二"Decline〃〉；index二l. 1.3;</p>
    <p>digest=c3fcd3d76192e4007dfb496cca67el3b</p>
    <p>步骤5，当代理服务器1接收到这个480响应时，代理服务器l 检测到INVITE的另一个路由途径&#8212;&#8212;用户代理5,于是代理服务器1 把这个INVITE请求转发给用户代理5。在该INVITE请求的 History-Info头域中增加用户代理5的信息；以图2为例，代理服 务器1把这个INVITE请求转发给用户代理5，在转发到用户代理5 的INVITE请求的History-Info头域中增加信息如下：</p>
    <p>〈sip:User2@UA2. example. com?Reason=SIP;cause=408;\</p>
    <p>text=〃RequestTimeout〃〉；index=l. 1. 1，</p>
    <p>&lt;sip:User3@UA3. example. com7Reason二SIP;cause二487;\</p>
    <p>text=〃Request Terminated"; index=l. 1.2，</p>
    <p>〈sip:User4@UA4. example. com"?Reason二SIP; cause=603; \</p>
    <p>text="Decline〃&gt;; index=l. 1.3</p>
    <p>&lt;sip:User5@UA5. example. com&gt;;index=l. 2;</p>
    <p>digest=dl74ab98d277d9f5a5611c2c9f419d9f</p>
    <p>步骤6.用户代理5发送200 OK响应给代理服务器1，代理服 务器1把这个200 OK响应转发给用户代理1，用户代理1向用户代 理5发送ACK响应，在用户代理1和用户代理5之间建立这个呼叫会 话。</p>
    <p>由此可见，扩展参数digest携带的摘要信息随着History-Info 头域内容不同而不同，通过摘要信息可以方便、准确、快捷的判断该 History-Info头域是否可信。通过为SIP消息的请求历史信息计算摘要的方式，可以有效的规避请求历史信息被伪造、篡改、删除和重</p>
    <p>新排列等问题，而且可以摆脱对TLS这类安全网络的依赖，使该功能 可以在普通的IP网络中被应用。</p>
    <p>图3给出的实施例主要描述根据本发明方法，SIP会话经过重定 向服务器和代理服务器时对请求历史信息的处理过程。具体的处理过 程如图3所示：</p>
    <p>1. 用户A发起一个到用户B的INVITE请求，该请求首先被发 送到重定向服务器。在该请求中包含了请求历史记录，并为该请求历 史记录计算了一个摘要。</p>
    <p>History-Info: &lt;sip:bob@biloxi. example, com〉； index=l;\ digest=6c652063616c6c7320746f2062652072</p>
    <p>2. 重定向服务器返回302响应，该响应的Contact头域中包 含了用户B当前的SIP地址。在该响应中会包含INVITE请求中所携 带的History-Info头域。</p>
    <p>History-Info: &lt;sip:bob@biloxi. example, com〉； index=l;\ digest=6c652063616c6c7320746f2062652072</p>
    <p>3. 用户A生成一个ACK请求发送给重定向服务器，结束重定 向的过程。</p>
    <p>4. 用户A使用用户B当前的SIP地址生成一个新的INVITE请 求，并把该请求发送到代理服务器。代理服务器接收到INVITE请求 后，从History-Info头域中提取digest参数所携带的摘要，重新计 算原History-Info头域中的请求历史记录的摘要，并把新计算出的 摘要和携带过来的摘要进行比较。比较合格后，在这个INVITE请求 的History-Info头域中，增加了代理服务器的信息条目，并为该请 求历史记录计算了一个新的摘要放入digest参数中。</p>
    <p>History-Info:&lt;sip:bob@biloxi. example. com"?Reason二SIP;cau se=302〉\</p>
    <p>text=〃Moved Temporarily"; index=l，&lt;sip:bob@chicago. example, com〉； index=2;\</p>
    <p>digest=43b8fcb8c4d2bbb8f6c7ebc7f3b5c455</p>
    <p>5. 代理服务器把该INVITE请求转发给用户B。用户B接收到 INVITE请求后，从History-Info头域中提取digest参数所携带的 摘要，重新计算原History-Info头域中的请求历史记录的摘要，并 把新计算出的摘要和携带过来的摘要进行比较。比较合格后，在该 INVITE请求中，增加了用户B的信息条目，并为该请求历史记录计 算了一个新的摘要放入digest参数中。</p>
    <p>History-Info:&lt;sip:bob@biloxi. example. com7Reason二SIP;cau se=302〉\</p>
    <p>text=〃Moved Temporarily"; index=l， 〈sip:bob@chicago. example, com〉； index=2， 〈sip:bob@client.Chicago, example, com〉； index=2.1;\ digest=c4bfbleab5d8d6b7ala3d5e2b8f6caf5</p>
    <p>图4给出的实施例主要描述根据本发明方法，SIP串行分岔会话 中对请求历史信息的处理过程，具体的处理过程如图4所示：</p>
    <p>1. 位于用户代理1的用户A发起一个到用户B的INVITE请求。 该请求首先被发送到代理服务器1。</p>
    <p>2. 代理服务器1接收到INVITE请求后，把用户A和代理服务 器1的信息条目加入到History-Info头域中，并为该请求历史记录 计算了一个摘要放入digest参数中。然后把该请求转发给用户B的 其中一个用户代理（用户代理2)。</p>
    <p>History-Info: &lt;sip:UserA@example. com〉； index二l, &lt;sip:UserA@ims. example, com》'index二l. 1;\ digest=accbfcccelb9a9d2bbb8f6cfecd3a6bb</p>
    <p>3. 转发INVITE请求后，代理服务器1为该INVITE请求产生 一个100响应发送给用户代理1。</p>
    <p>4. 用户代理2接收到INVITE请求后产生一个302响应给代理服务器l，告知用户B当前的SIP地址。</p>
    <p>5. 代理服务器1接收到302响应后，使用用户B当前的SIP 地址，把该INVITE请求转发给用户B的用户代理（用户代理3)。在 该INVITE请求的History-Info头域中，增加了用户代理3的信息条 目，删除原摘要，并为该请求历史信息重新计算一个新的摘要。</p>
    <p>History&#8212;Info: 〈sip:UserA@example. com〉； index=l, &lt;sip:UserA@ims. example. com?Reason二SIP;\ cause=302: text=〃Moved Temporarily"); index=l. 1， 〈sip:UserB@example. com&gt;; index=l. 2;\ digest=205468652072756c657320666f722064</p>
    <p>6. 用户代理3接收到INVITE请求后，为该INVITE请求产生 一个180响应。</p>
    <p>7. 代理服务器1接收到用户代理3产生的180响应后，把该 180响应转发给用户代理1。</p>
    <p>8. 假设用户代理3不可用，重发请求发送多次后超时，代理 服务器1继续把INVITE请求转发给用户B的另一个用户代理（用户 代理4)。在该INVITE请求的History-Info头域中，增加了用户代 理4的信息条目，删除原摘要，并为该请求历史信息重新计算一个新 的摘要。</p>
    <p>History-Info: &lt;sip:UserA@example. com〉； index=l， 〈sip:UserA@ims. example. com7Reason二SIP;\ cause=302; text二〃Moved Temporarily"; index=l. 1， &lt;sip:UserB@example. com7ReasorFSIP;cause-480;\ text=〃Tempomrily Unatvailable〃 〉； index=l. 2， &lt;sip:UserC@example. com〉；index=l. 3;\ digest=d5d5b9e6b6a8c2b7d3c9b5bdccd8b6a8</p>
    <p>9. 用户代理4忙，为该INVITE请求产生一个486响应。</p>
    <p>10. 代理服务器1接收到用户代理4的486响应后，产生一个 ACK请求给用户代理4。11. 代理服务器1把用户代理4的486响应转发给用户代理1。 在该486响应中，包含了 INVITE请求中的History-Info头域。</p>
    <p>History&#8212;Info: &lt;sip:UserA@example. com&gt;; index=l， &lt;sip:UserA@ims. example. com7Reason二SIP;\ cause=302; text=〃Moved Temporarily"; index二l. 1， &lt;sip:UserB@example. com"?Reason二SIP; cause=480; \ text=〃Temporarily Unavailable" &gt;; index=l. 2， &lt;sip:UserC@example. com〉； index=l. 3;\ digest=d5d5b9e6b6a8c2b7d3c9b5bdccd8b6a8</p>
    <p>12. 用户代理1接收到486响应后，产生一个ACK请求，结束 该INVITE请求流程。</p>
    <p>上述实施例中，是以各digest参数所携带的摘要信息可信为基 础描述的。如果各digest参数所携带的摘要信息不可信，SIP代理 服务器直接丢弃该SIP消息，不再继续处理。SIP代理服务器接收到 此类不可信消息时，可以产生错误日志并生成告警信息，具体错误处 理流程不在本专利中描述。</p>
  </div>
  </div></div><div class="patent-section patent-tabular-section"><a id="forward-citations"></a><div class="patent-section-header"><span class="patent-section-title"> 被以下专利引用</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th">引用专利</th><th class="patent-data-table-th"> 申请日期</th><th class="patent-data-table-th">公开日</th><th class="patent-data-table-th"> 申请人</th><th class="patent-data-table-th">专利名</th></tr></thead><tr><td class="patent-data-table-td citation-patent"><a href="/patents/CN102143010A?cl=zh">CN102143010A</a><span class='patent-tooltip-anchor' data-tooltip-text="由审查员引用"> *</span></td><td class="patent-data-table-td patent-date-value">2010年8月24日</td><td class="patent-data-table-td patent-date-value">2011年8月3日</td><td class="patent-data-table-td ">华为软件技术有限公司</td><td class="patent-data-table-td ">检测报文被修改的方法、发送方设备和接收方设备</td></tr></table><div class="patent-section-footer">* 由审查员引用</div></div><div class="patent-section patent-tabular-section"><a id="classifications"></a><div class="patent-section-header"><span class="patent-section-title">分类</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> </th><th class="patent-data-table-th"> </th></tr></thead><tr><td class="patent-data-table-td ">国际分类号</td><td class="patent-data-table-td "><span class="nested-value"><a href="https://www.google.com/url?id=8bJtBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029060000">H04L29/06</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=8bJtBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04L0029080000">H04L29/08</a></span>, <span class="nested-value"><a href="https://www.google.com/url?id=8bJtBwABERAJ&amp;q=http://web2.wipo.int/ipcpub/&amp;usg=AFQjCNER44F5jlVoswCkvW3YEcB5lW4moA#refresh=page&amp;notion=scheme&amp;version=20130101&amp;symbol=H04M0007000000">H04M7/00</a></span></td></tr></table><div class="patent-section-footer"></div></div><div class="patent-section patent-tabular-section"><a id="legal-events"></a><div class="patent-section-header"><span class="patent-section-title">法律事件</span></div><table class="patent-data-table"><thead class="patent-data-table-thead"><tr class="patent-data-table"><th class="patent-data-table-th"> 日期</th><th class="patent-data-table-th">代码</th><th class="patent-data-table-th">事件</th><th class="patent-data-table-th">说明</th></tr></thead><tr><td class="patent-data-table-td patent-date-value">2009年9月30日</td><td class="patent-data-table-td ">C06</td><td class="patent-data-table-td ">Publication</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2009年11月25日</td><td class="patent-data-table-td ">C10</td><td class="patent-data-table-td ">Request of examination as to substance</td><td class="patent-data-table-td "></td></tr><tr><td class="patent-data-table-td patent-date-value">2012年7月25日</td><td class="patent-data-table-td ">C14</td><td class="patent-data-table-td ">Granted</td><td class="patent-data-table-td "></td></tr></table><div class="patent-section-footer"></div></div><div class="modal-dialog" id="patent-images-lightbox"><div class="patent-lightbox-controls"><div class="patent-lightbox-rotate-controls"><div class="patent-lightbox-rotation-text">旋转</div><div class="rotate-icon rotate-ccw-icon"></div><div class="rotate-icon rotate-cw-icon"></div></div><div class="patent-lightbox-index-counter"></div><a class="patent-lightbox-fullsize-link" target="_blank">原始图片</a><div class="patent-drawings-control patent-drawings-next"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_right.png" alt="Next page"width="21" height="21" /></div><div class="patent-drawings-control patent-drawings-prev"><img class="patent-drawings-button-img"src="/googlebooks/images/kennedy/page_left.png" alt="Previous page"width="21" height="21" /></div></div><div class="modal-dialog-content"><div class="patent-lightbox-image-holder"><div class="patent-lightbox-placeholder"></div></div></div></div><script>_OC_initPatentsAtb({image_not_available_html: " 未提供图片。\x3ca href\x3d//docs.google.com/viewer?url\x3dpatentimages.storage.googleapis.com/pdfs/f11070be592d9d37e8c1/CN101547222A.pdf\x3e查看 PDF\x3c/a\x3e"});</script></div></div></div></div></div><script>(function() {var href = window.location.href;if (href.indexOf('?') !== -1) {var parameters = href.split('?')[1].split('&');for (var i = 0; i < parameters.length; i++) {var param = parameters[i].split('=');if (param[0] == 'focus') {var elem = document.getElementById(param[1]);if (elem) {elem.focus();}}}}})();</script><script>_OC_addFlags({LockSrc:"/books/javascript/lock_50a6672b5f82ffbd39b7a9e87fd4594c.js", Host:"https://www.google.com/", IsBooksRentalEnabled:1, IsBrowsingHistoryEnabled:1, IsWebReaderSvgEnabled:0, IsImageModeNotesEnabled:1, IsOfflineBubbleEnabled:1, IsFutureOnSaleVolumesEnabled:1, IsBooksUnifiedLeftNavEnabled:1, IsMobileRequest:0, IsZipitFolderCollectionEnabled:1, IsAdsDisabled:0, IsEmbeddedMediaEnabled:1, IsImageModeAnnotationsEnabled:1, IsMyLibraryGooglePlusEnabled:1, IsImagePageProviderEnabled:1, IsBookcardListPriceSmall:0, IsInternalUser:0, IsBooksShareButtonEnabled:0, IsDisabledRandomBookshelves:0});_OC_Run({"enable_p13n":false,"is_cobrand":false,"sign_in_url":"https://www.google.com/accounts/Login?service=\u0026continue=https://www.google.com/patents%3Fcl%3Dzh%26hl%3Dzh-CN\u0026hl=zh-CN"}, {"volume_id":"","is_ebook":true,"volumeresult":{"has_flowing_text":false,"has_scanned_text":true,"can_download_pdf":false,"can_download_epub":false,"is_pdf_drm_enabled":false,"is_epub_drm_enabled":false,"download_pdf_url":"https://www.google.com/patents/download/%E4%B8%80%E7%A7%8D%E5%9C%A8VoIP%E7%BD%91%E7%BB%9C%E4%B8%AD%E4%BC%A0%E8%BE%93SIP%E8%AF%B7%E6%B1%82%E5%8E%86.pdf?id=8bJtBwABERAJ\u0026hl=zh-CN\u0026output=pdf\u0026sig=ACfU3U1F30cObL8rBj11yZLTdthbS8Y2pw"},"sample_url":"https://www.google.com/patents/reader?id=8bJtBwABERAJ\u0026hl=zh-CN\u0026printsec=frontcover\u0026output=reader\u0026source=gbs_atb_hover","is_browsable":true,"is_public_domain":true}, {});</script><div id="footer_table" style="font-size:83%;text-align:center;position:relative;top:20px;height:4.5em;margin-top:2em"><div style="margin-bottom:8px"><a href="https://www.google.com/search?hl=zh-CN"><nobr>Google&nbsp;首页</nobr></a> - <a href="//www.google.com/patents/sitemap/"><nobr>站点地图</nobr></a> - <a href="http://www.google.com/googlebooks/uspto.html"><nobr>美国专利商标局 (USPTO) 专利信息批量下载</nobr></a> - <a href="/intl/zh-CN/privacy/"><nobr>隐私权政策</nobr></a> - <a href="/intl/zh-CN/policies/terms/"><nobr>服务条款</nobr></a> - <a href="https://support.google.com/faqs/answer/2539193?hl=zh-CN"><nobr> 关于 Google 专利</nobr></a> - <a href="//www.google.com/tools/feedback/intl/zh-CN/error.html" onclick="try{_OC_startFeedback({productId: '72792',locale: 'zh-CN'});return false;}catch(e){}"><nobr>发送反馈</nobr></a></div></div> <script type="text/javascript">var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript">var pageTracker = _gat._getTracker("UA-27188110-1");pageTracker._setCookiePath("/patents/");pageTracker._trackPageview();</script> </body></html>